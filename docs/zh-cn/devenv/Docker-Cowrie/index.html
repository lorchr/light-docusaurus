<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-zh-cn/devenv/Docker-Cowrie" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Docker-Cowrie | Light Docusaurus</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://lorchr.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://lorchr.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://lorchr.github.io/docs/zh-cn/devenv/Docker-Cowrie/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Docker-Cowrie | Light Docusaurus"><meta data-rh="true" name="description" content="- Docker安装Cowrie蜜罐并通过企业微信实现告警"><meta data-rh="true" property="og:description" content="- Docker安装Cowrie蜜罐并通过企业微信实现告警"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://lorchr.github.io/docs/zh-cn/devenv/Docker-Cowrie/"><link data-rh="true" rel="alternate" href="https://lorchr.github.io/docs/zh-cn/devenv/Docker-Cowrie/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://lorchr.github.io/docs/zh-cn/devenv/Docker-Cowrie/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://TLGHDZ3Y2I-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Light Docusaurus RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Light Docusaurus Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Light Docusaurus" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.e8086d6f.css">
<script src="/assets/js/runtime~main.6257abc0.js" defer="defer"></script>
<script src="/assets/js/main.34b50ab8.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Torch Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Torch Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Torch</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/guide/">Torch</a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/middleware/">Middleware</a><a class="navbar__item navbar__link" href="/electron/">Electron</a><a class="navbar__item navbar__link" href="/postman/">Postman</a><a class="navbar__item navbar__link" href="/diy/">DIY</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/docs/zh-cn/devenv/Docker-Cowrie/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li></ul></div><a href="https://github.com/lorchr/light-docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/guide/">Guide</a><button aria-label="展开侧边栏分类 &#x27;Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/develop-environment/">Develop Environment</a><button aria-label="折叠侧边栏分类 &#x27;Develop Environment&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/">Dev Environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/WSL-Docker/">WSL-Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/IDEA/">IDEA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Maven-Mvnd/">Maven-Mvnd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-Mysql/">Docker-Mysql</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-Pgsql/">Docker-Pgsql</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-Oracle/">Docker-Oracle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-Mssql/">Docker-Mssql</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-Redis/">Docker-Redis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-InfluxDB/">Docker-InfluxDB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-Elasticsearch/">Docker-Elasticsearch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-EMQX/">Docker-EMQX</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-Kafka/">Docker-Kafka</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-RabbitMQ/">Docker-RabbitMQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-RocketMQ/">Docker-RocketMQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-Nginx/">Docker-Nginx</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-MinIO/">Docker-MinIO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-Chat2DB/">Docker-Chat2DB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-Nodered/">Docker-Nodered</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-Sonarqube/">Docker-Sonarqube</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-Gitea/">Docker-Gitea</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/zh-cn/devenv/Docker-Cowrie/">Docker-Cowrie</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/Docker-Obsidian/">Docker-Obsidian</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zh-cn/devenv/IDEA-Remote-Develop/">IDEA-Remote-Develop</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/java-jvm/">Java (JVM)</a><button aria-label="展开侧边栏分类 &#x27;Java (JVM)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/spring-boot/">Spring Boot</a><button aria-label="展开侧边栏分类 &#x27;Spring Boot&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/spring-cloud/">Spring Cloud</a><button aria-label="展开侧边栏分类 &#x27;Spring Cloud&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/spring-security/">Spring Security</a><button aria-label="展开侧边栏分类 &#x27;Spring Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/spring-authorization-server/">Spring Authorization Server</a><button aria-label="展开侧边栏分类 &#x27;Spring Authorization Server&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/active-directory/">Active Directory</a><button aria-label="展开侧边栏分类 &#x27;Active Directory&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/database/">Database</a><button aria-label="展开侧边栏分类 &#x27;Database&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/git/">Git</a><button aria-label="展开侧边栏分类 &#x27;Git&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/linux/">Linux</a><button aria-label="展开侧边栏分类 &#x27;Linux&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/docker/">Docker</a><button aria-label="展开侧边栏分类 &#x27;Docker&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/kubernetes/">Kubernetes</a><button aria-label="展开侧边栏分类 &#x27;Kubernetes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/test/">Test</a><button aria-label="展开侧边栏分类 &#x27;Test&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/others/">Others</a><button aria-label="展开侧边栏分类 &#x27;Others&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/zh-cn/awesome-open-source/">Github Speed UP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/zh-cn/windows/">Windows</a></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/develop-environment/"><span itemprop="name">Develop Environment</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Docker-Cowrie</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Docker-Cowrie</h1></header><ul>
<li><a href="https://blog.csdn.net/weixin_42451330/article/details/134718748" target="_blank" rel="noopener noreferrer">Docker安装Cowrie蜜罐并通过企业微信实现告警</a></li>
<li><a href="https://blog.csdn.net/qq_51756940/article/details/135771900" target="_blank" rel="noopener noreferrer">Docker快速搭建ssh蜜罐Cowrie</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="一cowrie简介">一、Cowrie简介<a href="#一cowrie简介" class="hash-link" aria-label="一、Cowrie简介的直接链接" title="一、Cowrie简介的直接链接">​</a></h2>
<p>Cowrie是一个基于SSH/Telnet协议的开源蜜罐项目，主要用于模拟SSH和Telnet服务，吸引攻击者并记录他们的行为。它可以模拟SSH登录过程，包括用户名、密码输入等，以便跟踪潜在的攻击者。Cowrie提供了日志记录、事件通知和存档等功能，有助于研究网络攻击的技术和模式。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="二前期准备">二、前期准备<a href="#二前期准备" class="hash-link" aria-label="二、前期准备的直接链接" title="二、前期准备的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1为了能够保证数据持久化同时进行相关的参数传递需提前创建准备目录">1、为了能够保证数据持久化，同时进行相关的参数传递，需提前创建准备目录<a href="#1为了能够保证数据持久化同时进行相关的参数传递需提前创建准备目录" class="hash-link" aria-label="1、为了能够保证数据持久化，同时进行相关的参数传递，需提前创建准备目录的直接链接" title="1、为了能够保证数据持久化，同时进行相关的参数传递，需提前创建准备目录的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p cowrie/log/    # cowrie txt输出日志目录，通过文本分析使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p cowrie/etc     # cowrie 配置文件目录</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2在cowrieetc目录创建cowrie配置cowriecfg将以下配置复制到cowriecfg中也可从官网cowriecfgdist中获取获取后需要手动把telnet-改为-true文本获取改为-true获取地址-httpsgithubcomcowriecowrieblobmasteretccowriecfgdist">2、在cowrie/etc目录创建cowrie配置cowrie.cfg，将以下配置复制到cowrie.cfg中，也可从官网cowrie.cfg.dist中获取，获取后需要手动把telnet 改为 true，文本获取改为 true，获取地址 <a href="https://github.com/cowrie/cowrie/blob/master/etc/cowrie.cfg.dist" target="_blank" rel="noopener noreferrer">https://github.com/cowrie/cowrie/blob/master/etc/cowrie.cfg.dist</a><a href="#2在cowrieetc目录创建cowrie配置cowriecfg将以下配置复制到cowriecfg中也可从官网cowriecfgdist中获取获取后需要手动把telnet-改为-true文本获取改为-true获取地址-httpsgithubcomcowriecowrieblobmasteretccowriecfgdist" class="hash-link" aria-label="2在cowrieetc目录创建cowrie配置cowriecfg将以下配置复制到cowriecfg中也可从官网cowriecfgdist中获取获取后需要手动把telnet-改为-true文本获取改为-true获取地址-httpsgithubcomcowriecowrieblobmasteretccowriecfgdist的直接链接" title="2在cowrieetc目录创建cowrie配置cowriecfg将以下配置复制到cowriecfg中也可从官网cowriecfgdist中获取获取后需要手动把telnet-改为-true文本获取改为-true获取地址-httpsgithubcomcowriecowrieblobmasteretccowriecfgdist的直接链接">​</a></h3>
<div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># DO NOT EDIT THIS FILE!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Changes to default files will be lost on update and are difficult to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># manage and support.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Please make any changes to system defaults by overriding them in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># cowrie.cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># To override a specific setting, copy the name of the stanza and</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># setting to the file where you wish to override it.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># General Cowrie Options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[honeypot]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Sensor name is used to identify this Cowrie instance. Used by the database</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># logging modules such as mysql.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># If not specified, the logging modules will instead use the IP address of the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># server as the sensor name.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: not specified)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#sensor_name=myhostname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Hostname for the honeypot. Displayed by the shell prompt of the virtual</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># environment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: svr04)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hostname = svr04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Directory where to save log files in.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: log)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log_path = var/log/cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Directory where to save downloaded artifacts in.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: downloads)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">download_path = ${honeypot:state_path}/downloads</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Directory for static data files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: share/cowrie)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">share_path = share/cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Directory for variable state files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: var/lib/cowrie)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">state_path = var/lib/cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Directory for config files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: etc)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etc_path = etc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Directory where virtual file contents are kept in.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This is only used by commands like &#x27;cat&#x27; to display the contents of files.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Adding files here is not enough for them to appear in the honeypot - the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># actual virtual filesystem is kept in filesystem_file (see below)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: honeyfs)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contents_path = honeyfs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Directory for creating simple commands that only output text.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The command must be placed under this directory with the proper path, such</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># as:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   txtcmds/usr/bin/vi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The contents of the file will be the output of the command when run inside</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># the honeypot.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># In addition to this, the file must exist in the virtual filesystem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: txtcmds)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">txtcmds_path = txtcmds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Maximum file size (in bytes) for downloaded files to be stored in &#x27;download_path&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># A value of 0 means no limit. If the file size is known to be too big from the start,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># the file will not be stored on disk at all.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#download_limit_size = 10485760</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># TTY logging will log a transcript of the complete terminal interaction in UML</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># compatible format.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ttylog = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Default directory for TTY logs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: ttylog_path = %(state_path)s/tty)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ttylog_path = ${honeypot:state_path}/tty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Interactive timeout determines when logged in sessions are</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># terminated for being idle. In seconds.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: 180)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interactive_timeout = 180</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Authentication Timeout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The server disconnects after this time if the user has not successfully logged in. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The default is 120 seconds.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">authentication_timeout = 120</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># EXPERIMENTAL: back-end to user for Cowrie, options: proxy or shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: shell)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">backend = shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Timezone Cowrie uses for logging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This can be any valid timezone for the TZ environment variable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The special value `system` will let Cowrie use the system time zone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># `system` is not recommended because you will need to deal with daylight</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># savings time and other special cases yourself when analysing the logs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">timezone = UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom prompt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># By default, Cowrie creates a shell prompt like: root@svr03:~#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># If you want something totally custom, uncomment the option below and set your prompt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Beware that the path won&#x27;t be included in your prompt any longer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># prompt = hello&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Network Specific Options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># IP address to bind to when opening outgoing connections. Used by wget and</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># curl commands.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: not specified)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#out_addr = 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Fake address displayed as the address of the incoming connection.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This doesn&#x27;t affect logging, and is only used by honeypot commands such as</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># &#x27;w&#x27; and &#x27;last&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># If not specified, the actual IP address is displayed instead (default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># behaviour).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: not specified)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#fake_addr = 192.168.66.254</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The IP address on which this machine is reachable on from the internet.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Useful if you use portforwarding or other mechanisms. If empty, Cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># will determine by itself. Used in &#x27;netstat&#x27; output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#internet_facing_ip = 9.9.9.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Authentication Specific Options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Class that implements the checklogin() method.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Class must be defined in cowrie/core/auth.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Default is the &#x27;UserDB&#x27; class which uses the password database.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Alternatively the &#x27;AuthRandom&#x27; class can be used, which will let</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># a user login after a random number of attempts.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># It will also cache username/password combinations that allow login.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_class = UserDB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># When AuthRandom is used also set the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  auth_class_parameters: &lt;min try&gt;, &lt;max try&gt;, &lt;maxcache&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  for example: 2, 5, 10 = allows access after randint(2,5) attempts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  and cache 10 combinations.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#auth_class = AuthRandom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#auth_class_parameters = 2, 5, 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[backend_pool]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Backend Pool Configurations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># only used on the cowrie instance that runs the pool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># enable this to solely run the pool, regardless of other configurations (disables SSH and Telnet)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pool_only = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># time between full VM recycling (cleans older VMs and boots newer ones) - involves some downtime between cycles</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># -1 to disable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">recycle_period = 1500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># change interface below to allow connections from outside (e.g. remote pool)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listen_endpoints = tcp:6415:interface=127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># guest snapshots</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">save_snapshots = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">snapshot_path = ${honeypot:state_path}/snapshots</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># pool xml configs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config_files_path = ${honeypot:share_path}/pool_configs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">network_config = default_network.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nw_filter_config = default_filter.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># libvirt URI, common settings are qemu:///system or qemu:///session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libvirt_uri = qemu:///system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Use this syntax to directly connect to the UNIX socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># libvirt_uri = qemu+unix:///session?socket=/home/cowrie/.cache/libvirt/libvirt-sock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># =====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Guest details (for a generic x86-64 guest, like Ubuntu)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Used to provide configuration details to save snapshots, identify</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># running guests, and provide other details to Cowrie.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   - SSH and Telnet ports: which ports are listening for these services in the guest OS;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#     if you&#x27;re not using one of them omit the config or set to 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   - Guest private key: used by the pool to control the guest&#x27;s state via SSH; guest must</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#     have the corresponding pubkey in root&#x27;s authorized_keys (not implemented)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># =====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">guest_config = default_guest.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">guest_privkey = ${honeypot:state_path}/ubuntu18.04-guest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">guest_tag = ubuntu18.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">guest_ssh_port = 22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">guest_telnet_port = 23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Configs below are used on default XMLs provided.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># If you provide your own XML in guest_config you don&#x27;t need these configs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Guest hypervisor can be qemu or kvm, for example. Recent hardware has KVM,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># which is more performant than the qemu software-based emulation. Guest arch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># must match your machine&#x27;s. If it&#x27;s older or you&#x27;re unsure, set it to &#x27;qemu&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Memory size is in MB.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Advanced: guest_qemu_machine defines which machine Qemu emulates for your VM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># If you get a &quot;unsupported machine type&quot; exception when VMs are loading, change</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># it to a compatible machine listed by the command: &#x27;qemu-system-x86_64 -machine help&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">guest_image_path = /home/cowrie/cowrie-imgs/ubuntu18.04-minimal.qcow2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">guest_hypervisor = kvm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">guest_memory = 512</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">guest_qemu_machine = pc-q35-bionic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># =====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Guest details (for OpenWRT with ARM architecture)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Used to provide configuration details to save snapshots, identify running guests,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># and provide other details to Cowrie.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># =====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#guest_config = wrt_arm_guest.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#guest_tag = wrt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#guest_ssh_port = 22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#guest_telnet_port = 23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Configs below are used on default XMLs provided.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># If you provide your own XML in guest_config you don&#x27;t need these configs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Guest hypervisor can be qemu or kvm, for example. Recent hardware has KVM,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># which is more performant than the qemu software-based emulation. Guest arch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># must match your machine&#x27;s.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Memory size is in MB.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Advanced: guest_qemu_machine defines which machine Qemu emulates for your VM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># If you get a &quot;unsupported machine type&quot; exception when VMs are loading, change</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># it to a compatible machine listed by the command: &#x27;qemu-system-arm -machine help&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#guest_image_path = /home/cowrie/cowrie-imgs/root.qcow2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#guest_hypervisor = qemu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#guest_memory = 256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#guest_kernel_image = /home/cowrie/cowrie-imgs/zImage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#guest_qemu_machine = virt-2.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># =====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Other configs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># =====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Use NAT (for remote pool)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Guests exist in a local interface created by libvirt; NAT functionality creates a port in the host,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># exposed to a public interface, and forwards TCP data to and from the libvirt private interface.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Cowrie&#x27;s proxy receives the public information instead of the local IP of guests.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use_nat = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nat_public_ip = 192.168.1.40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Proxy Options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxy]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># type of backend:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   - simple: backend machine deployed by you (CAREFUL WITH SECURITY ASPECTS!!), specify hosts and ports below</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   - pool: cowrie-managed pool of virtual machines, configure below</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">backend = pool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># =====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Simple Backend Configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># =====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">backend_ssh_host = localhost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">backend_ssh_port = 2022</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">backend_telnet_host = localhost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">backend_telnet_port = 2023</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># =====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Pool Backend Configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># =====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># generic pool configurable settings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pool_max_vms = 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pool_vm_unused_timeout = 600</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># allow sharing guests between different attackers if no new VMs are available</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pool_share_guests = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Where to deploy the backend pool (only if backend = pool)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   - &quot;local&quot;: same machine as the proxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   - &quot;remote&quot;: set host and port of the pool below</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pool = local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Remote pool configurations (used with pool=remote)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pool_host = 192.168.1.40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pool_port = 6415</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># =====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Proxy Configurations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># =====================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># real credentials to log into backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">backend_user = root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">backend_pass = root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Telnet prompt detection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># To detect authentication prompts (and spoof auth details to the ones the backend accepts) we need to capture</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># login and password prompts, and spoof data to the backend in order to successfully authenticate. If disabled,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># attackers can only use the real user credentials of the backend.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">telnet_spoof_authentication = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># These regex were made using Ubuntu 18.04; you have to adapt these for the prompts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># from your backend. You can enable raw logging above to analyse data passing through</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># and identify the format of the prompts you need.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># You should generally include &quot;.*&quot; at the beginning and end of prompts, since Telnet messages can contain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># more data than the prompt.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># For login it is usually &lt;hostname&gt; login:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">telnet_username_prompt_regex = (\n|^)ubuntu login: .*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Password prompt is usually only the word Password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">telnet_password_prompt_regex = .*Password: .*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This data is sent by clients at the beginning of negotiation (before the password prompt), and contains the username</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># that is trying to log in. We replace that username with the one in &quot;backend_user&quot; to allow the chance of a successful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># login after the first password prompt. We are only able to check if credentials are allowed after the password is</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># inserted. If they are, then a correct username was already sent and authentication succeeds; if not, we send a fake</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># password to force authentication to fail.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">telnet_username_in_negotiation_regex = (.*\xff\xfa.*USER\x01)(.*?)(\xff.*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Other configs #</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># log raw TCP packets in SSh and Telnet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log_raw = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Shell Options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Options around Cowrie&#x27;s Shell Emulation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[shell]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># File in the Python pickle format containing the virtual filesystem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This includes the filenames, paths, permissions for the Cowrie filesystem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># but not the file contents. This is created by the bin/createfs utility from</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># a real template linux installation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: fs.pickle)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">filesystem = ${honeypot:share_path}/fs.pickle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># File that contains output for the `ps` command.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: share/cowrie/cmdoutput.json)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">processes = share/cowrie/cmdoutput.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Fake architectures/OS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># When Cowrie receive a command like /bin/cat XXXX (where XXXX is an executable)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># it replies with the content of a dummy executable (located in data_path/arch)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># compiled for an architecture/OS/endian_mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># arch can be a comma separated list. When there are multiple elements, a random</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># is chosen at login time.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: linux-x64-lsb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">arch = linux-x64-lsb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Here the list of supported OS-ARCH-ENDIANESS executables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bsd-aarch64-lsb:	    64-bit	LSB	ARM aarch64 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bsd-aarch64-msb:	    64-bit	MSB	ARM aarch64 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bsd-bfin-msb:		    32-bit	MSB	Analog Devices Blackfin	version	1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bsd-mips64-lsb:		64-bit	LSB	MIPS MIPS-III version 1	(SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bsd-mips64-msb:		64-bit	MSB	MIPS MIPS-III version 1	(SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bsd-mips-lsb:		    32-bit	LSB	MIPS MIPS-I version 1 (FreeBSD)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bsd-mips-msb:		    32-bit	MSB	MIPS MIPS-I version 1 (FreeBSD)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bsd-powepc64-lsb:	    64-bit	MSB	64-bit PowerPC or cisco	7500 version 1 (FreeBSD)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bsd-powepc-msb:		32-bit	MSB	PowerPC	or cisco 4500 version 1	(FreeBSD)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bsd-riscv64-lsb:	    64-bit	LSB	UCB RISC-V version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bsd-sparc64-msb:	    64-bit	MSB	SPARC V9 relaxed memory	ordering version 1 (FreeBSD)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bsd-sparc-msb:		32-bit	MSB	SPARC version 1	(SYSV) statically</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bsd-x32-lsb:		    32-bit	LSB	Intel 80386 version 1 (FreeBSD)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bsd-x64-lsb:		    64-bit	LSB	x86-64 version 1 (FreeBSD)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-aarch64-lsb:	64-bit	LSB	ARM aarch64 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-aarch64-msb:	64-bit	MSB	ARM aarch64 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-alpha-lsb:	    64-bit	LSB	Alpha (unofficial) version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-am33-lsb:		32-bit	LSB	Matsushita MN10300 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-arc-lsb:		32-bit	LSB	ARC Cores Tangent-A5 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-arc-msb:		32-bit	MSB	ARC Cores Tangent-A5 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-arm-lsb:		32-bit	LSB	ARM EABI5 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-arm-msb:		32-bit	MSB	ARM EABI5 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-avr32-lsb:	    32-bit	LSB	Atmel AVR 8-bit	version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-bfin-lsb:		32-bit	LSB	Analog Devices Blackfin version	1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-c6x-lsb:		32-bit	LSB	TI TMS320C6000 DSP family version 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-c6x-msb:		32-bit	MSB	TI TMS320C6000 DSP family version 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-cris-lsb:		32-bit	LSB	Axis cris version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-frv-msb:		32-bit	MSB	Cygnus FRV (unofficial) version	1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-h8300-msb:	    32-bit	MSB	Renesas	H8/300 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-hppa64-msb:	    64-bit	MSB	PA-RISC	02.00.00 (LP64) version	1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-hppa-msb:		32-bit	MSB	PA-RISC	*unknown arch 0xf* version 1 (GNU/Linux)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-ia64-lsb:		64-bit	LSB	IA-64 version 1	(SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-m32r-msb:		32-bit	MSB	Renesas	M32R version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-m68k-msb:		32-bit	MSB	Motorola m68k 68020 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-microblaze-msb:	32-bit	MSB	Xilinx MicroBlaze 32-bit RISC version 1	(SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-mips64-lsb:	    64-bit	LSB	MIPS MIPS-III version 1	(SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-mips64-msb:	    64-bit	MSB	MIPS MIPS-III version 1	(SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-mips-lsb:		32-bit	LSB	MIPS MIPS-I version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-mips-msb:		32-bit	MSB	MIPS MIPS-I version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-mn10300-lsb:	32-bit	LSB	Matsushita MN10300 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-nios-lsb:		32-bit	LSB	Altera Nios II version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-nios-msb:		32-bit	MSB	Altera Nios II version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-powerpc64-lsb:	64-bit	LSB	64-bit PowerPC or cisco	7500 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-powerpc64-msb:	64-bit	MSB	64-bit PowerPC or cisco	7500 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-powerpc-lsb:	32-bit	LSB	PowerPC	or cisco 4500 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-powerpc-msb:	32-bit	MSB	PowerPC	or cisco 4500 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-riscv64-lsb:  	64-bit	LSB	UCB RISC-V version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-s390x-msb:    	64-bit	MSB	IBM S/390 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-sh-lsb:	    	32-bit	LSB	Renesas	SH version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-sh-msb:	    	32-bit	MSB	Renesas	SH version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-sparc64-msb:  	64-bit	MSB	SPARC V9 relaxed memory	ordering version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-sparc-msb:    	32-bit	MSB	SPARC version 1	(SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-tilegx64-lsb:	64-bit	LSB	Tilera TILE-Gx version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-tilegx64-msb: 	64-bit	MSB	Tilera TILE-Gx version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-tilegx-lsb:   	32-bit	LSB	Tilera TILE-Gx version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-tilegx-msb:   	32-bit	MSB	Tilera TILE-Gx version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-x64-lsb:	    64-bit	LSB	x86-64 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-x86-lsb:	    32-bit	LSB	Intel 80386 version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># linux-xtensa-msb:   	32-bit	MSB	Tensilica Xtensa version 1 (SYSV)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># osx-x32-lsb:	    	32-bit	LSB Intel 80386</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># osx-x64-lsb:	    	64-bit	LSB	x86-64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># arch = bsd-aarch64-lsb, bsd-aarch64-msb, bsd-bfin-msb, bsd-mips-lsb, bsd-mips-msb, bsd-mips64-lsb, bsd-mips64-msb, bsd-powepc-msb, bsd-powepc64-lsb, bsd-riscv64-lsb, bsd-sparc-msb, bsd-sparc64-msb, bsd-x32-lsb, bsd-x64-lsb, linux-aarch64-lsb, linux-aarch64-msb, linux-alpha-lsb, linux-am33-lsb, linux-arc-lsb, linux-arc-msb, linux-arm-lsb, linux-arm-msb, linux-avr32-lsb, linux-bfin-lsb, linux-c6x-lsb, linux-c6x-msb, linux-cris-lsb, linux-frv-msb, linux-h8300-msb, linux-hppa-msb, linux-hppa64-msb, linux-ia64-lsb, linux-m32r-msb, linux-m68k-msb, linux-microblaze-msb, linux-mips-lsb, linux-mips-msb, linux-mips64-lsb, linux-mips64-msb, linux-mn10300-lsb, linux-nios-lsb, linux-nios-msb, linux-powerpc-lsb, linux-powerpc-msb, linux-powerpc64-lsb, linux-powerpc64-msb, linux-riscv64-lsb, linux-s390x-msb, linux-sh-lsb, linux-sh-msb, linux-sparc-msb, linux-sparc64-msb, linux-tilegx-lsb, linux-tilegx-msb, linux-tilegx64-lsb, linux-tilegx64-msb, linux-x64-lsb, linux-x86-lsb, linux-xtensa-msb, osx-x32-lsb, osx-x64-lsb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Modify the response of &#x27;/bin/uname&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Default (uname -a): Linux &lt;hostname&gt; &lt;kernel_version&gt; &lt;kernel_build_string&gt; &lt;hardware_platform&gt; &lt;operating system&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernel_version = 3.2.0-4-amd64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernel_build_string = #1 SMP Debian 3.2.68-1+deb7u1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hardware_platform = x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">operating_system = GNU/Linux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH Version as printed by &quot;ssh -V&quot; in shell emulation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh_version = OpenSSH_7.9p1, OpenSSL 1.1.1a  20 Nov 2018</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH Specific Options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ssh]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Enable SSH support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Public and private SSH key files. If these don&#x27;t exist, they are created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># automatically.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rsa_public_key = ${honeypot:state_path}/ssh_host_rsa_key.pub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rsa_private_key = ${honeypot:state_path}/ssh_host_rsa_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsa_public_key = ${honeypot:state_path}/ssh_host_dsa_key.pub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dsa_private_key = ${honeypot:state_path}/ssh_host_dsa_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ecdsa_public_key = ${honeypot:state_path}/ssh_host_ecdsa_key.pub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ecdsa_private_key = ${honeypot:state_path}/ssh_host_ecdsa_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ed25519_public_key = ${honeypot:state_path}/ssh_host_ed25519_key.pub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ed25519_private_key = ${honeypot:state_path}/ssh_host_ed25519_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Public keys supported are: ssh-rsa, ssh-dss, ecdsa-sha2-nistp256, ssh-ed25519</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public_key_auth = ssh-rsa,ecdsa-sha2-nistp256,ssh-ed25519</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH version string as present to the client.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Version string MUST start with SSH-2.0- or SSH-1.99-</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Use these to disguise your honeypot from a simple SSH version scan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Examples:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_5.1p1 Debian-5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-1.99-OpenSSH_4.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-1.99-OpenSSH_4.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-1.99-Sun_SSH_1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_4.2p1 Debian-7ubuntu3.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_4.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_4.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_5.1p1 Debian-5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_5.1p1 FreeBSD-20080901</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_5.3p1 Debian-3ubuntu5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_5.3p1 Debian-3ubuntu6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_5.3p1 Debian-3ubuntu7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_5.5p1 Debian-6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_5.5p1 Debian-6+squeeze1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_5.5p1 Debian-6+squeeze2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_5.8p2_hpn13v11 FreeBSD-20110503</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_5.9p1 Debian-5ubuntu1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_6.0p1 Debian-4+deb7u2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SSH-2.0-OpenSSH_5.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: &quot;SSH-2.0-OpenSSH_6.0p1 Debian-4+deb7u2&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version = SSH-2.0-OpenSSH_6.0p1 Debian-4+deb7u2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Cipher encryption algorithms to be used.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MUST be supplied as a comma-separated string without</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># any spaces or newlines.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Use ciphers to limit to more secure algorithms only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># any spaces.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Supported ciphers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># aes128-ctr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># aes192-ctr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># aes256-ctr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># aes256-cbc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># aes192-cbc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># aes128-cbc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3des-cbc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># blowfish-cbc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># cast128-cbc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ciphers = aes128-ctr,aes192-ctr,aes256-ctr,aes256-cbc,aes192-cbc,aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MAC Algorithm to be used.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MUST be supplied as a comma-separated string without</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># any spaces or newlines.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># hmac-sha1 and hmac-md5 are considered insecure now, and</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># instead MACs with higher number of bits should be used.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Supported HMACs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># hmac-sha2-512</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># hmac-sha2-384</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># hmac-sha2-256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># hmac-sha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># hmac-md5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">macs = hmac-sha2-512,hmac-sha2-384,hmac-sha2-256,hmac-sha1,hmac-md5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Compression Method to be used.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MUST be supplied as a comma-separated string without</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># any spaces or newlines.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Supported Compression Methods:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># zlib@openssh.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># zlib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">compression = zlib@openssh.com,zlib,none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Endpoint to listen on for incoming SSH connections.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># See https://twistedmatrix.com/documents/current/core/howto/endpoints.html#servers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: listen_endpoints = tcp:2222:interface=0.0.0.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (use systemd: endpoint for systemd activation)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># listen_endpoints = systemd:domain=INET:index=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># For both IPv4 and IPv6: listen_endpoints = tcp6:2222:interface=\:\:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Listening on multiple endpoints is supported with a single space seperator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># e.g listen_endpoints = &quot;tcp:2222:interface=0.0.0.0 tcp:1022:interface=0.0.0.0&quot; will result listening both on ports 2222 and 1022</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># use authbind for port numbers under 1024</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listen_endpoints = tcp:2222:interface=0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Enable the SFTP subsystem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sftp_enabled = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Enable SSH direct-tcpip forwarding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">forwarding = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This enables redirecting forwarding requests to another address</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Useful for forwarding protocols to other honeypots</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: false)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">forward_redirect = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Configure where to forward the data to.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># forward_redirect_&lt;portnumber&gt; = &lt;redirect ip&gt;:&lt;redirect port&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Redirect http/https</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># forward_redirect_80 = 127.0.0.1:8000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># forward_redirect_443 = 127.0.0.1:8443</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># To record SMTP traffic, install an SMTP honeypoint.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (e.g https://github.com/awhitehatter/mailoney), run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># python mailoney.py -s yahoo.com -t schizo_open_relay -p 12525</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># forward_redirect_25 = 127.0.0.1:12525</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># forward_redirect_587 = 127.0.0.1:12525</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This enables tunneling forwarding requests to another address</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Useful for forwarding protocols to a proxy like Squid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: false)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">forward_tunnel = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Configure where to tunnel the data to.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># forward_tunnel_&lt;portnumber&gt; = &lt;tunnel ip&gt;:&lt;tunnel port&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Tunnel http/https</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># forward_tunnel_80 = 127.0.0.1:3128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># forward_tunnel_443 = 127.0.0.1:3128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># No authentication checking at all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># enabling &#x27;auth_none&#x27; will enable the ssh2 &#x27;auth_none&#x27; authentication method</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># this allows the requested user in without any verification at all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: false)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#auth_none_enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Configure keyboard-interactive login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_keyboard_interactive_enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Telnet Specific Options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[telnet]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Enable Telnet support, disabled by default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Endpoint to listen on for incoming Telnet connections.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># See https://twistedmatrix.com/documents/current/core/howto/endpoints.html#servers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (default: listen_endpoints = tcp:2223:interface=0.0.0.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (use systemd: endpoint for systemd activation)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># listen_endpoints = systemd:domain=INET:index=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># For IPv4 and IPv6: listen_endpoints = tcp6:2223:interface=\:\: tcp:2223:interface=0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Listening on multiple endpoints is supported with a single space seperator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># e.g &quot;listen_endpoints = tcp:2223:interface=0.0.0.0 tcp:2323:interface=0.0.0.0&quot; will result listening both on ports 2223 and 2323</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># use authbind for port numbers under 1024</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listen_endpoints = tcp:2223:interface=0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Source Port to report in logs (useful if you use iptables to forward ports to Cowrie)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#reported_port = 23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Database logging Specific Options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># XMPP Logging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Log to an xmpp server.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[database_xmpp]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#server = sensors.carnivore.it</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#user = anonymous@sensors.carnivore.it</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#password = anonymous</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#muc = dionaea.sensors.carnivore.it</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#signal_createsession = cowrie-events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#signal_connectionlost = cowrie-events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#signal_loginfailed = cowrie-events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#signal_loginsucceeded = cowrie-events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#signal_command = cowrie-events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#signal_clientversion = cowrie-events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#debug=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Output Plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># These provide an extensible mechanism to send audit log entries to third</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># parties. The audit entries contain information on clients connecting to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># the honeypot.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Output entries need to start with &#x27;output_&#x27; and have the &#x27;enabled&#x27; entry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_xmpp]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server = conference.cowrie.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user = cowrie@cowrie.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password = cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">muc = hacker_room</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># JSON based logging module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_jsonlog]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logfile = ${honeypot:log_path}/cowrie.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">epoch_timestamp = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Supports logging to Elasticsearch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This is a simple early release</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_elasticsearch]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">host = localhost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">port = 9200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">index = cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># type has been deprecated since ES 6.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># use _doc which is the default type. See</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://stackoverflow.com/a/53688626 for</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># more information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#type = _doc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># set pipeline = geoip to map src_ip to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># geo location data. You can use a custom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># pipeline but you must ensure it exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># in elasticsearch.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#pipeline = geoip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Authentication. When x-pack.security is enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># in ES, default users have been created and requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># must be authenticated.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Credentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#username = elastic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#password =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># TLS encryption. Communications between the client (cowrie)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># and the ES server should naturally be protected by encryption</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># if requests are authenticated (to prevent from man-in-the-middle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># attacks). The following options are then paramount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># if username and password are provided.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># use ssl/tls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#ssl = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Path to trusted CA certs on disk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#ca_certs = /cowrie/cowrie-git/etc/elastic_ca.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># verify SSL certificates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#verify_certs = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Send login attemp information to SANS DShield</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># See https://isc.sans.edu/ssh.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># You must signup for an api key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Once registered, find your details at: https://isc.sans.edu/myaccount.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_dshield]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userid = userid_here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_key = auth_key_here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">batch_size = 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Graylog logging module for GELF http input</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_graylog]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url = http://graylog.example.com:122011/gelf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Local Syslog output module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This sends log messages to the local syslog daemon.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Facility can be:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># KERN, USER, MAIL, DAEMON, AUTH, LPR, NEWS, UUCP, CRON, SYSLOG and LOCAL0 to LOCAL7.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Format can be:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># text, cef</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_localsyslog]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">facility = USER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">format = text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Text output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This writes audit log entries to a text file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Format can be:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># text, cef</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_textlog]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logfile = ${honeypot:log_path}/audit.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">format = text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL logging module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Database structure for this module is supplied in docs/sql/mysql.sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL logging requires extra software: sudo apt-get install libmysqlclient-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MySQL logging requires an extra Python module: pip install mysql-python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_mysql]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">host = localhost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">database = cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">username = cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password = secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">port = 3306</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Rethinkdb output module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Rethinkdb output module requires extra Python module: pip install rethinkdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_rethinkdblog]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">host = 127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">port = 28015</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table = output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db = cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SQLite3 logging module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Logging to SQLite3 database. To init the database, use the script</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># docs/sql/sqlite3.sql:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#     sqlite3 &lt;db_file&gt; &lt; docs/sql/sqlite3.sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_sqlite]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db_file = cowrie.db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MongoDB logging module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MongoDB logging requires an extra Python module: pip install pymongo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_mongodb]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connection_string = mongodb://username:password@host:port/database</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">database = dbname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Splunk HTTP Event Collector (HEC) output module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># sends JSON directly to Splunk over HTTP or HTTPS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Use &#x27;https&#x27; if your HEC is encrypted, else &#x27;http&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># mandatory fields: url, token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># optional fields: index, source, sourcetype, host</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_splunk]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url = https://localhost:8088/services/collector/event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">token = 6A0EA6C6-8006-4E39-FC44-C35FF6E561A8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">index = cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sourcetype = cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source = cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># HPFeeds3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Python3 implementation of HPFeeds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_hpfeeds3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server = hpfeeds.mysite.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">port = 10000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">identifier = abc123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">secret = secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># VirusTotal output module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># You must signup for an api key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_virustotal]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api_key = 0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">upload = True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug = False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scan_file = True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scan_url = False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Cuckoo output module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_cuckoo]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># no slash at the end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url_base = http://127.0.0.1:8090</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user = user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">passwd = passwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># force will upload duplicated files to cuckoo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">force = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># upload to MalShare</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Register at https://malshare.com/register.php to get your API key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_malshare]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api_key = 130928309823098</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This will produce a _lot_ of messages - you have been warned....</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_slack]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">channel = channel_that_events_should_be_posted_in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">token = slack_token_for_your_bot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://csirtg.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># You must signup for an api key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_csirtg]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">username = wes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">feed = scanners</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">description = random scanning activity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">token = a1b2c3d4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_socketlog]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">address = 127.0.0.1:9000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">timeout = 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Upload files that cowrie has captured to an S3 (or compatible bucket)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Files are stored with a name that is the SHA of their contents</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_s3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The AWS credentials to use.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Leave these blank to use botocore&#x27;s credential discovery e.g .aws/config or ENV variables.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># As per https://github.com/boto/botocore/blob/develop/botocore/credentials.py#L50-L65</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">access_key_id = AKIDEXAMPLE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">secret_access_key = wJalrXUtnFEMI/K7MDENG+bPxRfiCYEXAMPLEKEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The bucket to store the files in. The bucket must already exist.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bucket = my-cowrie-bucket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The region the bucket is in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">region = eu-west-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># An alternate endpoint URL. If you self host a pithos instance you can set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># this to its URL (e.g. https://s3.mydomain.com) - can otherwise be blank</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#endpoint =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Whether or not to validate the S3 certificate. Set this to &#x27;no&#x27; to turn this</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># off. Do not do this for real AWS. It&#x27;s only needed for self-hosted S3 clone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># where you don&#x27;t yet have real certificates.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#verify = no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_influx]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">host = 127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">port = 8086</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">database_name = cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">retention_policy_duration = 12w</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_kafka]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">host = 127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">port = 9092</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">topic = cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_redis]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">host = 127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">port = 6379</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># DB of the redis server. Defaults to 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Password of the redis server. Defaults to None</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># password = secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Name of the list to push to or the channel to publish to. Required</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">keyname = cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Method to use when sending data to redis.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Can be one of [lpush, rpush, publish]. Defaults to lpush</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">send_method = lpush</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Perform Reverse DNS lookup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_reversedns]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Timeout in seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">timeout = 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_greynoise]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Name of the tags separated by comma, for which the IP has to be scanned for.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Example &quot;SHODAN,JBOSS_WORM,CPANEL_SCANNER_LOW&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># If there isn&#x27;t any specific tag then just leave it &quot;all&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tags = all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># It&#x27;s optional to have API key, so if you don&#x27;t want to but</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># API key then leave this option commented</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#api_key = 1234567890</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Upload all files to a MISP instance of your liking.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The API key can be found under Event Actions -&gt; Automation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_misp]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">base_url = https://misp.somedomain.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api_key = secret_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">verify_cert = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">publish_event = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Send message using Telegram bot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 1. Create a bot following https://core.telegram.org/bots#6-botfather to get token.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2. Send message to your bot, then use https://api.telegram.org/bot{bot_token}/getUpdates to find chat_id.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># N.b. bot will only send messages on cowrie.login.success, cowrie.command.input/.failed, and</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># cowrie.session.file_download, to prevent spam. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_telegram]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bot_token = 123456789:AbCDEfGhiJkLmnOpQRstUVWxYZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chat_id = 987654321</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The crashreporter sends data on Python exceptions to api.cowrie.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># To disable set `enabled = false` in cowrie.cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_crashreporter]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Reports login attempts to AbuseIPDB. A short guide is in the original</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># pull request on GitHub: https://github.com/cowrie/cowrie/pull/1346</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_abuseipdb]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#api_key =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#rereport_after = 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#tolerance_window is in minutes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#tolerance_window = 120</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#tolerance_attempts = 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># WARNING: A binary file is read from this directory on start-up. Do not</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># change unless you understand the security implications!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#dump_path = ${honeypot:state_path}/abuseipdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Report login and session tracking attempts via the ThreatJammer.com Report API.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ThreatJammer.com is a risk assessment tool &lt;https://threatjammer.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Read the docs for more information: https://cowrie.readthedocs.io/en/latest/threatjammer/README.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_threatjammer]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bearer_token = THREATJAMMER_API_TOKEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#api_url=https://dublin.report.threatjammer.com/v1/ip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#track_login = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#track_session = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#ttl = 86400</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#category = ABUSE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#tags = COWRIE,LOGIN,SESSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Send output to a Discord webhook</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_discord]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url = https://discord.com/api/webhooks/id/token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Datadog output module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># sends JSON directly to Datadog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># mandatory field: api_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># optional fields (fallback configured in module): ddsource, ddtags, service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># For more information on fields https://docs.datadoghq.com/api/latest/logs/#send-logs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_datadog]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url = https://http-intake.logs.datadoghq.com/api/v2/logs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api_key = abcdef1234567890fedcba0987654321</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ddsource = cowrie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ddtags = env:dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service = honeypot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Oracle Cloud custom logs output module</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># sends JSON directly to Oracle Cloud custom logs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># mandatory field: authtype, log_ocid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># optional fields (to be set if user_principals is selected as authtype): user_ocid, fingerprint, tenancy_ocid, region, keyfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># For more information on Oracle Cloud custom logs: https://docs.oracle.com/en-us/iaas/Content/Logging/Concepts/custom_logs.htm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># For more information on Oracle Cloud user principal authentication method: https://docs.oracle.com/en-us/iaas/Content/API/Concepts/apisigningkey.htm#five</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># For more information on Oracle Cloud instance principal authentication method: https://blogs.oracle.com/developers/post/accessing-the-oracle-cloud-infrastructure-api-using-instance-principals</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[output_oraclecloud]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># authtype must be set either to user_principals or to instance_principals</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">authtype = instance_principals</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># following parameters must be set in case user_principals is used. keyfile is the absolute path to your API pem key file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#log_ocid = ocid1.log.oc1.eu-stockholm-1.xxx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#user_ocid = ocid1.user.oc1..xxx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#fingerprint = 77:9c:4xxxxx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#tenancy_ocid = ocid1.tenancy.oc1..xxx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#region = eu-stockholm-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#keyfile = /home/xx/key.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3在cowrielog目录创建日志文件并赋权用于接收cowrie输出">3、在cowrie/log目录创建日志文件并赋权，用于接收cowrie输出<a href="#3在cowrielog目录创建日志文件并赋权用于接收cowrie输出" class="hash-link" aria-label="3、在cowrie/log目录创建日志文件并赋权，用于接收cowrie输出的直接链接" title="3、在cowrie/log目录创建日志文件并赋权，用于接收cowrie输出的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">touch audit.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">touch cowrie.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chwon polkitd:input</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 755 audit.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 755 cowrie.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4修改宿主机ssh端口将22改为其他端口如3332">4、修改宿主机ssh端口，将22改为其他端口，如3332<a href="#4修改宿主机ssh端口将22改为其他端口如3332" class="hash-link" aria-label="4、修改宿主机ssh端口，将22改为其他端口，如3332的直接链接" title="4、修改宿主机ssh端口，将22改为其他端口，如3332的直接链接">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#  将port 22 改为port 3222</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vim /etc/ssh/sshd_config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#  重启ssh生效 无法重启可能SELinux的问题，临时关闭SELinux ：setenforce 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart sshd.service  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5注意事项">5、注意事项<a href="#5注意事项" class="hash-link" aria-label="5、注意事项的直接链接" title="5、注意事项的直接链接">​</a></h3>
<ol>
<li>如开了iptables记得添加3222端口。</li>
<li>在docker运行的时候，不能关闭火墙，否则导致docker规则被清空，现象为宿主机能访问容器映射的端口，但是其他机器无法访问容器映射的端口，解决方法为重启docker。</li>
<li>无法通过docker exec -it 进入容器内部，原因未知。</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="三通过docker拉取并运行cowrie镜像">三、通过docker拉取并运行cowrie镜像<a href="#三通过docker拉取并运行cowrie镜像" class="hash-link" aria-label="三、通过docker拉取并运行cowrie镜像的直接链接" title="三、通过docker拉取并运行cowrie镜像的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -d \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --publish 22:2222 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --publish 23:2223 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --volumn /home/webapp/Honeypot/cowrie/etc:/cowrie/cowrie-git/etc \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --volumn /home/webapp/Honeypot/cowrie/downloads:/cowrie/cowrie-git/var/lib/cowrie/downloads \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --volumn /home/webapp/Honeypot/cowrie/log:/cowrie/cowrie-git/var/log/cowrie \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --env COWRIE_TELNET_ENABLED=yes \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --net dev \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --restart=always \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --name cowrie \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cowrie/cowrie:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="四cowrie与微信告警联动">四、cowrie与微信告警联动<a href="#四cowrie与微信告警联动" class="hash-link" aria-label="四、cowrie与微信告警联动的直接链接" title="四、cowrie与微信告警联动的直接链接">​</a></h2>
<p>注意！！！需确保能成功调用企业微信API，如何设置及测试请看我另一份文章：如何通过linux调用企业微信发送告警消息。</p>
<p>该脚本分为两个部分，第一个部分为告警分析，第二部分为通过企业微信接口发送告警消息。</p>
<p>说明:我写的分析脚本比较简单，通过定时任务触发，统计昨日通过ssh登录的用户有多少，统计好了发送到企业微信，当然你可以自定义分析及要发送内容。</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 第一部分告警配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 获取昨日时间</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yesterday=`date -d yesterday +%Y-%m-%d`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 备份日志</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp ./audit.log ./audit.log.${yesterday}.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /dev/null &gt; ./audit.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 分析昨日登录次数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tologin=`grep login audit.log.${yesterday}.log | grep ${yesterday} | wc -l`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 第二部分与企业微信联动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 设置企业微信相关信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 每个企业都拥有唯一的corpid，获取此信息可在管理后台“我的企业”－“企业信息”下查看“企业ID”（需要有管理员权限）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">corpid=&quot;xxxxx&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># secret是企业应用里面用于保障数据安全的“钥匙”，每一个应用都有一个独立的访问密钥，为了保证数据的安全，secret务必不能泄漏。secret查看方法：在管理后台-&gt;“应用管理”-&gt;“应用”-&gt;“自建”，点进某个应用，即可看到。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">corpsecret=&quot;xxxxx&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 每个应用都有唯一的agentid。在管理后台-&gt;“应用管理”-&gt;“应用”，点进某个应用，即可看到agentid。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">agentid=&quot;xxxxx&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 每个部门都有唯一的id，在管理后台-&gt;“通讯录”-&gt;“组织架构”-&gt;点击某个部门右边的小圆点可以看到</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#toparty=&quot;PartyID&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 每个成员都有唯一的userid，即所谓“账号”。在管理后台-&gt;“通讯录”-&gt;点进某个成员的详情页，可以看到。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userids=&quot;xxxxx|xxxxx&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 获取access_token URL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url=&quot;https://qyapi.weixin.qq.com/cgi-bin/gettoken&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># access_token是企业后台去企业微信的后台获取信息时的重要票据，由corpid和secret产生。所有接口在通信时都需要携带此信息用于验证接口的访问权限,jq 可通过 yum install jq 安装。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">access_token=$(curl -s -G &quot;$url&quot; --data-urlencode &quot;corpid=$corpid&quot; --data-urlencode &quot;corpsecret=$corpsecret&quot; | jq -r .access_token)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 发送的消息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message=&quot;{\&quot;touser\&quot; : \&quot;$userids\&quot;, \&quot;toparty\&quot; : \&quot;$toparty\&quot;, \&quot;msgtype\&quot; : \&quot;text\&quot;, \&quot;agentid\&quot; : \&quot;$agentid\&quot;, \&quot;text\&quot; : {\&quot;content\&quot; : \&quot;您昨日ssh被登录：$tologin次，请及时处理！\&quot;}}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -s -X POST &quot;https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=$access_token&quot; -d &quot;$message&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="五创建定时任务">五、创建定时任务<a href="#五创建定时任务" class="hash-link" aria-label="五、创建定时任务的直接链接" title="五、创建定时任务的直接链接">​</a></h2>
<p>创建定时任务，每天24点执行,向微信发送今日ssh登录情况</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">crontab -e </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00 00 * * *     /home/webapp/Honeypot/cowrie/log/analyze.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/lorchr/light-docusaurus/tree/main/docs/zh-cn/devenv/Docker-Cowrie.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/zh-cn/devenv/Docker-Gitea/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Docker-Gitea</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/zh-cn/devenv/Docker-Obsidian/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Docker-Obsidian</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一cowrie简介" class="table-of-contents__link toc-highlight">一、Cowrie简介</a></li><li><a href="#二前期准备" class="table-of-contents__link toc-highlight">二、前期准备</a><ul><li><a href="#1为了能够保证数据持久化同时进行相关的参数传递需提前创建准备目录" class="table-of-contents__link toc-highlight">1、为了能够保证数据持久化，同时进行相关的参数传递，需提前创建准备目录</a></li><li><a href="#2在cowrieetc目录创建cowrie配置cowriecfg将以下配置复制到cowriecfg中也可从官网cowriecfgdist中获取获取后需要手动把telnet-改为-true文本获取改为-true获取地址-httpsgithubcomcowriecowrieblobmasteretccowriecfgdist" class="table-of-contents__link toc-highlight">2、在cowrie/etc目录创建cowrie配置cowrie.cfg，将以下配置复制到cowrie.cfg中，也可从官网cowrie.cfg.dist中获取，获取后需要手动把telnet 改为 true，文本获取改为 true，获取地址 https://github.com/cowrie/cowrie/blob/master/etc/cowrie.cfg.dist</a></li><li><a href="#3在cowrielog目录创建日志文件并赋权用于接收cowrie输出" class="table-of-contents__link toc-highlight">3、在cowrie/log目录创建日志文件并赋权，用于接收cowrie输出</a></li><li><a href="#4修改宿主机ssh端口将22改为其他端口如3332" class="table-of-contents__link toc-highlight">4、修改宿主机ssh端口，将22改为其他端口，如3332</a></li><li><a href="#5注意事项" class="table-of-contents__link toc-highlight">5、注意事项</a></li></ul></li><li><a href="#三通过docker拉取并运行cowrie镜像" class="table-of-contents__link toc-highlight">三、通过docker拉取并运行cowrie镜像</a></li><li><a href="#四cowrie与微信告警联动" class="table-of-contents__link toc-highlight">四、cowrie与微信告警联动</a></li><li><a href="#五创建定时任务" class="table-of-contents__link toc-highlight">五、创建定时任务</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/category/guide/">Torch</a></li><li class="footer__item"><a class="footer__link-item" href="/middleware/">Middleware</a></li><li class="footer__item"><a class="footer__link-item" href="/electron/">Electron</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/diy/">DIY</a></li><li class="footer__item"><a href="https://github.com/lorchr/light-docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Offical</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Home<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docusaurus.io/docs/playground" target="_blank" rel="noopener noreferrer" class="footer__link-item">Playground<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Light-Docusaurus, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>