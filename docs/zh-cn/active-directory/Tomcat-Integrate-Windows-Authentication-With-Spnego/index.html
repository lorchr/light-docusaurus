<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-zh-cn/active-directory/Tomcat-Integrate-Windows-Authentication-With-Spnego" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Tomcat-Integrate-Windows-Authentication-With-Spnego | Light Docusaurus</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://lorchr.github.io/light-docusaurus/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://lorchr.github.io/light-docusaurus/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://lorchr.github.io/light-docusaurus/docs/zh-cn/active-directory/Tomcat-Integrate-Windows-Authentication-With-Spnego/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Tomcat-Integrate-Windows-Authentication-With-Spnego | Light Docusaurus"><meta data-rh="true" name="description" content="官方文档"><meta data-rh="true" property="og:description" content="官方文档"><link data-rh="true" rel="icon" href="/light-docusaurus/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://lorchr.github.io/light-docusaurus/docs/zh-cn/active-directory/Tomcat-Integrate-Windows-Authentication-With-Spnego/"><link data-rh="true" rel="alternate" href="https://lorchr.github.io/light-docusaurus/docs/zh-cn/active-directory/Tomcat-Integrate-Windows-Authentication-With-Spnego/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://lorchr.github.io/light-docusaurus/docs/zh-cn/active-directory/Tomcat-Integrate-Windows-Authentication-With-Spnego/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://TLGHDZ3Y2I-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/light-docusaurus/blog/rss.xml" title="Light Docusaurus RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/light-docusaurus/blog/atom.xml" title="Light Docusaurus Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Light Docusaurus" href="/light-docusaurus/opensearch.xml"><link rel="stylesheet" href="/light-docusaurus/assets/css/styles.609e5209.css">
<script src="/light-docusaurus/assets/js/runtime~main.c76c40a0.js" defer="defer"></script>
<script src="/light-docusaurus/assets/js/main.4a0c9925.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/light-docusaurus/"><div class="navbar__logo"><img src="/light-docusaurus/img/logo.svg" alt="Torch Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/light-docusaurus/img/logo.svg" alt="Torch Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Torch</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/light-docusaurus/docs/category/guide/">Torch</a><a class="navbar__item navbar__link" href="/light-docusaurus/blog/">Blog</a><a class="navbar__item navbar__link" href="/light-docusaurus/middleware/">Middleware</a><a class="navbar__item navbar__link" href="/light-docusaurus/electron/">Electron</a><a class="navbar__item navbar__link" href="/light-docusaurus/postman/">Postman</a><a class="navbar__item navbar__link" href="/light-docusaurus/diy/">DIY</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/light-docusaurus/docs/zh-cn/active-directory/Tomcat-Integrate-Windows-Authentication-With-Spnego/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li></ul></div><a href="https://github.com/lorchr/light-docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/guide/">Guide</a><button aria-label="展开侧边栏分类 &#x27;Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/develop-environment/">Develop Environment</a><button aria-label="展开侧边栏分类 &#x27;Develop Environment&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/java-jvm/">Java (JVM)</a><button aria-label="展开侧边栏分类 &#x27;Java (JVM)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/spring-boot/">Spring Boot</a><button aria-label="展开侧边栏分类 &#x27;Spring Boot&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/spring-cloud/">Spring Cloud</a><button aria-label="展开侧边栏分类 &#x27;Spring Cloud&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/spring-security/">Spring Security</a><button aria-label="展开侧边栏分类 &#x27;Spring Security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/spring-authorization-server/">Spring Authorization Server</a><button aria-label="展开侧边栏分类 &#x27;Spring Authorization Server&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/light-docusaurus/docs/category/active-directory/">Active Directory</a><button aria-label="折叠侧边栏分类 &#x27;Active Directory&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/active-directory/Install-AD-DS/">Install-AD-DS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/light-docusaurus/docs/zh-cn/active-directory/Tomcat-Integrate-Windows-Authentication-With-Spnego/">Tomcat-Integrate-Windows-Authentication-With-Spnego</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/database/">Database</a><button aria-label="展开侧边栏分类 &#x27;Database&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/git/">Git</a><button aria-label="展开侧边栏分类 &#x27;Git&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/linux/">Linux</a><button aria-label="展开侧边栏分类 &#x27;Linux&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/docker/">Docker</a><button aria-label="展开侧边栏分类 &#x27;Docker&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/kubernetes/">Kubernetes</a><button aria-label="展开侧边栏分类 &#x27;Kubernetes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/test/">Test</a><button aria-label="展开侧边栏分类 &#x27;Test&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/others/">Others</a><button aria-label="展开侧边栏分类 &#x27;Others&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/light-docusaurus/docs/zh-cn/awesome-open-source/">Awesome open source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/light-docusaurus/docs/zh-cn/windows/">Windows</a></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/light-docusaurus/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/light-docusaurus/docs/category/active-directory/"><span itemprop="name">Active Directory</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Tomcat-Integrate-Windows-Authentication-With-Spnego</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Tomcat-Integrate-Windows-Authentication-With-Spnego</h1></header><p>官方文档</p>
<ul>
<li><a href="https://learn.microsoft.com/zh-cn/aspnet/web-api/overview/security/integrated-windows-authentication">Windows 集成身份验证</a></li>
<li><a href="https://learn.microsoft.com/en-us/iis/configuration/system.webServer/security/authentication/windowsAuthentication/">Windows Authentication</a></li>
<li><a href="https://learn.microsoft.com/zh-cn/windows/win32/ad/service-principal-names">服务主体名称</a></li>
<li><a href="https://tomcat.apache.org/tomcat-10.1-doc/windows-auth-howto.html">Windows Authentication How-To</a></li>
<li><a href="https://www.w3cschool.cn/tomcat/6wds1ka3.html">Tomcat Windows 认证</a></li>
<li><a href="https://xy2401.com/local-docs/apache.zh/tomcat-9.0/windows-auth-howto.html">Tomcat Windows 认证</a></li>
</ul>
<p>Windows域认证流程</p>
<ul>
<li><a href="https://blog.csdn.net/zj007ok/article/details/101434566">https://blog.csdn.net/zj007ok/article/details/101434566</a></li>
</ul>
<p>SPNEGO使用</p>
<ul>
<li>
<p><a href="https://spnego.sourceforge.net/">使用Spnego为Tomcat集成Win-Auth</a></p>
</li>
<li>
<p><a href="https://spnego.sourceforge.net/pre_flight.html">使用Spnego为Tomcat集成Win-Auth</a></p>
</li>
<li>
<p><a href="https://spnego.sourceforge.net/spnego_tomcat.html">使用Spnego为oTomcat集成Win-Auth</a></p>
</li>
<li>
<p><a href="https://sourceforge.net/p/spnego/discussion/">Spnego讨论区</a></p>
</li>
<li>
<p><a href="https://github.com/michael-o/tomcatspnegoad">Win Auth Demo</a></p>
</li>
<li>
<p><a href="https://tomcatspnegoad.sourceforge.net">Win Auth Demo Document</a></p>
</li>
</ul>
<p>客户端(浏览器)设置参考</p>
<ul>
<li><a href="http://www.oracle.com/technetwork/articles/idm/weblogic-sso-kerberos-1619890.html">weblogic-sso-kerberos</a></li>
</ul>
<h2 id="一tomcat配置">一、Tomcat配置</h2>
<ul>
<li>tomcat 版本为 9.0.85</li>
<li>JDK 版本为 jdk 1.8</li>
</ul>
<p>以下用<code>~</code>表示Tomcat安装目录: <code>D:\Develop\apache-tomcat-9.0.85</code></p>
<h4 id="1-添加-spnego-依赖-spnegojar">1. 添加 Spnego 依赖 <code>spnego.jar</code></h4>
<p>版本依赖关系</p>
<table><thead><tr><th>Tomcat</th><th>JDK</th><th>spnego</th></tr></thead><tbody><tr><td>Tomcat 8</td><td>Java 8</td><td>spnego-r9.jar</td></tr><tr><td>Tomcat 9</td><td>Java 11+</td><td>spnego-r9.jar</td></tr><tr><td>Tomcat 10+</td><td>Java 11+</td><td>spnego-jakarta-2.0.jar</td></tr></tbody></table>
<ul>
<li><a href="https://sourceforge.net/projects/spnego/files/spnego-r9.jar/download">spnego-r9.jar</a></li>
<li><a href="https://sourceforge.net/projects/spnego/files/spnego-jakarta-2.0.jar/download">spnego-jakarta-2.0.jar</a></li>
</ul>
<p>将下载的依赖包放入 <code>tomcat/lib/</code> 目录下，例如: <code>~\lib\spnego-r9.jar</code></p>
<h3 id="2-修改-webxml-文件">2. 修改 web.xml 文件</h3>
<p>修改 <code>~\conf\web.xml</code>，添加以下内容</p>
<pre><code class="language-xml">&lt;!--==================== SPNEGO FILTER - Kerberos SSO ===================== --&gt; 
&lt;filter&gt;
    &lt;filter-name&gt;SpnegoHttpFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;net.sourceforge.spnego.SpnegoHttpFilter&lt;/filter-class&gt;

    &lt;init-param&gt;
        &lt;param-name&gt;spnego.allow.basic&lt;/param-name&gt;
        &lt;param-value&gt;true&lt;/param-value&gt;
    &lt;/init-param&gt;

    &lt;init-param&gt;
        &lt;param-name&gt;spnego.allow.localhost&lt;/param-name&gt;
        &lt;param-value&gt;true&lt;/param-value&gt;
    &lt;/init-param&gt;

    &lt;init-param&gt;
        &lt;param-name&gt;spnego.allow.unsecure.basic&lt;/param-name&gt;
        &lt;param-value&gt;true&lt;/param-value&gt;
    &lt;/init-param&gt;

    &lt;init-param&gt;
        &lt;param-name&gt;spnego.login.client.module&lt;/param-name&gt;
        &lt;param-value&gt;spnego-client&lt;/param-value&gt;
    &lt;/init-param&gt;

    &lt;init-param&gt;
        &lt;param-name&gt;spnego.krb5.conf&lt;/param-name&gt;
        &lt;param-value&gt;krb5.conf&lt;/param-value&gt;
    &lt;/init-param&gt;

    &lt;init-param&gt;
        &lt;param-name&gt;spnego.login.conf&lt;/param-name&gt;
        &lt;param-value&gt;login.conf&lt;/param-value&gt;
    &lt;/init-param&gt;

    &lt;init-param&gt;
        &lt;!-- 此处配置 AD域账号，用于服务端的认证 --&gt;
        &lt;param-name&gt;spnego.preauth.username&lt;/param-name&gt;
        &lt;param-value&gt;pc01&lt;/param-value&gt;
    &lt;/init-param&gt;

    &lt;init-param&gt;
        &lt;!-- 此处配置 AD域账号对应的密码，用于服务端的认证 --&gt;
        &lt;param-name&gt;spnego.preauth.password&lt;/param-name&gt;
        &lt;param-value&gt;Admin123&lt;/param-value&gt;
    &lt;/init-param&gt;

    &lt;init-param&gt;
        &lt;param-name&gt;spnego.login.server.module&lt;/param-name&gt;
        &lt;param-value&gt;spnego-server&lt;/param-value&gt;
    &lt;/init-param&gt;

    &lt;init-param&gt;
        &lt;param-name&gt;spnego.prompt.ntlm&lt;/param-name&gt;
        &lt;param-value&gt;true&lt;/param-value&gt;
    &lt;/init-param&gt;

    &lt;init-param&gt;
        &lt;param-name&gt;spnego.logger.level&lt;/param-name&gt;
        &lt;param-value&gt;1&lt;/param-value&gt;
    &lt;/init-param&gt;
&lt;/filter&gt;

&lt;filter-mapping&gt;
    &lt;filter-name&gt;SpnegoHttpFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
</code></pre>
<h3 id="3-创建krb5conf和loginconf">3. 创建<code>krb5.conf</code>和<code>login.conf</code></h3>
<ul>
<li><a href="https://spnego.sourceforge.net/krb5.conf">https://spnego.sourceforge.net/krb5.conf</a></li>
</ul>
<p>添加<code>~/krb5.conf</code></p>
<pre><code class="language-conf">[libdefaults]
default_realm = DEV.LOCAL
# 如果未在 ~/conf/web.xml 配置域账号，则需要配置keytab
# default_keytab_name = FILE:C:\apache-tomcat-9.0.85\conf\tomcat.keytab
# 加密算法，根据【AD域-用户及计算机管理-用户-账户-账号选项】设置值选择
default_tkt_enctypes = aes256-cts aes256-cts-hmac-sha1-96 aes128-cts-hmac-sha1-96 aes128-cts rc4-hmac des3-cbc-sha1 des-cbc-md5 des-cbc-crc arcfour-hmac arcfour-hmac-md5
default_tgs_enctypes = aes256-cts aes256-cts-hmac-sha1-96 aes128-cts-hmac-sha1-96 aes128-cts rc4-hmac des3-cbc-sha1 des-cbc-md5 des-cbc-crc arcfour-hmac arcfour-hmac-md5
permitted_enctypes   = aes256-cts aes256-cts-hmac-sha1-96 aes128-cts-hmac-sha1-96 aes128-cts rc4-hmac des3-cbc-sha1 des-cbc-md5 des-cbc-crc arcfour-hmac arcfour-hmac-md5
forwardable=true

[realms]
DEV.LOCAL = {
    # AD域服务器的地址
    kdc = win-dc01.dev.local
    default_domain = DEV.LOCAL
}

[domain_realm]
dev.local= DEV.LOCAL
.dev.local= DEV.LOCAL
</code></pre>
<ul>
<li><a href="https://spnego.sourceforge.net/login.conf">https://spnego.sourceforge.net/login.conf</a></li>
</ul>
<p>添加<code>~/login.conf</code></p>
<pre><code class="language-conf">spnego-client {
	com.sun.security.auth.module.Krb5LoginModule required;
};

spnego-server {
	com.sun.security.auth.module.Krb5LoginModule required
	storeKey=true
	isInitiator=false;
};
</code></pre>
<h3 id="4-注册spnservice-principal-name">4. 注册SPN（Service Principal Name）</h3>
<p>一个SPN只能对应一个用户名，一个用户可以有多个SPN</p>
<pre><code class="language-shell"># 查看帮助
setspn --help

# 添加SPN
setspn -A HTTP/lin-pc01                 pc01
setspn -A HTTP/lin-pc01.dev.local       pc01

setspn -A HTTP/win-pc01                 pc02
setspn -A HTTP/win-pc01.dev.local       pc02

# 查看账号关联的SPN
setspn -L pc01

# 删除账号关联的SPN
setspn -D HTTP/lin-pc01                 pc01

# 查询SPN信息
setspn -Q HTTP/lin-pc01.dev.local
</code></pre>
<p><img src="/light-docusaurus/assets/images/39-11c690519180b31db0845556e69b5961.png" width="1151" height="865"></p>
<p>生成<code>tomcat.keytab</code></p>
<pre><code class="language-shell"># /out      输出文件路径
# /mapuser  映射用户
# /princ    关联的计算机
# /pass     映射用户的密码
# /kvno     版本
ktpass /out c:\tomcat.keytab /mapuser pc01@DEV.LOCAL /princ HTTP/lin-pc01.dev.local@DEV.LOCAL /pass &#x27;Admin123&#x27; /kvno 0

ktpass /princ HTTP/YOUR_COMPUTER_NAME_HERE@YOUR_DOMAIN_HERE.COM /mapuser YOUR_USER_HERE /pass YOUR_PASSWORD_HERE /Target YOUR_DOMAIN_HERE.COM /out YOUR_KEYTAB_FILENAME_HERE.keytab /kvno 0 /crypto RC4-HMAC-NT /ptype KRB5_NT_PRINCIPAL
</code></pre>
<p><img src="/light-docusaurus/assets/images/40-89010bb2f7534b366df7e2ca85d294ea.png" width="1151" height="865"></p>
<h3 id="5-测试配置文件">5. 测试配置文件</h3>
<pre><code class="language-java">import java.io.File;
import java.io.FileNotFoundException;
import java.security.NoSuchAlgorithmException;
 
import javax.security.auth.callback.Callback;
import javax.security.auth.callback.CallbackHandler;
import javax.security.auth.callback.NameCallback;
import javax.security.auth.callback.PasswordCallback;
import javax.security.auth.login.Configuration;
import javax.security.auth.login.LoginContext;
 
public final class HelloKDC {
 
    private HelloKDC() {
        // default private
    }
 
    public static void main(final String[] args) throws Exception {
 
    	// Domain (pre-authentication) account
        final String username = &quot;pc01&quot;;
        
        // Password for the pre-auth acct.
        final String password = &quot;Admin123&quot;;
        
        // Name of our krb5 config file
        final String krbfile = &quot;krb5.conf&quot;;
        
        // Name of our login config file
        final String loginfile = &quot;login.conf&quot;;
        
        // Name of our login module
        final String module = &quot;spnego-client&quot;;
 
        // set some system properties
        System.setProperty(&quot;java.security.krb5.conf&quot;, krbfile);
        System.setProperty(&quot;java.security.auth.login.config&quot;, loginfile);
        //System.setProperty(&quot;sun.security.krb5.debug&quot;, true);
 
        // assert 
        HelloKDC.validate(username, password, krbfile, loginfile, module);
 
        final CallbackHandler handler = 
            HelloKDC.getUsernamePasswordHandler(username, password);
 
        final LoginContext loginContext = new LoginContext(module, handler);
 
        // attempt to login
        loginContext.login();
 
        // output some info
        System.out.println(&quot;Subject=&quot; + loginContext.getSubject());
 
        // logout
        loginContext.logout();
 
        System.out.println(&quot;Connection test successful.&quot;);
    }
 
    private static void validate(final String username, final String password
        , final String krbfile, final String loginfile, final String moduleName) 
        throws FileNotFoundException, NoSuchAlgorithmException {
 
        // confirm username was provided
        if (null == username || username.isEmpty()) {
            throw new IllegalArgumentException(&quot;Must provide a username&quot;);
        }
 
        // confirm password was provided
        if (null == password || password.isEmpty()) {
            throw new IllegalArgumentException(&quot;Must provide a password&quot;);
        }
 
        // confirm krb5.conf file exists
        if (null == krbfile || krbfile.isEmpty()) {
            throw new IllegalArgumentException(&quot;Must provide a krb5 file&quot;);
        } else {
            final File file = new File(krbfile);
            if (!file.exists()) {
                throw new FileNotFoundException(krbfile);
            }
        }
 
        // confirm loginfile
        if (null == loginfile || loginfile.isEmpty()) {
            throw new IllegalArgumentException(&quot;Must provide a login file&quot;);
        } else {
            final File file = new File(loginfile);
            if (!file.exists()) {
                throw new FileNotFoundException(loginfile);
            }
        }
 
        // confirm that runtime loaded the login file
        final Configuration config = Configuration.getConfiguration();
 
        // confirm that the module name exists in the file
        if (null == config.getAppConfigurationEntry(moduleName)) {
            throw new IllegalArgumentException(&quot;The module name &quot; 
                    + moduleName + &quot; was not found in the login file&quot;);
        }        
    }
 
    private static CallbackHandler getUsernamePasswordHandler(
        final String username, final String password) {
 
        final CallbackHandler handler = new CallbackHandler() {
            public void handle(final Callback[] callback) {
                for (int i=0; i&lt;callback.length; i++) {
                    if (callback[i] instanceof NameCallback) {
                        final NameCallback nameCallback = (NameCallback) callback[i];
                        nameCallback.setName(username);
                    } else if (callback[i] instanceof PasswordCallback) {
                        final PasswordCallback passCallback = (PasswordCallback) callback[i];
                        passCallback.setPassword(password.toCharArray());
                    } else {
                        System.err.println(&quot;Unsupported Callback: &quot; 
                                + callback[i].getClass().getName());
                    }
                }
            }
        };
 
        return handler;
    }
}
</code></pre>
<pre><code class="language-shell"># 编译
javac HelloKDC.java

# 运行
java HelloKDC
</code></pre>
<h3 id="6-创建一个-hello_spnegojsp-文件">6. 创建一个 <code>hello_spnego.jsp</code> 文件</h3>
<ul>
<li><a href="https://spnego.sourceforge.net/hello_spnego.zip">https://spnego.sourceforge.net/hello_spnego.zip</a></li>
</ul>
<p>添加 <code>~/webapps/ROOT/hello_spnego.jsp</code></p>
<pre><code class="language-jsp">&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Hello SPNEGO Example&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
Hello &lt;%= request.getRemoteUser() %&gt; !
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2 id="二客户端配置">二、客户端配置</h2>
<ul>
<li><a href="https://spnego.sourceforge.net/client_keytab.html">https://spnego.sourceforge.net/client_keytab.html</a></li>
</ul>
<h3 id="1-编译-hellokeytabjava">1. 编译 HelloKeytab.java</h3>
<pre><code class="language-java">import java.net.URL;

import net.sourceforge.spnego.SpnegoHttpURLConnection;

public class HelloKeytab {

    public static void main(final String[] args) throws Exception {
        System.setProperty(&quot;java.security.krb5.conf&quot;, &quot;krb5.conf&quot;);
        System.setProperty(&quot;sun.security.krb5.debug&quot;, &quot;true&quot;);
        System.setProperty(&quot;java.security.auth.login.config&quot;, &quot;client-login.conf&quot;);
          
        SpnegoHttpURLConnection spnego = null;
        
        try {
            spnego = new SpnegoHttpURLConnection(&quot;custom-client&quot;);
            spnego.connect(new URL(&quot;http://win10.lh9527.com:8080/hello_spnego.jsp&quot;));
            
            System.out.println(&quot;HTTP Status Code: &quot; 
                    + spnego.getResponseCode());
            
            System.out.println(&quot;HTTP Status Message: &quot;
                    + spnego.getResponseMessage());

        } finally {
            if (null != spnego) {
                spnego.disconnect();
            }
        }
    }
}
</code></pre>
<h3 id="2-创建-loginconf-文件">2. 创建 login.conf 文件</h3>
<p><code>client-login.conf</code></p>
<pre><code class="language-conf">custom-client {
    com.sun.security.auth.module.Krb5LoginModule required
    storeKey=true
    useKeyTab=true
    keyTab=&quot;file:///C:/spnego/client-keytab.keytab&quot;
    principal=pyy;
};
</code></pre>
<h3 id="3-创建密钥表文件">3. 创建密钥表文件</h3>
<pre><code class="language-shell">ktab.exe -a pyy Admin123 -k client-keytab.keytab

ktab.exe -l -k client-keytab.keytab
</code></pre>
<h3 id="4-测试密钥表文件">4. 测试密钥表文件</h3>
<pre><code class="language-shell">javac -cp .;spnego-r9.jar HelloKeytab.java

java -cp .;spnego-r9.jar HelloKeytab
</code></pre>
<h2 id="三服务器配置">三、服务器配置</h2>
<ul>
<li><a href="https://spnego.sourceforge.net/server_keytab.html">https://spnego.sourceforge.net/server_keytab.html</a></li>
</ul>
<h3 id="1-编译-hellokeytabjava-1">1. 编译 HelloKeytab.java</h3>
<pre><code class="language-java">import java.net.URL;

import net.sourceforge.spnego.SpnegoHttpURLConnection;

public class HelloKeytab {

    public static void main(final String[] args) throws Exception {
        System.setProperty(&quot;java.security.krb5.conf&quot;, &quot;krb5.conf&quot;);
        System.setProperty(&quot;sun.security.krb5.debug&quot;, &quot;true&quot;);
        System.setProperty(&quot;java.security.auth.login.config&quot;, &quot;server-login.conf&quot;);
          
        SpnegoHttpURLConnection spnego = null;
        
        try {
            spnego = new SpnegoHttpURLConnection(&quot;custom-client&quot;);
            spnego.connect(new URL(&quot;http://win10.lh9527.com:8080/hello_spnego.jsp&quot;));
            
            System.out.println(&quot;HTTP Status Code: &quot; 
                    + spnego.getResponseCode());
            
            System.out.println(&quot;HTTP Status Message: &quot;
                    + spnego.getResponseMessage());

        } finally {
            if (null != spnego) {
                spnego.disconnect();
            }
        }
    }
}
</code></pre>
<h3 id="2-创建-loginconf-文件-1">2. 创建 login.conf 文件</h3>
<p><code>server-login.conf</code></p>
<pre><code class="language-conf">custom-client {
    com.sun.security.auth.module.Krb5LoginModule required
    storeKey=true
    useKeyTab=true
    keyTab=&quot;file:///C:/spnego/server-keytab.keytab&quot;
    principal=win10;
};
</code></pre>
<h3 id="3-创建密钥表文件-1">3. 创建密钥表文件</h3>
<pre><code class="language-shell">ktab.exe -a win10 Admin123 -k server-keytab.keytab

ktab.exe -l -k server-keytab.keytab
</code></pre>
<h3 id="4-测试密钥表文件-1">4. 测试密钥表文件</h3>
<pre><code class="language-shell">javac -cp .;spnego-r9.jar HelloKeytab.java

java -cp .;spnego-r9.jar HelloKeytab
</code></pre>
<h3 id="5-配置应用程序服务器以使用-keytab-文件">5. 配置应用程序服务器以使用 keytab 文件</h3>
<ol>
<li>将 <code>server-keytab.keytab</code> 移至与 <code>login.conf</code> 文件相同的目录，改名为 <code>tomcat.keytab</code>。</li>
<li>修改应用服务器的 <code>login.conf</code> 文件以反映 <code>keytab</code> 文件的使用情况。</li>
</ol>
<pre><code class="language-conf">spnego-client {
	com.sun.security.auth.module.Krb5LoginModule required;
};

spnego-server {
	com.sun.security.auth.module.Krb5LoginModule required
	storeKey=true
	useKeyTab=true
	keyTab=&quot;tomcat.keytab&quot;
	principal=win10
	isInitiator=false
	storeKey=true;
};
</code></pre>
<ol start="3">
<li>从<code>web.xml</code>文件中删除用户名和密码</li>
</ol>
<h2 id="四认证信息委派">四、认证信息委派</h2>
<ul>
<li><a href="https://spnego.sourceforge.net/user_access_control.html">https://spnego.sourceforge.net/user_access_control.html</a></li>
</ul>
<h3 id="1-ad域账户开启delegation">1. AD域账户开启Delegation</h3>
<p>在【AD DS域管理 - 用户和计算机 - 用户 - 属性 - 账户 - 账户选项】中，
勾选  <code>Account is trusted for delegation</code> (Windows Server 2019中没有此选项，可能已过期)</p>
<h3 id="2-tomcat开启delegation">2. Tomcat开启Delegation</h3>
<pre><code class="language-xml">&lt;init-param&gt;
    &lt;param-name&gt;spnego.prompt.ntlm&lt;/param-name&gt;
    &lt;param-value&gt;true&lt;/param-value&gt;
&lt;/init-param&gt;
&lt;!-- 添加此项，使Tomcat支持delegate --&gt;
&lt;init-param&gt;
    &lt;param-name&gt;spnego.allow.delegation&lt;/param-name&gt;
    &lt;param-value&gt;true&lt;/param-value&gt;
&lt;/init-param&gt;
</code></pre>
<h3 id="3-创建一个-hello_delegatejsp-文件">3. 创建一个 <code>hello_delegate.jsp</code> 文件</h3>
<ul>
<li><a href="https://spnego.sourceforge.net/credential_delegation.html">https://spnego.sourceforge.net/credential_delegation.html</a></li>
</ul>
<p>添加<code>~/webapps/ROOT/hello_delegate.jsp</code></p>
<pre><code class="language-jsp">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;%@ page import=&quot;java.net.*&quot; %&gt;
&lt;%@ page import=&quot;org.ietf.jgss.*&quot; %&gt;
&lt;%@ page import=&quot;net.sourceforge.spnego.*&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Hello Delegate Example&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;%
    if (request instanceof DelegateServletRequest) {
        DelegateServletRequest dsr = (DelegateServletRequest) request;
        GSSCredential creds = dsr.getDelegatedCredential();

        if (null == creds) {
            out.print(&quot;No delegated creds.&quot;);
        } else {
            out.print(creds.getName().toString());

            SpnegoHttpURLConnection spnego =
                new SpnegoHttpURLConnection(creds);

            spnego.connect(new URL(&quot;http://win10.lh9527.com:8080/hello_spnego.jsp&quot;));

            out.print(&quot;&lt;br /&gt;HTTP Status Code: &quot; + spnego.getResponseCode());
            out.print(&quot;&lt;br /&gt;HTTP Status Message: &quot; + spnego.getResponseMessage());
            spnego.disconnect();
        }

    } else {
        out.print(&quot;Request not a delegate.&quot;);
    }
%&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="测试委派">测试委派</h3>
<ol>
<li>复制一个tomcat，分别启动server1, server2</li>
<li>访问server1: <a href="http://server1:8080/hello_spnego.jsp">http://server1:8080/hello_spnego.jsp</a></li>
<li>访问server2: <a href="http://server1:8080/hello_spnego.jsp">http://server1:8080/hello_spnego.jsp</a></li>
<li>访问server2: <a href="http://server1:8080/hello_delegate.jsp">http://server1:8080/hello_delegate.jsp</a></li>
</ol>
<h2 id="问题解决">问题解决</h2>
<h3 id="1-spnego-checksum-failed">1. SPNEGO Checksum failed</h3>
<ul>
<li><a href="https://stackoverflow.com/questions/26784376/spnego-with-tomcat-error-gssexception-failure-unspecified-at-gss-api-level-me">SPNEGO with Tomcat error: GSSException: Failure unspecified at GSS-API level (Mechanism level: Checksum failed)</a></li>
<li><a href="https://stackoverflow.com/questions/34306386/gsscontext-with-null-srcname/45712445#45712445">GSSContext with null SrcName</a></li>
<li><a href="http://middlesphere-1.blogspot.ru/2016/10/kerberos-spnego-checksum-failed-problem.html">kerberos-spnego-checksum-failed-problem</a></li>
<li><a href="https://stackoverflow.com/questions/47809459/kerberos-ad-spnego-authentication-fails-on-one-machine-but-not-on-another">Kerberos AD Spnego authentication fails on one machine but not on another</a></li>
<li><a href="https://sourceforge.net/p/spnego/discussion/1003769/thread/3653ff3362/">AES256 Checksum failed</a></li>
</ul>
<p>错误信息如下</p>
<pre><code class="language-shell">GSSException: Failure unspecified at GSS-API level (Mechanism level: Checksum failed)
</code></pre>
<ol>
<li>检查AD域账号是否已开启 <code>AES-128</code> / <code>AES-256</code> 认证</li>
<li>检查<code>krb5.conf</code>中配置的加密方式是否匹配<code>AES-128</code> / <code>AES-256</code></li>
<li>检查浏览器的配置是否正确，Chrome和Edge不需要配置，IE和Firefox需要设置，参考 <a href="http://www.oracle.com/technetwork/articles/idm/weblogic-sso-kerberos-1619890.html">Client Configuration</a> 部分</li>
<li>检查JDK版本，实测 <code>tomcat-9.0.85</code> 版本使用<code>jdk 21</code>会报错，改为<code>jdk 1.8</code>就可以正常访问，可以更换JDK版本再测试</li>
<li>tomcat服务器和tomcat <code>web.xml</code>中配置的账号需要绑定，即添加SPN步骤</li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/lorchr/light-docusaurus/tree/main/docs/zh-cn/active-directory/2-Tomcat-Integrate-Windows-Authentication-With-Spnego.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/light-docusaurus/docs/zh-cn/active-directory/Install-AD-DS/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Install-AD-DS</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/light-docusaurus/docs/category/database/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Database</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一tomcat配置" class="table-of-contents__link toc-highlight">一、Tomcat配置</a><ul><li><a href="#2-修改-webxml-文件" class="table-of-contents__link toc-highlight">2. 修改 web.xml 文件</a></li><li><a href="#3-创建krb5conf和loginconf" class="table-of-contents__link toc-highlight">3. 创建<code>krb5.conf</code>和<code>login.conf</code></a></li><li><a href="#4-注册spnservice-principal-name" class="table-of-contents__link toc-highlight">4. 注册SPN（Service Principal Name）</a></li><li><a href="#5-测试配置文件" class="table-of-contents__link toc-highlight">5. 测试配置文件</a></li><li><a href="#6-创建一个-hello_spnegojsp-文件" class="table-of-contents__link toc-highlight">6. 创建一个 <code>hello_spnego.jsp</code> 文件</a></li></ul></li><li><a href="#二客户端配置" class="table-of-contents__link toc-highlight">二、客户端配置</a><ul><li><a href="#1-编译-hellokeytabjava" class="table-of-contents__link toc-highlight">1. 编译 HelloKeytab.java</a></li><li><a href="#2-创建-loginconf-文件" class="table-of-contents__link toc-highlight">2. 创建 login.conf 文件</a></li><li><a href="#3-创建密钥表文件" class="table-of-contents__link toc-highlight">3. 创建密钥表文件</a></li><li><a href="#4-测试密钥表文件" class="table-of-contents__link toc-highlight">4. 测试密钥表文件</a></li></ul></li><li><a href="#三服务器配置" class="table-of-contents__link toc-highlight">三、服务器配置</a><ul><li><a href="#1-编译-hellokeytabjava-1" class="table-of-contents__link toc-highlight">1. 编译 HelloKeytab.java</a></li><li><a href="#2-创建-loginconf-文件-1" class="table-of-contents__link toc-highlight">2. 创建 login.conf 文件</a></li><li><a href="#3-创建密钥表文件-1" class="table-of-contents__link toc-highlight">3. 创建密钥表文件</a></li><li><a href="#4-测试密钥表文件-1" class="table-of-contents__link toc-highlight">4. 测试密钥表文件</a></li><li><a href="#5-配置应用程序服务器以使用-keytab-文件" class="table-of-contents__link toc-highlight">5. 配置应用程序服务器以使用 keytab 文件</a></li></ul></li><li><a href="#四认证信息委派" class="table-of-contents__link toc-highlight">四、认证信息委派</a><ul><li><a href="#1-ad域账户开启delegation" class="table-of-contents__link toc-highlight">1. AD域账户开启Delegation</a></li><li><a href="#2-tomcat开启delegation" class="table-of-contents__link toc-highlight">2. Tomcat开启Delegation</a></li><li><a href="#3-创建一个-hello_delegatejsp-文件" class="table-of-contents__link toc-highlight">3. 创建一个 <code>hello_delegate.jsp</code> 文件</a></li><li><a href="#测试委派" class="table-of-contents__link toc-highlight">测试委派</a></li></ul></li><li><a href="#问题解决" class="table-of-contents__link toc-highlight">问题解决</a><ul><li><a href="#1-spnego-checksum-failed" class="table-of-contents__link toc-highlight">1. SPNEGO Checksum failed</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/docs/category/guide/">Torch</a></li><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/middleware/">Middleware</a></li><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/electron/">Electron</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/diy/">DIY</a></li><li class="footer__item"><a href="https://github.com/lorchr/light-docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Offical</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Home<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docusaurus.io/docs/playground" target="_blank" rel="noopener noreferrer" class="footer__link-item">Playground<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Light-Docusaurus, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>