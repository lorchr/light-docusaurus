<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-zh-cn/spring-authorization-server/SAS-FAQ" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.1">
<title data-rh="true">SAS-FAQ | Light Docusaurus</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://lorchr.github.io/light-docusaurus/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://lorchr.github.io/light-docusaurus/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://lorchr.github.io/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-FAQ/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SAS-FAQ | Light Docusaurus"><meta data-rh="true" name="description" content="- Spring Authorization Server常见问题解答(FAQ)"><meta data-rh="true" property="og:description" content="- Spring Authorization Server常见问题解答(FAQ)"><link data-rh="true" rel="icon" href="/light-docusaurus/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://lorchr.github.io/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-FAQ/"><link data-rh="true" rel="alternate" href="https://lorchr.github.io/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-FAQ/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://lorchr.github.io/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-FAQ/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://TLGHDZ3Y2I-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/light-docusaurus/blog/rss.xml" title="Light Docusaurus RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/light-docusaurus/blog/atom.xml" title="Light Docusaurus Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Light Docusaurus" href="/light-docusaurus/opensearch.xml"><link rel="stylesheet" href="/light-docusaurus/assets/css/styles.10a62360.css">
<script src="/light-docusaurus/assets/js/runtime~main.9eecdcd0.js" defer="defer"></script>
<script src="/light-docusaurus/assets/js/main.270bc9c7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/light-docusaurus/"><div class="navbar__logo"><img src="/light-docusaurus/img/logo.svg" alt="Torch Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/light-docusaurus/img/logo.svg" alt="Torch Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Torch</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/light-docusaurus/docs/category/guide/">Torch</a><a class="navbar__item navbar__link" href="/light-docusaurus/blog/">Blog</a><a class="navbar__item navbar__link" href="/light-docusaurus/middleware/">Middleware</a><a class="navbar__item navbar__link" href="/light-docusaurus/electron/">Electron</a><a class="navbar__item navbar__link" href="/light-docusaurus/postman/">Postman</a><a class="navbar__item navbar__link" href="/light-docusaurus/diy/">DIY</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-FAQ/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li></ul></div><a href="https://github.com/lorchr/light-docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/light-docusaurus/docs/category/guide/">Guide</a><button aria-label="展开侧边栏分类 &#x27;Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/light-docusaurus/docs/category/develop-environment/">Develop Environment</a><button aria-label="展开侧边栏分类 &#x27;Develop Environment&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/light-docusaurus/docs/category/java-jvm/">Java (JVM)</a><button aria-label="展开侧边栏分类 &#x27;Java (JVM)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/light-docusaurus/docs/category/spring-boot/">Spring Boot</a><button aria-label="展开侧边栏分类 &#x27;Spring Boot&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/light-docusaurus/docs/category/spring-cloud/">Spring Cloud</a><button aria-label="展开侧边栏分类 &#x27;Spring Cloud&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/light-docusaurus/docs/category/spring-security/">Spring Security</a><button aria-label="展开侧边栏分类 &#x27;Spring Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/light-docusaurus/docs/category/spring-authorization-server/">Spring Authorization Server</a><button aria-label="折叠侧边栏分类 &#x27;Spring Authorization Server&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Geting-Start-Index/">SAS-Geting-Start-Index</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-OAuth2.1-Protocol/">SAS-OAuth2.1-Protocol</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Spring-Boot-Authorization-Server/">SAS-Spring-Boot-Authorization-Server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Spring-Boot-Authorization-Server-Addition/">SAS-Spring-Boot-Authorization-Server-Addition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Device-Authorization/">SAS-Device-Authorization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Customize-Exception-Configurer/">SAS-Customize-Exception-Configurer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Token-Enhancer-And-Parser/">SAS-Token-Enhancer-And-Parser</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Image-Captcha/">SAS-Image-Captcha</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-OAuth2-Client/">SAS-OAuth2-Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-OAuth2-Resource-Server/">SAS-OAuth2-Resource-Server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-SMS-Code-Login/">SAS-SMS-Code-Login</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-OAuth2-Extension-Grant-Type/">SAS-OAuth2-Extension-Grant-Type</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Frontend-Backend-Separate/">SAS-Frontend-Backend-Separate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Github-Gitee-Login/">SAS-Github-Gitee-Login</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Wechat-Login/">SAS-Wechat-Login</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Separate-Consent-And-Device-Authorize-Page/">SAS-Separate-Consent-And-Device-Authorize-Page</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Spring-Cloud-Gateway/">SAS-Spring-Cloud-Gateway</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Vue-Authorization-Code/">SAS-Vue-Authorization-Code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Vue-PKCE/">SAS-Vue-PKCE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Redis-Core-Service/">SAS-Redis-Core-Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-QrCode-Login/">SAS-QrCode-Login</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/Opaque-Token-Resource-Server/">Opaque-Token-Resource-Server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Wecom-DingTalk-Login/">SAS-Wecom-DingTalk-Login</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/LDAP-Login/">LDAP-Login</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/LDAP-Grant-Type/">LDAP-Grant-Type</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Saml2-Login-Grant/">SAS-Saml2-Login-Grant</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Build-GraalVM-Native-Image/">SAS-Build-GraalVM-Native-Image</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Getting-Start/">SAS-Getting-Start</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Opaque-Token/">SAS-Opaque-Token</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/Wecom-Login/">Wecom-Login</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Optimize-Customlize-UserDetailService/">SAS-Optimize-Customlize-UserDetailService</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Optimize-Add-Redis-Cache/">SAS-Optimize-Add-Redis-Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Optimize-Persistance-JWKSource/">SAS-Optimize-Persistance-JWKSource</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Optimize-Redis-Serializer-Add-Jackson-Mixin/">SAS-Optimize-Redis-Serializer-Add-Jackson-Mixin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-FAQ/">SAS-FAQ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/light-docusaurus/docs/category/active-directory/">Active Directory</a><button aria-label="展开侧边栏分类 &#x27;Active Directory&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/light-docusaurus/docs/category/database/">Database</a><button aria-label="展开侧边栏分类 &#x27;Database&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/light-docusaurus/docs/category/git/">Git</a><button aria-label="展开侧边栏分类 &#x27;Git&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/light-docusaurus/docs/category/linux/">Linux</a><button aria-label="展开侧边栏分类 &#x27;Linux&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/light-docusaurus/docs/category/docker/">Docker</a><button aria-label="展开侧边栏分类 &#x27;Docker&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/light-docusaurus/docs/category/kubernetes/">Kubernetes</a><button aria-label="展开侧边栏分类 &#x27;Kubernetes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/light-docusaurus/docs/category/test/">Test</a><button aria-label="展开侧边栏分类 &#x27;Test&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/light-docusaurus/docs/category/others/">Others</a><button aria-label="展开侧边栏分类 &#x27;Others&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/light-docusaurus/docs/zh-cn/awesome-open-source/">Awesome open source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/light-docusaurus/docs/zh-cn/windows/">Windows</a></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/light-docusaurus/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/light-docusaurus/docs/category/spring-authorization-server/"><span itemprop="name">Spring Authorization Server</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">SAS-FAQ</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>SAS-FAQ</h1></header><ul>
<li><a href="https://juejin.cn/post/7279242389000208438" target="_blank" rel="noopener noreferrer">Spring Authorization Server常见问题解答(FAQ)</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="一常见问题解答">一、常见问题解答<a href="#一常见问题解答" class="hash-link" aria-label="一、常见问题解答的直接链接" title="一、常见问题解答的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后响应错误码999">1. 访问授权申请(<code>/oauth2/authorize</code>)接口跳转到默认登录页面，登录成功后响应错误码999<a href="#1-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后响应错误码999" class="hash-link" aria-label="1-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后响应错误码999的直接链接" title="1-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后响应错误码999的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-错误示例">1. 错误示例<a href="#1-错误示例" class="hash-link" aria-label="1. 错误示例的直接链接" title="1. 错误示例的直接链接">​</a></h4>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;timestamp&quot;:&quot;2023-06-24 01:08:42&quot;,&quot;status&quot;:999,&quot;error&quot;:&quot;None&quot;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-可能造成该问题的原因">2. 可能造成该问题的原因：<a href="#2-可能造成该问题的原因" class="hash-link" aria-label="2. 可能造成该问题的原因：的直接链接" title="2. 可能造成该问题的原因：的直接链接">​</a></h4>
<ol>
<li>登录页面的某些静态资源被拦截了，在资源服务器中放行登录页面的所有静态资源</li>
<li>未放行路径<code>/error</code>，当登录页面的某些静态资源不存在导致404时会跳转到<code>/error</code>处理，未放行该路径会导致请求重定向至登录页面</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-以上问题排查建议">3. 以上问题排查建议：<a href="#3-以上问题排查建议" class="hash-link" aria-label="3. 以上问题排查建议：的直接链接" title="3. 以上问题排查建议：的直接链接">​</a></h4>
<ol>
<li>浏览器打开登录页面(<a href="http://127.0.0.1:8080/login)%EF%BC%8C" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8080/login)，</a> 然后按F12，看一下控制台中有哪些请求是302并且被重定向至登录页面的</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后跳转回来时授权申请oauth2authorize接口响应400错误">2. 访问授权申请(<code>/oauth2/authorize</code>)接口跳转到默认登录页面，登录成功后跳转回来时授权申请(<code>/oauth2/authorize</code>)接口响应400错误<a href="#2-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后跳转回来时授权申请oauth2authorize接口响应400错误" class="hash-link" aria-label="2-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后跳转回来时授权申请oauth2authorize接口响应400错误的直接链接" title="2-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后跳转回来时授权申请oauth2authorize接口响应400错误的直接链接">​</a></h3>
<p>检查数据库中是否存在授权申请使用的客户端信息，因为最终客户 端信息是在数据库中存储着的。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后跳转回来时授权申请oauth2authorize接口响应404错误">3. 访问授权申请(<code>/oauth2/authorize</code>)接口跳转到默认登录页面，登录成功后跳转回来时授权申请(<code>/oauth2/authorize</code>)接口响应404错误<a href="#3-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后跳转回来时授权申请oauth2authorize接口响应404错误" class="hash-link" aria-label="3-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后跳转回来时授权申请oauth2authorize接口响应404错误的直接链接" title="3-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后跳转回来时授权申请oauth2authorize接口响应404错误的直接链接">​</a></h3>
<p>在添加认证服务配置与资源服务配置时两个过滤器链不要添加<code>@Order</code>注解，以防认证服务配置被覆盖
如果有网关代理，记得认证服务配置中的签发地址(<code>issue</code>)中需要添加网关的代理路径</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-在pkce流程中通过tokenoauth2token接口获取token时响应-invalid_grant">4. 在PKCE流程中通过token(<code>/oauth2/token</code>)接口获取token时，响应 <code>invalid_grant</code><a href="#4-在pkce流程中通过tokenoauth2token接口获取token时响应-invalid_grant" class="hash-link" aria-label="4-在pkce流程中通过tokenoauth2token接口获取token时响应-invalid_grant的直接链接" title="4-在pkce流程中通过tokenoauth2token接口获取token时响应-invalid_grant的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-错误示例-1">1. 错误示例<a href="#1-错误示例-1" class="hash-link" aria-label="1. 错误示例的直接链接" title="1. 错误示例的直接链接">​</a></h4>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;error&quot;:&quot;invalid_grant&quot;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-可能造成该问题的原因-1">2. 可能造成该问题的原因<a href="#2-可能造成该问题的原因-1" class="hash-link" aria-label="2. 可能造成该问题的原因的直接链接" title="2. 可能造成该问题的原因的直接链接">​</a></h4>
<ol>
<li>授权码错误</li>
<li>客户端id错误</li>
<li>回调地址错误(跟请求<code>/oauth2/authorize</code>时携带的不一致)</li>
<li>授权码过期</li>
<li>生成<code>code_challenge</code>的算法有问题</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-在oauth2流程中通过tokenoauth2token接口获取token时响应-invalid_client">5. 在OAuth2流程中通过token(<code>/oauth2/token</code>)接口获取token时，响应 <code>invalid_client</code><a href="#5-在oauth2流程中通过tokenoauth2token接口获取token时响应-invalid_client" class="hash-link" aria-label="5-在oauth2流程中通过tokenoauth2token接口 获取token时响应-invalid_client的直接链接" title="5-在oauth2流程中通过tokenoauth2token接口获取token时响应-invalid_client的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-错误示例-2">1. 错误示例<a href="#1-错误示例-2" class="hash-link" aria-label="1. 错误示例的直接链接" title="1. 错误示例的直接链接">​</a></h4>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;error&quot;:&quot;invalid_client&quot;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-可能造成该问题的原因-2">2. 可能造成该问题的原因<a href="#2-可能造成该问题的原因-2" class="hash-link" aria-label="2. 可能造成该问题的原因的直接链接" title="2. 可能造成该问题的原因的直接链接">​</a></h4>
<ol>
<li>客户端id错误</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-client-授权登录后-如何退出呢">6. client 授权登录后 如何退出呢？<a href="#6-client-授权登录后-如何退出呢" class="hash-link" aria-label="6. client 授权登录后 如何退出呢？的直接链接" title="6. client 授权登录后 如何退出呢？的直接链接">​</a></h3>
<p>Spring Security 提供了退出的端点：<code>/logout</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-直接配置-preauthorize-注解不生效">7. 直接配置 <code>@PreAuthorize</code> 注解不生效<a href="#7-直接配置-preauthorize-注解不生效" class="hash-link" aria-label="7-直接配置-preauthorize-注解不生效的直接链接" title="7-直接配置-preauthorize-注解不生效的直接链接">​</a></h3>
<p>检查是否添加以下两个注解</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@EnableWebSecurity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@EnableMethodSecurity(jsr250Enabled = true, securedEnabled = true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>详见本系列的第九篇文章: <a href="https://juejin.cn/post/7244043482772029498" target="_blank" rel="noopener noreferrer">Spring Authorization Server入门 (九) Spring Boot引入Resource Server对接认证服 务</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="8-客户端对接认证服务时出现authorization_request_not_found异常">8. 客户端对接认证服务时出现<code>[authorization_request_not_found]</code>异常<a href="#8-客户端对接认证服务时出现authorization_request_not_found异常" class="hash-link" aria-label="8-客户端对接认证服务时出现authorization_request_not_found异常的直接链接" title="8-客户端对接认证服务时出现authorization_request_not_found异常的直接链接">​</a></h3>
<p>认证服务器和客户端在同一个机器上时不能使用同一个ip，例如<code>127.0.0.1</code>，在存储cookie时不会区分端口的，比如<code>127.0.0.1:8000</code>和<code>127.0.0.1:8080</code>这两个，他们的cookie是同一个的，后者会覆盖前者；如果配置认证服务的地址是<code>127.0.0.1:8080</code>然后通过<code>127.0.0.1:8000</code>去访问客户端则会在登录后出现<code>[authorization_request_not_found]</code>异常，详见<a href="https://github.com/spring-projects/spring-security/issues/5946" target="_blank" rel="noopener noreferrer">spring-security issues 5946</a></p>
<p>如果使用的是域名，可以解析两个子域名，一个解析到认证服务，一个解析到客户端服务</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="9-如果不用这个web页面登录有个接口然后用安卓界面登录呢应该用什么处理方式">9. 如果不用这个web页面登录，有个接口，然后用安卓界面登录呢，应该用什么处理方式？<a href="#9-如果不用这个web页面登录有个接口然后用安卓界面登录呢应该用什么处理方式" class="hash-link" aria-label="9. 如果不用这个web页面登录，有个接口，然后用安卓界面登录呢，应该用什么处理方式？的直接链接" title="9. 如果不用这个web页面登录，有个接口，然后用安卓界面登录呢，应该用什么处理方式？的直接链接">​</a></h3>
<p>移动app和pc的app用的比较多的是PKCE模式，如果不想跳转到web登录页面就用自定义<code>grant_type</code>的方式添加一种认证并获取token的grant，比如系列文章中的自定义<code>grant_type</code>，那种是访问接口就直接响应<code>access token</code>了</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="10-oidc中的idtoken到底有什么用一路看过来也没看到有用这个token的地方">10. oidc中的<code>idToken</code>到底有什么用？一路看过来也没看到有用这个token的地方<a href="#10-oidc中的idtoken到底有什么用一路看过来也没看到有用这个token的地方" class="hash-link" aria-label="10-oidc中的idtoken到底有什么用一路看过来也没看到有用这个token的地方的直接链接" title="10-oidc中的idtoken到底有什么用一路看过来也没看到有用这个token的地方的直接链接">​</a></h3>
<p><code>idToken</code>中包含了用户信息，解析后可以直接获取用户信息，不用再请求服务器了</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-使用自定义的userdetailsservice登录时出现序列化问题">11. 使用自定义的<code>UserDetailsService</code>登录时出现序列化问题<a href="#11-使用自定义的userdetailsservice登录时出现序列化问题" class="hash-link" aria-label="11-使用自定义的userdetailsservice登录时出现序列化问题的直接链接" title="11-使用自定义的userdetailsservice登录时出现序列化问题的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-异常堆栈描述">1. 异常堆栈描述<a href="#1-异常堆栈描述" class="hash-link" aria-label="1. 异常堆栈描述的直接链接" title="1. 异常堆栈描述的直接链接">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">java.lang.IllegalArgumentException: The class with com.example.entity.Oauth2BasicUser and name of com.example.entity.Oauth2BasicUser is not in the allowlist. If you believe this class is safe to deserialize, please provide an explicit mapping using Jackson annotations or by providing a Mixin. If the serialization is only done by a trusted source, you can also enable default typing. See github.com for details</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-解决方案">2. 解决方案<a href="#2-解决方案" class="hash-link" aria-label="2. 解决方案的直接链接" title="2. 解决方案的直接链接">​</a></h4>
<p>实体类添加两个注解：<code>@JsonSerialize</code>与<code>@JsonIgnoreProperties(ignoreUnknown = true)</code></p>
<ul>
<li><code>@JsonSerialize</code>: 添加<code>JsonMixin</code></li>
<li><code>@JsonIgnoreProperties(ignoreUnknown = true)</code>: 序列化时忽略未知字段</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-按照教程搭建起来结果登录时一直提示用户名密码不对">12. 按照教程搭建起来，结果登录时一直提示用户名密码不对<a href="#12-按照教程搭建起来结果登录时一直提示用户名密码不对" class="hash-link" aria-label="12. 按照教程  搭建起来，结果登录时一直提示用户名密码不对的直接链接" title="12. 按照教程搭建起来，结果登录时一直提示用户名密码不对的直接链接">​</a></h3>
<p>可能是注入了一个<code>UserDetailsService</code>，账号密码跟文中不同，但是使用的账号密码却是文章的账号密码</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-为什么客户端的认证信息要在请求头中添加authorization这个请求头header的authorization-参数值为basic空格base64clientid">13. 为什么客户端的认证信息要在请求头中添加<code>Authorization</code>这个请求头，header的<code>Authorization</code> 参数值为Basic+空格+base64(clientId<!-- -->:clientSecret<!-- -->)<a href="#13-为什么客户端的认证信息要在请求头中添加authorization这个请求头header的authorization-参数值为basic空格base64clientid" class="hash-link" aria-label="13-为什么客户端的认证信息要在请求头中添加authorization这个请求头header的authorization-参数值为basic空格base64clientid的直接链接" title="13-为什么客户端的认证信息要在请求头中添加authorization这个请求头header的authorization-参数值为basic空格base64clientid的直接链接">​</a></h3>
<p>这是oauth2协议定的标准，客户端的认证方式设置为BasicAuth时认证信息是在header中是这么个格式，以base64编码后加上前缀放入header中，详见本系列的第一章：<a href="https://juejin.cn/post/7239953874950733884" target="_blank" rel="noopener noreferrer">Spring Authorization Server入门 (一) 初识SpringAuthorizationServer和OAuth2.1协议</a>，里边介绍了客户端的各种认证方式</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="14-要怎样继承改写daoauthenticationprovider主要是继承了这个类项目启动了发现并没有进入自己继承的这个daoauthenticationprovider的类操作是啥问题">14. 要怎样继承改写<code>DaoAuthenticationProvider</code>，  主要是继承了这个类，项目启动了发现并没有进入自己继承的这个<code>DaoAuthenticationProvider</code>的类操作。是啥问题<a href="#14-要怎样继承改写daoauthenticationprovider主要是继承了这个类项目启动了发现并没有进入自己继承的这个daoauthenticationprovider的类操作是啥问题" class="hash-link" aria-label="14-要怎样继承改写daoauthenticationprovider主要是继承了这个类项目启动了发现并没有进入自己继承的这个daoauthenticationprovider的类操作是啥问题的直接链接" title="14-要怎样继承改写daoauthenticationprovider主要是继承了这个类项目启动了发现并没有进入自己继承的这个daoauthenticationprovider的类操作是啥问题的直接链接">​</a></h3>
<p>自己实现的没加<code>@Component</code>注解吗？如果加了那可能是在其它地方有provider实现被注入ioc中了；Security在初始化时会有个校验，好像是如果ioc中有多个<code>DaoAuthenticationProvider</code>的实例就只初始化默认的<code>DaoAuthenticationProvider</code>而不初始化子类，但是如果只有一个的话就会用ioc中的，所以不能多个实现都注入ioc</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="15-使用oracle数据库在授权申请时会抛出异常堆栈">15. 使用Oracle数据库在授权申请时会抛出异常堆栈<a href="#15-使用oracle数据库在授权申请时会抛出异常堆栈" class="hash-link" aria-label="15. 使用Oracle数据库在授权申请时会抛出异常堆栈的直接链接" title="15. 使用Oracle数据库在授权申请时会抛出异常堆栈的直接链接">​</a></h3>
<p>框架问题，使用Oracle时确实会出现这种问题，如果需要解决可能需要重写<code>AuthorizationService</code>，详见<a href="https://github.com/spring-projects/spring-authorization-server/issues/428" target="_blank" rel="noopener noreferrer">spring-authorization-server issues 428</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="16-集成-spring-cloud-gateway-出现-oauth2authenticationexception-invalid_user_info_response">16. 集成 <code>spring-cloud-gateway</code> 出现 <code>OAuth2AuthenticationException: [invalid_user_info_response]</code><a href="#16-集成-spring-cloud-gateway-出现-oauth2authenticationexception-invalid_user_info_response" class="hash-link" aria-label="16-集成-spring-cloud-gateway-出现-oauth2authenticationexception-invalid_user_info_response的直接链接" title="16-集成-spring-cloud-gateway-出现-oauth2authenticationexception-invalid_user_info_response的直接链接">​</a></h3>
<ul>
<li><a href="https://stackoverflow.com/questions/76093710/spring-security-oauth-invalid-user-info-response" target="_blank" rel="noopener noreferrer">Spring Security OAuth: [invalid_user_info_response]</a></li>
</ul>
<p>新版本的<code>spring-security-oauth2-client</code> 修改了获取用户信息后的处理逻辑，见 <code>org.springframework.security.oauth2.client.oidc.userinfo.OidcReactiveOAuth2UserService#getUserInfo</code>，增加了对token签发 <code>subject</code> 的校验</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">private Mono&lt;OidcUserInfo&gt; getUserInfo(OidcUserRequest userRequest) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (!OidcUserRequestUtils.shouldRetrieveUserInfo(userRequest)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return Mono.empty();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // @formatter:off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return this.oauth2UserService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .loadUser(userRequest)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .map(OAuth2User::getAttributes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .map((claims) -&gt; convertClaims(claims, userRequest.getClientRegistration()))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .map(OidcUserInfo::new)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .doOnNext((userInfo) -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                String subject = userInfo.getSubject();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (subject == null || !subject.equals(userRequest.getIdToken().getSubject())) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    OAuth2Error oauth2Error = new OAuth2Error(INVALID_USER_INFO_RESPONSE_ERROR_CODE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    throw new OAuth2AuthenticationException(oauth2Error, oauth2Error.toString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // @formatter:on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>文章会记录可能遇到的问题，并给出一个解决方案，目前框架异常提示信息不完善，所以出现问题后很难排查，这里给出一些解决方案，让大家少走一些弯路；本篇文章持续更新中，欢迎各位读者指正、补充和完善，谢谢大家</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/lorchr/light-docusaurus/tree/main/docs/zh-cn/spring-authorization-server/200-SAS-FAQ.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Optimize-Redis-Serializer-Add-Jackson-Mixin/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">SAS-Optimize-Redis-Serializer-Add-Jackson-Mixin</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/light-docusaurus/docs/category/active-directory/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Active Directory</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一常见问题解答" class="table-of-contents__link toc-highlight">一、常见问题解答</a><ul><li><a href="#1-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后响应错误码999" class="table-of-contents__link toc-highlight">1. 访问授权申请(<code>/oauth2/authorize</code>)接口跳转到默认登录页面，登录成功后响应错误码999</a></li><li><a href="#2-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后跳转回来时授权申请oauth2authorize接口响应400错误" class="table-of-contents__link toc-highlight">2. 访问授权申请(<code>/oauth2/authorize</code>)接口跳转到默认登录页面，登录成功后跳转回来时授权申请(<code>/oauth2/authorize</code>)接口响应400错误</a></li><li><a href="#3-访问授权申请oauth2authorize接口跳转到默认登录页面登录成功后跳转回来时授权申请oauth2authorize接口响应404错误" class="table-of-contents__link toc-highlight">3. 访问授权申请(<code>/oauth2/authorize</code>)接口跳转到默认登录页面，登录成功后跳转回来时授权申请(<code>/oauth2/authorize</code>)接口响应404错误</a></li><li><a href="#4-在pkce流程中通过tokenoauth2token接口获取token时响应-invalid_grant" class="table-of-contents__link toc-highlight">4. 在PKCE流程中通过token(<code>/oauth2/token</code>)接口获取token时，响应 <code>invalid_grant</code></a></li><li><a href="#5-在oauth2流程中通过tokenoauth2token接口获取token时响应-invalid_client" class="table-of-contents__link toc-highlight">5. 在OAuth2流程中通过token(<code>/oauth2/token</code>)接口获取token时，响应 <code>invalid_client</code></a></li><li><a href="#6-client-授权登录后-如何退出呢" class="table-of-contents__link toc-highlight">6. client 授权登录后 如何退出呢？</a></li><li><a href="#7-直接配置-preauthorize-注解不生效" class="table-of-contents__link toc-highlight">7. 直接配置 <code>@PreAuthorize</code> 注解不生效</a></li><li><a href="#8-客户端对接认证服务时出现authorization_request_not_found异常" class="table-of-contents__link toc-highlight">8. 客户端对接认证服务时出现<code>[authorization_request_not_found]</code>异常</a></li><li><a href="#9-如果不用这个web页面登录有个接口然后用安卓界面登录呢应该用什么处理方式" class="table-of-contents__link toc-highlight">9. 如果不用这个web页面登录，有个接口，然后用安卓界面登录呢，应该用什么处理方式？</a></li><li><a href="#10-oidc中的idtoken到底有什么用一路看过来也没看到有用这个token的地方" class="table-of-contents__link toc-highlight">10. oidc中的<code>idToken</code>到底有什么用？一路看过来也没看到有用这个token的地方</a></li><li><a href="#11-使用自定义的userdetailsservice登录时出现序列化问题" class="table-of-contents__link toc-highlight">11. 使用自定义的<code>UserDetailsService</code>登录时出现序列化问题</a></li><li><a href="#12-按照教程搭建起来结果登录时一直提示用户名密码不对" class="table-of-contents__link toc-highlight">12. 按照教程搭建起来，结果登录时一直提示用户名密码不对</a></li><li><a href="#13-为什么客户端的认证信息要在请求头中添加authorization这个请求头header的authorization-参数值为basic空格base64clientid" class="table-of-contents__link toc-highlight">13. 为什么客户端的认证信息要在请求头中添加<code>Authorization</code>这个请求头，header的<code>Authorization</code> 参数值为Basic+空格+base64(clientId)</a></li><li><a href="#14-要怎样继承改写daoauthenticationprovider主要是继承了这个类项目启动了发现并没有进入自己继承的这个daoauthenticationprovider的类操作是啥问题" class="table-of-contents__link toc-highlight">14. 要怎样继承改写<code>DaoAuthenticationProvider</code>，主要是继承了这个类，项目启动了发现并没有进入自己继承的这个<code>DaoAuthenticationProvider</code>的类操作。是啥问题</a></li><li><a href="#15-使用oracle数据库在授权申请时会抛出异常堆栈" class="table-of-contents__link toc-highlight">15. 使用Oracle数据库在授权申请时会抛出异常堆栈</a></li><li><a href="#16-集成-spring-cloud-gateway-出现-oauth2authenticationexception-invalid_user_info_response" class="table-of-contents__link toc-highlight">16. 集成 <code>spring-cloud-gateway</code> 出现 <code>OAuth2AuthenticationException: [invalid_user_info_response]</code></a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/docs/category/guide/">Torch</a></li><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/middleware/">Middleware</a></li><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/electron/">Electron</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/diy/">DIY</a></li><li class="footer__item"><a href="https://github.com/lorchr/light-docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Offical</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Home<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docusaurus.io/docs/playground" target="_blank" rel="noopener noreferrer" class="footer__link-item">Playground<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Light-Docusaurus, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>