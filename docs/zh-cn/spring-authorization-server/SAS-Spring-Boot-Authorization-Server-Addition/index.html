<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-zh-cn/spring-authorization-server/SAS-Spring-Boot-Authorization-Server-Addition" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">SAS-Spring-Boot-Authorization-Server-Addition | Light Docusaurus</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://lorchr.github.io/light-docusaurus/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://lorchr.github.io/light-docusaurus/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://lorchr.github.io/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Spring-Boot-Authorization-Server-Addition/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SAS-Spring-Boot-Authorization-Server-Addition | Light Docusaurus"><meta data-rh="true" name="description" content="- Spring Authorization Server入门 (三) 集成流程说明、细节补充和各种方式获取token测试"><meta data-rh="true" property="og:description" content="- Spring Authorization Server入门 (三) 集成流程说明、细节补充和各种方式获取token测试"><link data-rh="true" rel="icon" href="/light-docusaurus/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://lorchr.github.io/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Spring-Boot-Authorization-Server-Addition/"><link data-rh="true" rel="alternate" href="https://lorchr.github.io/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Spring-Boot-Authorization-Server-Addition/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://lorchr.github.io/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Spring-Boot-Authorization-Server-Addition/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://TLGHDZ3Y2I-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/light-docusaurus/blog/rss.xml" title="Light Docusaurus RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/light-docusaurus/blog/atom.xml" title="Light Docusaurus Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Light Docusaurus" href="/light-docusaurus/opensearch.xml"><link rel="stylesheet" href="/light-docusaurus/assets/css/styles.609e5209.css">
<script src="/light-docusaurus/assets/js/runtime~main.8c0ff940.js" defer="defer"></script>
<script src="/light-docusaurus/assets/js/main.898faf32.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/light-docusaurus/"><div class="navbar__logo"><img src="/light-docusaurus/img/logo.svg" alt="Torch Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/light-docusaurus/img/logo.svg" alt="Torch Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Torch</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/light-docusaurus/docs/category/guide/">Torch</a><a class="navbar__item navbar__link" href="/light-docusaurus/blog/">Blog</a><a class="navbar__item navbar__link" href="/light-docusaurus/middleware/">Middleware</a><a class="navbar__item navbar__link" href="/light-docusaurus/electron/">Electron</a><a class="navbar__item navbar__link" href="/light-docusaurus/postman/">Postman</a><a class="navbar__item navbar__link" href="/light-docusaurus/diy/">DIY</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Spring-Boot-Authorization-Server-Addition/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li></ul></div><a href="https://github.com/lorchr/light-docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/guide/">Guide</a><button aria-label="展开侧边栏分类 &#x27;Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/develop-environment/">Develop Environment</a><button aria-label="展开侧边栏分类 &#x27;Develop Environment&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/java-jvm/">Java (JVM)</a><button aria-label="展开侧边栏分类 &#x27;Java (JVM)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/spring-boot/">Spring Boot</a><button aria-label="展开侧边栏分类 &#x27;Spring Boot&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/spring-cloud/">Spring Cloud</a><button aria-label="展开侧边栏分类 &#x27;Spring Cloud&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/spring-security/">Spring Security</a><button aria-label="展开侧边栏分类 &#x27;Spring Security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/light-docusaurus/docs/category/spring-authorization-server/">Spring Authorization Server</a><button aria-label="折叠侧边栏分类 &#x27;Spring Authorization Server&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Geting-Start-Index/">SAS-Geting-Start-Index</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-OAuth2.1-Protocol/">SAS-OAuth2.1-Protocol</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Spring-Boot-Authorization-Server/">SAS-Spring-Boot-Authorization-Server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Spring-Boot-Authorization-Server-Addition/">SAS-Spring-Boot-Authorization-Server-Addition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Device-Authorization/">SAS-Device-Authorization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Customize-Exception-Configurer/">SAS-Customize-Exception-Configurer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Token-Enhancer-And-Parser/">SAS-Token-Enhancer-And-Parser</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Image-Captcha/">SAS-Image-Captcha</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-OAuth2-Client/">SAS-OAuth2-Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-OAuth2-Resource-Server/">SAS-OAuth2-Resource-Server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-SMS-Code-Login/">SAS-SMS-Code-Login</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-OAuth2-Extension-Grant-Type/">SAS-OAuth2-Extension-Grant-Type</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Frontend-Backend-Separate/">SAS-Frontend-Backend-Separate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Github-Gitee-Login/">SAS-Github-Gitee-Login</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Wechat-Login/">SAS-Wechat-Login</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Separate-Consent-And-Device-Authorize-Page/">SAS-Separate-Consent-And-Device-Authorize-Page</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Spring-Cloud-Gateway/">SAS-Spring-Cloud-Gateway</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Vue-Authorization-Code/">SAS-Vue-Authorization-Code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Vue-PKCE/">SAS-Vue-PKCE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Redis-Core-Service/">SAS-Redis-Core-Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-QrCode-Login/">SAS-QrCode-Login</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Optimize-Customlize-UserDetailService/">SAS-Optimize-Customlize-UserDetailService</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Optimize-Add-Redis-Cache/">SAS-Optimize-Add-Redis-Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Optimize-Persistance-JWKSource/">SAS-Optimize-Persistance-JWKSource</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Optimize-Redis-Serializer-Add-Jackson-Mixin/">SAS-Optimize-Redis-Serializer-Add-Jackson-Mixin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-FAQ/">SAS-FAQ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/active-directory/">Active Directory</a><button aria-label="展开侧边栏分类 &#x27;Active Directory&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/database/">Database</a><button aria-label="展开侧边栏分类 &#x27;Database&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/git/">Git</a><button aria-label="展开侧边栏分类 &#x27;Git&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/linux/">Linux</a><button aria-label="展开侧边栏分类 &#x27;Linux&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/docker/">Docker</a><button aria-label="展开侧边栏分类 &#x27;Docker&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/kubernetes/">Kubernetes</a><button aria-label="展开侧边栏分类 &#x27;Kubernetes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/test/">Test</a><button aria-label="展开侧边栏分类 &#x27;Test&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/others/">Others</a><button aria-label="展开侧边栏分类 &#x27;Others&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/light-docusaurus/docs/zh-cn/awesome-open-source/">Awesome open source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/light-docusaurus/docs/zh-cn/windows/">Windows</a></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/light-docusaurus/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/light-docusaurus/docs/category/spring-authorization-server/"><span itemprop="name">Spring Authorization Server</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">SAS-Spring-Boot-Authorization-Server-Addition</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>SAS-Spring-Boot-Authorization-Server-Addition</h1></header><ul>
<li><a href="https://juejin.cn/post/7241058098974720037">Spring Authorization Server入门 (三) 集成流程说明、细节补充和各种方式获取token测试</a></li>
</ul>
<h2 id="一spring-boot-与spring-authorization-server集成流程说明">一、Spring boot 与Spring authorization Server集成流程说明</h2>
<ol>
<li>创建项目</li>
<li>添加依赖</li>
<li>初始化数据库(用户授权确认表、用户认证信息表和客户端信息表)</li>
<li>创建<code>AuthorizationConfig</code>(名字自定)类</li>
<li>配置认证端点过滤器链，添加身份认证过滤器了、密码解析器、<code>jws</code>相关配置和认证服务设置</li>
<li>配置上添加<code>@Configuration</code>、<code>@EnableWebSecurity</code>和<code>@EnableMethodSecurity</code>注解</li>
<li>添加一个接口，将登录和用户授权确认页面请求转发至自定义的页面</li>
<li>在<code>application.yml</code>中配置数据源信息</li>
<li>添加自定义页面相关静态文件</li>
</ol>
<h2 id="二细节补充">二、细节补充</h2>
<p>在<a href="https://juejin.cn/post/7239953874950815804">上一篇文章</a>中的<code>AuthorizationConfig.java</code>配置类中，类上有三个注解，分别是<code>@Configuration</code>、<code>@EnableWebSecurity</code>和<code>@EnableMethodSecurity</code>注解，虽然在类中有注释，但是这里在细讲一下，同时放一下官网的说明</p>
<h3 id="1-enablewebsecurity">1. <code>@EnableWebSecurity</code></h3>
<ul>
<li>加载了<code>WebSecurityConfiguration</code>配置类, 配置安全认证策略。</li>
<li>加载了<code>AuthenticationConfiguration</code>, 配置了认证信息。</li>
</ul>
<h3 id="2-enablemethodsecurity-官网文档说明">2. <code>@EnableMethodSecurity</code> <a href="https://docs.spring.io/spring-security/reference/servlet/authorization/method-security.html#jc-enable-method-security">官网文档说明</a></h3>
<p>默认启用方法级别的安全校验</p>
<ul>
<li>设置注解属性 <code>jsr250Enabled = true</code> 是为了启用JSR250注解支持，例如<code>@RolesAllowed</code>、<code>@PermitAll</code>和<code>@DenyAll</code>注解</li>
<li>设置属性 <code>securedEnabled = true</code> 是为了启用<code>@Secured</code>注解支持，不设置属性则添加<code>@Secured</code>注解无效</li>
</ul>
<h3 id="3-configuration-文档说明地址">3. <code>@Configuration</code> <a href="https://docs.spring.io/spring-security/reference/5.8/migration/servlet/config.html#add-configuration-annotation">文档说明地址</a></h3>
<ul>
<li>在Spring security 6.0 版本及之后版本中将<code>@Configuration</code>注解从<code>@EnableWebSecurity</code>, <code>@EnableMethodSecurity</code>, <code>@EnableGlobalMethodSecurity</code> 和 <code>@EnableGlobalAuthentication</code> 中移除，使用这些注解需手动添加 <code>@Configuration</code> 注解</li>
</ul>
<h2 id="三测试">三、测试</h2>
<h3 id="1-授权码模式获取token">1. 授权码模式获取token</h3>
<p>该流程上一章已经说过了，本篇文章就大概过一下</p>
<h4 id="1-组装url发起授权请求">1. 组装url发起授权请求</h4>
<pre><code class="language-shell">http://127.0.0.1:8080/oauth2/authorize?client_id=messaging-client&amp;response_type=code&amp;scope=message.read&amp;redirect_uri=http://127.0.0.1:8080/login/oauth2/code/messaging-client-oidc
</code></pre>
<p>参数解释</p>
<ul>
<li><code>client_id</code>：客户端的id</li>
<li><code>response_type</code>：授权码模式固定为<code>code</code></li>
<li><code>scope</code>：请求授权的范围</li>
<li><code>redirect_uri</code>：回调地址</li>
</ul>
<h4 id="2-重定向至登录页面">2. 重定向至登录页面</h4>
<p><img alt="img" src="data:;base64,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" width="1512" height="542"></p>
<h4 id="3-重定向至回调地址">3. 重定向至回调地址</h4>
<p>该客户端已经经过用户授权确认了，授权确认信息表中已存在，所以直接重定向至回调地址</p>
<p><img alt="img" src="/light-docusaurus/assets/images/3-2-27cf2986414ac8880a96dfc203e9def8.awebp" width="1512" height="355"></p>
<h4 id="4-复制code至postman发起请求">4. 复制code至postman发起请求</h4>
<p><img alt="img" src="/light-docusaurus/assets/images/3-3-128f3a1a6805ec5518800310d7e57b7a.awebp" width="1503" height="588"></p>
<p>添加<code>Basic Auth</code>(客户端id和客户端秘钥)</p>
<ul>
<li><code>grant_type</code>: 在授权码模式中固定为<code>authorization_code</code></li>
<li><code>redirect_uri</code>：与第一步请求授权时携带的<code>redirect_uri</code>一致，并且是严格匹配模式，客户端配置中不能只配置一个域名</li>
<li><code>code</code>：重定向至<code>redirect_uri</code>携带的code参数</li>
</ul>
<h3 id="2-刷新token">2. 刷新token</h3>
<p><img alt="img" src="/light-docusaurus/assets/images/3-4-fbcb261abb56ce073a074737fe3b905f.awebp" width="1497" height="684"></p>
<p>上一步通过授权码模式获取了一个<code>token</code>，如上图，现在尝试下使用响应中的<code>refresh_token</code>来刷新一下<code>token</code>看看
对<code>/oauth2/token</code>接口发起一个POST请求，请求参数为<code>grant_type</code>和<code>refresh_token</code>，还有客户端的相关认证</p>
<ul>
<li><code>grant_type</code>：刷新<code>token</code>时固定值为<code>refresh_token</code></li>
<li><code>refresh_token</code>：请求<code>/oauth2/token</code>接口响应数据中的<code>refresh_token</code></li>
</ul>
<p><img alt="img" src="/light-docusaurus/assets/images/3-5-b52bd60527433a167af86b3ef19d8adf.awebp" width="1495" height="705"></p>
<p>另外，不要忘了<code>basic auth</code>的请求头</p>
<p><img alt="img" src="/light-docusaurus/assets/images/3-6-e4a25dfba3d80faf21a0bcecb3eb42bc.awebp" width="1495" height="743"></p>
<p>接下来编写一个测试接口并添加<code>@PreAuthorize(&quot;hasAuthority(&#x27;app&#x27;)&quot;)</code>注解，设置只有拥有app权限的人才能访问接口，如下</p>
<pre><code class="language-java">package com.example.controller;

import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

/**
 * 测试接口
 *
 * @author vains
 */
@RestController
public class TestController {

    @GetMapping(&quot;/test01&quot;)
    @PreAuthorize(&quot;hasAuthority(&#x27;app&#x27;)&quot;)
    public String test01() {
        return &quot;test01&quot;;
    }

}
</code></pre>
<p>然后携带<code>token</code>去请求这个测试接口</p>
<p><img alt="img" src="/light-docusaurus/assets/images/3-7-8f697ec898c9b4549dc603e33dc7b469.awebp" width="1498" height="710"></p>
<p>这时我们会发现接口响应403，并且错误信息都在响应头中，而响应内容是空的。如下</p>
<p><img alt="img" src="/light-docusaurus/assets/images/3-8-e3baf96fd4f24428cc21d780af75af98.awebp" width="1498" height="421"></p>
<p>我们来看下框架中关于权限不足的默认实现，将提取出来的异常信息放入响应头中返回</p>
<p><img alt="img" src="/light-docusaurus/assets/images/3-9-444d06f9ee125956aaef9177a4732c50.awebp" width="1197" height="774"></p>
<p>响应的错误信息在请求头中是因为源码中提到的<a href="https://datatracker.ietf.org/doc/html/rfc6750#section-3.1">RFC 6750</a>和oauth2.1协议规范中的<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-1-07#name-the-www-authenticate-respon">The WWW-Authenticate Response Header Field</a>规定了异常信息的位置
接下来就是403的问题，之前我们获取<code>token</code>的时候是通过授权码流程获取<code>token</code>，oauth2的授权实际上是依赖客户端的<code>scope</code>，用户在发起授权时是  通过申请客户端<code>scope</code>的方式来获取授权，所以<code>token</code>中此时实际上只有我们申请的<code>scope</code>权限，我们断点看一下携带<code>token</code>请求时通过<code>BearerTokenAuthenticationFilter</code>解析<code>token</code>获取的认证信息。</p>
<p><img alt="img" src="/light-docusaurus/assets/images/3-10-8cb5b777e086543741b143979c3f7fbe.awebp" width="1224" height="838"></p>
<p>我们可以看到，通过<code>token</code>获取的权限只有<code>scope</code>的内容，并且有个前缀<code>SCOPE_</code>，这个前缀是在<code>JwtGrantedAuthoritiesConverter</code>类解析<code>token</code>时默认添加的，如下</p>
<p><img alt="img" src="/light-docusaurus/assets/images/3-11-eeeaaec58eb6a787baddc105286a4b25.awebp" width="1458" height="807"></p>
<p>如果想要去除这个前缀则重写该类就行，详细内容请等待下一章扩展篇
按照这个规则将<code>@PreAuthorize(&quot;hasAuthority(&#x27;app&#x27;)&quot;)</code>中的值app改为<code>SCOPE_message.read</code>，重启重新访问</p>
<p><img alt="img" src="data:;base64,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" width="523" height="262"></p>
<p><img alt="img" src="/light-docusaurus/assets/images/3-13-bb6abf82493b40d080ac21b15dc5dfde.awebp" width="1495" height="468"></p>
<p>出现这个问题是因为重启后<code>jws</code>的配置发生了变化，无法正确解析<code>token</code>，重新调用一下刷新<code>token</code>的接口获取一个<code>token</code>就行
刷新<code>token</code>后访问接口，这时请求就正常了，没有响应403权限不足的提示了。</p>
<p><img alt="img" src="/light-docusaurus/assets/images/3-14-93be1f3f9a7a2043650a97e1f478817a.awebp" width="1497" height="514"></p>
<h3 id="3-客户端模式">3. 客户端模式</h3>
<p>该模式是为客户端准备的，客户端内部调用时可能会用到该模式
客户端模式的参数有四个，<code>grant_type</code>、<code>scope、client_id</code>和<code>client_secret</code>，客户端认证方式不是<code>client_secret_post</code>的客户端发起请求时只用携带<code>grant_type</code>参数即可，其它方式按照各自特点携带客户端的认证信息。</p>
<p><img alt="img" src="/light-docusaurus/assets/images/3-15-38b926300689194f9c7e040ab5867c51.awebp" width="1512" height="486"></p>
<ul>
<li><code>grant_type</code> 在客户端模式下固定为<code>client_credentials</code></li>
<li><code>client_id</code>：客户端的id</li>
<li><code>client_secret</code>: 客户端的秘钥</li>
<li><code>scope</code>：本次请求授权的范围</li>
</ul>
<p>拼接完scope参数请求如下示例</p>
<p><img alt="img" src="/light-docusaurus/assets/images/3-16-8fd33b17b36b13a55557417c0d51bf2b.awebp" width="1483" height="546"></p>
<h3 id="4-授权码扩展流程pkceproof-key-for-code-exchange">4. 授权码扩展流程PKCE(Proof Key for Code Exchange)</h3>
<p>首先需要添加一个公共客户端并且设置<code>proof key</code>支持，为求方便直接修改<code>AuthorizationConfig.java</code>，之后重启服务，会添加一条适用<code>pkce</code>流程的客户端</p>
<pre><code class="language-java">/**
 * 配置客户端Repository
 *
 * @param jdbcTemplate    db 数据源信息
 * @param passwordEncoder 密码解析器
 * @return 基于数据库的repository
 */
@Bean
public RegisteredClientRepository registeredClientRepository(JdbcTemplate jdbcTemplate, PasswordEncoder passwordEncoder) {
    RegisteredClient registeredClient = RegisteredClient.withId(UUID.randomUUID().toString())
            // 客户端id
            .clientId(&quot;messaging-client&quot;)
            // 客户端秘钥，使用密码解析器加密
            .clientSecret(passwordEncoder.encode(&quot;123456&quot;))
            // 客户端认证方式，基于请求头的认证
            .clientAuthenticationMethod(ClientAuthenticationMethod.CLIENT_SECRET_BASIC)
            // 配置资源服务器使用该客户端获取授权时支持的方式
            .authorizationGrantType(AuthorizationGrantType.AUTHORIZATION_CODE)
            .authorizationGrantType(AuthorizationGrantType.REFRESH_TOKEN)
            .authorizationGrantType(AuthorizationGrantType.CLIENT_CREDENTIALS)
            // 授权码模式回调地址，oauth2.1已改为精准匹配，不能只设置域名，并且屏蔽了localhost，本机使用127.0.0.1访问
            .redirectUri(&quot;http://127.0.0.1:8080/login/oauth2/code/messaging-client-oidc&quot;)
            .redirectUri(&quot;https://www.baidu.com&quot;)
            // 该客户端的授权范围，OPENID与PROFILE是IdToken的scope，获取授权时请求OPENID的scope时认证服务会返回IdToken
            .scope(OidcScopes.OPENID)
            .scope(OidcScopes.PROFILE)
            // 自定scope
            .scope(&quot;message.read&quot;)
            .scope(&quot;message.write&quot;)
            // 客户端设置，设置用户需要确认授权
            .clientSettings(ClientSettings.builder().requireAuthorizationConsent(true).build())
            .build();

    // 基于db存储客户端，还有一个基于内存的实现 InMemoryRegisteredClientRepository
    JdbcRegisteredClientRepository registeredClientRepository = new JdbcRegisteredClientRepository(jdbcTemplate);

    // 初始化客户端
    RegisteredClient repositoryByClientId = registeredClientRepository.findByClientId(registeredClient.getClientId());
    if (repositoryByClientId == null) {
        registeredClientRepository.save(registeredClient);
    }
    // 设备码授权客户端
    RegisteredClient deviceClient = RegisteredClient.withId(UUID.randomUUID().toString())
            .clientId(&quot;device-message-client&quot;)
            // 公共客户端
            .clientAuthenticationMethod(ClientAuthenticationMethod.NONE)
            // 设备码授权
            .authorizationGrantType(AuthorizationGrantType.DEVICE_CODE)
            .authorizationGrantType(AuthorizationGrantType.REFRESH_TOKEN)
            // 自定scope
            .scope(&quot;message.read&quot;)
            .scope(&quot;message.write&quot;)
            .build();
    RegisteredClient byClientId = registeredClientRepository.findByClientId(deviceClient.getClientId());
    if (byClientId == null) {
        registeredClientRepository.save(deviceClient);
    }

    // PKCE客户端
    RegisteredClient pkceClient = RegisteredClient.withId(UUID.randomUUID().toString())
            .clientId(&quot;pkce-message-client&quot;)
            // 公共客户端
            .clientAuthenticationMethod(ClientAuthenticationMethod.NONE)
            // 设备码授权
            .authorizationGrantType(AuthorizationGrantType.AUTHORIZATION_CODE)
            .authorizationGrantType(AuthorizationGrantType.REFRESH_TOKEN)
            // 授权码模式回调地址，oauth2.1已改为精准匹配，不能只设置域名，并且屏蔽了localhost，本机使用127.0.0.1访问
            .redirectUri(&quot;http://127.0.0.1:8080/login/oauth2/code/messaging-client-oidc&quot;)
            .clientSettings(ClientSettings.builder().requireProofKey(Boolean.TRUE).build())
            // 自定scope
            .scope(&quot;message.read&quot;)
            .scope(&quot;message.write&quot;)
            .build();
    RegisteredClient findPkceClient = registeredClientRepository.findByClientId(pkceClient.getClientId());
    if (findPkceClient == null) {
        registeredClientRepository.save(pkceClient);
    }
    return registeredClientRepository;
}
</code></pre>
<h4 id="1-生成code-verifier和code-challenge">1. 生成Code Verifier和Code Challenge</h4>
<p><a href="https://tonyxu-io.github.io/pkce-generator/">在线生成网站</a></p>
<p><img alt="img" src="/light-docusaurus/assets/images/3-17-fd6d3a9141a2af34e4cc5e25d82055b5.awebp" width="1512" height="503"></p>
<p>生成示例，先生成 <code>Code Verifier</code> 再生成 <code>Code Challenge</code></p>
<ul>
<li><code>Code Verifier</code>：0q9mMHEV-E_-8vxP2Aa93Y6ZKmXCan36YfAoLQViXvo</li>
<li><code>Code Challenge</code>：kfis_wJYpmCAPO-Ap1Sc6GXyz_x2dhhMsm9FOA7eEWY</li>
</ul>
<h4 id="2-拼接请求地址">2. 拼接请求地址</h4>
<pre><code class="language-shell">http://127.0.0.1:8080/oauth2/authorize?response_type=code&amp;client_id=pkce-message-client&amp;redirect_uri=http://127.0.0.1:8080/login/oauth2/code/messaging-client-oidc&amp;scope=message.read&amp;code_challenge=kfis_wJYpmCAPO-Ap1Sc6GXyz_x2dhhMsm9FOA7eEWY&amp;code_challenge_method=S256
</code></pre>
<p>参数说明</p>
<ul>
<li><code>response_type</code>: 固定值为code</li>
<li><code>client_id:</code> 客户端id</li>
<li><code>redirect_uri</code>：获取授权的回调地址</li>
<li><code>scope</code>：请求授权的范围</li>
<li><code>code_challenge</code>：在<code>CodeVerifier</code>的SHA256值基础上，再用<code>BASE64URL</code>编码</li>
</ul>
<h4 id="3-重定向至登录页面">3. 重定向至登录页面</h4>
<p>授权接口检测到尚未登录，重定向至登录页面</p>
<p><img alt="img" src="data:;base64,UklGRjggAABXRUJQVlA4ICwgAAAQDQGdASroBcIBPpFIoEylpCMiILQ4cLASCWlu/E853lUI/C9tvVd6cpl5ZRQbjX+c9Uf+L6f3oi8wH68/rl7v3oP/uHSzf77//+6b/av+p7AH7O+tt/6/Zi/vv/Z6gD//8D15o/yPbj/pPDPxm+qf2j90/Y2yp9eOpH8y++v8f+3+g//R8HfjP8+ewL7C/3nie/YTu29L/3n7E+wF7E/VP+54VPzR6kfYL/ie4B/Pv7R6X/7Dwi/v3+z9gT+h/4D9f/de/u//p/r/Pj9Y//L3Cv6F/f/Tn9jf71+0OC7gDIoTa24fH0F2nMYrW3QUn63WtW4Ili8ldirAtXRzt0rFwHsMzljFhmIqVlQMTEqVheNN/jxJXyg4ICxfaY0aoItAbyW79r2i8wqRrPkdWy/a9ovMKkaz5HVsv2vaLzCpGs+R1bL9r2i8vMlmdg+SvNrLAOVWMqWkmCdwKnwSowqrEcLXao3xWq8MazOwxoWs6JFNc/fcL9UmGnt6gfpjzECBZntBruEr3x48ZvDKRD5uUI0fLFFGdQVDCpFzSUFCDs05FcTtf71wJoc4O5d7uXFafaxd+17ReYVI1nyOrZfte0XmFSNZ8jq2X7XtF5hUjWfI6tl+17PQt52Y8B4Lzgh6BWmqw4M/NKcphUadvhiklx+bUhhqWHQoFbB4GTByQsfzRYSvc7MWmBsy6FitosmAYf3iDa2GmKa9tiuMIyosKXMLxEcZdBLBgkpJ3JHmKauzNNpwitjpo8zSZQ4Tkoap0mFa8PrKrAPDgVi2Fkv/bLe/FYpP6Ha/lgoGuGEBT9lj/VgOoPxEYhAdisaO50POArfnFGGtz4NEpMaT3v7VAtHY8kqaalLEzTzAlSrtNSpqMK6XAT/XRNmZe1NXWZeL001dZl4vTTV1mXi9NNXWZeL4YWrmefmDQHtvLU8f39Mag5tiRPf86Duj+7UjWfI6tl+17ReYVI1nyOrZfte0XmFSNZ8jq2X7XtF5hUjWfI6tfdNNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNRLBe2Gkw1p1LRdSzv9oFR+KVoM/83HRbKhFP+00hbuBo5qzTRarIdk+5IlxQr7U1dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001OnZvvMAm5ptH9GWXuajaAsvfMwIOq7fNAHMFHnvPGBVZSYid7UuYNzcqzh6usy8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausKLof2jVDsCzPXC4nMR3164Xa5iTC830bV/Cl0Ru8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausyqAQSCiX20rR1QCOMHIGouAMaFnNNXS5tPXppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausyqBt5FFkhzT29LUgwFGNNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1hM0r69Tx3CDQsY8WjRtdW23JvLm+ja6uTC830bWRp78QziLV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vUtZj2DjofVzm/Ffe70jLVCPOl1MeFs72p4GSkLddXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9N1/N+KzLxfRl7U1dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NNXWZdWGYWCsG5ePN9G11cmF5vo2urkwvN9G1UoiSlQEwXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9NL+IlgY/ZKuEeuQDBdgG0s/FSD9ihcQGv15v0PH1/BJNxxnCNvV6aausy8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMqSG8XMv72tzrfgw1TV8dgSG2sGpcfnXq1SHPiQ9XWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi9KYFVzR5N8Tq5MLzfRtcxJhXr6Nrq5MGXWVK6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausy8PpO0qQA5PvcXppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aausy8XlRtJ4BGnvvgygMz34YrmQ3bwbQ3EVvNv94PQLIhL5qYICQW8mOiC6QE7uZOMvgdS25bVexDymHmKLaascfvLT+90GNNXWZeL001dZl4vTTV1mXi9NNXWZeL001dZl4vTTV1mXi2wHG1MPFH7hAzJ3/wBhL/RQCqy4UAWguHr7/wp4RcQRQSE0EuCN32jKKxEKcMaausy8Xppq6zLxemmrrMvF6aausy8Xppq6zLxemmrrMvF6aaus0NrFM8AAP7qcatRY/Jx5Yt2luTMzrLDa8Jd9+ecewQ7Km3UF+bhL1bTDnWCDSNQzMvpI8e0lWT8VwhRH9zj4UFQQ1yTsVVQUUpsCfhTjqJGsP5+0E7IrUrK5Ofw1M14tROUM/pT+M2s2vqbYUmUO6Ek84296rkzxHPgJbu6XvjI/Nh0SPERVvI0kYEl7fK7v0WVE0v/JNqsDAfC5NSvLq/Hafs8akgXqze/C0FC882Ctfr/HXj2sS8yi+t39FIJ/JC+b/Xf2IGjg/sD9iLa+rifPqMe38Nb9L6wFiRNldWHGmUQudNFE6b+1H3z9lxJhnGtHvrodY+mt1/gQ+Zajk8KVexaBC95CFqtvGnFhICzPWYw1Oy4TWUT74pmh6dWjKOmK3PvKQsUN2bErPM2mZ7Yy0NN7rT2T7xoYqqleQsWpihFv0HByZUuMCZk+T/JxqALW1bKwudb1KOBYJrzKMngJIwVdt9Gmqm0Zjv7ekR4LgyFK063jnJZWtPN+ExHqUZwPzNrEylPUGaKAq/Zwj9HrJqj+sPhw5PhORb20ESbzjuo882iavd55UrrD5e7YWmOYYORIZ7IsoTwEFBAxO/mxbiHExauXBiyy5cqgyOyDGv+2MW0c9YTpEEhz74UBg+oepn9XaD38txpMlsedxq9uJlgtz/oNkVL1gAPo1AvifExM5iSiO2DQFTmf4AAm1GxbsxZpzo634veM9A6mioK9Wyl2ghiOGryHhxzsMhPsVnyXMjX2bUvYxzHpX4ictn6PAL1eXSDus4NTwlwFh1kOaF5PbZ/xwDXdbid9ZaiR8usDIWmKP6mlEGNq+wiF4fICd937mDWM0bk9YgnRA3RMfEy/TUUJG24SYysdhbTCMIR86oq/Mdd43F9OeWQQ3RBvhtsA5YOFnwbuZ0tQwq41GyFGoAgQYNa5e2/y88bsIPAPYDc24sZeBkBNnZYGQbyi2nn5ubq3P9ereCtwH/hCSLhwrahE8mjgf8h7kRYucpLOOk4E6dFAdPcdqKiwsRK9+COboGkzEGRth0mUBF0+akIDvTtpLv2jDRxvO2X6xZUCZheDk72sjeFLqhx/6JMdC04sfkDMVGDQuZkNX9p3LP/1KP/O8orBh11/tX9DUJRKsGRaVuzD6BBQGb9gQZ610+JkTdUWriW0J2Pv9ylrXBOJ+/ZiW4nDPS8Srrqb7J0AasRbNiJmUUZ0x1mkDUO8QA0bun88SSugDskql9srr98e5kPZxrtlaAS3JPk4UarmImqqt2yJwWROWhMKf2UDSc3Lj28sIZuP8iR3vsNjdKjHgODUSIdUo7pZjQc+uv2UC8+5Lq0ABnhTOZrE6BxysMNmBEZ/WwsbLXjqlIXNge4+zAbailwHgHyL6mRLTj2yQJV0H8WLnmVTPii0sYBNDMGHNVWR8z5ad1lTrKnWVOsqdZU6yp1lTrKnWVOsqdZU6yp1lTrKnWVOsqdZU6yp1lTrKnWVOsqdZU6yp1lTrKnWVOsqdZU6yp1lTrKnhtjnn4u8yixlS8FPA4fXZw8aVtkJRiLhxt/4tvAeM6LM8c58XS1NZbZeW9UsQYJmXMWEodqd8d/HvbldxAt8MtOFzgDtL/1H4U1BJTLNS1JYqMOXTPsCUTmnDrzP6q9VOwWoAfPdOMqdpiuMg4xPhennSDTt8Y05RNU9XxvpPaBJGP2ffqmsLaAnCDg2h3f5TEV0tDHhSeDOKZQB/jLEomM3DTgQZWvmYrRD5cMdpLOgusboYiowuYmb36LzulvX2FspcQgycaBxMCeoBeJsaj6dXSWCt/nZTLFct5EOL/WinbysE535ByBFYZTANZB30h9BpuGasLPcSNzl5tWbW0fsC/a6NxgxHIXZ2vUnKOxNm1D4ecUZ7vg1+Nsxa+vJycH79tGhMrmLsZHQ+HnotEJVsJGgok41WobTMO6xclSzSoGxASCt+9iP543peLBHGe79V8/FtQVkWvpmj1iqTpiQcplzTJrORvnG7L+9HqhNUiro3fjARPHuTahj1dDjhbCg4HL4sp+PVMkEifMrZyU+jmbSUcRvyZu6AWQnx8oRk2F5MdmTOz/TBZoMZ6Q43XVyqswBgTWBxSkZ/7rLSlez1x2diWmMUNFJdeS4n7v04D5IQ2Yebf1gGN0HZQkTunT/UQ/YtAX6LTvMM/+4QqEOgNDGiJrZnfjQX3vWm5gB9Z/UomL6L3VkGTfesrGjRK282xCor0h4b2+bgsnp2sXu3Wy+UsWYY3+gBa8SgdENDjcsUH+4//+58aHkdbYrj9MpknjFucxHeEmxnJ6n3INlj0bmyyALo3fjiGV5MwATsaIsprNBqIyi1hGaM2v01pwBQJryGIjwbfqiDqrdE6p+0iRMQOz/DgH8y7BrNJh1Bk6C86vQ0pliis3x6DvMXVf9yvC+RrUTrXkWu7vQATXV5eXHj3RMdzjXn0rc5tRwBkQQ0p+uoE6T+4jtJAFB/4OAQke8vBgpDtzlxoqJG8RI61JHVOVX4QAHw69F1H/NTsUkg94ngPDuiLtnl42S11IH3SEYeUrPxNgGgA4a2t678vgDZJBQIkGSgrsT1EzetTFM5R0R5+QiQc1J1tq9hLdqp8qftxwOlRCNUsl7rkWcXFCG2uxLsFRRsw8CrDOEGLtPevarskbY0LKj6WxlxP1X2MITAezG7XcQdaS26Bv65QX898F6+KqZJVSYfoTrhmml50qpTEIYj5NWWo6EVFEmQVkS62dFPiE18nL+dnX9W6njK621aj7pFAPGt2mNKIdyFeDnFlabh0KiwtvjA6X/IXfyqzR58MzX93/+x9YMZbJbrnK0NbXFEPOeh78joOJYg1fx8NR5viAH/f4oXi/HYnfYQJz15jaIedqsPTYNTCj+RglRTIPB6huddkm19D8hL6Kd3rfKae89BlAY4XQM+7t1aCjJJWI4YCEhuHES5gmWbdmSxTexT1VHTiaQa6n7/YhQczHDzJRY0H4H2EDWjLVJ2pza5VZ/s0IIA+A8G1ldX+S5wDnIZxdJlzIEQReq0/7RZoT9B96go/Ts9U4g6XjzgUK5ZPBYaEOm2uE7mRjHh49z/d2RXKBSWABuXFllFIVcKhfp8wlX/TpF0ZW8TXBXJ92Jx6Kug7cz3slBrajj860iu693oJM32HCyBzJKyYM3ISPFvOceZ1LoOyFShbXjKyrhkuiPfRoz16SQ4Q3Hy/XQbCaN3fRQMMRJA41Ou8pd2NezU0kvNhkktzFJQW7NZQC1k2S4vept6g9/AotTgghYu34/HtmMIx7Sf/nuKHtvk+goqxQFBMXeyqJdGV6xbeYpFfzsgA0ydt5nIw+D3MO8vClT+8yBoWAWkKww7KfwWSfQao/cBVi/lvInf/juDjD+N3/iYD1jFySBtBjlMiNyFkdvVKGtCjgGc1XDD7eG8k1WCYb0abfzJ/AsrbzbMcoI/n0nmifGQ2Kd4kJXSK43e9uT+P19OXvN/AOxWH8BxyhfSiVzffbbZiwyx9SSvRuhWY5nU5KrCeDHEVX+L0ZbZAetlPbZIaVIy2BxlS7f1dn/tben8TFW3cX0CfO9M1f88r/aEGM1KmwkiIUAAAAAAAG54micFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABL+L2LFZE3tRPx+468f1uILEStxbo+b8co2zK1EGXnaL2jDOGf9ILrvxQR9USmIZPp4o2QYz5tvYd5ZY6yJcZc5qyGFYnJw3afcuxBAQqmKW6Ss+Eg5JPZkttR/zxOZ1fJ98vNyMTVlkvLVKQ8T6H4lB+/p+lDpmXZ95pRw2v5PtrORvMRF0CQ18OxkgaTKc8A23To9uAmzDXi+i0+OPpMmmlQE5tGmXC/U5wgcFmoyHHrSMvN3aMJ2O5YUosdvzXruGu4Ma4DiztPA0ngRTANhfEhk5aFbWFyOqV4ILR8T/cLz1+F7g3vSmN+F4JenR1BEwzCbabTlvQXPa2+KGwXPNWZXKWXE07Q8z3wnvV4WBy/aSp833n5o5bs1Tj6MGot82/iTPgfKhWE2fETyHeiRWiwh3gbztDaHtsoDUqBQMRMlenRI6VJy+Z3S+hEppPVjA4a39/KBtCjwwD1aoMT06/O3+gH8C1sVaUahBRBQIIP/H3jvah64BCQlW89y/Ta5i6dM1K891pe9NzFbU3iq6N7PlTPeiWk1CV+DW1yJqun/jPH+cwxdjZebXsfTDWIgvOQNX7nDPzIdc99b2roevUZDvTm5bNDJOaZZDt7odBd3D1Xu6Quipkh6svEaTdNiIAt5XsAUrTtIAu55I4RVLAtMWIWtbGia0CFhyR9yMLqjevtrtI0pVDx63alkHDCe13/vreHBmngxPVR7WtTxa7Eje4AAAC8hGK/470Ih8NqcpBt8uyREYF/E3g0+Cz/gw7aVRHznq7CYSptB8PDY7+q4Ba1fhdYYn5p+OOhkQU4ZiQZoNd6ZdhdaxRaTeMajvA3TXkp34XTc3qYOrdiOqE2jM2PfMY5n/XFBzQBqOKlIGFEwQlrUZdRkF5P4v3I/U0h6JuT1hZ40zDXPiNTK8CoIyAIrDfQFXETmYkB7DQuKIssLEAJ08eAKQIkP0bsb8Rb9Nnp68X29K/The9kbLWtw4KwuJ6vHMVEoYLvSmoX4P1Sidv81P+54iqVK8nQHadivxzsg9F09KphDoP2YdCyLR07I1qJbm7JfqNm6ubGfNBOEFQ95wl4liKsgbktWgaFiBkZHGtuoELMPC9LqlzTfjScSs9zk0akH+HhfMHeiiAYl1ebrxn9OUIlLt9G9xnhbWnXy596I+7CgINGoT8t7qE6K/LK38oGdCFmGBoMssVuk4Wo9iRAaRo/tVF/86/obRwMvob8gwgr+j6d+CTR4vrp5vzJALU3LcPa53Y/bDToQEO7PHbakjGhyXmBiDOG1l6snQ9th5kUs6WMlHFq89N3mLKT+21e8Q+pCXdwAAADEsRZxPOY4Lj6niob8rm9P+TMQihXKqS3XyK5Mc/rwD7Q1MaGU8NzDEpNWbCdpKdadCSFX6/X6/X6JSsBV/XfW5Vp99DCHsezMYqaUPajuYqnSgAAAez15LmiUX9P/tu5VUOdPxmBPnr+MCHW0FcIv+aW1LMtFsxGbae2hVLB1YR/2vPU9banEWk9IqV1Kx6RUBDQAZe7IWY4oRrXisH3IinM5Cg8H+XSMuLqIelMPRCISwN2EilH4c4GW5H9M5iTxAaZp8IoSvYHxVUDduUDcHKEjN0Y1O/0I4pZP3xGgw1jxnjvZLuOArMbmW8+SXeeKRMgIW90CTE8bBiRUFUwimCvesijMCiXKEDOswj6iJm/sYxzaNNEUKpTZdor1NdgAAAcFV6oQMBtQgAAAABRUBSfH4qnUmz7/KzI5obE9c66dPAEIbPQzGhcaozhi7JvQamBMhxyLtQAiILbsJjLKJr3KkfgCX3z+P2iZbo4l9RxaaIbmdn7KOLTRDczs/ZRxaaGmItJ70nO07ec7P2UcaMJJVRlVrh/jJzFLRSRBF7GGXpgYjBTyDcYiMSAAAA9OREgGQ05/0MiWLw+ELQvza37ngDbI6wBvqCIvZWZIkGec2AyDKVAYwHJeAmjnQSz1JFnu1OwwHLXCUWVtcYiAyCHpJG/sGhBsLyMQ9QFGPDvdYYEEQwyn/vKdce0sjnhHhlaxwgOiBXFNz7VL9wN9JVzjkvixsjw6vlBVmN/4d5BtWs3//rqazDn9TfydOXKFfokl0r4/AAAvzDigAAAAAAAAFsANmOTj56I4wokgFctAmWfEUUvX4l3lrciZOC3SCAn/IsJYakn7MG1D8lc1/g3z174Ob4NVdms55mvEKTgbRPJx4TjwnHhOPCceE5BdqOJdZBQn4tvuRskH99LAHjSw8X/o3nnvy3yI1MfkNlKwAAABPi31vogfWmawDgVPnm5EAVIN8h4ca16cRS6bBPZI3d0ffTidNcQb/uE3E4NpUG9xYCM2rEiBV5coH5kCrUQKBPhI5dpXNKjuJCC1fiEvOZl//Uel0RY7Gg/GFs3K/M5yQ0fn7+5Q1G/UCXf38fQhTLjEiO12bkKGPPw9UqEhuZHB9SqhQ2vrTeJ6BCQ0u6+TUFMNZRVn+Oo/rNy7GBt8oT4vFgLHewAI8aTFMHJmdvZxkB44/GRlI8D3i4ScahdjTOgLDIQrJ3pjlJMpE5Nr4kp+uzTLwbX2XVoPYjQxFm5pCOYwX/Iod+dGOIr2/H5F1mnxpjrcvybfUO9lldN1krgmNRV74D9Vg0UtZAFII+dizkoOB6AAAA4u6BlEF3c9+cGXrGXERW1Hr/l+Y1UHFMOJ+7AIyPYc/3un/Kxcw73tfv41lXGfbtu67u2QkxUIpPgf9Uv6Y+Ksffp08xidQD1dDr4yDYL9r0p/vt0D5a5ADBQ5NzO58LD5FoIy5XkWmh9se8yCKxzQ/EzID3pvBY4PcNBvFZtnE3CWrrU8y4L7DKMbUP2s0wTR3TWVW83jydT4UiGkXb8igEU0kS3sFzLmQ9SxIbQF9wcAAAEzbcbuMmASFJ/pnpfyxlcLXOsR9P/Sc+Aj/zVtAqdbv6klE9Igbcex+t2/kqSX3bLbkro2aWZRM4FG4sseIR3n+t1KBVNBfl3L/2gAAAAAAAAAAAAAAAAAAAAAAAAAbd7VOt3jzAEOkgAAAA+Xnixvj98rRAksXxGx8zbo1jbya5959gyVM8/q7g2Dm26pdpNPSjNtK38KOM0e2HImULI2MGjCKeVUr/qEBh80SQtlaxGh93P+EjlIPK048skRo1cWxGAPOSoCFhfwRe82HLw9aYeVrQkIdrYNZULRt7mcJfk2V4MZElUXtFx9CBys0rhGHdboZDrs6MII+ETw7YfcQ+kY1mEkBYwDUarUdByba5jHMbYn0gKEdSojl+Xb6rnjoEdjWc7oLQrdDvRDhxYG0s3l1w/auATUU9Wwx0y7LDf6CWc+O6C0yhFIoFPqAvacDOZbdTCjkUUP9h2roebXsdmq4QL168b3gpEGzPg/pC2aT5sqlPcEEUeMLd74Rf29rrLSwwhfLxES8QvI2ggKcOFig6P/LRw0y7IOaSbKCNkVgFUnmLqDe7O/ZME1PNA0P/WIQcGZTuD61MTT+iw5zxp/1GWiLf8sQgugjkY/dMAIm9LyeXPSGZT8bbYx63XE0DRPOlADM3dfRBs6MasSpwzNs2RYPdJAj07Nqoyt0nwd57uKgt5gfsuefwnwnaEjXNZPgCzihT8LG00/B1bGrAq/PcGui3Jma4My4nRqkKBNWTOqOOiaJs3cZVVGE0ahOJ42wFTJuStdZmneWNqGgRIiXpvOIPHchPCM4+cdAzDSevHzyEQEV+doOY6SYUzJCCFjALw9xcXmKevpQUAkPb2HAccRK/XrNMPT7nFr5MPRwTdqCmh99pi/0vtCaNACmymYayE7tdKUyX1qsr8aR0atBzkMKW0lLQ73A6740GwtQKLoLJgGtRlWkR4G7EtPGepnNbFYoC72nLTGqQ1doJszO1t3nq1IG6FJ3WPfT5WBa/bQM+MiRC34XIC6nJnSsO0kPVZheVl2xWHMqav52XsfY0rqngl4AAADyMgTGVRdqY0WSkV1GK94pl9URD/0j7deY70En6oSSrdcNs5o8nS9eAx39Vv7SJk/10cKr8jKATsWfRVF5Bc0L5/35drI3GDMH6hA7LEPUizF3H6RI7g+Ca7/5rBA12JrfjkKaGxI9CAnCHGdq/NxkOkoP8svf/YgpcHXGd28Q/LeUYWcio0TfrY6ZfTSAUGwgI9yIOESiRrsYyreY4E4GRTWNefdJEtP3aAn3XvjpkhGitTMM6HNcMD6P6vCS8/RqqHizJ5mYqdpC7vJ1WDHIchOgOCtDM0IP4Bf6bkzN8zV6Lou2uL5y2sOTbS16O52jRJ3Lb/gXrWhF6Sat5JEBzN5jwMsx8cSEUT7n6WhoSIqKGrfxHvWJ2piKhKsTn7Om+Psd7x2dAPRO8ql4AryPX4EeJBAXyJdR0xOikpGNYuV+KUy1h6U3bqZ7y444AiH6ISvoO79XiUMsDnty6BOWPKf7Lk5UTqxYygWWk2UWsSu/Bmg30Vkrj2COscAAAAAAAAAA" width="1512" height="450"></p>
<h4 id="4-重定向至第2步指定的redirect_uri地址">4. 重定向至第2步指定的redirect_uri地址</h4>
<p><img alt="img" src="/light-docusaurus/assets/images/3-19-5cf78c28d79145bfdab96b0d24c47e27.awebp" width="1512" height="251"></p>
<h4 id="5-使用postman模拟客户端发起请求获取token">5. 使用Postman模拟客户端发起请求获取token</h4>
<p><img alt="img" src="/light-docusaurus/assets/images/3-20-160df56fd1b879aefce6f940bff78b9d.awebp" width="1495" height="669"></p>
<p>参数解释</p>
<ul>
<li><code>grant_type</code>: 跟授权码一样，固定为<code>authorization_code</code></li>
<li><code>client_id</code>：客户端id</li>
<li><code>redirect_uri</code>：第2步中的回调地址</li>
<li><code>code_verifier</code>：第1步中生成的<code>code_verifier </code></li>
<li><code>code</code>：授权接口重定向至回调地址时携带的参数<code>code</code></li>
</ul>
<h2 id="四总结">四、总结</h2>
<p>至此oauth2.1的所有流程基本都测试了一遍，设备码因为需要在原有基础上进行扩展，也留到下一章的扩展篇一块儿测试，在以后的文章会有设备码流程、登录添加图形验证码、自定义<code>token</code>生成和解析、自定义响应体和去除权限前缀等内容。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/lorchr/light-docusaurus/tree/main/docs/zh-cn/spring-authorization-server/3-SAS-Spring-Boot-Authorization-Server-Addition.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Spring-Boot-Authorization-Server/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">SAS-Spring-Boot-Authorization-Server</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Device-Authorization/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">SAS-Device-Authorization</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一spring-boot-与spring-authorization-server集成流程说明" class="table-of-contents__link toc-highlight">一、Spring boot 与Spring authorization Server集成流程说明</a></li><li><a href="#二细节补充" class="table-of-contents__link toc-highlight">二、细节补充</a><ul><li><a href="#1-enablewebsecurity" class="table-of-contents__link toc-highlight">1. <code>@EnableWebSecurity</code></a></li><li><a href="#2-enablemethodsecurity-官网文档说明" class="table-of-contents__link toc-highlight">2. <code>@EnableMethodSecurity</code> 官网文档说明</a></li><li><a href="#3-configuration-文档说明地址" class="table-of-contents__link toc-highlight">3. <code>@Configuration</code> 文档说明地址</a></li></ul></li><li><a href="#三测试" class="table-of-contents__link toc-highlight">三、测试</a><ul><li><a href="#1-授权码模式获取token" class="table-of-contents__link toc-highlight">1. 授权码模式获取token</a></li><li><a href="#2-刷新token" class="table-of-contents__link toc-highlight">2. 刷新token</a></li><li><a href="#3-客户端模式" class="table-of-contents__link toc-highlight">3. 客户端模式</a></li><li><a href="#4-授权码扩展流程pkceproof-key-for-code-exchange" class="table-of-contents__link toc-highlight">4. 授权码扩展流程PKCE(Proof Key for Code Exchange)</a></li></ul></li><li><a href="#四总结" class="table-of-contents__link toc-highlight">四、总结</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/docs/category/guide/">Torch</a></li><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/middleware/">Middleware</a></li><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/electron/">Electron</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/diy/">DIY</a></li><li class="footer__item"><a href="https://github.com/lorchr/light-docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Offical</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Home<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docusaurus.io/docs/playground" target="_blank" rel="noopener noreferrer" class="footer__link-item">Playground<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Light-Docusaurus, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>