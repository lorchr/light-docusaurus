<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-zh-cn/linux/Generate-CA-and-server-cert-With-OpenSSL" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Generate-CA-and-server-cert-With-OpenSSL | Light Docusaurus</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://lorchr.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://lorchr.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://lorchr.github.io/docs/zh-cn/linux/Generate-CA-and-server-cert-With-OpenSSL/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Generate-CA-and-server-cert-With-OpenSSL | Light Docusaurus"><meta data-rh="true" name="description" content="基于openssl工具完成自建CA以及为server,client颁发证书"><meta data-rh="true" property="og:description" content="基于openssl工具完成自建CA以及为server,client颁发证书"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://lorchr.github.io/docs/zh-cn/linux/Generate-CA-and-server-cert-With-OpenSSL/"><link data-rh="true" rel="alternate" href="https://lorchr.github.io/docs/zh-cn/linux/Generate-CA-and-server-cert-With-OpenSSL/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://lorchr.github.io/docs/zh-cn/linux/Generate-CA-and-server-cert-With-OpenSSL/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://TLGHDZ3Y2I-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Light Docusaurus RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Light Docusaurus Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Light Docusaurus" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.e8086d6f.css">
<script src="/assets/js/runtime~main.2519630d.js" defer="defer"></script>
<script src="/assets/js/main.a410c441.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Torch Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Torch Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Torch</b></a><a class="navbar__item navbar__link" href="/docs/category/guide/">Torch</a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/middleware/">Middleware</a><a class="navbar__item navbar__link" href="/electron/">Electron</a><a class="navbar__item navbar__link" href="/postman/">Postman</a><a class="navbar__item navbar__link" href="/diy/">DIY</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/docs/zh-cn/linux/Generate-CA-and-server-cert-With-OpenSSL/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li></ul></div><a href="https://github.com/lorchr/light-docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><p><a href="https://blog.csdn.net/weixin_42700740/article/details/117527769" target="_blank" rel="noopener noreferrer">基于openssl工具完成自建CA以及为server,client颁发证书</a></p>
<header><h1>基于openssl工具完成自建CA以及为server,client颁发证书</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="一openssl简介"><strong>一.openssl简介</strong><a href="#一openssl简介" class="hash-link" aria-label="一openssl简介的直接链接" title="一openssl简介的直接链接">​</a></h2>
<p>  openssl 是目前最流行的 SSL <strong>密码库工具</strong>，其提供了一个通用、健壮、功能完备的工具套件，用以支持SSL/TLS 协议的实现。\n官网：<a href="https://www.openssl.org/source/" target="_blank" rel="noopener noreferrer">openssl官网</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-主要构成部分"><strong>1.1 主要构成部分</strong><a href="#11-主要构成部分" class="hash-link" aria-label="11-主要构成部分的直接链接" title="11-主要构成部分的直接链接">​</a></h3>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">1.</span><span class="token method function property-access" style="color:#d73a49">密码算法库</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">对称加密、非对称加密、</span><span class="token constant" style="color:#36acaa">HASH</span><span class="token plain">运算等</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2.</span><span class="token method function property-access" style="color:#d73a49">密钥和证书封装管理功能</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">证书申请、颁发、撤销</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3.</span><span class="token constant" style="color:#36acaa">SSL</span><span class="token plain">通信</span><span class="token constant" style="color:#36acaa">API</span><span class="token function" style="color:#d73a49">接口</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">https通信</span><span class="token constant" style="color:#36acaa">SSL</span><span class="token plain">接口</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-openssl用途"><strong>1.2 openssl用途</strong><a href="#12-openssl用途" class="hash-link" aria-label="12-openssl用途的直接链接" title="12-openssl用途的直接链接">​</a></h3>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">1.</span><span class="token plain">建立 </span><span class="token constant" style="color:#36acaa">RSA</span><span class="token plain">、</span><span class="token constant" style="color:#36acaa">DH</span><span class="token plain">、</span><span class="token constant" style="color:#36acaa">DSA</span><span class="token plain"> key 参数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2.</span><span class="token plain">建立 </span><span class="token constant" style="color:#36acaa">X</span><span class="token number" style="color:#36acaa">.509</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">证书、证书签名请求</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">CSR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token function" style="color:#d73a49">和CRLs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">证书撤销列表</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3.</span><span class="token plain">计算消息摘要</span><span class="token constant" style="color:#36acaa">HASH</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4.</span><span class="token plain">使用各种 </span><span class="token maybe-class-name">Cipher加密</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">解密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5.</span><span class="token constant" style="color:#36acaa">SSL</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">TLS</span><span class="token plain"> 客户端以及服务器的测试</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">6.</span><span class="token plain">处理</span><span class="token constant" style="color:#36acaa">S</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">MIME</span><span class="token plain"> 或者加密邮件</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-证书密钥csr请求文件crl列表-查看命令"><strong>1.3 证书、密钥、CSR请求文件、CRL列表 查看命令</strong><a href="#13-证书密钥csr请求文件crl列表-查看命令" class="hash-link" aria-label="13-证书密钥csr请求文件crl列表-查看命令的直接链接" title="13-证书密钥csr请求文件crl列表-查看命令的直接链接">​</a></h3>
<p>证书查看：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crt</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">noout </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">text</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>私钥查看：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">text </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>公钥查看：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">pubin </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> pcapubkey</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">text </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">noout</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>CSR查看：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">text </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">csr</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">noout</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>CRL列表查看：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl crl </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> testca</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crl</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">text </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">noout</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="二rsa密钥操作"><strong>二.RSA密钥操作</strong><a href="#二rsa密钥操作" class="hash-link" aria-label="二rsa密钥操作的直接链接" title="二rsa密钥操作的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21密钥生成"><strong>2.1密钥生成</strong><a href="#21密钥生成" class="hash-link" aria-label="21密钥生成的直接链接" title="21密钥生成的直接链接">​</a></h3>
<p>默认情况下，openssl 输出格式为 PKCS#1-PEM\n生成RSA私钥(无加密)：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out rsa_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2048</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>生成RSA公钥：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> rsa_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">pubout </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out rsa_public</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>生成RSA私钥(使用aes256加密)：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">aes256 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">passout pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">123456</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out rsa_aes_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2048</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其中 passout 代替shell 进行密码输入，否则会提示输入密码；\n生成加密后的内容如：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">BEGIN</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">RSA</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">PRIVATE</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">KEY</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Proc</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">ENCRYPTED</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">DEK</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Info</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">AES</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">256</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">CBC</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">5584D000DDDD53DD5B12AE935F05A007</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Base64</span><span class="token plain"> </span><span class="token maybe-class-name">Encoded</span><span class="token plain"> </span><span class="token maybe-class-name">Data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">END</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">RSA</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">PRIVATE</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">KEY</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此时若生成公钥，需要提供密码</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> rsa_aes_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">passin pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">pubout </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out rsa_public</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其中 passin 代替shell 进行密码输入，否则会提示输入密码；</p>
<p>将需要输入密码使用的.key私钥文件转成不需要输入密码的.key文件（其实就是使用passin将密码提前输入了）：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">passin pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">222222</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>从证书中提取私钥：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> rca</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cer</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">pubkey </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">noout </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> rcapubkey</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-转换命令"><strong>2.2 转换命令</strong><a href="#22-转换命令" class="hash-link" aria-label="22-转换命令的直接链接" title="22-转换命令的直接链接">​</a></h3>
<p>私钥转非加密：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> rsa_aes_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">passin pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out rsa_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>私钥转加密：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> rsa_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">aes256 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">passout pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out rsa_aes_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>私钥PEM转DER：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> rsa_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">outform der</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out rsa_aes_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">der</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>-inform和-outform 参数制定输入输出格式，由der转pem格式同理。</p>
<p>pem转crt格式：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> fullchain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out fullchain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>pem转key格式：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> privkey</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out privkey</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看私钥明细（使用-pubin参数可查看公钥明细）：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> rsa_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">noout </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">text</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>私钥PKCS#1转PKCS#8</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl pkcs8 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">topk8 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> rsa_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">passout pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out pkcs8_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其中-passout指定了密码，输出的pkcs8格式密钥为加密形式，pkcs8默认采用des3 加密算法，内容如下：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">BEGIN</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ENCRYPTED</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">PRIVATE</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">KEY</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Base64</span><span class="token plain"> </span><span class="token maybe-class-name">Encoded</span><span class="token plain"> </span><span class="token maybe-class-name">Data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">END</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ENCRYPTED</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">PRIVATE</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">KEY</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用-nocrypt参数可以输出无加密的pkcs8密钥，如下：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">BEGIN</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">PRIVATE</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">KEY</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Base64</span><span class="token plain"> </span><span class="token maybe-class-name">Encoded</span><span class="token plain"> </span><span class="token maybe-class-name">Data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">END</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">PRIVATE</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">KEY</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-使用公私钥进行密码学运算"><strong>2.3 使用公私钥进行密码学运算</strong><a href="#23-使用公私钥进行密码学运算" class="hash-link" aria-label="23-使用公私钥进行密码学运算的直接链接" title="23-使用公私钥进行密码学运算的直接链接">​</a></h3>
<p>1.私钥的生成</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl genras </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out </span><span class="token keyword" style="color:#00009f">private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2048</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>2.使用私钥生成公钥</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsa </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token keyword" style="color:#00009f">private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">pubout </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out </span><span class="token keyword" style="color:#00009f">public</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>3.使用公钥对文件进行加密</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsautl </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">encrypt </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">txt</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">inkey </span><span class="token keyword" style="color:#00009f">public</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">pubin </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">en</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪 贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>4.使用私钥对加密文件进行解密</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl rsautl </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">decrypt </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">en</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">inkey </span><span class="token keyword" style="color:#00009f">private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>5.使用私钥对文件进行签名</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl dgst </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">sign </span><span class="token keyword" style="color:#00009f">private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">md5 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">sign</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>6.使用公钥对签名后的文件进行验签</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl dgst </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">verify </span><span class="token keyword" style="color:#00009f">public</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">md5 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">signature message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">sign</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>7.摘要算法</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl dgst </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">sha1 file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">txt</span><span class="token plain">		</span><span class="token comment" style="color:#999988;font-style:italic">//只计算摘要，不导出文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl sha1 file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">txt</span><span class="token plain">			</span><span class="token comment" style="color:#999988;font-style:italic">//只计算摘要，不导出文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl sha1 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out digest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">txt</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">txt</span><span class="token plain">	</span><span class="token comment" style="color:#999988;font-style:italic">//导 出文件</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="三生成自签名证书"><strong>三.生成自签名证书</strong><a href="#三生成自签名证书" class="hash-link" aria-label="三生成自签名证书的直接链接" title="三生成自签名证书的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-生成-rsa-私钥和自签名证书"><strong>3.1 生成 RSA 私钥和自签名证书</strong><a href="#31-生成-rsa-私钥和自签名证书" class="hash-link" aria-label="31-生成-rsa-私钥和自签名证书的直接链接" title="31-生成-rsa-私钥和自签名证书的直接链接">​</a></h3>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">newkey rsa</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">nodes </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">keyout rsa_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">x509 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">days </span><span class="token number" style="color:#36acaa">365</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>  其中req是证书请求的子命令，-newkey rsa:2048 -keyout private_key.pem 表示生成私钥(PKCS8格式)，-nodes 表示私钥不加密，若不带参数将提示输入密码；-x509表示输出证书，-days365 为有效期，此后根据提示输入证书拥有者信息；\n若执行自动输入，可使用-subj选项：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">newkey rsa</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">nodes </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">keyout rsa_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">x509 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">days </span><span class="token number" style="color:#36acaa">365</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crt</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">subj </span><span class="token string" style="color:#e3116c">&quot;/C=CN/ST=GD/L=SZ/O=vihoo/OU=dev/CN=vivo.com/emailAddress=yy@vivo.com&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-使用-已有rsa-私钥生成自签名证书"><strong>3.2 使用 已有RSA 私钥生成自签名证书</strong><a href="#32-使用-已有rsa-私钥生成自签名证书" class="hash-link" aria-label="32-使用-已有rsa-私钥生成自签名证书的直接链接" title="32-使用-已有rsa-私钥生成自签名证书的直接链接">​</a></h3>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">x509 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">days </span><span class="token number" style="color:#36acaa">365</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">key rsa_private</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label=" 复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>-new 指生成证书请求，加上-x509 表示直接输出证书，-key 指定私钥文件，其余选项与上述命令相同。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="四生成签名请求及ca-签名"><strong>四.生成签名请求及CA 签名</strong><a href="#四生成签名请求及ca-签名" class="hash-link" aria-label="四生成签名请求及ca-签名的直接链接" title="四生成签名请求及ca-签名的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-使用-rsa私钥生成-csr-签名请求"><strong>4.1 使用 RSA私钥生成 CSR 签名请求</strong><a href="#41-使用-rsa私钥生成-csr-签名请求" class="hash-link" aria-label="41-使用-rsa私钥生成-csr-签名请求的直接链接" title="41-使用-rsa私钥生成-csr-签名请求的直接链接">​</a></h3>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">aes256 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">passout pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">key server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">csr</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此后输入密码、server证书信息完成，也可以命令行指定各类参数</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">key server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">passin pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">csr</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">subj </span><span class="token string" style="color:#e3116c">&quot;/C=CN/ST=GD/L=SZ/O=vihoo/OU=dev/CN=vivo.com/emailAddress=yy@vivo.com&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>*** 此时生成的 csr签名请求文件可提交至 CA进行签发 ***</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-查看csr-的细节"><strong>4.2 查看CSR 的细节</strong><a href="#42-查看csr-的细节" class="hash-link" aria-label="42-查看csr-的细节的直接链接" title="42-查看csr-的细节的直接链接">​</a></h3>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">csr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">BEGIN</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">CERTIFICATE</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">REQUEST</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Base64EncodedData</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">END</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">CERTIFICATE</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">REQUEST</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">noout </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">text </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">csr</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-使用-ca-证书及ca密钥-对请求签发证书进行签发生成-x509证书"><strong>4.3 使用 CA 证书及CA密钥 对请求签发证书进行签发，生成 x509证书</strong><a href="#43-使用-ca-证书及ca密钥-对请求签发证书进行签发生成-x509证书" class="hash-link" aria-label="43-使用-ca-证书及ca密钥-对请求签发证书进行签发生成-x509证书的直接链接" title="43-使用-ca-证书及ca密钥-对请求签发证书进行签发生成-x509证书的直接链接">​</a></h3>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">req </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">days </span><span class="token number" style="color:#36acaa">3650</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">csr</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">CA</span><span class="token plain"> ca</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crt</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">CAkey</span><span class="token plain"> ca</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">passin pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">CAcreateserial</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其中 CAxxx 选项用于指定CA 参数输入</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="五证书查看及转换"><strong>五.证书查看及转换</strong><a href="#五证书查看及转换" class="hash-link" aria-label="五证书查看及转换的直接链接" title="五证书查看及转换的直接链接">​</a></h2>
<p>查看证书细节：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crt</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">noout </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">text</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>转换证书编码格式：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cer</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">inform </span><span class="token constant" style="color:#36acaa">DER</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">outform </span><span class="token constant" style="color:#36acaa">PEM</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>合成 pkcs#12 证书(含私钥)</p>
<p>将 pem 证书和私钥转 pkcs#12 证书 ：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl pkcs12 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crt</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">inkey server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">passin pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">password pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">p12</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其中-export指导出pkcs#12 证书，-inkey 指定了私钥文件，-passin 为私钥(文件)密码(nodes为无加密)，-password 指定 p12文件的密码(导入导出)。</p>
<p>将 pem 证书和私钥/CA 证书 合成pkcs#12 证书：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl pkcs12 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crt</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">inkey server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">passin pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain">chain </span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">CAfile</span><span class="token plain"> ca</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crt</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">password pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out server</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">all</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">p12</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其中-chain指示同时添加证书链，-CAfile 指定了CA证书，导出的p12文件将包含多个证书。(其他选项：-name可用于指定server证书别名；-caname用于指定ca证书别名)</p>
<p>pcks#12 提取PEM文件(含私钥) ：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl pkcs12 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">p12</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">password pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">passout pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out out</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其中-password 指定 p12文件的密码(导入导出)，-passout指输出私钥的加密密码(nodes为无加密)。</p>
<p>导出的文件为pem格式，同时包含证书和私钥(pkcs#8)：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token maybe-class-name">Bag</span><span class="token plain"> </span><span class="token maybe-class-name">Attributes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">localKeyID</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">DD</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">46</span><span class="token plain"> 3D 1E </span><span class="token number" style="color:#36acaa">91</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">EF</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">01</span><span class="token plain"> 3B 2E 4A </span><span class="token number" style="color:#36acaa">75</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">81</span><span class="token plain"> 4F </span><span class="token number" style="color:#36acaa">11</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">A6</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">E7</span><span class="token plain"> 	1F </span><span class="token number" style="color:#36acaa">79</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subject</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">C</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">CN</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">ST</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">GD</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">L</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">SZ</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">O</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">vihoo</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">OU</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dev</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">CN</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">vihoo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">emailAddress</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">yy@vihoo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">issuer</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">C</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">CN</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">ST</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">GD</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">L</span><span class="token operator" style="color:#393A34">=</span><span class="token constant" style="color:#36acaa">SZ</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">O</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">viroot</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">OU</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dev</span><span class="token operator" style="color:#393A34">/</span><span class="token constant" style="color:#36acaa">CN</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">viroot</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">emailAddress</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">yy@viroot</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">BEGIN</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">CERTIFICATE</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">MIIDazCCAlMCCQCIOlA9</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">dcfEjANBgkqhkiG9w0BAQUFADB5MQswCQYDVQQGEwJD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1LpQCA</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">2B6dn4scZwaCD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">END</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">CERTIFICATE</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Bag</span><span class="token plain"> </span><span class="token maybe-class-name">Attributes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">localKeyID</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">DD</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">46</span><span class="token plain"> 3D 1E </span><span class="token number" style="color:#36acaa">91</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">EF</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">01</span><span class="token plain"> 3B 2E 4A </span><span class="token number" style="color:#36acaa">75</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">81</span><span class="token plain"> 4F </span><span class="token number" style="color:#36acaa">11</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">A6</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">E7</span><span class="token plain"> 1F </span><span class="token number" style="color:#36acaa">79</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Key</span><span class="token plain"> </span><span class="token maybe-class-name">Attributes</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">No</span><span class="token plain"> </span><span class="token maybe-class-name">Attributes</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">BEGIN</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ENCRYPTED</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">PRIVATE</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">KEY</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQDC</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">6rAc1YaPRNf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">K9ZLHbyBTKVaxehjxzJHHw</span><span class="token operator" style="color:#393A34">==</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">END</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ENCRYPTED</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">PRIVATE</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">KEY</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">--</span><span class="token operator" style="color:#393A34">-</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>仅提取私钥：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> openssl pkcs12 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">p12</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">password pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">passout pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">nocerts </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out out</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p> 仅提取证书(所有证书)：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> openssl pkcs12 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">p12</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">password pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">nokeys </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out out</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>仅提取ca证书：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl pkcs12 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> server</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">all</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">p12</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">password pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">nokeys </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">cacerts </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out out</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">cacert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>仅提取server证书：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl pkcs12 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> server</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">all</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">p12</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">password pass</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">111111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">nokeys </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">clcerts </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out out</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="六基于openssl自建ca同时为serverclient颁发证书"><strong>六.基于OPENSSL自建CA，同时为server,client颁发证书</strong><a href="#六基于openssl自建ca同时为serverclient颁发证书" class="hash-link" aria-label="六基于openssl自建ca同时为serverclient颁发证书的直接链接" title="六基于openssl自建ca同时为serverclient颁发证书的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-自建ca"><strong>6.1 自建CA</strong><a href="#61-自建ca" class="hash-link" aria-label="61-自建ca的直接链接" title="61-自建ca的直接链接">​</a></h3>
<p>  在进行https通信时需要做双向认证，我们可以利用自己建立的测试CA来为服务器端颁发服务器数字证书，为客户端（浏览器）生成文件形式的数字证书（可以同时利用openssl生成客户端私钥）。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="611-1-创建ca需要用到的目录和文件"><strong>6.1.1 1 创建CA需要用到的目录和文件</strong><a href="#611-1-创建ca需要用到的目录和文件" class="hash-link" aria-label="611-1-创建ca需要用到的目录和文件的直接链接" title="611-1-创建ca需要用到的目录和文件的直接链接">​</a></h4>
<p>随便找个目录比如/home，在该目录下创建自建CA所需要用的文件夹：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir testca</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd testca</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir newcerts </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> conf    </span><span class="token comment" style="color:#999988;font-style:italic">//创建证书、私钥、配置文件夹备用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod g</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">rwx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">o</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">rwx </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">//设置private文件夹的操作权限，为group和other均可读写、执行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo </span><span class="token string" style="color:#e3116c">&quot;01&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> serial             </span><span class="token comment" style="color:#999988;font-style:italic">//用于存放下一个证书的序列号</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">touch index</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">txt</span><span class="token plain">					</span><span class="token comment" style="color:#999988;font-style:italic">//用于存放证书信息数据库</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir newcerts </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> conf    </span><span class="token comment" style="color:#999988;font-style:italic">//创建证书、私钥、配置文件夹备用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod g</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">rwx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">o</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">rwx </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain">  	 </span><span class="token comment" style="color:#999988;font-style:italic">//设置private文件夹的操作权限，为group和other均可读写、执行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo </span><span class="token string" style="color:#e3116c">&quot;01&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> serial            	 </span><span class="token comment" style="color:#999988;font-style:italic">//用于存放下一个证书的序列号</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">touch index</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">txt</span><span class="token plain">					</span><span class="token comment" style="color:#999988;font-style:italic">//用于 存放证书信息数据库</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>说明：\n  testca为待建CA的主目录。其中newcerts子目录将存放CA签署（颁发）过的数字证书（证书备份目录）。而private目录用于存放CA的<strong>私钥</strong>。目录conf只是用于存放一些简化参数用的<strong>配置文件</strong>。\n  文件serial和index.txt分别用于存放下一个证书的序列号和证书信息数据库。当然，偷懒起见，可以只用按照本文操作即可，不一定需要关心各个目录和文件的作用。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="612-生成ca的私钥和自签名证书即根证书自建ca需要生成私钥和ca证书"><strong>6.1.2 生成CA的私钥和自签名证书（即根证书,自建CA需要生成私钥和CA证书）</strong><a href="#612-生成ca的私钥和自签名证书即根证书自建ca需要生成私钥和ca证书" class="hash-link" aria-label="612-生成ca的私钥和自签名证书即根证书自建ca需要生成私钥和ca证书的直接链接" title="612-生成ca的私钥和自签名证书即根证书自建ca需要生成私钥和ca证书的直接链接">​</a></h4>
<p>创建文件：（在conf文件夹下：）\ngedit gentestca.conf\n文件内容如下：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">####################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> req </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_keyfile </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">home</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">testca</span><span class="token operator" style="color:#393A34">/</span><span class="token keyword" style="color:#00009f">private</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">cakey</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain">		#需要修改为自己的实际路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_md </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> md5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prompt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">distinguished_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ca_distinguished_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x509_extensions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ca_extensions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> ca_distinguished_name </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">organizationName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">TestOrg</span><span class="token plain">          				 #可以自定义</span><span class="token constant" style="color:#36acaa">CA</span><span class="token plain">的信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">organizationalUnitName  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">TestDepartment</span><span class="token plain">  		 #可以自定义</span><span class="token constant" style="color:#36acaa">CA</span><span class="token plain">的信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">commonName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">TestCA</span><span class="token plain">								#可以自定义</span><span class="token constant" style="color:#36acaa">CA</span><span class="token plain">的信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">emailAddress </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ca_admin@testorg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token plain">   			#可以自定义</span><span class="token constant" style="color:#36acaa">CA</span><span class="token plain">的信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> ca_extensions </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basicConstraints </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">CA</span><span class="token operator" style="color:#393A34">:</span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">########################################</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png" alt="" class="img_ev3q"></p>
<p>进入testca目录下然后执行命令如下（生成X509的CA证书）：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">x509 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">newkey rsa</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out cacert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">outform </span><span class="token constant" style="color:#36acaa">PEM</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">days </span><span class="token number" style="color:#36acaa">2190</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">config </span><span class="token string" style="color:#e3116c">&quot;/home/testca/conf/gentestca.conf&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>执行过程中需要输入CA私钥的保护密码，假设我们输入密码：123456。\n简单解释：CA使用自己的私钥cakey.pem（在gentestca.conf文件中指定）按照gentestca.conf文件中的规则自签名生成证书。</p>
<p>可以用如下命令查看一下CA自己证书的内容：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> cacert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">text </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">noout</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="613-创建一个配置文件以便后续ca日常操作中使用为其他请求签发证书时的配置"><strong>6.1.3 创建一个配置文件，以便后续CA日常操作中使用（为其他请求签发证书时的配置）：</strong><a href="#613-创建一个配置文件以便后续ca日常操作中使用为其他请求签发证书时的配置" class="hash-link" aria-label="613-创建一个配置文件以便后续ca日常操作中使用为其他请求签发证书时的配置的直接链接" title="613-创建一个配置文件以便后续ca日常操作中使用为其他请求签发证书时的配置的直接链接">​</a></h4>
<p>在conf文件夹下创建文件：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gedit testca</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>文件内容如下：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">####################################</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> ca </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_ca      </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> testca                   # 按需修改</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> testca </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">										 # 按需修改</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dir            	</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">home</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">testca   		# top dir，按实际给出</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">database       	</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> $dir</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">txt</span><span class="token plain">          # index file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token property-access">new_certs_dir</span><span class="token plain">  	</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> $dir</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">newcerts           # </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">certs</span><span class="token plain"> dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">certificate    		</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> $dir</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">cacert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain">         	# </span><span class="token maybe-class-name">The</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">CA</span><span class="token plain"> cert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">serial         		</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> $dir</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">serial             		# serial no file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private_key    	</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> $dir</span><span class="token operator" style="color:#393A34">/</span><span class="token keyword" style="color:#00009f">private</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">cakey</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain">  	# </span><span class="token constant" style="color:#36acaa">CA</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">RANDFILE</span><span class="token plain">       	</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> $dir</span><span class="token operator" style="color:#393A34">/</span><span class="token keyword" style="color:#00009f">private</span><span class="token operator" style="color:#393A34">/</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">rand</span><span class="token plain">      	# random number file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_days   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">365</span><span class="token plain">                     	# how long to certify </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_crl_days</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token plain">                     	# how long before next </span><span class="token constant" style="color:#36acaa">CRL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_md     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> md5                    	 # message digest method to use</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unique_subject </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> no                      	# </span><span class="token known-class-name class-name">Set</span><span class="token plain"> to </span><span class="token string" style="color:#e3116c">&#x27;no&#x27;</span><span class="token plain"> to allow creation </span><span class="token keyword" style="color:#00009f">of</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                     			# several ctificates </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> same subject</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token property-access">policy</span><span class="token plain">         </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> policy_any              	# </span><span class="token keyword module" style="color:#00009f">default</span><span class="token plain"> policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> policy_any </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">countryName             </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> optional</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stateOrProvinceName     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> optional</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">localityName            </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> optional</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">organizationName        </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> optional</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">organizationalUnitName  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> optional</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">commonName              </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> supplied</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">emailAddress            </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> optional</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">########################################</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62-ca的常规操作"><strong>6.2 CA的常规操作</strong><a href="#62-ca的常规操作" class="hash-link" aria-label="62-ca的常规操作的直接链接" title="62-ca的常规操作的直接链接">​</a></h3>
<p>  在我们自建CA完成之后，就相当于有了一个证书颁发机构，可以执行如下的一些常规操作：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="621-根据证书申请请求签发证书为其他请求签发证书"><strong>6.2.1 根据证书申请请求签发证书(为其他请求签发证书)</strong><a href="#621-根据证书申请请求签发证书为其他请求签发证书" class="hash-link" aria-label="621-根据证书申请请求签发证书为其他请求签发证书的直接链接" title="621-根据证书申请请求签发证书为其他请求签发证书的直接链接">​</a></h4>
<p>  假设收到一个证书请求文件名为req.pem，文件格式应该是PKCS#10格式（标准证书请求格式）。\n首先可以查看一下证书请求的内容，执行命令：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">text </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">noout</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>  将看到证书请求的内容，包括请求者唯一的名字（DN）、公钥信息（可能还有一组扩展的可选属性）。</p>
<p>执行签发命令：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl ca </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">config </span><span class="token string" style="color:#e3116c">&quot;/home/testca/conf/testca.conf&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>  执行过程中会要求输入访问CA的私钥密码（刚才设置的123456）。\n  签发命令简单解释：实际上就是请求方将自己的请求文件req.pem发给CA，CA按照之前写好的配置文件testca.conf中的规则给请求方生成证书cert.pem。</p>
<p>  完成上一步后，签发好的证书就是cert.pem，另外/home/testca/newcerts里也会有一个相同的证书副本（文件名为证书序列号）。</p>
<p>你可以执行以下语句来查看生成的证书的内容：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">text </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">noout</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="622-吊销证书作废证书"><strong>6.2.2 吊销证书（作废证书）</strong><a href="#622-吊销证书作废证书" class="hash-link" aria-label="622-吊销证书作废证书的直接链接" title="622-吊销证书作废证书的直接链接">​</a></h4>
<p>  一般由于用户私钥泄露等情况才需要吊销一个未过期的证书。（当然我们用本测试CA时其时很少用到该命令，除非专门用于测试吊销证书的情况）\n假设需要被吊销的证书文件为cert.pem，则执行以下命令吊销证书：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl ca </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">revoke cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">config </span><span class="token string" style="color:#e3116c">&quot;$HOME/testca/conf/testca.conf&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="623-生成证书吊销列表文件crl"><strong>6.2.3 生成证书吊销列表文件（CRL）</strong><a href="#623-生成证书吊销列表文件crl" class="hash-link" aria-label="623-生成证书吊销列表文件crl的直接链接" title="623-生成证书吊销列表文件crl的直接链接">​</a></h4>
<p>  准备公开被吊销的证书列表时，可以生成证书吊销列表（CRL），执行命令如下：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl ca </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">gencrl </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out testca</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crl</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">config </span><span class="token string" style="color:#e3116c">&quot;$HOME/testca/conf/testca.conf&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>  还可以添加-crldays和-crlhours参数来说明下一个吊销列表将在多少天后（或多少小时候）发布。</p>
<p>  可以用以下命令检查testca.crl的内容：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl crl </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> testca</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crl</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">text </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">noout</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="63-ca为server签发证书"><strong>6.3 CA为server签发证书</strong><a href="#63-ca为server签发证书" class="hash-link" aria-label="63-ca为server签发证书的直接链接" title="63-ca为server签发证书的直接链接">​</a></h3>
<p>任意路径下创建一个文件夹server:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir sever</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>生成server的私钥server.key及证书申请的请求文件serverreq.pem：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">newkey rsa</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1024</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">keyout server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out serverreq</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">subj </span><span class="token string" style="color:#e3116c">&quot;/O=ServerCom/OU=ServerOU/CN=server&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>设置私钥保护密码为：111111\n解释：server生成请求文件serverreq.pem之后就可以将这个文件发送给CA申请证书了，操作如下：</p>
<p>提交serverreq.pem向CA申请证书并生成证书server.crt：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl ca </span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> serverreq</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pem</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">crt</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">config </span><span class="token string" style="color:#e3116c">&quot;/home/testca/conf/testca.conf&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>解释：可以看出-in表示提交给CA的文件，就是申请文件，-out表示输出文件就是server的证书server.crt，其中生成证书的规则-config是按照之前CA定义的testca.conf文件，这里路径不要写错。\n至此，server证书申请成功，可以看到共有三个文件：\n <img decoding="async" loading="lazy" src="https://i-blog.csdnimg.cn/blog_migrate/6c1ec74b4c40da60fd11b2a44e517661.png" alt="在这里插入图片描述" class="img_ev3q">\n同时，在CA目录下newcerts目录下也生成了该证书的备份：01.pem，这和备份的内容和生成的证书server.crt完全一致。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="64-ca为client签发证书"><strong>6.4 CA为client签发证书</strong><a href="#64-ca为client签发证书" class="hash-link" aria-label="64-ca为client签发证书的直接链接" title="64-ca为client签发证书的直接链接">​</a></h3>
<p>client的证书生成方式和server完全一致，这里就不在赘述。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="65-server和client基于证书完成https通信"><strong>6.5 server和client基于证书完成https通信</strong><a href="#65-server和client基于证书完成https通信" class="hash-link" aria-label="65-server和client基于证书完成https通信的直接链接" title="65-server和client基于证书完成https通信的直接链接">​</a></h3>
<p>  https通信需要完成证书验证，我们在上面以及自建了CA，并为server和client颁发了证书，因此可以基于证书验证实现https通信测试了。具体代码设计可见下一篇博客。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="五-感谢支持"><strong>五. 感谢支持</strong><a href="#五-感谢支持" class="hash-link" aria-label="五-感谢支持的直接链接" title="五-感谢支持的直接链接">​</a></h2>
<p>    完结撒花！密码学实属复杂深奥的问题，不仅在原理上难以理解，在代码实现上更是难的一批，写这篇文章花了我很大精力。希望看到这里的小伙伴能点个关注，我后续会持续更新更多关于密码学原理分析和实现，也欢迎大家广泛交流。\n    码字实属不易，如果本文对你有10分帮助，就赏个10分把，感谢各位大佬支持！</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/lorchr/light-docusaurus/tree/main/docs/zh-cn/linux/Generate-CA-and-server-cert-With-OpenSSL.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一openssl简介" class="table-of-contents__link toc-highlight"><strong>一.openssl简介</strong></a><ul><li><a href="#11-主要构成部分" class="table-of-contents__link toc-highlight"><strong>1.1 主要构成部分</strong></a></li><li><a href="#12-openssl用途" class="table-of-contents__link toc-highlight"><strong>1.2 openssl用途</strong></a></li><li><a href="#13-证书密钥csr请求文件crl列表-查看命令" class="table-of-contents__link toc-highlight"><strong>1.3 证书、密钥、CSR请求文件、CRL列表 查看命令</strong></a></li></ul></li><li><a href="#二rsa密钥操作" class="table-of-contents__link toc-highlight"><strong>二.RSA密钥操作</strong></a><ul><li><a href="#21密钥生成" class="table-of-contents__link toc-highlight"><strong>2.1密钥生成</strong></a></li><li><a href="#22-转换命令" class="table-of-contents__link toc-highlight"><strong>2.2 转换命令</strong></a></li><li><a href="#23-使用公私钥进行密码学运算" class="table-of-contents__link toc-highlight"><strong>2.3 使用公私钥进行密码学运算</strong></a></li></ul></li><li><a href="#三生成自签名证书" class="table-of-contents__link toc-highlight"><strong>三.生成自签名证书</strong></a><ul><li><a href="#31-生成-rsa-私钥和自签名证书" class="table-of-contents__link toc-highlight"><strong>3.1 生成 RSA 私钥和自签名证书</strong></a></li><li><a href="#32-使用-已有rsa-私钥生成自签名证书" class="table-of-contents__link toc-highlight"><strong>3.2 使用 已有RSA 私钥生成自签名证书</strong></a></li></ul></li><li><a href="#四生成签名请求及ca-签名" class="table-of-contents__link toc-highlight"><strong>四.生成签名请求及CA 签名</strong></a><ul><li><a href="#41-使用-rsa私钥生成-csr-签名请求" class="table-of-contents__link toc-highlight"><strong>4.1 使用 RSA私钥生成 CSR 签名请求</strong></a></li><li><a href="#42-查看csr-的细节" class="table-of-contents__link toc-highlight"><strong>4.2 查看CSR 的细节</strong></a></li><li><a href="#43-使用-ca-证书及ca密钥-对请求签发证书进行签发生成-x509证书" class="table-of-contents__link toc-highlight"><strong>4.3 使用 CA 证书及CA密钥 对请求签发证书进行签发，生成 x509证书</strong></a></li></ul></li><li><a href="#五证书查看及转换" class="table-of-contents__link toc-highlight"><strong>五.证书查看及转换</strong></a></li><li><a href="#六基于openssl自建ca同时为serverclient颁发证书" class="table-of-contents__link toc-highlight"><strong>六.基于OPENSSL自建CA，同时为server,client颁发证书</strong></a><ul><li><a href="#61-自建ca" class="table-of-contents__link toc-highlight"><strong>6.1 自建CA</strong></a></li><li><a href="#62-ca的常规操作" class="table-of-contents__link toc-highlight"><strong>6.2 CA的常规操作</strong></a></li><li><a href="#63-ca为server签发证书" class="table-of-contents__link toc-highlight"><strong>6.3 CA为server签发证书</strong></a></li><li><a href="#64-ca为client签发证书" class="table-of-contents__link toc-highlight"><strong>6.4 CA为client签发证书</strong></a></li><li><a href="#65-server和client基于证书完成https通信" class="table-of-contents__link toc-highlight"><strong>6.5 server和client基于证书完成https通信</strong></a></li></ul></li><li><a href="#五-感谢支持" class="table-of-contents__link toc-highlight"><strong>五. 感谢支持</strong></a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/category/guide/">Torch</a></li><li class="footer__item"><a class="footer__link-item" href="/middleware/">Middleware</a></li><li class="footer__item"><a class="footer__link-item" href="/electron/">Electron</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/diy/">DIY</a></li><li class="footer__item"><a href="https://github.com/lorchr/light-docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Offical</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Home<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docusaurus.io/docs/playground" target="_blank" rel="noopener noreferrer" class="footer__link-item">Playground<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Light-Docusaurus, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>