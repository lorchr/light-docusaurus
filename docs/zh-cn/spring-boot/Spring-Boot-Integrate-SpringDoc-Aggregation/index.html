<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-zh-cn/spring-boot/Spring-Boot-Integrate-SpringDoc-Aggregation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Spring-Boot-Integrate-SpringDoc-Aggregation | Light Docusaurus</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://lorchr.github.io/light-docusaurus/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://lorchr.github.io/light-docusaurus/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://lorchr.github.io/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Integrate-SpringDoc-Aggregation/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Spring-Boot-Integrate-SpringDoc-Aggregation | Light Docusaurus"><meta data-rh="true" name="description" content="- springdoc-openapi demo"><meta data-rh="true" property="og:description" content="- springdoc-openapi demo"><link data-rh="true" rel="icon" href="/light-docusaurus/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://lorchr.github.io/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Integrate-SpringDoc-Aggregation/"><link data-rh="true" rel="alternate" href="https://lorchr.github.io/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Integrate-SpringDoc-Aggregation/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://lorchr.github.io/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Integrate-SpringDoc-Aggregation/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://TLGHDZ3Y2I-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/light-docusaurus/blog/rss.xml" title="Light Docusaurus RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/light-docusaurus/blog/atom.xml" title="Light Docusaurus Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Light Docusaurus" href="/light-docusaurus/opensearch.xml"><link rel="stylesheet" href="/light-docusaurus/assets/css/styles.609e5209.css">
<script src="/light-docusaurus/assets/js/runtime~main.c76c40a0.js" defer="defer"></script>
<script src="/light-docusaurus/assets/js/main.4a0c9925.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/light-docusaurus/"><div class="navbar__logo"><img src="/light-docusaurus/img/logo.svg" alt="Torch Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/light-docusaurus/img/logo.svg" alt="Torch Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Torch</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/light-docusaurus/docs/category/guide/">Torch</a><a class="navbar__item navbar__link" href="/light-docusaurus/blog/">Blog</a><a class="navbar__item navbar__link" href="/light-docusaurus/middleware/">Middleware</a><a class="navbar__item navbar__link" href="/light-docusaurus/electron/">Electron</a><a class="navbar__item navbar__link" href="/light-docusaurus/postman/">Postman</a><a class="navbar__item navbar__link" href="/light-docusaurus/diy/">DIY</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Integrate-SpringDoc-Aggregation/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li></ul></div><a href="https://github.com/lorchr/light-docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/guide/">Guide</a><button aria-label="展开侧边栏分类 &#x27;Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/develop-environment/">Develop Environment</a><button aria-label="展开侧边栏分类 &#x27;Develop Environment&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/java-jvm/">Java (JVM)</a><button aria-label="展开侧边栏分类 &#x27;Java (JVM)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/light-docusaurus/docs/category/spring-boot/">Spring Boot</a><button aria-label="折叠侧边栏分类 &#x27;Spring Boot&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Api-Specification/">Api-Specification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/SPI/">SPI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Common-Async-Data-Handle/">Common-Async-Data-Handle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Multi-Thread-Transaction/">Multi-Thread-Transaction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Obfuscate-Spring-Boot-Application-With-Classfinal/">Obfuscate-Spring-Boot-Application-With-Classfinal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Obfuscate-Spring-Boot-Application-With-Proguard/">Obfuscate-Spring-Boot-Application-With-Proguard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Endpoints/">Spring-Boot-Endpoints</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Ip-Address-Parse/">Spring-Boot-Ip-Address-Parse</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Ip-Ragion-Parse/">Spring-Boot-Ip-Ragion-Parse</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Json-Diff/">Spring-Boot-Json-Diff</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Native-Memory-Leak/">Spring-Boot-Native-Memory-Leak</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Unit-Test/">Spring-Boot-Unit-Test</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Core/">Spring-Core</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Rate-Limit/">Spring-Rate-Limit</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Statemachine/">Spring-Statemachine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/SpringEvent/">SpringEvent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Dynamic-Datasource/">Spring-Boot-Dynamic-Datasource</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-QrCode-Zxing/">Spring-Boot-QrCode-Zxing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-With-Enum-Type/">Spring-Boot-With-Enum-Type</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Actuator/">Spring-Boot-Actuator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Parameter-Validate/">Spring-Boot-Parameter-Validate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Sql-Injection/">Sql-Injection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Enhance-Request-And-Response/">Enhance-Request-And-Response</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/Spring-Boot-Integrate-SpringDoc-Aggregation/">Spring-Boot-Integrate-SpringDoc-Aggregation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/light-docusaurus/docs/zh-cn/spring-boot/file/File-Upload-Split-Continue-on-Break/">file</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/light-docusaurus/docs/category/file/">File</a><button aria-label="展开侧边栏分类 &#x27;File&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/spring-cloud/">Spring Cloud</a><button aria-label="展开侧边栏分类 &#x27;Spring Cloud&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/spring-security/">Spring Security</a><button aria-label="展开侧边栏分类 &#x27;Spring Security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/spring-authorization-server/">Spring Authorization Server</a><button aria-label="展开侧边栏分类 &#x27;Spring Authorization Server&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/active-directory/">Active Directory</a><button aria-label="展开侧边栏分类 &#x27;Active Directory&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/database/">Database</a><button aria-label="展开侧边栏分类 &#x27;Database&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/git/">Git</a><button aria-label="展开侧边栏分类 &#x27;Git&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/linux/">Linux</a><button aria-label="展开侧边栏分类 &#x27;Linux&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/docker/">Docker</a><button aria-label="展开侧边栏分类 &#x27;Docker&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/kubernetes/">Kubernetes</a><button aria-label="展开侧边栏分类 &#x27;Kubernetes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/test/">Test</a><button aria-label="展开侧边栏分类 &#x27;Test&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/light-docusaurus/docs/category/others/">Others</a><button aria-label="展开侧边栏分类 &#x27;Others&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/light-docusaurus/docs/zh-cn/awesome-open-source/">Awesome open source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/light-docusaurus/docs/zh-cn/windows/">Windows</a></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/light-docusaurus/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/light-docusaurus/docs/category/spring-boot/"><span itemprop="name">Spring Boot</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Spring-Boot-Integrate-SpringDoc-Aggregation</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Spring-Boot-Integrate-SpringDoc-Aggregation</h1></header><ul>
<li><a href="https://github.com/ahuadoreen/studentmanager">springdoc-openapi demo</a></li>
<li><a href="https://github.com/springdoc/springdoc-openapi">springdoc-openapi github</a></li>
<li><a href="https://springdoc.org/">springdoc-openapi 官方文档</a></li>
<li><a href="https://blog.csdn.net/wangzhihao1994/article/details/108408595">Spring Boot 整合 springdoc-openapi</a></li>
<li><a href="https://blog.csdn.net/qq_35425070/article/details/105347336">Swagger3 注解使用（Open API 3）</a></li>
</ul>
<h2 id="简单集成">简单集成</h2>
<h3 id="1-添加依赖项">1. 添加依赖项</h3>
<pre><code class="language-xml">&lt;!-- Springdoc 2.x --&gt;
&lt;!--&lt;dependency&gt;
    &lt;groupId&gt;io.springfox&lt;/groupId&gt;
    &lt;artifactId&gt;springfox-boot-starter&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt;
    &lt;artifactId&gt;knife4j-spring-boot-starter&lt;/artifactId&gt;
&lt;/dependency&gt;--&gt;

&lt;!-- Springdoc 3.x --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springdoc&lt;/groupId&gt;
    &lt;artifactId&gt;springdoc-openapi-starter-webmvc-ui&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt;
    &lt;artifactId&gt;knife4j-openapi3-jakarta-spring-boot-starter&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!--&lt;dependency&gt;
    &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt;
    &lt;artifactId&gt;knife4j-openapi3-spring-boot-starter&lt;/artifactId&gt;
&lt;/dependency&gt;--&gt;

</code></pre>
<h3 id="2-添加配置">2. 添加配置</h3>
<pre><code class="language-yaml">light:
  cloud:
    # Swagger 文档配置
    openapi:
      enable: true
      profiles: dev,test,nat
      base-group: Light Cloud
      scan-group: Demo Service
      scan-packages: com.light.cloud.service.demo.controller
      description: Light Cloud Restful APIs
      version: 1.0.0
      license-name: Apache License 2.0
      license-url: https://www.apache.org/licenses/LICENSE-2.0
      contact-name: Light Cloud
      contact-email: whitetulips@163.com
      contact-url: https://gitee.com/lorchr/spring-cloud-samples
      terms-of-service-url: https://gitee.com/lorchr/spring-cloud-samples
      internals:
        tencent-sdk:
          group-name: Tencent SDK
          location: com.light.cloud.sdk.tencent.wechat.controller;com.light.cloud.sdk.tencent.wecom.controller
        alibaba-sdk:
          group-name: Alibaba SDK
          location: com.light.cloud.sdk.alibaba.dingtalk.controller
      # Note: 外部接口这部分已经废弃 
      externals:
        classpath-doc:
          group-name: Classpath Doc
          schema: classpath
          location: classpath:openapi.json
        local-doc:
          group-name: Local Doc
          schema: file
          location: D:/openapi.json.txt
        http-doc:
          group-name: HTTP Doc
          schema: http
          uri: localhost:8080
          location: /v3/api-docs
</code></pre>
<h3 id="3-openapiproperties-属性定义">3. OpenapiProperties 属性定义</h3>
<pre><code class="language-java">package com.light.cloud.common.web.openapi.properties;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.boot.context.properties.ConfigurationProperties;

import com.light.cloud.common.core.constant.PlatformConstant;
import lombok.Data;

/**
 * Swagger属性配置
 *
 * @author Hui Liu
 * @date 2022/8/5
 */
@Data
@ConfigurationProperties(prefix = OpenapiProperties.OPENAPI_PREFIX)
public class OpenapiProperties {

    public static final String OPENAPI_PREFIX = &quot;light.cloud.openapi&quot;;
    public static final String OPENAPI_ENABLE = &quot;enable&quot;;
    public static final String OPENAPI_SCAN_PACKAGES = &quot;light.cloud.openapi.scan-packages&quot;;

    private Boolean enable = true;

    private String profiles = &quot;dev,test,nat&quot;;

    /**
     * Web模块的名称
     */
    private String baseGroup = PlatformConstant.PLATFORM_NAME;

    /**
     * 扫描的业务服务名称
     */
    private String scanGroup;

    /**
     * 扫描的业务服务包路径 多个异&quot;,“分隔
     */
    private String scanPackages;

    /**
     * 服务描述信息
     */
    private String description = &quot;Light Cloud Restful APIs&quot;;
    /**
     * 服务版本
     */
    private String version = PlatformConstant.PLATFORM_VERSION;

    /**
     * 证书许可名称
     */
    private String licenseName = &quot;Apache License 2.0&quot;;

    /**
     * 证书许可URL
     */
    private String licenseUrl = &quot;https://www.apache.org/licenses/LICENSE-2.0&quot;;

    /**
     * 联系人
     */
    private String contactName = PlatformConstant.PLATFORM_NAME;

    /**
     * 联系人URL
     */
    private String contactUrl = &quot;https://gitee.com/lorchr/spring-cloud-samples&quot;;

    /**
     * 联系人邮箱地址
     */
    private String contactEmail = &quot;whitetulips@163.com&quot;;

    /**
     * 服务条款URL
     */
    private String termsOfServiceUrl = &quot;https://gitee.com/lorchr/spring-cloud-samples&quot;;

    /**
     * 依赖的其他公共模块 &lt;p&gt;
     * group-name: 接口文档分组名称 &lt;p&gt;
     * location: 接口文档的包路径 &lt;p&gt;
     */
    private Map&lt;String, RouteDefinition&gt; internals = new HashMap&lt;&gt;(4);

    /**
     * @deprecated 此方式只能实现接口的展示，不能跨服务调用，使用 knife4j aggregation 代替
     * 引用外部的api文件解析生成文档 &lt;p&gt;
     * group-name: 接口文档分组名称 &lt;p&gt;
     * location: 接口文档的包路径 &lt;p&gt;
     *
     * openapi文档地址支持多种格式
     * &lt;ul&gt;
     *     &lt;li&gt;Windows本地文件: file:///D:/openapi.json.txt&lt;/li&gt;
     *     &lt;li&gt;Linux本地文件: file://var/lib/openapi.json&lt;/li&gt;
     *     &lt;li&gt;Classpath文件: classpath:openapi.json&lt;/li&gt;
     *     &lt;li&gt;Http资源文件: http://localhost:8080/v3/api-docs&lt;/li&gt;
     *     &lt;li&gt;...&lt;/li&gt;
     * &lt;/ul&gt;
     */
    private Map&lt;String, RouteDefinition&gt; externals = new HashMap&lt;&gt;(4);

}

</code></pre>
<h3 id="4-routedefinition-路由定义">4. RouteDefinition 路由定义</h3>
<pre><code class="language-java">package com.light.cloud.common.web.openapi.properties;

import lombok.Data;

@Data
public class RouteDefinition {

    /**
     * 接口文档分组名称 &lt;p&gt;
     * 认证服务
     */
    private String groupName;

    /**
     * 文档读取协议 http https ftp file ...  &lt;p&gt;
     * http
     */
    private String schema;

    /**
     * 文档读取地址 &lt;p&gt;
     * localhost:8080
     */
    private String uri;

    /**
     * 文档读取位置 &lt;p&gt;
     * /auth/v3/api-docs &lt;p&gt;
     * com.light.cloud.sdk
     */
    private String location;

    /**
     * 服务器地址 &lt;p&gt;
     * http://localhost:8080
     */
    private String serverUrl;

}

</code></pre>
<h3 id="5-openapiconfig-配置类">5. OpenapiConfig 配置类</h3>
<pre><code class="language-java">package com.light.cloud.common.web.openapi.config;

import java.util.List;

import io.swagger.v3.oas.models.Components;
import io.swagger.v3.oas.models.ExternalDocumentation;
import io.swagger.v3.oas.models.media.StringSchema;
import io.swagger.v3.oas.models.parameters.HeaderParameter;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import com.google.common.collect.Lists;
import com.light.cloud.common.core.constant.PlatformConstant;
import com.light.cloud.common.web.openapi.processor.OpenapiAdditionalBeanRegistry;
import com.light.cloud.common.web.openapi.properties.OpenapiProperties;
import io.swagger.v3.oas.annotations.enums.ParameterIn;
import io.swagger.v3.oas.models.OpenAPI;
import io.swagger.v3.oas.models.info.Contact;
import io.swagger.v3.oas.models.info.Info;
import io.swagger.v3.oas.models.info.License;
import io.swagger.v3.oas.models.parameters.Parameter;
import io.swagger.v3.oas.models.security.OAuthFlow;
import io.swagger.v3.oas.models.security.OAuthFlows;
import io.swagger.v3.oas.models.security.Scopes;
import io.swagger.v3.oas.models.security.SecurityRequirement;
import io.swagger.v3.oas.models.security.SecurityScheme;
import jakarta.annotation.Resource;

/**
 * Openapi配置类
 *
 * @author Hui Liu
 * @date 2022/7/29
 */
@Configuration
@EnableConfigurationProperties(value = {OpenapiProperties.class})
public class OpenapiConfig {

    @Value(&quot;${&quot; + PlatformConstant.SPRING_APPLICATION_NAME + &quot;:&#x27;Light Cloud&#x27;}&quot;)
    private String serviceName;

    @Resource
    private OpenapiProperties openapiProperties;

    @Bean
    public OpenAPI openAPI() {
        // 添加 components 后可以重复引用
        Components components = new Components()
                .addParameters(PlatformConstant.HEADER_CLIENT_ID, clientId())
                .addParameters(PlatformConstant.HEADER_AUTHORIZATION, authorization());
        return new OpenAPI()
                .info(
                        new Info().title(serviceName)
                                .description(openapiProperties.getDescription())
                                .version(openapiProperties.getVersion())
                                .license(new License()
                                        .name(openapiProperties.getLicenseName())
                                        .url(openapiProperties.getLicenseUrl()))
                                .contact(new Contact()
                                        .name(openapiProperties.getContactName())
                                        .email(openapiProperties.getContactEmail())
                                        .url(openapiProperties.getContactUrl()))
                                .termsOfService(openapiProperties.getTermsOfServiceUrl())
                )
                //外部文档
                .externalDocs(new ExternalDocumentation()
                        .description(&quot;官方文档&quot;).url(&quot;https://springdoc.org&quot;)
                )
                // webhooks
//                .webhooks(new HashMap&lt;&gt;())
                // 全局统一安全认证配置 一个key对应一个schema（安全配置），
                // 对接口添加 @SecurityRequirement 可使用不同的安全规则
                .schemaRequirement(PlatformConstant.HEADER_AUTHORIZATION, apikeySecuritySchema())
//                .schemaRequirement(PlatformConstant.HEADER_CLIENT_ID, apikeySecuritySchema())
//                .schemaRequirement(HttpHeaders.AUTHORIZATION, oauth2SecuritySchema())
                // 全局安全校验项，也可以在对应的controller上加注解SecurityRequirement
                .addSecurityItem(new SecurityRequirement().addList(PlatformConstant.HEADER_AUTHORIZATION))
                // 组件定义
                .components(components);
    }

    /**
     * 动态注册Swagger文档配置
     */
    @Bean
    public OpenapiAdditionalBeanRegistry openapiAdditionalBeanRegistry() {
        return new OpenapiAdditionalBeanRegistry();
    }


    // region 统一认证配置

    /**
     * Access Token Header接口级授权 &lt;p&gt;
     * https://github.com/springfox/springfox/issues/3477  &lt;p&gt;
     * Note: 使用List注入时无法接收服务内定义的参数，单独注入可以避免这个问题
     */
    @Bean
    public Parameter authorization() {
        Parameter authorization = new Parameter()
                // 参数名
                .name(PlatformConstant.HEADER_AUTHORIZATION)
                // 参数配置
                // 参数描述信息
                .description(&quot;认证的 Token。当全局授权（Authorize）后，此处不必填写&quot;)
                // 参数类型 QUERY HEADER COOKIE PATH FORM BODY
                .in(ParameterIn.HEADER.toString())
                // 参数数据类型定义
                .schema(new StringSchema())
                // 是否必填
                .required(false);
        return authorization;
    }

    @Bean
    public Parameter clientId() {
        Parameter clientId = new Parameter()
                // 参数名
                .name(PlatformConstant.HEADER_CLIENT_ID)
                // 参数配置
                // 参数描述信息
                .description(&quot;ClientId 系统的名称&quot;)
                // 参数类型 QUERY HEADER COOKIE PATH FORM BODY
                .in(ParameterIn.HEADER.toString())
                // 参数数据类型定义
                .schema(new StringSchema())
                // 是否必填
                .required(false);
        return clientId;
    }

    /**
     * Access Token Header接口级授权
     * &lt;p&gt;
     * https://github.com/springfox/springfox/issues/3477
     */
    public List&lt;Parameter&gt; openapiParameters() {
        Parameter accessToken = new Parameter()
                // 参数名
                .name(PlatformConstant.HEADER_AUTHORIZATION)
                // 参数配置
                // 参数描述信息
                .description(&quot;认证的 Token。当全局授权（Authorize）后，此处不必填写&quot;)
                // 参数类型 QUERY HEADER COOKIE PATH FORM BODY
                .in(ParameterIn.HEADER.toString())
                // 是否必填
                .required(false);
        Parameter systemName = new Parameter()
                // 参数名
                .name(PlatformConstant.HEADER_CLIENT_ID)
                // 参数配置
                // 参数描述信息
                .description(&quot;ClientId 系统的名称&quot;)
                // 参数类型 QUERY HEADER COOKIE PATH FORM BODY
                .in(ParameterIn.HEADER.toString())
                // 是否必填
                .required(false);
        return Lists.newArrayList(accessToken, systemName);
    }

    /**
     * apikey认证
     */
    public SecurityScheme apikeySecuritySchema() {
        return new SecurityScheme()
                // token类型
                .type(SecurityScheme.Type.APIKEY)
                // token名称
                .name(PlatformConstant.HEADER_AUTHORIZATION)
                // token位置
                .in(SecurityScheme.In.HEADER);
    }

    /**
     * http认证
     */
    public SecurityScheme httpSecuritySchema() {
        return new SecurityScheme()
                // token类型
                .type(SecurityScheme.Type.HTTP)
                // token名称
                .name(PlatformConstant.HEADER_AUTHORIZATION)
                // token位置
                .in(SecurityScheme.In.HEADER);
    }

    /**
     * oauth认证
     */
    public SecurityScheme oauth2SecuritySchema() {
        return new SecurityScheme()
                // token类型
                .type(SecurityScheme.Type.OAUTH2)
                .name(&quot;OAuth2认证&quot;)
                .description(&quot;OAuth2认证&quot;)
                .flows(new OAuthFlows()
//                        .implicit()
//                        .clientCredentials()
                        .password(new OAuthFlow()
                                .authorizationUrl(&quot;/oauth2/authorize&quot;)
                                .tokenUrl(&quot;/oauth2/token&quot;)
                                .refreshUrl(&quot;/oauth2/refreshToken&quot;)
                                .scopes(scopes()))
                        .authorizationCode(new OAuthFlow()
                                .authorizationUrl(&quot;/oauth2/authorize&quot;)
                                .tokenUrl(&quot;/oauth2/token&quot;)
                                .refreshUrl(&quot;/oauth2/refreshToken&quot;)
                                .scopes(scopes())));
    }

    private Scopes scopes() {
        return new Scopes()
                .addString(&quot;global&quot;, &quot;accessAnything&quot;);
    }

    // endregion

}

</code></pre>
<h3 id="6-springdocconfig-配置类">6. SpringDocConfig 配置类</h3>
<pre><code class="language-java">package com.light.cloud.common.web.openapi.config;

import java.nio.charset.StandardCharsets;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

import com.light.cloud.common.core.constant.PlatformConstant;
import io.swagger.v3.oas.models.parameters.HeaderParameter;
import org.apache.commons.collections4.CollectionUtils;
import org.apache.commons.collections4.MapUtils;
import org.apache.commons.lang3.ArrayUtils;
import org.apache.commons.lang3.StringUtils;

import org.springdoc.core.customizers.OpenApiCustomizer;
import org.springdoc.core.customizers.GlobalOpenApiCustomizer;
import org.springdoc.core.customizers.GlobalOperationCustomizer;
import org.springdoc.core.models.GroupedOpenApi;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.beans.factory.config.ConfigurableListableBeanFactory;
import org.springframework.boot.actuate.autoconfigure.endpoint.web.CorsEndpointProperties;
import org.springframework.boot.actuate.autoconfigure.endpoint.web.WebEndpointProperties;
import org.springframework.boot.actuate.autoconfigure.web.server.ManagementPortType;
import org.springframework.boot.actuate.endpoint.ExposableEndpoint;
import org.springframework.boot.actuate.endpoint.web.EndpointLinksResolver;
import org.springframework.boot.actuate.endpoint.web.EndpointMapping;
import org.springframework.boot.actuate.endpoint.web.EndpointMediaTypes;
import org.springframework.boot.actuate.endpoint.web.ExposableWebEndpoint;
import org.springframework.boot.actuate.endpoint.web.WebEndpointsSupplier;
import org.springframework.boot.actuate.endpoint.web.annotation.ControllerEndpointsSupplier;
import org.springframework.boot.actuate.endpoint.web.annotation.ServletEndpointsSupplier;
import org.springframework.boot.actuate.endpoint.web.servlet.WebMvcEndpointHandlerMapping;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.env.Environment;
import org.springframework.core.env.Profiles;
import org.springframework.core.io.support.PathMatchingResourcePatternResolver;
import org.springframework.web.method.HandlerMethod;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.node.TreeTraversingParser;
import com.fasterxml.jackson.databind.type.MapType;
import com.light.cloud.common.core.constant.BaseConstant;
import com.light.cloud.common.core.enums.ResponseEnum;
import com.light.cloud.common.core.tool.StringTool;
import com.light.cloud.common.web.openapi.properties.OpenapiProperties;
import com.light.cloud.common.web.openapi.properties.RouteDefinition;

import io.swagger.v3.core.util.Json;
import io.swagger.v3.core.util.Yaml;
import io.swagger.v3.oas.models.Components;
import io.swagger.v3.oas.models.media.Schema;
import io.swagger.v3.oas.models.OpenAPI;
import io.swagger.v3.oas.models.Operation;
import io.swagger.v3.oas.models.parameters.Parameter;
import io.swagger.v3.oas.models.PathItem;
import io.swagger.v3.oas.models.Paths;
import io.swagger.v3.oas.models.servers.Server;
import jakarta.annotation.Resource;
import lombok.extern.slf4j.Slf4j;

/**
 * SpringDoc配置类
 *
 * @author Hui Liu
 * @date 2022/7/29
 */
@Slf4j
@Configuration
public class SpringDocConfig {

    @Value((&quot;${server.servlet.context-path:}&quot;))
    private String contextPath;

    public static final String BASE_PACKAGE = &quot;com.light.cloud.common.web.endpoints&quot;;

    @Resource
    private Environment environment;

    @Resource
    private OpenapiProperties openapiProperties;

    @Resource
    private List&lt;Parameter&gt; openapiParameters;

    private CustomOperationCustomizer customOperationCustomizer = new CustomOperationCustomizer();

    private CustomOpenApiCustomizer customOpenApiCustomizer = new CustomOpenApiCustomizer();

    /**
     * 添加分组
     *
     * @return
     */
    @Bean(&quot;platformApi&quot;)
    public GroupedOpenApi platformApi() {
        boolean isOpen = true;
        String profileStr = openapiProperties.getProfiles();
        if (StringUtils.isNotBlank(profileStr)) {
            List&lt;String&gt; profileList = Arrays.stream(profileStr.split(BaseConstant.COMMA))
                    .map(String::trim).collect(Collectors.toList());
            Profiles profiles = Profiles.of(profileList.toArray(new String[0]));
            isOpen = environment.acceptsProfiles(profiles);
        }
        return GroupedOpenApi.builder()
                .group(openapiProperties.getBaseGroup())
                // 扫描该包下的所有需要在Swagger中展示的API，@Hidden 注解标注的除外
                .packagesToScan(BASE_PACKAGE)
                // 添加全局参数
                .addOperationCustomizer(customOperationCustomizer)
                // 添加统一的上下文地址 contextPath
//                .addOpenApiCustomizer(customOpenApiCustomizer)
                .build();
    }

    @Bean(&quot;serviceApi&quot;)
    public GroupedOpenApi serviceApi() {
        boolean isOpen = true;
        String profileStr = openapiProperties.getProfiles();
        if (StringUtils.isNotBlank(profileStr)) {
            List&lt;String&gt; profileList = Arrays.stream(profileStr.split(BaseConstant.COMMA))
                    .map(String::trim).collect(Collectors.toList());
            Profiles profiles = Profiles.of(profileList.toArray(new String[0]));
            isOpen = environment.acceptsProfiles(profiles);
        }
        return GroupedOpenApi.builder()
                .group(openapiProperties.getScanGroup())
                // 扫描该包下的所有需要在Swagger中展示的API， @Hidden 注解标注的除外
                .packagesToScan(openapiProperties.getScanPackages())
                // 添加全局参数
                .addOperationCustomizer(customOperationCustomizer)
                // 添加统一的上下文地址 contextPath
//                .addOpenApiCustomizer(customOpenApiCustomizer)
                .build();
    }

    // region 动态注册Swagger文档配置
//    /**
//     * 动态注册Swagger文档配置
//     */
//    @Bean
//    public OpenapiAdditionalBeanRegistry openapiAdditionalBeanRegistry() {
//        return new OpenapiAdditionalBeanRegistry();
//    }

    /**
     * 注册项目模块内部的接口文档
     */
    public void registerInternalOpenApis(ConfigurableListableBeanFactory beanFactory) {
        Map&lt;String, GroupedOpenApi&gt; openApis = internalOpenApis();
        for (Map.Entry&lt;String, GroupedOpenApi&gt; entry : openApis.entrySet()) {
            String docName = entry.getKey();
            GroupedOpenApi openApi = entry.getValue();
            beanFactory.registerSingleton(docName + &quot;InternalApi&quot;, openApi);
        }
    }

    /**
     * 注册项目模块外部的接口文档
     *
     * @deprecated 此方式只能实现接口的展示，不能跨服务调用，使用 knife4j aggregation 代替
     */
    public void registerExternalOpenApis(ConfigurableListableBeanFactory beanFactory) {
        Map&lt;String, GroupedOpenApi&gt; openApis = externalOpenApis();
        for (Map.Entry&lt;String, GroupedOpenApi&gt; entry : openApis.entrySet()) {
            String docName = entry.getKey();
            GroupedOpenApi openApi = entry.getValue();
            beanFactory.registerSingleton(docName + &quot;ExternalApi&quot;, openApi);
        }
    }

    /**
     * 解析项目模块内部的接口文档
     *
     * @return key-组名称 value-Api文档对象
     */
    public Map&lt;String, GroupedOpenApi&gt; internalOpenApis() {
        Map&lt;String, RouteDefinition&gt; internals = openapiProperties.getInternals();
        if (MapUtils.isEmpty(internals)) {
            return Collections.emptyMap();
        }
        Map&lt;String, GroupedOpenApi&gt; openApiMap = new HashMap&lt;&gt;(internals.size());
        for (Map.Entry&lt;String, RouteDefinition&gt; entry : internals.entrySet()) {
            String entityKey = entry.getKey();
            RouteDefinition route = entry.getValue();
            String groupName = StringUtils.isBlank(route.getGroupName()) ? parseGroupName(entityKey) : route.getGroupName();
            String scanPackage = route.getLocation();

            GroupedOpenApi openApi = GroupedOpenApi.builder()
                    .group(groupName)
                    // 扫描该包下的所有需要在Swagger中展示的API，@Hidden 注解标注的除外
                    .packagesToScan(scanPackage)
                    // 添加全局参数
                    .addOperationCustomizer(customOperationCustomizer)
                    // 添加统一的上下文地址 contextPath
//                    .addOpenApiCustomizer(customOpenApiCustomizer)
                    .build();

            openApiMap.put(entityKey, openApi);
        }
        return openApiMap;
    }

    /**
     * 解析项目模块外部的接口文档
     *
     * @return key-组名称 value-Api文档对象
     * @deprecated 此方式只能实现接口的展示，不能跨服务调用，使用 knife4j aggregation 代替
     */
    public Map&lt;String, GroupedOpenApi&gt; externalOpenApis() {
        Map&lt;String, RouteDefinition&gt; externals = openapiProperties.getExternals();
        if (MapUtils.isEmpty(externals)) {
            return Collections.emptyMap();
        }
        Map&lt;String, GroupedOpenApi&gt; openApiMap = new HashMap&lt;&gt;(externals.size());
        for (Map.Entry&lt;String, RouteDefinition&gt; entry : externals.entrySet()) {
            String entityKey = entry.getKey();
            RouteDefinition route = entry.getValue();
            String groupName = StringUtils.isBlank(route.getGroupName()) ? parseGroupName(entityKey) : route.getGroupName();
            String resourcePath = buildUrl(route.getSchema().toLowerCase(), route.getUri(), route.getLocation());
            Map&lt;String, Object&gt; apiSpecMap = getResourceAsMap(resourcePath);

            GroupedOpenApi openApi = GroupedOpenApi.builder()
                    .group(groupName)
                    // 扫描该包下的所有需要在Swagger中展示的API，@Hidden 注解标注的除外
//                    .packagesToScan(scanPackage)
                    // 添加全局参数
                    .addOperationCustomizer(customOperationCustomizer)
                    // 添加统一的上下文地址 contextPath
                    .addOpenApiCustomizer(new FileOpenApiCustomizer(apiSpecMap, route.getServerUrl()))
                    .build();

            openApiMap.put(entityKey, openApi);
        }
        return openApiMap;
    }

    private String parseGroupName(String entityKey) {
        String[] strings = StringUtils.splitByCharacterTypeCamelCase(entityKey);
        return Arrays.stream(strings).map(s -&gt; StringTool.toUpperCamelCase(s, null))
                .collect(Collectors.joining(BaseConstant.SPACE));
    }

    private String buildUrl(String schema, String uri, String path) {
        if (StringUtils.equalsAny(schema, &quot;http&quot;, &quot;https&quot;)) {
            return schema + &quot;://&quot; + uri + &quot;/&quot; + path;
        } else if (StringUtils.equalsAny(schema, &quot;ftp&quot;, &quot;sftp&quot;)) {
            return schema + &quot;://&quot; + uri + &quot;/&quot; + path;
        } else if (StringUtils.equalsAny(schema, &quot;classpath&quot;)) {
            return path;
        } else if (StringUtils.equalsAny(schema, &quot;file&quot;)) {
            String osName = System.getProperty(&quot;os.name&quot;).toLowerCase();
            if (osName.startsWith(&quot;windows&quot;)) {
                return schema + &quot;:///&quot; + uri + &quot;/&quot; + path;
            } else if (osName.startsWith(&quot;linux&quot;)) {
                return schema + &quot;:/&quot; + uri + &quot;/&quot; + path;
            }
        }
        throw new UnsupportedOperationException(&quot;Unsupported schema: &quot; + schema);
    }

    private Map&lt;String, Object&gt; getResourceAsMap(String resourcePath) {
        try {
            // 支持 classpath:  file:// http: ftp:// 等协议
            org.springframework.core.io.Resource resource = new PathMatchingResourcePatternResolver()
                    .getResource(resourcePath);
            byte[] bytes = resource.getContentAsByteArray();
            if (ArrayUtils.isNotEmpty(bytes)) {
                String content = new String(bytes, StandardCharsets.UTF_8);

                Map&lt;String, Object&gt; apiSpecMap = null;
                if (resourcePath.endsWith(BaseConstant.DOT_YAML) || resourcePath.endsWith(BaseConstant.DOT_YML)) {
                    apiSpecMap = yamlToMap(content, Map.class);
                } else {
                    apiSpecMap = jsonToMap(content, Map.class, String.class, Object.class);
                }
                return apiSpecMap;
            }
        } catch (Exception ex) {
            log.error(ex.getMessage());
        }
        return null;
    }

    // endregion

    // region 可解决Spring 6.x 与Swagger 3.0.0 不兼容问题

    /**
     * 增加如下配置可解决Spring 6.x 与Swagger 3.0.0 不兼容问题
     **/
    @Bean
    public WebMvcEndpointHandlerMapping webEndpointServletHandlerMapping(WebEndpointsSupplier webEndpointsSupplier,
                                                                         ServletEndpointsSupplier servletEndpointsSupplier,
                                                                         ControllerEndpointsSupplier controllerEndpointsSupplier,
                                                                         EndpointMediaTypes endpointMediaTypes,
                                                                         CorsEndpointProperties corsProperties,
                                                                         WebEndpointProperties webEndpointProperties,
                                                                         Environment environment) {
        List&lt;ExposableEndpoint&lt;?&gt;&gt; allEndpoints = new ArrayList();
        Collection&lt;ExposableWebEndpoint&gt; webEndpoints = webEndpointsSupplier.getEndpoints();
        allEndpoints.addAll(webEndpoints);
        allEndpoints.addAll(servletEndpointsSupplier.getEndpoints());
        allEndpoints.addAll(controllerEndpointsSupplier.getEndpoints());
        String basePath = webEndpointProperties.getBasePath();
        EndpointMapping endpointMapping = new EndpointMapping(basePath);
        boolean shouldRegisterLinksMapping = this.shouldRegisterLinksMapping(webEndpointProperties, environment, basePath);
        return new WebMvcEndpointHandlerMapping(endpointMapping, webEndpoints,
                endpointMediaTypes, corsProperties.toCorsConfiguration(),
                new EndpointLinksResolver(allEndpoints, basePath), shouldRegisterLinksMapping);
    }

    private boolean shouldRegisterLinksMapping(WebEndpointProperties webEndpointProperties,
                                               Environment environment,
                                               String basePath) {
        return webEndpointProperties.getDiscovery().isEnabled()
                &amp;&amp; (org.springframework.util.StringUtils.hasText(basePath)
                || ManagementPortType.get(environment).equals(ManagementPortType.DIFFERENT));
    }

    // endregion


    // region 全局参数及上下文处理

    /**
     * 添加全局的请求头参数，并为所有接口添加context-path
     */
    // @Bean
    public OpenApiCustomizer customerGlobalOpenApiCustomizer() {
        return openApi -&gt; {
            Paths paths = openApi.getPaths();
            String[] pathSet = paths.keySet().toArray(new String[0]);
            for (String path : pathSet) {
                PathItem pathItem = paths.get(path);
                // 添加全局的请求头参数
                pathItem.readOperations().forEach(operation -&gt; {
                    // 引用在 OpenAPI 中定义的 components
                    operation.addParametersItem(new HeaderParameter().$ref(&quot;#/components/parameters/&quot; + PlatformConstant.HEADER_CLIENT_ID))
                            .addParametersItem(new HeaderParameter().$ref(&quot;#/components/parameters/&quot; + PlatformConstant.HEADER_AUTHORIZATION));
                });
                // 为接口添加 context-path
                paths.put(contextPath + path, pathItem);
                paths.remove(path);
            }
        };
    }


    public class CustomOperationCustomizer implements GlobalOperationCustomizer {
        @Override
        public Operation customize(Operation operation, HandlerMethod handlerMethod) {
            for (Parameter parameter : openapiParameters) {
                operation.addParametersItem(parameter);
            }
            return operation;
        }
    }

    public class CustomOpenApiCustomizer implements GlobalOpenApiCustomizer {

        @Override
        public void customise(OpenAPI openApi) {
            if (StringUtils.isBlank(contextPath)) {
                return;
            }
            Paths paths = openApi.getPaths();
            // To avoid ConcurrentModificationException
            String[] keySet = paths.keySet().toArray(new String[0]);
            for (String key : keySet) {
                if (key.startsWith(contextPath)) {
                    continue;
                }
                PathItem pathItem = paths.get(key);
                // add contextPath to the individual operation
                paths.put(contextPath + key, pathItem);
                paths.remove(key);
            }

//            Server server = openApi.getServers().get(0);
//            // Add the basePath to the server entry
//            server.setUrl(server.getUrl());
        }
    }

    /**
     * @see &lt;a href=&quot;https://stackoverflow.com/questions/71156280/how-can-i-add-custom-json-object-to-openapi-spec-generated-by-springboot-springd&quot;&gt;How can I add custom json object to Openapi spec generated by SpringBoot SpringDoc?&lt;/a&gt;
     * @see &lt;a href=&quot;https://github.com/springdoc/springdoc-openapi/issues/705&quot;&gt;Programatically schemas added are not showed in the generated openapi &lt;/a&gt;
     * @see &lt;a href=&quot;https://github.com/springdoc/springdoc-openapi/issues/1703&quot;&gt;How to refresh the API&lt;/a&gt;
     */
    public class FileOpenApiCustomizer implements GlobalOpenApiCustomizer {

        private Map&lt;String, Object&gt; apiSpecMap;
        private List&lt;String&gt; serverUrls;

        public FileOpenApiCustomizer(Map&lt;String, Object&gt; apiSpecMap, String serverUrls) {
            this.apiSpecMap = apiSpecMap;
            if (StringUtils.isNotBlank(serverUrls)) {
                this.serverUrls = Arrays.stream(serverUrls.split(&quot;,&quot;)).toList();
            }
        }

        @Override
        public void customise(OpenAPI openApi) {
            if (StringUtils.isBlank(contextPath)) {
                contextPath = &quot;&quot;;
            }
            // add external info to api
            Map&lt;String, Object&gt; extensions = new HashMap&lt;&gt;();
            extensions.put(&quot;external&quot;, &quot;https://lorchr.github.io/light-docusaurus&quot;);
            openApi.setExtensions(extensions);

            // 添加server信息，发送请求是 curl脚本会生成新的url
            if (CollectionUtils.isNotEmpty(serverUrls)) {
                List&lt;Server&gt; servers = serverUrls.stream().map(url -&gt; {
                    Server server = new Server();
                    server.setUrl(url);
                    return server;
                }).collect(Collectors.toList());
                openApi.setServers(servers);
            }

            Map&lt;String, Object&gt; pathMap = (Map&lt;String, Object&gt;) apiSpecMap.get(&quot;paths&quot;);
            Paths paths = openApi.getPaths();
            // Note: 如果此处不清空，其他接口的数据也会显示到当前的接口集中
            paths.clear();
            for (Map.Entry&lt;String, Object&gt; entry : pathMap.entrySet()) {
                String key = entry.getKey();
                Map&lt;String, Object&gt; valueMap = (Map&lt;String, Object&gt;) entry.getValue();
                PathItem pathItem = jsonToBean(beanToJson(valueMap), PathItem.class);
//                for (Map.Entry&lt;String, Object&gt; innerEntry : valueMap.entrySet()) {
//                    String innerKey = innerEntry.getKey();
//                    Object innerValue = innerEntry.getValue();
//                    Operation operation = jsonToBean(JsonTool.beanToJson(innerValue), Operation.class);
//                    if (PathItem.HttpMethod.POST.name().equalsIgnoreCase(innerKey)) {
//                        pathItem.setPost(operation);
//                    } else if (PathItem.HttpMethod.GET.name().equalsIgnoreCase(innerKey)) {
//                        pathItem.setGet(operation);
//                    } else if (PathItem.HttpMethod.PUT.name().equalsIgnoreCase(innerKey)) {
//                        pathItem.setPut(operation);
//                    } else if (PathItem.HttpMethod.PATCH.name().equalsIgnoreCase(innerKey)) {
//                        pathItem.setPatch(operation);
//                    } else if (PathItem.HttpMethod.DELETE.name().equalsIgnoreCase(innerKey)) {
//                        pathItem.setDelete(operation);
//                    } else if (PathItem.HttpMethod.HEAD.name().equalsIgnoreCase(innerKey)) {
//                        pathItem.setHead(operation);
//                    } else if (PathItem.HttpMethod.OPTIONS.name().equalsIgnoreCase(innerKey)) {
//                        pathItem.setOptions(operation);
//                    } else if (PathItem.HttpMethod.TRACE.name().equalsIgnoreCase(innerKey)) {
//                        pathItem.setTrace(operation);
//                    }
//                }
                paths.addPathItem(key, pathItem);
            }

//            String openapi = (String) apiSpecMap.get(&quot;openapi&quot;);
//            List&lt;Object&gt; info = (List&lt;Object&gt;) apiSpecMap.get(&quot;info&quot;);
//            Map&lt;String, Object&gt; externalDocs = (Map&lt;String, Object&gt;) apiSpecMap.get(&quot;externalDocs&quot;);
//            List&lt;Object&gt; servers = (List&lt;Object&gt;) apiSpecMap.get(&quot;servers&quot;);
//            List&lt;Object&gt; tags = (List&lt;Object&gt;) apiSpecMap.get(&quot;tags&quot;);
//            Map&lt;String, Object&gt; paths = (Map&lt;String, Object&gt;) apiSpecMap.get(&quot;paths&quot;);
//            List&lt;Object&gt; security = (List&lt;Object&gt;) apiSpecMap.get(&quot;security&quot;);
//            Map&lt;String, Object&gt; components = (Map&lt;String, Object&gt;) apiSpecMap.get(&quot;components&quot;);

            Components components = openApi.getComponents();
            Map&lt;String, Object&gt; componentMap = (Map&lt;String, Object&gt;) apiSpecMap.get(&quot;components&quot;);
            Map&lt;String, Object&gt; schemaMap = (Map&lt;String, Object&gt;) componentMap.get(&quot;schemas&quot;);
            for (Map.Entry&lt;String, Object&gt; entry : schemaMap.entrySet()) {
                String key = entry.getKey();
                Object value = entry.getValue();

                Schema schema = jsonToBean(beanToJson(value), Schema.class);
                components.addSchemas(key, schema);
            }
        }
    }

    // endregion


    /**
     * 使用Swagger时，最好使用自带的 {@link io.swagger.v3.core.util.Json} {@link io.swagger.v3.core.util.Yaml}解析类
     *
     * @param content json字符串
     * @param clazz   目标对象类型
     * @return clazz 类型对象
     */
    public &lt;T&gt; T jsonToBean(String content, Class&lt;T&gt; clazz) {
        try {
            return Json.mapper().readValue(content, clazz);
        } catch (JsonProcessingException e) {
            throw new RuntimeException(e);
        }
    }

    public Map jsonToMap(String content, Class&lt;? extends Map&gt; mapType,
                         Class&lt;String&gt; keyType, Class&lt;Object&gt; valueType) {
        try {
            ObjectMapper mapper = Json.mapper();
            MapType type = mapper.getTypeFactory()
                    .constructMapType(mapType, keyType, valueType);
            return mapper.readValue(content, type);
        } catch (JsonProcessingException e) {
            throw new RuntimeException(e);
        }
    }

    public String beanToJson(Object bean) {
        try {
            return Json.mapper().writeValueAsString(bean);
        } catch (JsonProcessingException e) {
            throw new RuntimeException(e);
        }
    }

    public &lt;T&gt; T yamlToBean(String content, Class&lt;T&gt; clazz) {
        try {
            return Yaml.mapper().readValue(content, clazz);
        } catch (JsonProcessingException e) {
            throw new RuntimeException(e);
        }
    }

    /**
     * Jackson yaml不支持带锚点的yaml文档解析：
     *
     * @see &lt;a href=&quot;https://stackoverflow.com/questions/40074700/jackson-yaml-support-for-anchors-and-references&quot;&gt;Jackson YAML: support for anchors and references&lt;/a&gt;
     * @see &lt;a href=&quot;https://github.com/FasterXML/jackson-dataformats-text/issues/98&quot;&gt;Jackson Yaml anchors/references Support&lt;/a&gt;
     */
    public static &lt;K, V&gt; Map&lt;K, V&gt; yamlToMap(String content, Class&lt;? extends Map&gt; mapType,
                                             Class&lt;K&gt; keyType, Class&lt;V&gt; valueType) {
        try {
            ObjectMapper mapper = Yaml.mapper();
            final JsonNode rootNode = mapper.readTree(content);

            MapType type = mapper.getTypeFactory()
                    .constructMapType(mapType, keyType, valueType);
            TreeTraversingParser treeTraversingParser = new TreeTraversingParser(rootNode);
            return mapper.readValue(treeTraversingParser, type);
        } catch (Exception e) {
            log.error(ResponseEnum.YAML_PARSE_ERROR.getDesc(), e);
        }
        return null;
    }

    /**
     * 使用 snakeyaml 可以支持锚点
     */
    public Map yamlToMap(String content, Class&lt;? extends Map&gt; mapType) {
        org.yaml.snakeyaml.Yaml yaml = new org.yaml.snakeyaml.Yaml();
        return yaml.loadAs(content, mapType);
    }

    public String beanToYaml(Object bean) {
        try {
            return Yaml.mapper().writeValueAsString(bean);
        } catch (JsonProcessingException e) {
            throw new RuntimeException(e);
        }
    }

}

</code></pre>
<h3 id="7openapiadditionalbeanregistry-动态注册类">7.OpenapiAdditionalBeanRegistry 动态注册类</h3>
<pre><code class="language-java">package com.light.cloud.common.web.openapi.processor;

import jakarta.servlet.http.HttpServletRequest;
import org.springdoc.core.properties.SpringDocConfigProperties;
import org.springframework.beans.BeansException;
import org.springframework.beans.PropertyValues;
import org.springframework.beans.factory.BeanFactory;
import org.springframework.beans.factory.BeanFactoryAware;
import org.springframework.beans.factory.config.ConfigurableListableBeanFactory;
import org.springframework.beans.factory.config.InstantiationAwareBeanPostProcessor;

import com.light.cloud.common.web.openapi.config.SpringDocConfig;
import jakarta.annotation.Resource;

/**
 * Swagger 额外Bean的手动注册
 *
 * @see springfox.documentation.spring.web.plugins.DocumentationPluginsManager
 * @see org.springdoc.core.providers.SpringDocProviders
 * @see org.springdoc.core.configuration.SpringDocConfiguration#springDocProviders(java.util.Optional, java.util.Optional, java.util.Optional, java.util.Optional, java.util.Optional, java.util.Optional, java.util.Optional, org.springdoc.core.providers.ObjectMapperProvider)
 * @see org.springframework.web.servlet.DispatcherServlet#doDispatch(jakarta.servlet.http.HttpServletRequest, jakarta.servlet.http.HttpServletResponse)
 * @see org.springdoc.webmvc.ui.SwaggerConfigResource#openapiJson(HttpServletRequest)
 * @author Hui Liu
 * @date 2022/9/27
 */
public class OpenapiAdditionalBeanRegistry implements InstantiationAwareBeanPostProcessor, BeanFactoryAware {

    @Resource
    private SpringDocConfig springDocConfig;

    @Resource
    private SpringDocConfigProperties springDocConfigProperties;

    private ConfigurableListableBeanFactory beanFactory;

    @Override
    public void setBeanFactory(BeanFactory beanFactory) throws BeansException {
        if (beanFactory instanceof ConfigurableListableBeanFactory) {
            this.beanFactory = (ConfigurableListableBeanFactory) beanFactory;
        }
    }

    @Override
    public PropertyValues postProcessProperties(PropertyValues pvs, Object bean, String beanName) throws BeansException {
        // springfox 切入点
//        if (&quot;documentationPluginsManager&quot;.equals(beanName)) {
//            springDocConfig.registerOpenApis(beanFactory);
//        }
        // springdoc 切入点
        if (&quot;springDocProviders&quot;.equals(beanName)) {
            springDocConfig.registerInternalOpenApis(beanFactory);
            // Note: 接口废弃，外部接口调用使用 knife4j-aggregation
            springDocConfig.registerExternalOpenApis(beanFactory);

            // 禁用缓存，会自动加载新的文档
            SpringDocConfigProperties.Cache cache = springDocConfigProperties.getCache();
            if (!cache.isDisabled()) {
                cache.setDisabled(Boolean.TRUE);
                springDocConfigProperties.setCache(cache);
            }
        }
        return InstantiationAwareBeanPostProcessor.super.postProcessProperties(pvs, bean, beanName);
    }

}

</code></pre>
<h2 id="聚合api文档">聚合Api文档</h2>
<h3 id="1-添加依赖项-1">1. 添加依赖项</h3>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt;
    &lt;artifactId&gt;knife4j-aggregation-spring-boot-starter&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<h3 id="2-添加配置-1">2. 添加配置</h3>
<pre><code class="language-yaml"># 使用 knife4j aggregation 实现外部接口的展示和调用
knife4j:
  enable-aggregation: true
  cloud:
    enable: true
    routes:
      - name: 权限管理
        uri: 192.168.3.49:80
        location: /oauth/v3/api-docs
      - name: 系统管理
        uri: 192.168.3.49:80
        location: /system/v3/api-docs
</code></pre>
<h3 id="3-routeproxyfilter-路由过滤器">3. RouteProxyFilter 路由过滤器</h3>
<pre><code class="language-java">package com.light.cloud.common.web.openapi.aggregation.filter;

import cn.hutool.core.io.IoUtil;
import cn.hutool.core.util.StrUtil;

import com.fasterxml.jackson.core.type.TypeReference;
import com.github.xiaoymin.knife4j.aggre.core.pojo.SwaggerRoute;
import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.google.gson.stream.JsonReader;
import com.light.cloud.common.core.tool.JsonTool;
import com.light.cloud.common.web.openapi.aggregation.RouteDispatcher;
import jakarta.servlet.Filter;
import jakarta.servlet.FilterChain;
import jakarta.servlet.FilterConfig;
import jakarta.servlet.ServletException;
import jakarta.servlet.ServletOutputStream;
import jakarta.servlet.ServletRequest;
import jakarta.servlet.ServletResponse;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import org.apache.commons.collections4.CollectionUtils;
import org.apache.commons.collections4.MapUtils;
import org.apache.commons.lang3.StringUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.web.util.ContentCachingResponseWrapper;

import java.io.IOException;
import java.io.PrintWriter;
import java.nio.charset.StandardCharsets;
import java.util.ArrayList;
import java.util.Enumeration;
import java.util.List;
import java.util.Map;
import java.util.Objects;
import java.util.function.Function;
import java.util.stream.Collectors;

/***
 * @see com.github.xiaoymin.knife4j.aggre.spring.configuration.Knife4jAggregationAutoConfiguration
 * @see com.github.xiaoymin.knife4j.aggre.core.filter.Knife4jRouteProxyFilter
 * @since  2.0.8
 * @author &lt;a href=&quot;mailto:xiaoymin@foxmail.com&quot;&gt;xiaoymin@foxmail.com&lt;/a&gt;
 * 2020/10/29 20:06
 */
public class RouteProxyFilter implements Filter {

    private final RouteDispatcher routeDispatcher;
    private final Gson gson = new GsonBuilder().create();

    Logger logger = LoggerFactory.getLogger(RouteProxyFilter.class);

    public RouteProxyFilter(RouteDispatcher routeDispatcher) {
        this.routeDispatcher = routeDispatcher;
    }

    @Override
    public void init(FilterConfig filterConfig) throws ServletException {

    }

    @Override
    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {
        HttpServletRequest request = (HttpServletRequest) servletRequest;
        HttpServletResponse response = (HttpServletResponse) servletResponse;
        String uri = request.getRequestURI();
        // Note: 有些版本的前端代码中Header名称 knife4j-gateway-request 存在拼写错误
        if (routeDispatcher.checkRoute(request.getHeader(RouteDispatcher.ROUTE_PROXY_HEADER_NAME))) {
            if (StrUtil.endWith(uri, RouteDispatcher.OPENAPI_GROUP_INSTANCE_ENDPOINT)) {
                String group = request.getParameter(&quot;group&quot;);
                SwaggerRoute swaggerRoute = routeDispatcher.getRoute(group);
                writeRouteResponse(response, null, swaggerRoute == null ? &quot;&quot; : swaggerRoute.getContent());
                // 响应当前服务disk-实例
            } else {
                if (logger.isDebugEnabled()) {
                    logger.debug(&quot;Current Request URI:{},Proxy Request&quot;, uri);
                }
                routeDispatcher.execute(request, response);
            }
        } else {
            // go on
            if (StrUtil.endWith(uri, RouteDispatcher.OPENAPI_GROUP_ENDPOINT)) {
                // 响应当前服务聚合结构
                ContentCachingResponseWrapper responseWrapper = response instanceof ContentCachingResponseWrapper ?
                        (ContentCachingResponseWrapper) response : new ContentCachingResponseWrapper(response);
                filterChain.doFilter(request, responseWrapper);
                String result = new String(responseWrapper.getContentAsByteArray());
                writeRouteResponse(response, result, gson.toJson(routeDispatcher.getRoutes()));
            } else if (StrUtil.endWith(uri, RouteDispatcher.OPENAPI_GROUP_INSTANCE_ENDPOINT)) {
                // 响应当前服务disk-实例
                String group = request.getParameter(&quot;group&quot;);
                SwaggerRoute swaggerRoute = routeDispatcher.getRoute(group);
                writeRouteResponse(response, null, swaggerRoute == null ? &quot;&quot; : swaggerRoute.getContent());
            } else if (uri.endsWith(&quot;/webjars/js/app.b0c0d7df.js&quot;)) {
                // Note: 修复 openapi 3.0 兼容性问题
                ContentCachingResponseWrapper responseWrapper = response instanceof ContentCachingResponseWrapper ?
                        (ContentCachingResponseWrapper) response : new ContentCachingResponseWrapper(response);
                filterChain.doFilter(request, responseWrapper);
                String result = new String(responseWrapper.getContentAsByteArray());
                String newResult = result.replace(&quot;url:re.a.getValue(e,\&quot;url\&quot;,\&quot;\&quot;,!0)&quot;, &quot;url:re.a.getValue(e,\&quot;url\&quot;,\&quot;\&quot;,!0),header:re.a.getValue(e,\&quot;header\&quot;,\&quot;\&quot;,!0)&quot;)
                        .replace(&quot;url:re.a.getValue(t,\&quot;url\&quot;,\&quot;\&quot;,!0)&quot;, &quot;url:re.a.getValue(t,\&quot;url\&quot;,\&quot;\&quot;,!0),header:re.a.getValue(t,\&quot;header\&quot;,\&quot;\&quot;,!0)&quot;)
                        .replace(&quot;t.servicePath=re.a.getValue(e,\&quot;servicePath\&quot;,null,!0)&quot;, &quot;t.servicePath=re.a.getValue(e,\&quot;servicePath\&quot;,null,!0),t.header=re.a.getValue(e,\&quot;header\&quot;,null,!0)&quot;);
                byte[] bytes = newResult.getBytes(StandardCharsets.UTF_8);
                responseWrapper.setContentLengthLong(bytes.length);
                responseWrapper.setContentLength(bytes.length);
                responseWrapper.setBufferSize(bytes.length);
                responseWrapper.getOutputStream().write(bytes);
                responseWrapper.copyBodyToResponse();
            } else {
                filterChain.doFilter(servletRequest, servletResponse);
            }
        }
    }

    /**
     * 响应服务端的内容
     * @param response 响应流
     * @param content 内容
     * @throws IOException 异常
     */
    protected void writeRouteResponse(HttpServletResponse response, String result, String content) throws IOException {
        byte[] bytes = content.getBytes(StandardCharsets.UTF_8);
        if (StringUtils.isNotBlank(result)) {
            Map&lt;String, Object&gt; resultMap = JsonTool.jsonToMap(result, Map.class, String.class, Object.class);
            List&lt;Map&lt;String, Object&gt;&gt; routes = JsonTool.jsonToBean(content, new TypeReference&lt;List&lt;Map&lt;String, Object&gt;&gt;&gt;() {
            });
            if (CollectionUtils.isNotEmpty(routes)) {
                // 添加外部文档
                List&lt;Map&lt;String, Object&gt;&gt; urls = (List&lt;Map&lt;String, Object&gt;&gt;) resultMap.getOrDefault(&quot;urls&quot;, new ArrayList&lt;&gt;());
                for (Map&lt;String, Object&gt; route : routes) {
                    route.put(&quot;url&quot;, routeDispatcher.getRootPath() + route.get(&quot;location&quot;));
                    urls.add(route);
                }
                // 移除单独的文档配置
                // resultMap.remove(&quot;url&quot;);
                resultMap.put(&quot;urls&quot;, urls);
                bytes = JsonTool.beanToJson(resultMap).getBytes(StandardCharsets.UTF_8);
            }
        }
        ServletOutputStream outputStream = response.getOutputStream();
        outputStream.write(bytes);
        outputStream.flush();
        outputStream.close();
    }
    @Override
    public void destroy() {

    }

}

</code></pre>
<h3 id="4-securitybasicauthfilter-认证过滤器">4. SecurityBasicAuthFilter 认证过滤器</h3>
<pre><code class="language-java">package com.light.cloud.common.web.openapi.aggregation.filter;

import com.github.xiaoymin.knife4j.aggre.core.pojo.BasicAuth;
import jakarta.servlet.Filter;
import jakarta.servlet.FilterChain;
import jakarta.servlet.FilterConfig;
import jakarta.servlet.ServletException;
import jakarta.servlet.ServletRequest;
import jakarta.servlet.ServletResponse;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.io.IOException;
import java.util.Base64;

/***
 * @see com.github.xiaoymin.knife4j.aggre.spring.configuration.Knife4jAggregationAutoConfiguration
 * @see com.github.xiaoymin.knife4j.aggre.core.filter.Knife4jSecurityBasicAuthFilter
 * @since  2.0.9
 * @author &lt;a href=&quot;mailto:xiaoymin@foxmail.com&quot;&gt;xiaoymin@foxmail.com&lt;/a&gt;
 * 2020/11/25 19:55
 */
public class SecurityBasicAuthFilter implements Filter {

    Logger logger = LoggerFactory.getLogger(SecurityBasicAuthFilter.class);
    /***
     * basic auth验证
     */
    public static final String SwaggerBootstrapUiBasicAuthSession = &quot;Knife4jAggregationBasicAuthSession&quot;;

    /***
     * 是否开启basic验证,默认不开启
     */
    /**
     * 文档Basic保护
     */
    private BasicAuth basicAuth;

    public SecurityBasicAuthFilter(BasicAuth basicAuth) {
        this.basicAuth = basicAuth;
    }

    protected String decodeBase64(String source) {
        String decodeStr = null;
        if (source != null) {
            // BASE64Decoder decoder=new BASE64Decoder();
            try {
                // byte[] bytes=decoder.decodeBuffer(source);
                byte[] bytes = Base64.getDecoder().decode(source);
                decodeStr = new String(bytes);
            } catch (Exception e) {
                logger.error(e.getMessage(), e);
            }
        }
        return decodeStr;
    }
    @Override
    public void init(FilterConfig filterConfig) throws ServletException {

    }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        HttpServletRequest servletRequest = (HttpServletRequest) request;
        HttpServletResponse httpServletResponse = (HttpServletResponse) response;
        // 针对swagger资源请求过滤
        if (basicAuth != null &amp;&amp; basicAuth.isEnable()) {
            // 判断Session中是否存在
            Object swaggerSessionValue = servletRequest.getSession().getAttribute(SwaggerBootstrapUiBasicAuthSession);
            if (swaggerSessionValue != null) {
                chain.doFilter(request, response);
            } else {
                // 匹配到,判断auth
                // 获取请求头Authorization
                String auth = servletRequest.getHeader(&quot;Authorization&quot;);
                if (auth == null || &quot;&quot;.equals(auth)) {
                    writeForbiddenCode(httpServletResponse);
                    return;
                }
                String userAndPass = decodeBase64(auth.substring(6));
                String[] upArr = userAndPass.split(&quot;:&quot;);
                if (upArr.length != 2) {
                    writeForbiddenCode(httpServletResponse);
                } else {
                    String iptUser = upArr[0];
                    String iptPass = upArr[1];
                    // 匹配服务端用户名及密码
                    if (iptUser.equals(basicAuth.getUsername()) &amp;&amp; iptPass.equals(basicAuth.getPassword())) {
                        servletRequest.getSession().setAttribute(SwaggerBootstrapUiBasicAuthSession, basicAuth.getUsername());
                        chain.doFilter(request, response);
                    } else {
                        writeForbiddenCode(httpServletResponse);
                        return;
                    }
                }
            }
        } else {
            chain.doFilter(request, response);
        }
    }

    @Override
    public void destroy() {

    }

    private void writeForbiddenCode(HttpServletResponse httpServletResponse) throws IOException {
        httpServletResponse.setStatus(401);
        httpServletResponse.setHeader(&quot;WWW-Authenticate&quot;, &quot;Basic realm=\&quot;input OpenAPI userName &amp; password \&quot;&quot;);
        httpServletResponse.getWriter().write(&quot;You do not have permission to access this resource&quot;);
    }

}


</code></pre>
<h3 id="5-routedispatcher-路由分发器">5. RouteDispatcher 路由分发器</h3>
<pre><code class="language-java">package com.light.cloud.common.web.openapi.aggregation;


import cn.hutool.core.collection.CollectionUtil;
import cn.hutool.core.io.IoUtil;
import cn.hutool.core.lang.Assert;
import cn.hutool.core.util.StrUtil;
import cn.hutool.json.JSONObject;
import com.github.xiaoymin.knife4j.aggre.core.RouteCache;
import com.github.xiaoymin.knife4j.aggre.core.RouteRepository;
import com.github.xiaoymin.knife4j.aggre.core.RouteResponse;
import com.github.xiaoymin.knife4j.aggre.core.common.ExecutorEnum;
import com.github.xiaoymin.knife4j.aggre.core.common.RouteUtils;
import com.github.xiaoymin.knife4j.aggre.core.pojo.BasicAuth;
import com.github.xiaoymin.knife4j.aggre.core.pojo.HeaderWrapper;
import com.github.xiaoymin.knife4j.aggre.core.pojo.SwaggerRoute;
import com.light.cloud.common.web.openapi.aggregation.executor.ApacheClientExecutor;
import com.light.cloud.common.web.openapi.aggregation.executor.OkHttpClientExecutor;
import com.light.cloud.common.web.openapi.aggregation.executor.RouteExecutor;
import jakarta.servlet.ServletOutputStream;
import jakarta.servlet.http.Part;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.util.StringUtils;

import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.io.InputStream;
import java.io.PrintWriter;
import java.net.URI;
import java.util.*;

/***
 * @see com.github.xiaoymin.knife4j.aggre.core.RouteDispatcher
 * @since  2.0.8
 * @author &lt;a href=&quot;mailto:xiaoymin@foxmail.com&quot;&gt;xiaoymin@foxmail.com&lt;/a&gt;
 * 2020/10/29 20:08
 */
public class RouteDispatcher {

    /**
     * header
     */
    public static final String ROUTE_PROXY_HEADER_NAME = &quot;knife4j-gateway-request&quot;;
    public static final String ROUTE_PROXY_HEADER_BASIC_NAME = &quot;knife4j-gateway-basic-request&quot;;
    public static final String OPENAPI_GROUP_ENDPOINT = &quot;/swagger-config&quot;;
    public static final String OPENAPI_GROUP_INSTANCE_ENDPOINT = &quot;/swagger-instance&quot;;
    public static final String ROUTE_BASE_PATH = &quot;/&quot;;

    Logger logger = LoggerFactory.getLogger(com.github.xiaoymin.knife4j.aggre.core.RouteDispatcher.class);
    /**
     * current project contextPath
     */
    private String rootPath;

    private RouteRepository routeRepository;

    private RouteExecutor routeExecutor;

    private RouteCache&lt;String, SwaggerRoute&gt; routeCache;

    private Set&lt;String&gt; ignoreHeaders = new HashSet&lt;&gt;();

    public RouteDispatcher(RouteRepository routeRepository, RouteCache&lt;String, SwaggerRoute&gt; routeRouteCache,
                           ExecutorEnum executorEnum, String rootPath) {
        this.routeRepository = routeRepository;
        this.routeCache = routeRouteCache;
        this.rootPath = rootPath;
        initExecutor(executorEnum);
        ignoreHeaders.addAll(Arrays.asList(new String[]{
                &quot;host&quot;, &quot;content-length&quot;, ROUTE_PROXY_HEADER_NAME, ROUTE_PROXY_HEADER_BASIC_NAME, &quot;Request-Origion&quot;, &quot;language&quot;, &quot;knife4j-gateway-code&quot;
        }));
    }

    private void initExecutor(ExecutorEnum executorEnum) {
        if (executorEnum == null) {
            throw new IllegalArgumentException(&quot;ExecutorEnum can not be empty&quot;);
        }
        switch (executorEnum) {
            case APACHE:
                this.routeExecutor = new ApacheClientExecutor();
                break;
            case OKHTTP:
                this.routeExecutor = new OkHttpClientExecutor();
                break;
            default:
                throw new UnsupportedOperationException(&quot;UnSupported ExecutorType:&quot; + executorEnum.name());
        }
    }

    public boolean checkRoute(String header) {
        if (StrUtil.isNotBlank(header)) {
            SwaggerRoute swaggerRoute = routeRepository.getRoute(header);
            if (swaggerRoute != null) {
                return StrUtil.isNotBlank(swaggerRoute.getUri());
            }
        }
        return false;
    }

    public void execute(HttpServletRequest request, HttpServletResponse response) {
        try {
            RouteRequestContext routeContext = new RouteRequestContext();
            this.buildContext(routeContext, request);
            RouteResponse routeResponse = routeExecutor.executor(routeContext);
            writeResponseStatus(routeResponse, response);
            writeResponseHeader(routeResponse, response);
            writeBody(routeResponse, response);
        } catch (Exception e) {
            logger.error(&quot;has Error:{}&quot;, e.getMessage());
            logger.error(e.getMessage(), e);
            // write Default
            writeDefault(request, response, e.getMessage());
        }
    }

    protected void writeDefault(HttpServletRequest request, HttpServletResponse response, String errMsg) {
        response.setContentType(&quot;application/json&quot;);
        response.setCharacterEncoding(&quot;UTF-8&quot;);
        try {
            PrintWriter printWriter = response.getWriter();
            Map&lt;String, String&gt; map = new HashMap&lt;&gt;();
            map.put(&quot;message&quot;, errMsg);
            map.put(&quot;code&quot;, &quot;500&quot;);
            map.put(&quot;path&quot;, request.getRequestURI());
            new JSONObject(map).write(printWriter);
            printWriter.close();
        } catch (IOException e) {
            // ignore
        }
    }

    /**
     * Write Http Status Code
     *
     * @param routeResponse routeResponse
     * @param response      response
     */
    protected void writeResponseStatus(RouteResponse routeResponse, HttpServletResponse response) {
        if (routeResponse != null) {
            response.setStatus(routeResponse.getStatusCode());
        }
    }

    /**
     * Write Response Header
     *
     * @param routeResponse route instance
     * @param response Servlet Response
     */
    protected void writeResponseHeader(RouteResponse routeResponse, HttpServletResponse response) {
        if (routeResponse != null) {
            if (CollectionUtil.isNotEmpty(routeResponse.getHeaders())) {
                for (HeaderWrapper header : routeResponse.getHeaders()) {
                    if (!StrUtil.equalsIgnoreCase(header.getName(), &quot;Transfer-Encoding&quot;)) {
                        response.addHeader(header.getName(), header.getValue());
                    }
                }
            }
            if (logger.isDebugEnabled()) {
                logger.debug(&quot;Content-Type:{},Charset-Encoding:{}&quot;, routeResponse.getContentType(), routeResponse.getCharsetEncoding());
            }
            response.setContentType(routeResponse.getContentType());
            if (routeResponse.getContentLength() &gt; 0) {
                response.setContentLengthLong(routeResponse.getContentLength());
            }
            response.setCharacterEncoding(routeResponse.getCharsetEncoding().displayName());
        }
    }

    /**
     * Write Body
     *
     * @param routeResponse route
     * @param response Servlet Response
     */
    protected void writeBody(RouteResponse routeResponse, HttpServletResponse response) throws IOException {
        if (routeResponse != null) {
            if (routeResponse.success()) {
                InputStream inputStream = routeResponse.getBody();
                if (inputStream != null) {
                    int read = -1;
                    byte[] bytes = new byte[1024 * 1024];
                    ServletOutputStream outputStream = response.getOutputStream();
                    while ((read = inputStream.read(bytes)) != -1) {
                        outputStream.write(bytes, 0, read);
                    }
                    IoUtil.close(inputStream);
                    IoUtil.close(outputStream);
                }
            } else {
                String text = routeResponse.text();
                if (StrUtil.isNotBlank(text)) {
                    PrintWriter printWriter = response.getWriter();
                    printWriter.write(text);
                    printWriter.close();
                }
            }

        }
    }

    /**
     * Build Context of Route
     * @param routeRequestContext Route Context
     * @param request Servlet Request
     */
    protected void buildContext(RouteRequestContext routeRequestContext, HttpServletRequest request) throws IOException {
        // Whether Basic
        String basicHeader = request.getHeader(ROUTE_PROXY_HEADER_BASIC_NAME);
        if (StrUtil.isNotBlank(basicHeader)) {
            BasicAuth basicAuth = routeRepository.getAuth(basicHeader);
            if (basicAuth != null) {
                // add Basic header
                routeRequestContext.addHeader(&quot;Authorization&quot;, RouteUtils.authorize(basicAuth.getUsername(),
                        basicAuth.getPassword()));
            }
        }
        SwaggerRoute swaggerRoute = getRoute(request.getHeader(ROUTE_PROXY_HEADER_NAME));
        // String uri=&quot;http://knife4j.xiaominfo.com&quot;;
        String uri = swaggerRoute.getUri();
        String fromUri = request.getRequestURI();
        // get project servlet.contextPath
        if (StrUtil.isNotBlank(this.rootPath) &amp;&amp; !StrUtil.equals(this.rootPath, ROUTE_BASE_PATH)) {
            fromUri = fromUri.replaceFirst(this.rootPath, &quot;&quot;);
            // 此处需要追加一个请求头basePath，因为父项目设置了context-path
            routeRequestContext.addHeader(&quot;X-Forwarded-Prefix&quot;, this.rootPath);
        }
        // 判断servicePath
        if (StrUtil.isNotBlank(swaggerRoute.getServicePath()) &amp;&amp; !StrUtil.equals(swaggerRoute.getServicePath(),
                ROUTE_BASE_PATH)) {
            if (StrUtil.startWith(fromUri, swaggerRoute.getServicePath())) {
                // 实际在请求时,剔除servicePath,否则会造成404
                fromUri = fromUri.replaceFirst(swaggerRoute.getServicePath(), &quot;&quot;);
            }
        }
        if (StrUtil.isNotBlank(swaggerRoute.getLocation())) {
            if (swaggerRoute.getLocation().indexOf(fromUri) == -1) {
                logger.debug(&quot;location:{},fromURI:{}&quot;, swaggerRoute.getLocation(), fromUri);
                // 当前路径是请求非获取OpenAPI实例路径地址，判断debugURL
                if (StrUtil.isNotBlank(swaggerRoute.getDebugUrl())) {
                    // 设置为调试地址
                    uri = swaggerRoute.getDebugUrl();
                }
            }
        }
        if (logger.isDebugEnabled()) {
            logger.debug(&quot;Debug URI:{},fromURI:{}&quot;, uri, fromUri);
        }
        Assert.notEmpty(uri, &quot;Uri is Empty&quot;);
        StringBuilder requestUrlBuilder = new StringBuilder();
        requestUrlBuilder.append(uri);
        requestUrlBuilder.append(fromUri);
        // String requestUrl=uri+fromUri;
        String requestUrl = requestUrlBuilder.toString();
        String host = URI.create(uri).getHost();
        if (logger.isDebugEnabled()) {
            logger.debug(&quot;目标请求Url:{},请求类型:{},Host:{}&quot;, requestUrl, request.getMethod(), host);
        }
        routeRequestContext.setOriginalUri(fromUri);
        routeRequestContext.setUrl(requestUrl);
        routeRequestContext.setMethod(request.getMethod());
        Enumeration&lt;String&gt; enumeration = request.getHeaderNames();
        while (enumeration.hasMoreElements()) {
            String key = enumeration.nextElement();
            String value = request.getHeader(key);
            if (!ignoreHeaders.contains(key.toLowerCase())) {
                routeRequestContext.addHeader(key, value);
            }
        }
        routeRequestContext.addHeader(&quot;Host&quot;, host);
        Enumeration&lt;String&gt; params = request.getParameterNames();
        while (params.hasMoreElements()) {
            String name = params.nextElement();
            String value = request.getParameter(name);
            // logger.info(&quot;param-name:{},value:{}&quot;,name,value);
            routeRequestContext.addParam(name, value);
        }
        // 增加文件，sinc 2.0.9
        String contentType = request.getContentType();
        if ((!StringUtils.isEmpty(contentType)) &amp;&amp;
                contentType.contains(&quot;multipart/form-data&quot;)) {
            try {
                Collection&lt;Part&gt; parts = request.getParts();
                if (CollectionUtil.isNotEmpty(parts)) {
                    Map&lt;String, String&gt; paramMap = routeRequestContext.getParams();
                    parts.forEach(part -&gt; {
                        String key = part.getName();
                        if (!paramMap.containsKey(key)) {
                            routeRequestContext.addPart(part);
                        }
                    });
                }
            } catch (ServletException e) {
                // ignore
                logger.warn(&quot;get part error,message:&quot; + e.getMessage());
            }
        }
        routeRequestContext.setRequestContent(request.getInputStream());
    }

    public SwaggerRoute getRoute(String header) {
        // 去除缓存机制，由于Eureka以及Nacos设立了心跳检测机制，服务在多节点部署时，节点ip可能存在变化,导致调试最终转发给已经下线的服务
        // since 2.0.9
        SwaggerRoute swaggerRoute = routeRepository.getRoute(header);
        return swaggerRoute;
    }

    public List&lt;SwaggerRoute&gt; getRoutes() {
        return routeRepository.getRoutes();
    }

    public String getRootPath() {
        return rootPath;
    }
}

</code></pre>
<h3 id="6-routerequestcontext-路由上下文">6. RouteRequestContext 路由上下文</h3>
<pre><code class="language-java">package com.light.cloud.common.web.openapi.aggregation;

import com.github.xiaoymin.knife4j.aggre.core.pojo.BasicAuth;
import com.github.xiaoymin.knife4j.aggre.core.pojo.HeaderWrapper;
import jakarta.servlet.http.Part;

import java.io.InputStream;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

/***
 *
 * @since  2.0.8
 * @author &lt;a href=&quot;mailto:xiaoymin@foxmail.com&quot;&gt;xiaoymin@foxmail.com&lt;/a&gt;
 * 2020/10/29 20:34
 */
public class RouteRequestContext {

    /**
     * 当前请求的接口地址
     */
    private String originalUri;
    /**
     * 请求接口
     */
    private String url;
    /**
     * 请求类型
     */
    private String method;
    /**
     * 请求头
     */
    private List&lt;HeaderWrapper&gt; headers = new ArrayList&lt;&gt;();
    /**
     * 查询参数
     */
    private Map&lt;String, String&gt; params = new HashMap&lt;&gt;();
    /**
     * 文件
     */
    private List&lt;Part&gt; parts = new ArrayList&lt;&gt;();

    /**
     * 请求内容
     */
    private InputStream requestContent;

    /**
     * 请求长度
     */
    private Long contentLength;
    /**
     * Basic验证
     */
    private BasicAuth basicAuth;

    /**
     * 添加请求头
     * @param key 请求头
     * @param value 值
     */
    public void addHeader(String key, String value) {
        this.headers.add(new HeaderWrapper(key, value));
    }

    /**
     * 添加params参数
     * @param name 参数名称
     * @param value 参数值
     */
    public void addParam(String name, String value) {
        this.params.put(name, value);
    }

    /**
     * 增加文件参数
     * @param part  文件
     */
    public void addPart(Part part) {
        this.parts.add(part);
    }

    public BasicAuth getBasicAuth() {
        return basicAuth;
    }

    public void setBasicAuth(BasicAuth basicAuth) {
        this.basicAuth = basicAuth;
    }

    public String getOriginalUri() {
        return originalUri;
    }

    public void setOriginalUri(String originalUri) {
        this.originalUri = originalUri;
    }

    public Long getContentLength() {
        return contentLength;
    }

    public void setContentLength(Long contentLength) {
        this.contentLength = contentLength;
    }

    public Map&lt;String, String&gt; getParams() {
        return params;
    }

    public void setParams(Map&lt;String, String&gt; params) {
        this.params = params;
    }

    public String getUrl() {
        return url;
    }

    public void setUrl(String url) {
        this.url = url;
    }

    public String getMethod() {
        return method;
    }

    public void setMethod(String method) {
        this.method = method;
    }

    public List&lt;HeaderWrapper&gt; getHeaders() {
        return headers;
    }

    public void setHeaders(List&lt;HeaderWrapper&gt; headers) {
        this.headers = headers;
    }

    public InputStream getRequestContent() {
        return requestContent;
    }

    public void setRequestContent(InputStream requestContent) {
        this.requestContent = requestContent;
    }

    public List&lt;Part&gt; getParts() {
        return parts;
    }

    public void setParts(List&lt;Part&gt; parts) {
        this.parts = parts;
    }
}

</code></pre>
<h3 id="7-routeexecutor-路由执行器">7. RouteExecutor 路由执行器</h3>
<pre><code class="language-java">package com.light.cloud.common.web.openapi.aggregation.executor;

import com.github.xiaoymin.knife4j.aggre.core.RouteResponse;
import com.light.cloud.common.web.openapi.aggregation.RouteRequestContext;

/***
 * @see com.github.xiaoymin.knife4j.aggre.core.RouteExecutor
 * @since  2.0.8
 * @author &lt;a href=&quot;mailto:xiaoymin@foxmail.com&quot;&gt;xiaoymin@foxmail.com&lt;/a&gt;
 * 2020/10/29 20:33
 */
public interface RouteExecutor {

    /**
     * 执行器
     * @param routeContext 请求上下文
     * @return 响应对象
     */
    RouteResponse executor(RouteRequestContext routeContext);
}


</code></pre>
<h3 id="8-okhttpclientexecutor-路由执行器-okhttp-实现">8. OkHttpClientExecutor 路由执行器 OkHttp 实现</h3>
<pre><code class="language-java">package com.light.cloud.common.web.openapi.aggregation.executor;


import com.github.xiaoymin.knife4j.aggre.core.RouteResponse;
import com.light.cloud.common.web.openapi.aggregation.RouteRequestContext;

/***
 * @see com.github.xiaoymin.knife4j.aggre.core.executor.OkHttpClientExecutor
 * @since  2.0.8
 * @author &lt;a href=&quot;mailto:xiaoymin@foxmail.com&quot;&gt;xiaoymin@foxmail.com&lt;/a&gt;
 * 2020/10/29 20:40
 */
public class OkHttpClientExecutor implements RouteExecutor {

    @Override
    public RouteResponse executor(RouteRequestContext routeContext) {
        return null;
    }
}
</code></pre>
<h3 id="9-apacheclientexecutor-路由执行器-apache-实现">9. ApacheClientExecutor 路由执行器 Apache 实现</h3>
<pre><code class="language-java">package com.light.cloud.common.web.openapi.aggregation.executor;

import cn.hutool.core.collection.CollectionUtil;
import com.github.xiaoymin.knife4j.aggre.core.RouteResponse;
import com.github.xiaoymin.knife4j.aggre.core.executor.ApacheClientResponse;
import com.github.xiaoymin.knife4j.aggre.core.executor.DefaultClientResponse;
import com.github.xiaoymin.knife4j.aggre.core.ext.PoolingConnectionManager;
import com.github.xiaoymin.knife4j.aggre.core.pojo.HeaderWrapper;
import com.light.cloud.common.web.openapi.aggregation.RouteRequestContext;
import jakarta.servlet.http.Part;
import org.apache.http.Header;
import org.apache.http.client.methods.CloseableHttpResponse;
import org.apache.http.client.methods.HttpUriRequest;
import org.apache.http.client.methods.RequestBuilder;
import org.apache.http.conn.HttpHostConnectException;
import org.apache.http.entity.BasicHttpEntity;
import org.apache.http.entity.ContentType;
import org.apache.http.entity.mime.HttpMultipartMode;
import org.apache.http.entity.mime.MultipartEntityBuilder;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.util.Map;

/***
 * @see com.github.xiaoymin.knife4j.aggre.core.executor.ApacheClientExecutor
 * 基于HttpClient组件的转发策略
 * @since  2.0.8
 * @author &lt;a href=&quot;mailto:xiaoymin@foxmail.com&quot;&gt;xiaoymin@foxmail.com&lt;/a&gt;
 * 2020/10/29 20:35
 */
public class ApacheClientExecutor extends PoolingConnectionManager implements RouteExecutor {

    Logger logger = LoggerFactory.getLogger(com.github.xiaoymin.knife4j.aggre.core.executor.ApacheClientExecutor.class);

    private HttpUriRequest buildRequest(RouteRequestContext routeContext) {
        RequestBuilder builder = RequestBuilder.create(routeContext.getMethod());
        if (logger.isDebugEnabled()) {
            logger.debug(&quot;ApacheClient Uri:{}&quot;, routeContext.getUrl());
        }
        builder.setUri(routeContext.getUrl());
        if (CollectionUtil.isNotEmpty(routeContext.getHeaders())) {
            // 构建Header
            for (HeaderWrapper headerWrapper : routeContext.getHeaders()) {
                builder.addHeader(headerWrapper.getName(), headerWrapper.getValue());
            }
        }
        if (CollectionUtil.isNotEmpty(routeContext.getParams())) {
            // 构建Params
            for (Map.Entry&lt;String, String&gt; entry : routeContext.getParams().entrySet()) {
                builder.addParameter(entry.getKey(), entry.getValue());
            }
        }
        if (routeContext.getRequestContent() != null) {
            // 文件请求是否为空 since 2.0.9
            if (CollectionUtil.isNotEmpty(routeContext.getParts())) {
                MultipartEntityBuilder partFileBuilder = MultipartEntityBuilder.create();
                partFileBuilder.setCharset(StandardCharsets.UTF_8);
                partFileBuilder.setMode(HttpMultipartMode.BROWSER_COMPATIBLE);
                // 从请求头获取context-type
                Header header = builder.getFirstHeader(&quot;content-type&quot;);
                if (header != null) {
                    // 赋值
                    partFileBuilder.setContentType(ContentType.parse(header.getValue()));
                }
                for (Part part : routeContext.getParts()) {
                    try {
                        partFileBuilder.addBinaryBody(part.getName(), part.getInputStream(), ContentType.MULTIPART_FORM_DATA, part.getSubmittedFileName());// 文件流
                    } catch (IOException e) {
                        logger.warn(&quot;add part file error,message:&quot; + e.getMessage());
                    }
                }
                builder.setEntity(partFileBuilder.build());
            } else {
                // 普通请求，构建请求体
                BasicHttpEntity basicHttpEntity = new BasicHttpEntity();
                basicHttpEntity.setContent(routeContext.getRequestContent());
                // if the entity contentLength isn&#x27;t set, transfer-encoding will be set
                // to chunked in org.apache.http.protocol.RequestContent. See gh-1042
                builder.setEntity(basicHttpEntity);
            }
        }
        builder.setConfig(getRequestConfig());
        return builder.build();
    }

    @Override
    public RouteResponse executor(RouteRequestContext routeContext) {
        RouteResponse routeResponse = null;
        try {
            // 判断当前接口是否需要执行basic
            CloseableHttpResponse closeableHttpResponse = getClient().execute(buildRequest(routeContext));
            routeResponse = new ApacheClientResponse(closeableHttpResponse);
        } catch (Exception e) {
            logger.error(&quot;Executor Failed,message:&quot; + e.getMessage(), e);
            // 当前异常有可能是服务下线导致
            if (e instanceof HttpHostConnectException) {
                // 服务下线，连接失败
                routeResponse = new DefaultClientResponse(routeContext.getOriginalUri(), e.getMessage(), 504);
            } else {
                routeResponse = new DefaultClientResponse(routeContext.getOriginalUri(), e.getMessage());
            }
        }
        return routeResponse;
    }

}

</code></pre>
<h3 id="10-aggregationconfig">10. AggregationConfig</h3>
<p><strong>注意</strong> 因为使用了knif4j集成依赖的一些实体对象，所以需要手动排除 <code>Knife4jAggregationAutoConfiguration</code> 配置类</p>
<pre><code class="language-java">package com.light.cloud.common.web.openapi.aggregation.config;

import cn.hutool.core.util.StrUtil;
import com.github.xiaoymin.knife4j.aggre.core.RouteCache;
import com.github.xiaoymin.knife4j.aggre.core.RouteRepository;
import com.github.xiaoymin.knife4j.aggre.core.cache.RouteInMemoryCache;
import com.github.xiaoymin.knife4j.aggre.core.common.ExecutorEnum;
import com.github.xiaoymin.knife4j.aggre.core.pojo.BasicAuth;
import com.github.xiaoymin.knife4j.aggre.core.pojo.SwaggerRoute;
import com.github.xiaoymin.knife4j.aggre.repository.CloudRepository;
import com.github.xiaoymin.knife4j.aggre.repository.DiskRepository;
import com.github.xiaoymin.knife4j.aggre.repository.EurekaRepository;
import com.github.xiaoymin.knife4j.aggre.repository.NacosRepository;
import com.github.xiaoymin.knife4j.aggre.spring.configuration.HttpConnectionSetting;
import com.github.xiaoymin.knife4j.aggre.spring.configuration.Knife4jAggregationProperties;
import com.github.xiaoymin.knife4j.aggre.spring.support.CloudSetting;
import com.github.xiaoymin.knife4j.aggre.spring.support.DiskSetting;
import com.github.xiaoymin.knife4j.aggre.spring.support.EurekaSetting;
import com.github.xiaoymin.knife4j.aggre.spring.support.NacosSetting;
import com.light.cloud.common.web.openapi.aggregation.RouteDispatcher;
import com.light.cloud.common.web.openapi.aggregation.filter.RouteProxyFilter;
import com.light.cloud.common.web.openapi.aggregation.filter.SecurityBasicAuthFilter;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.boot.web.servlet.FilterRegistrationBean;
import org.springframework.boot.web.servlet.filter.OrderedFormContentFilter;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Conditional;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.env.Environment;

import java.util.Objects;

/**
 * @see com.github.xiaoymin.knife4j.aggre.spring.configuration.Knife4jAggregationAutoConfiguration
 */
@Configuration
@EnableConfigurationProperties({Knife4jAggregationProperties.class, HttpConnectionSetting.class,
        DiskSetting.class, CloudSetting.class, EurekaSetting.class,
        NacosSetting.class, BasicAuth.class})
@ConditionalOnProperty(name = &quot;knife4j.enable-aggregation&quot;, havingValue = &quot;true&quot;)
public class AggregationConfig {

    final Environment environment;

    @Autowired
    public AggregationConfig(Environment environment) {
        this.environment = environment;
    }

    @Bean
    public RouteCache&lt;String, SwaggerRoute&gt; routeCache() {
        return new RouteInMemoryCache();
    }

    @Bean(initMethod = &quot;start&quot;, destroyMethod = &quot;close&quot;)
    @ConditionalOnProperty(name = &quot;knife4j.cloud.enable&quot;, havingValue = &quot;true&quot;)
    public CloudRepository cloudRepository(@Autowired Knife4jAggregationProperties knife4jAggregationProperties) {
        return new CloudRepository(knife4jAggregationProperties.getCloud());
    }

    @Bean(initMethod = &quot;start&quot;, destroyMethod = &quot;close&quot;)
    @ConditionalOnProperty(name = &quot;knife4j.eureka.enable&quot;, havingValue = &quot;true&quot;)
    public EurekaRepository eurekaRepository(@Autowired Knife4jAggregationProperties knife4jAggregationProperties) {
        return new EurekaRepository(knife4jAggregationProperties.getEureka());
    }

    @Bean(initMethod = &quot;start&quot;, destroyMethod = &quot;close&quot;)
    @ConditionalOnProperty(name = &quot;knife4j.nacos.enable&quot;, havingValue = &quot;true&quot;)
    public NacosRepository nacosRepository(@Autowired Knife4jAggregationProperties knife4jAggregationProperties) {
        return new NacosRepository(knife4jAggregationProperties.getNacos());
    }

    @Bean
    @ConditionalOnProperty(name = &quot;knife4j.disk.enable&quot;, havingValue = &quot;true&quot;)
    public DiskRepository diskRepository(@Autowired Knife4jAggregationProperties knife4jAggregationProperties) {
        return new DiskRepository(knife4jAggregationProperties.getDisk());
    }

    @Bean
    public RouteDispatcher routeDispatcher(@Autowired RouteRepository routeRepository,
                                           @Autowired RouteCache&lt;String, SwaggerRoute&gt; routeCache) {
        // 获取当前项目的contextPath
        String contextPath = Objects.toString(environment.getProperty(&quot;server.servlet.context-path&quot;), &quot;&quot;);
        if (StrUtil.isBlank(contextPath)) {
            contextPath = &quot;/&quot;;
        }
        if (StrUtil.isNotBlank(contextPath) &amp;&amp; !StrUtil.equals(contextPath, RouteDispatcher.ROUTE_BASE_PATH)) {
            // 判断是否/开头
            if (!StrUtil.startWith(contextPath, RouteDispatcher.ROUTE_BASE_PATH)) {
                contextPath = RouteDispatcher.ROUTE_BASE_PATH + contextPath;
            }
        }
        return new RouteDispatcher(routeRepository, routeCache, ExecutorEnum.APACHE, contextPath);
    }

    /**
     * 注意过滤器的顺序，如果此过滤器在鉴权过滤器后方，会导致转发失败
     * @param routeDispatcher
     * @return
     */
    @Bean
    public FilterRegistrationBean routeProxyFilter(@Autowired RouteDispatcher routeDispatcher) {
        FilterRegistrationBean filterRegistrationBean = new FilterRegistrationBean();
        filterRegistrationBean.setFilter(new RouteProxyFilter(routeDispatcher));
        filterRegistrationBean.setOrder(OrderedFormContentFilter.DEFAULT_ORDER + 1);
        filterRegistrationBean.setEnabled(true);
        filterRegistrationBean.addUrlPatterns(&quot;/*&quot;);
        return filterRegistrationBean;
    }

    @Bean
    @ConditionalOnProperty(name = &quot;knife4j.basic-auth.enable&quot;, havingValue = &quot;true&quot;)
    public FilterRegistrationBean routeBasicFilter(@Autowired Knife4jAggregationProperties knife4jAggregationProperties) {
        FilterRegistrationBean filterRegistrationBean = new FilterRegistrationBean();
        filterRegistrationBean.setFilter(new SecurityBasicAuthFilter(knife4jAggregationProperties.getBasicAuth()));
        filterRegistrationBean.setOrder(10);
        filterRegistrationBean.setEnabled(true);
        filterRegistrationBean.addUrlPatterns(&quot;/*&quot;);
        return filterRegistrationBean;
    }
}

</code></pre>
<h2 id="前端改造">前端改造</h2>
<ul>
<li>knife4j-openapi3-spring-boot-starter 4.5.0</li>
<li>knife4j-openapi3-ui 4.4.0</li>
<li>knife4j-openapi3-ui 4.5.0</li>
</ul>
<p>因为 knife4j 进行聚合后进行接口调试，需要根据 <code>knife4j-gateway-request</code> Header头进行路由，改造的主要目的是将这个参数添加到请求中</p>
<p>有些版本，如: <code>knife4j-openapi3-ui 4.1.0</code> 此属性拼写错误 <code>knfie4j-gateway-request</code></p>
<h3 id="1准备工作">1.准备工作</h3>
<h4 id="1-下载前端源码">1. 下载前端源码</h4>
<pre><code class="language-shell">git clone -b v4.5.0 https://github.com/xiaoymin/knife4j
</code></pre>
<h4 id="2-修改前端代理-dworkspacegithubknife4jknife4j-vuevueconfigjs">2. 修改前端代理 <code>D:\Workspace\Github\knife4j\knife4j-vue\vue.config.js</code></h4>
<pre><code class="language-js">proxy: {
    &quot;/&quot;: {
    //target: &#x27;http://localhost:8990/&#x27;,
    target: &#x27;http://localhost:31112/system/&#x27;,
    /* target: &#x27;http://knife4j.xiaominfo.com/&#x27;, */
    ws: true,
    changeOrigin: true
    }
}
</code></pre>
<h3 id="2-前端源码改造测试">2. 前端源码改造测试</h3>
<h4 id="1-修改接口调用-dworkspacegithubknife4jknife4j-vuesrccoreknife4jasyncjs">1. 修改接口调用 <code>D:\Workspace\Github\knife4j\knife4j-vue\src\core\Knife4jAsync.js</code></h4>
<p>将后台返回的 header 值设置到前端缓存的分组实例对象中，以便调用时读取</p>
<pre><code class="language-js">/**
 * 解析springdoc-OpenAPI
 * @param {*} data
 */
SwaggerBootstrapUi.prototype.analysisSpringDocOpenApiGroupSuccess = function (data) {
  var that = this;
  var t = typeof data;
  var groupData = null;
  if (t == &#x27;string&#x27;) {
    // groupData = JSON.parse(data)
    groupData = KUtils.json5parse(data);
  } else {
    groupData = data;
  }
  that.log(&#x27;响应分组json数据&#x27;);
  that.log(groupData);
  var serviceOptions = [];
  var allGroupIds = [];
  var groupUrls = KUtils.getValue(groupData, &#x27;urls&#x27;, [], true);
  var newGroupData = [];
  if (KUtils.arrNotEmpty(groupUrls)) {
    groupUrls.forEach(gu =&gt; {
      var newGroup = {
        name: KUtils.getValue(gu, &#x27;name&#x27;, &#x27;default&#x27;, true),
        url: KUtils.getValue(gu, &#x27;url&#x27;, &#x27;&#x27;, true),
        header: KUtils.getValue(gu, &#x27;header&#x27;, &#x27;&#x27;, true),                  // Add Line
        location: KUtils.getValue(gu, &#x27;url&#x27;, &#x27;&#x27;, true),
        swaggerVersion: &#x27;3.0.3&#x27;,
        tagSort: KUtils.getValue(groupData, &#x27;tagsSorter&#x27;, &#x27;order&#x27;, true),
        operationSort: KUtils.getValue(groupData, &#x27;operationsSorter&#x27;, &#x27;order&#x27;, true),
        servicePath: KUtils.getValue(gu, &#x27;servicePath&#x27;, null, true),
        contextPath: KUtils.getValue(gu, &#x27;contextPath&#x27;, null, true)
      };
      newGroupData.push(newGroup);
    })
  } else {
    // https://gitee.com/xiaoym/knife4j/issues/I5L440#note_12238431
    // 如果开发者没有创建bean对象，urls对象为空，取而代之的是直接返回url
    newGroupData.push({
      name: KUtils.getValue(groupData, &#x27;name&#x27;, &#x27;default&#x27;, true),
      url: KUtils.getValue(groupData, &#x27;url&#x27;, &#x27;&#x27;, true),
      location: KUtils.getValue(groupData, &#x27;url&#x27;, &#x27;&#x27;, true),
      swaggerVersion: &#x27;3.0.3&#x27;,
      tagSort: KUtils.getValue(groupData, &#x27;tagsSorter&#x27;, &#x27;order&#x27;, true),
      operationSort: KUtils.getValue(groupData, &#x27;operationsSorter&#x27;, &#x27;order&#x27;, true),
      servicePath: KUtils.getValue(groupData, &#x27;servicePath&#x27;, null, true),
      contextPath: KUtils.getValue(groupData, &#x27;contextPath&#x27;, null, true)
    })
  }
  newGroupData.forEach(function (group) {
    var g = new SwaggerBootstrapUiInstance(
      KUtils.toString(group.name, &#x27;&#x27;).replace(/\//g, &#x27;-&#x27;),
      group.location,
      group.swaggerVersion
    );
    console.log(&quot;groupInfo&quot;, group);                                // Add Line
    console.log(&quot;desktop&quot;, that.desktop);                           // Add Line
    console.log(&quot;desktopCode&quot;, that.desktopCode);                   // Add Line
    g.url = group.url.replace(&quot;/system&quot;, &quot;&quot;);                       // Add Line
    g.header = KUtils.getValue(group, &#x27;header&#x27;, &#x27;&#x27;, true),          // Add Line
    g.desktop = that.desktop;
    g.desktopCode = that.desktopCode;
    //排序规则2022.12.6
    g.tagSort = group.tagSort;
    g.operationSort = group.operationSort;
    //增加basePath，主要是网关聚合的场景
    g.servicePath = KUtils.getValue(group, &#x27;servicePath&#x27;, null, true);
    g.contextPath = KUtils.getValue(group, &#x27;contextPath&#x27;, null, true);
    // g.url=&#x27;/test/json&#x27;;
    var newUrl = &#x27;&#x27;;
    // 此处需要判断basePath路径的情况
    if (group.url != null &amp;&amp; group.url != undefined &amp;&amp; group.url != &#x27;&#x27;) {
      newUrl = group.url;
    } else {
      newUrl = group.location;
    }
    g.extUrl = newUrl;
    if (that.validateExtUrl == &#x27;&#x27;) {
      that.validateExtUrl = g.extUrl;
    }
    // 判断当前分组url是否存在basePath
    if (
      group.basePath != null &amp;&amp;
      group.basePath != undefined &amp;&amp;
      group.basePath != &#x27;&#x27;
    ) {
      g.baseUrl = group.basePath;
    }
    // 赋值查找缓存的id
    if (that.cacheApis.length &gt; 0) {
      var cainstance = null;
      that.cacheApis.forEach(ca =&gt; {
        if (ca.id == g.groupId) {
          cainstance = ca;
        }
      })
      /*  $.each(that.cacheApis, function (x, ca) {
         if (ca.id == g.groupId) {
           cainstance = ca
         }
       }) */
      if (cainstance != null) {
        g.firstLoad = false;
        // 判断旧版本是否包含updatesApi属性
        if (!cainstance.hasOwnProperty(&#x27;updateApis&#x27;)) {
          cainstance[&#x27;updateApis&#x27;] = {};
        }
        g.cacheInstance = cainstance;
        that.log(g);
        // g.groupApis=cainstance.cacheApis;
      } else {
        g.cacheInstance = new SwaggerBootstrapUiCacheApis({
          id: g.groupId,
          name: g.name
        });
      }
    } else {
      g.cacheInstance = new SwaggerBootstrapUiCacheApis({
        id: g.groupId,
        name: g.name
      });
    }
    // 双向绑定
    serviceOptions.push({
      label: g.name,
      value: g.id
    });
    // 增加所有分组id，为afterScript特性
    allGroupIds.push(g.id);
    that.instances.push(g);
  })
  // 赋值分组id
  if (KUtils.arrNotEmpty(that.instances)) {
    that.instances.forEach(inst =&gt; {
      inst.allGroupIds = allGroupIds;
    })
  }
  // 初始化所有
  this.serviceOptions = serviceOptions;
  this.store.dispatch(&#x27;globals/setServiceOptions&#x27;, serviceOptions);
  // that.$Vue.serviceOptions = serviceOptions;
  if (serviceOptions.length &gt; 0) {
    // that.$Vue.defaultServiceOption = serviceOptions[0].value;
    this.defaultServiceOption = serviceOptions[0].value;
    this.store.dispatch(&#x27;globals/setDefaultService&#x27;, serviceOptions[0].value);
  }
}
</code></pre>
<h4 id="2-dworkspacegithubknife4jknife4j-vuesrcviewsapidebugvue">2. <code>D:\Workspace\Github\knife4j\knife4j-vue\src\views\api\Debug.vue</code></h4>
<p>将分组实例对象中的header参数设置到请求的 header 中，实现接口的调用</p>
<pre><code class="language-js">    debugSendRawRequest() {
      // 发送raw类型的请求
      // console(&quot;发送raw接口&quot;);
      var validateForm = this.validateRawForm();
      if (validateForm.validate) {
        this.debugLoading = true;
        // 发送状态置为已发送请求
        this.debugSend = true;
        // raw类型的请求需要判断是何种类型
        var headers = this.debugHeaders();
        var url = this.debugUrl;
        var methodType = this.debugMethodType.toLowerCase();
        var data = this.rawText;
        var formParams = this.debugRawFormParams();
        // 得到key-value的参数值,对请求类型进行判断，判断是否为path
        if (this.debugPathFlag) {
          const realFormParams = {};
          // 是path类型的接口,需要对地址、参数进行replace处理
          this.debugPathParams.forEach(pathKey =&gt; {
            var replaceRege = &quot;{&quot; + pathKey + &quot;}&quot;;
            // var value = formParams[pathKey];
            var value = KUtils.getValue(formParams, pathKey, &quot;&quot;, true);
            url = url.replace(replaceRege, value);
          });
          for (var key in formParams) {
            // 判断key在debugPath中是否存在
            if (this.debugPathParams.indexOf(key) == -1) {
              // 不存在
              realFormParams[key] = formParams[key];
            }
          }
          // 重新赋值
          formParams = realFormParams;
        }
        var checkResult = this.checkUrlParams(url);
        if (checkResult.result) {
          url = checkResult.url;
          formParams = Object.assign(formParams, checkResult.params);
        }
        var baseUrl = &#x27;&#x27;;
        // 是否启用Host
        if (this.enableHost) {
          baseUrl = this.enableHostText;
        }
        var requestConfig = {
          baseURL: baseUrl,
          url: this.debugCheckUrl(url),
          method: methodType,
          headers: headers,
          params: formParams,
          data: data,
          // Cookie标志
          withCredentials: this.debugSendHasCookie(headers),
          timeout: 0
        }
        // 需要判断是否是下载请求
        // https://gitee.com/xiaoym/knife4j/issues/I1U4LA
        // 判断当前接口规范是OAS3还是Swagger2
        if (this.oas2) {
          // OAS2规范制定了produces的定义,需要判断请求头
          // 需要判断是否是下载请求
          if (this.debugStreamFlag()) {
            // 流请求
            requestConfig = { ...requestConfig, responseType: &quot;blob&quot; };
          }
        } else {
          // 统一追加一个blob类型的响应,在OpenAPI3.0的规范中,没有关于produces的设定，因此无法判断当前请求是否是流的请求
          // https://gitee.com/xiaoym/knife4j/issues/I374SP
          requestConfig = { ...requestConfig, responseType: &quot;blob&quot; };
        }
        // console(headers);
        // console(this.rawText);
        console.log(&quot;headers&quot;, headers);                              // Add Line
        console.log(&quot;formParams&quot;, formParams);                        // Add Line
        console.log(&quot;requestConfig&quot;, requestConfig);                  // Add Line
        requestConfig.url = requestConfig.url.replace(&quot;/system&quot;, &quot;&quot;)  // Add Line
        var startTime = new Date();
        DebugAxios.create()
          .request(requestConfig)
          .then(res =&gt; {
            this.debugLoading = false;
            this.handleDebugSuccess(startTime, new Date(), res);
          })
          .catch(err =&gt; {
            this.debugLoading = false;
            if (err.response) {
              this.handleDebugError(startTime, new Date(), err.response);
            } else {
              this.$message.error(err.message);
            }
          });
      } else {
        this.$message.info(validateForm.message);
      }
    },
</code></pre>
<p>改了上面的地方之后，应该就可以成功代理了</p>
<h3 id="3-后端静态文件改造思路">3. 后端静态文件改造思路</h3>
<pre><code class="language-shell"># 搜索下面方法
analysisSpringDocOpenApiGroupSuccess

# 找到对应的文件
app.5de26223.js   # knife4j-openapi2-ui 4.5.0
app.c31badf5.js   # knife4j-openapi3-ui 4.5.0
app.b0c0d7df.js   # knife4j-openapi3-ui 4.4.0

# 源码中的显眼单词定位 如： that.log(&#x27;响应分组json数据&#x27;); 中的 `响应分组json数据`

# 分别添加获取设置 header 的语句
url:re.a.getValue(e,&quot;url&quot;,&quot;&quot;,!0)
url:re.a.getValue(e,&quot;url&quot;,&quot;&quot;,!0),header:re.a.getValue(e,&quot;header&quot;,&quot;&quot;,!0)

url:re.a.getValue(t,&quot;url&quot;,&quot;&quot;,!0)
url:re.a.getValue(t,&quot;url&quot;,&quot;&quot;,!0),header:re.a.getValue(t,&quot;header&quot;,&quot;&quot;,!0)

t.servicePath=re.a.getValue(e,&quot;servicePath&quot;,null,!0)
t.servicePath=re.a.getValue(e,&quot;servicePath&quot;,null,!0),t.header=re.a.getValue(e,&quot;header&quot;,null,!0)

</code></pre>
<h2 id="问题">问题</h2>
<h3 id="1-接口的调用最好使用-knife4j-gateway-code-去除当前项目的context-path-否则会出现异常">1. 接口的调用最好使用 <code>knife4j-gateway-code</code> 去除当前项目的context-path 否则会出现异常</h3>
<h3 id="2-解决问题一如果项目本身需要使用聚合接口需要在所有接口前再添加一次-context-path">2. 【解决问题一】如果项目本身需要使用聚合接口，需要在所有接口前再添加一次 context-path</h3>
<pre><code class="language-java">@Bean
public OpenAPI openAPI() {
    // 添加 components 后可以重复引用
    Components components = new Components()
            .addParameters(PlatformConstant.HEADER_CLIENT_ID, clientId())
            .addParameters(PlatformConstant.HEADER_AUTHORIZATION, authorization());
    return new OpenAPI()
            .info(
                    new Info().title(serviceName)
                            .description(openapiProperties.getDescription())
                            .version(openapiProperties.getVersion())
                            .license(new License()
                                    .name(openapiProperties.getLicenseName())
                                    .url(openapiProperties.getLicenseUrl()))
                            .contact(new Contact()
                                    .name(openapiProperties.getContactName())
                                    .email(openapiProperties.getContactEmail())
                                    .url(openapiProperties.getContactUrl()))
                            .termsOfService(openapiProperties.getTermsOfServiceUrl())
            )
            //外部文档
            .externalDocs(new ExternalDocumentation()
                    .description(&quot;官方文档&quot;).url(&quot;https://springdoc.org&quot;)
            )
            // webhooks
//                .webhooks(new HashMap&lt;&gt;())
            // 全局统一安全认证配置 一个key对应一个schema（安全配置），
            // 对接口添加 @SecurityRequirement 可使用不同的安全规则
            .schemaRequirement(PlatformConstant.HEADER_AUTHORIZATION, apikeySecuritySchema())
//                .schemaRequirement(PlatformConstant.HEADER_CLIENT_ID, apikeySecuritySchema())
//                .schemaRequirement(HttpHeaders.AUTHORIZATION, oauth2SecuritySchema())
            // 全局安全校验项，也可以在对应的controller上加注解SecurityRequirement
            .addSecurityItem(new SecurityRequirement().addList(PlatformConstant.HEADER_AUTHORIZATION))
            // 组件定义
            .components(components);
}

/**
 * 添加全局的请求头参数，并为所有接口添加context-path
 */
@Bean
public OpenApiCustomizer customerGlobalOpenApiCustomizer() {
    return openApi -&gt; {
        Paths paths = openApi.getPaths();
        String[] pathSet = paths.keySet().toArray(new String[0]);
        for (String path : pathSet) {
            PathItem pathItem = paths.get(path);
            // 添加全局的请求头参数
            pathItem.readOperations().forEach(operation -&gt; {
                // 引用在 OpenAPI 中定义的 components
                operation.addParametersItem(new HeaderParameter().$ref(&quot;#/components/parameters/&quot; + PlatformConstant.HEADER_CLIENT_ID))
                        .addParametersItem(new HeaderParameter().$ref(&quot;#/components/parameters/&quot; + PlatformConstant.HEADER_AUTHORIZATION));
            });
            // 为接口添加 context-path
            paths.put(contextPath + path, pathItem);
            paths.remove(path);
        }
    };
}
</code></pre>
<p>Note: 这种方式会导致直接调用本地接口（非聚合方式）报错</p>
<h3 id="3-对于项目默认需要token校验的可以使用-components-实现参数的复用">3. 对于项目默认需要Token校验的，可以使用 components 实现参数的复用</h3>
<h3 id="4-一个自定义动态注册-requestmapping-的-bug">4. 一个自定义动态注册 RequestMapping 的 Bug</h3>
<ul>
<li><a href="https://blog.csdn.net/mole_exp/article/details/123992395">Java内存马-SpringMVC篇</a></li>
<li><a href="https://blog.csdn.net/maple_son/article/details/122572869">springboot 2.6.x 自定义注册 RequestMapping</a></li>
</ul>
<pre><code class="language-shell">java.lang.IllegalArgumentException:  Expected lookupPath in request attribute &quot;org.springframework.web.util.UrlPathHelper.PATH&quot;.
</code></pre>
<pre><code class="language-yaml">spring:
  # Spring MVC 处理映射匹配的默认策略已从AntPathMatcher更改为PathPatternParser。
  # 此处配置为使用AntPathMatcher兼容 swagger 相关的路径匹配
  mvc:
    path-match:
      matching-strategy: ANT_PATH_MATCHER
</code></pre></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/lorchr/light-docusaurus/tree/main/docs/zh-cn/spring-boot/23-Spring-Boot-Integrate-SpringDoc-Aggregation.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/light-docusaurus/docs/zh-cn/spring-boot/Enhance-Request-And-Response/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Enhance-Request-And-Response</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/light-docusaurus/docs/zh-cn/spring-boot/file/File-Upload-Split-Continue-on-Break/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">File-Upload-Split-Continue-on-Break</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#简单集成" class="table-of-contents__link toc-highlight">简单集成</a><ul><li><a href="#1-添加依赖项" class="table-of-contents__link toc-highlight">1. 添加依赖项</a></li><li><a href="#2-添加配置" class="table-of-contents__link toc-highlight">2. 添加配置</a></li><li><a href="#3-openapiproperties-属性定义" class="table-of-contents__link toc-highlight">3. OpenapiProperties 属性定义</a></li><li><a href="#4-routedefinition-路由定义" class="table-of-contents__link toc-highlight">4. RouteDefinition 路由定义</a></li><li><a href="#5-openapiconfig-配置类" class="table-of-contents__link toc-highlight">5. OpenapiConfig 配置类</a></li><li><a href="#6-springdocconfig-配置类" class="table-of-contents__link toc-highlight">6. SpringDocConfig 配置类</a></li><li><a href="#7openapiadditionalbeanregistry-动态注册类" class="table-of-contents__link toc-highlight">7.OpenapiAdditionalBeanRegistry 动态注册类</a></li></ul></li><li><a href="#聚合api文档" class="table-of-contents__link toc-highlight">聚合Api文档</a><ul><li><a href="#1-添加依赖项-1" class="table-of-contents__link toc-highlight">1. 添加依赖项</a></li><li><a href="#2-添加配置-1" class="table-of-contents__link toc-highlight">2. 添加配置</a></li><li><a href="#3-routeproxyfilter-路由过滤器" class="table-of-contents__link toc-highlight">3. RouteProxyFilter 路由过滤器</a></li><li><a href="#4-securitybasicauthfilter-认证过滤器" class="table-of-contents__link toc-highlight">4. SecurityBasicAuthFilter 认证过滤器</a></li><li><a href="#5-routedispatcher-路由分发器" class="table-of-contents__link toc-highlight">5. RouteDispatcher 路由分发器</a></li><li><a href="#6-routerequestcontext-路由上下文" class="table-of-contents__link toc-highlight">6. RouteRequestContext 路由上下文</a></li><li><a href="#7-routeexecutor-路由执行器" class="table-of-contents__link toc-highlight">7. RouteExecutor 路由执行器</a></li><li><a href="#8-okhttpclientexecutor-路由执行器-okhttp-实现" class="table-of-contents__link toc-highlight">8. OkHttpClientExecutor 路由执行器 OkHttp 实现</a></li><li><a href="#9-apacheclientexecutor-路由执行器-apache-实现" class="table-of-contents__link toc-highlight">9. ApacheClientExecutor 路由执行器 Apache 实现</a></li><li><a href="#10-aggregationconfig" class="table-of-contents__link toc-highlight">10. AggregationConfig</a></li></ul></li><li><a href="#前端改造" class="table-of-contents__link toc-highlight">前端改造</a><ul><li><a href="#1准备工作" class="table-of-contents__link toc-highlight">1.准备工作</a></li><li><a href="#2-前端源码改造测试" class="table-of-contents__link toc-highlight">2. 前端源码改造测试</a></li><li><a href="#3-后端静态文件改造思路" class="table-of-contents__link toc-highlight">3. 后端静态文件改造思路</a></li></ul></li><li><a href="#问题" class="table-of-contents__link toc-highlight">问题</a><ul><li><a href="#1-接口的调用最好使用-knife4j-gateway-code-去除当前项目的context-path-否则会出现异常" class="table-of-contents__link toc-highlight">1. 接口的调用最好使用 <code>knife4j-gateway-code</code> 去除当前项目的context-path 否则会出现异常</a></li><li><a href="#2-解决问题一如果项目本身需要使用聚合接口需要在所有接口前再添加一次-context-path" class="table-of-contents__link toc-highlight">2. 【解决问题一】如果项目本身需要使用聚合接口，需要在所有接口前再添加一次 context-path</a></li><li><a href="#3-对于项目默认需要token校验的可以使用-components-实现参数的复用" class="table-of-contents__link toc-highlight">3. 对于项目默认需要Token校验的，可以使用 components 实现参数的复用</a></li><li><a href="#4-一个自定义动态注册-requestmapping-的-bug" class="table-of-contents__link toc-highlight">4. 一个自定义动态注册 RequestMapping 的 Bug</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/docs/category/guide/">Torch</a></li><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/middleware/">Middleware</a></li><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/electron/">Electron</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/lorchr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/light-docusaurus/diy/">DIY</a></li><li class="footer__item"><a href="https://github.com/lorchr/light-docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Offical</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Home<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docusaurus.io/docs/playground" target="_blank" rel="noopener noreferrer" class="footer__link-item">Playground<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Light-Docusaurus, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>