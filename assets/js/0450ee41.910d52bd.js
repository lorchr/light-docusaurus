"use strict";(self.webpackChunklight_docusaurus=self.webpackChunklight_docusaurus||[]).push([[91707],{28453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>d});var i=r(96540);const s={},l=i.createContext(s);function t(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(l.Provider,{value:n},e.children)}},35195:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"zh-cn/spring-security/Spring-Security-Kerberos-With-MiniKDC","title":"Spring-Security-Kerberos-With-MiniKDC","description":"- krb5-server Docker","source":"@site/docs/zh-cn/spring-security/2-Spring-Security-Kerberos-With-MiniKDC.md","sourceDirName":"zh-cn/spring-security","slug":"/zh-cn/spring-security/Spring-Security-Kerberos-With-MiniKDC","permalink":"/docs/zh-cn/spring-security/Spring-Security-Kerberos-With-MiniKDC","draft":false,"unlisted":false,"editUrl":"https://github.com/lorchr/light-docusaurus/tree/main/docs/zh-cn/spring-security/2-Spring-Security-Kerberos-With-MiniKDC.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"troch","previous":{"title":"Spring-Security-Saml-With-Keycloak","permalink":"/docs/zh-cn/spring-security/Spring-Security-Saml-With-Keycloak"},"next":{"title":"Service-For-AD-Login","permalink":"/docs/zh-cn/spring-security/Service-For-AD-Login"}}');var s=r(74848),l=r(28453);const t={},d=void 0,c={},a=[{value:"\u90e8\u7f72MiniKDC",id:"\u90e8\u7f72minikdc",level:2},{value:"\u90e8\u7f72Krb5-Server",id:"\u90e8\u7f72krb5-server",level:2},{value:"\u90e8\u7f72ApacheDS",id:"\u90e8\u7f72apacheds",level:2},{value:"1. \u5b89\u88c5 ApacheDS",id:"1-\u5b89\u88c5-apacheds",level:3},{value:"2. \u5b89\u88c5 ApacheDS Studio",id:"2-\u5b89\u88c5-apacheds-studio",level:3},{value:"1. \u914d\u7f6e LDAP",id:"1-\u914d\u7f6e-ldap",level:3},{value:"3. \u914d\u7f6e Kerberos",id:"3-\u914d\u7f6e-kerberos",level:3},{value:"\u90e8\u7f72Apache Kerby",id:"\u90e8\u7f72apache-kerby",level:2},{value:"1. \u51c6\u5907\u914d\u7f6e\u6587\u4ef6",id:"1-\u51c6\u5907\u914d\u7f6e\u6587\u4ef6",level:3},{value:"Kerberos\u8ba4\u8bc1\uff08\u4e00\uff09\u2014\u2014\u7b80\u660e\u8be6\u7ec6\u7684\u5b89\u88c5\u548c\u8bf4\u660e",id:"kerberos\u8ba4\u8bc1\u4e00\u7b80\u660e\u8be6\u7ec6\u7684\u5b89\u88c5\u548c\u8bf4\u660e",level:2},{value:"\u51c6\u5907",id:"\u51c6\u5907",level:3},{value:"\u4e00\u3001\u5b89\u88c5Kerberos server",id:"\u4e00\u5b89\u88c5kerberos-server",level:3},{value:"\u5b89\u88c5\u6307\u4ee4",id:"\u5b89\u88c5\u6307\u4ee4",level:4},{value:"\u4fee\u6539 krb5.conf",id:"\u4fee\u6539-krb5conf",level:4},{value:"\u914d\u7f6e kdc.conf",id:"\u914d\u7f6e-kdcconf",level:4},{value:"\u914d\u7f6e kadm5.acl",id:"\u914d\u7f6e-kadm5acl",level:4},{value:"\u521b\u5efa\u6570\u636e\u5e93",id:"\u521b\u5efa\u6570\u636e\u5e93",level:4},{value:"\u542f\u52a8\u670d\u52a1",id:"\u542f\u52a8\u670d\u52a1",level:4},{value:"\u521b\u5efa\u7ba1\u7406\u5458",id:"\u521b\u5efa\u7ba1\u7406\u5458",level:4},{value:"kadmin.local",id:"kadminlocal",level:4},{value:"\u4e8c\u3001\u5b89\u88c5Kerberos client",id:"\u4e8c\u5b89\u88c5kerberos-client",level:3},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:4},{value:"\u4fee\u6539\u914d\u7f6e",id:"\u4fee\u6539\u914d\u7f6e",level:4},{value:"\u6d4b\u8bd5kadmin",id:"\u6d4b\u8bd5kadmin",level:4},{value:"\u4e09\u3001\u5e38\u89c1\u64cd\u4f5c\u6307\u4ee4",id:"\u4e09\u5e38\u89c1\u64cd\u4f5c\u6307\u4ee4",level:3},{value:"Kerberos\u5e38\u7528\u547d\u4ee4",id:"kerberos\u5e38\u7528\u547d\u4ee4",level:4},{value:"kadmin\u6a21\u5f0f\u4e0b\u5e38\u7528\u547d\u4ee4",id:"kadmin\u6a21\u5f0f\u4e0b\u5e38\u7528\u547d\u4ee4",level:4},{value:"kadmin\uff08\u6570\u636e\u5e93\u7ba1\u7406\uff09",id:"kadmin\u6570\u636e\u5e93\u7ba1\u7406",level:4},{value:"kinit(\u5728\u5ba2\u6237\u7aef\u8ba4\u8bc1\u7528\u6237)",id:"kinit\u5728\u5ba2\u6237\u7aef\u8ba4\u8bc1\u7528\u6237",level:4},{value:"\u5bfc\u51fakeytab\u8ba4\u8bc1\u6587\u4ef6(\u5728KDC\u4f7f\u7528)",id:"\u5bfc\u51fakeytab\u8ba4\u8bc1\u6587\u4ef6\u5728kdc\u4f7f\u7528",level:4},{value:"4\u3001kdestroy(\u5220\u9664\u5f53\u524d\u7684\u8ba4\u8bc1\u7f13\u5b58)",id:"4kdestroy\u5220\u9664\u5f53\u524d\u7684\u8ba4\u8bc1\u7f13\u5b58",level:4},{value:"5\u3001\u7528\u6237\u8ba4\u8bc1\uff08\u767b\u5f55\uff09",id:"5\u7528\u6237\u8ba4\u8bc1\u767b\u5f55",level:4},{value:"\u56db\u3001\u5e38\u89c1\u9519\u8bef\u4fe1\u606f",id:"\u56db\u5e38\u89c1\u9519\u8bef\u4fe1\u606f",level:3},{value:"1. <code>kinit: Cannot contact any KDC for realm &#39;LIGHT.LOCAL&#39; while getting initial credentials</code>",id:"1-kinit-cannot-contact-any-kdc-for-realm-lightlocal-while-getting-initial-credentials",level:4},{value:"2. <code>Client not found in Kerberos database (6) - CLIENT_NOT_FOUND</code>",id:"2-client-not-found-in-kerberos-database-6---client_not_found",level:4},{value:"\u5176\u4ed6",id:"\u5176\u4ed6",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://hub.docker.com/r/gcavalcante8808/krb5-server",children:"krb5-server Docker"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://github.com/gcavalcante8808/docker-krb5-server",children:"krb5-server Github"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://github.com/eugenp/tutorials/tree/master/spring-security-modules/spring-security-oauth2-sso/spring-security-sso-kerberos",children:"KDC Server"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.baeldung.com/spring-security-kerberos-integration",children:"Spring Security Kerberos Integration With MiniKdc"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://github.com/eugenp/tutorials/tree/master/spring-security-modules/spring-security-oauth2-sso/spring-security-sso-kerberos",children:"Spring Security Kerberos Integration With MiniKdc Github"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.kerberos.org/",children:"kerberos \u5b98\u7f51"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://kerberos.org/dist/index.html",children:"kerberos \u5b98\u65b9\u6587\u6863"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"http://web.mit.edu/kerberos/krb5-current/doc/",children:"kerberos \u5b98\u65b9\u6587\u6863"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://web.mit.edu/kerberos/krb5-latest/doc/admin/install_kdc.html#",children:"krb5 server\u5b89\u88c5"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.cnblogs.com/liugp/p/16468514.html",children:"Kerberos\u8ba4\u8bc1\u539f\u7406\u4e0e\u73af\u5883\u90e8\u7f72"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://blog.csdn.net/tktttt/article/details/111151776",children:"kerberos\u8ba4\u8bc1\u642d\u5efa\u5b89\u88c5"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"http://www.yashinu.com/w4/show-4459476.html",children:"Spring Security Kerberos windows \u8eab\u4efd\u9a8c\u8bc1\u4e2d\u7684\u9519\u8bef"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://blog.51cto.com/u_15101587/2623920",children:"\u4f7f\u7528Spring\u62e6\u622a\u5668\u5b9e\u73b0SPNEGO\u670d\u52a1\u7aef"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.thetechnojournals.com/2019/12/integratedkerberos-authentication-using.html",children:"https://www.thetechnojournals.com/2019/12/integratedkerberos-authentication-using.html"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://github.com/thetechnojournals/spring-tutorials/blob/master/KerberosAuthTutorial",children:"https://github.com/thetechnojournals/spring-tutorials/blob/master/KerberosAuthTutorial"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://blog.csdn.net/weixin_40496191/article/details/124056421",children:"https://blog.csdn.net/weixin_40496191/article/details/124056421"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://blog.csdn.net/weixin_40496191/article/details/124056953",children:"https://blog.csdn.net/weixin_40496191/article/details/124056953"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://directory.apache.org/kerby/",children:"Apache kerby"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://directory.apache.org/apacheds/kerberos-user-guide.html",children:"ApacheDS"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u90e8\u7f72minikdc",children:"\u90e8\u7f72MiniKDC"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"git clone https://github.com/eugenp/tutorials\n\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u90e8\u7f72krb5-server",children:"\u90e8\u7f72Krb5-Server"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"git clone https://github.com/gcavalcante8808/docker-krb5-server\n\ndocker run --detach \\\n    --publish 4088:88 \\\n    --publish 4464:464 \\\n    --publish 4749:749 \\\n    --volume krb5kdc-data:/var/lib/krb5kdc\\\n    --env KRB5_REALM=EXAMPLE.COM \\\n    --env KRB5_KDC=localhost \\\n    --env KRB5_PASS=mypass \\\n    --ip 172.18.0.199 \\\n    --hostname krb5.light.local \\\n    --network dev \\\n    --restart=no \\\n    --name krb5-server \\\n    gcavalcante8808/krb5-server\n\ndocker exec -it -u root krb5-server /bin/bash\n\ncat /etc/krb5.conf\n\n# Will prompt for the password provided or the generated.\nkinit admin/admin@EXAMPLE.COM\nklist\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-conf",children:"[libdefaults]\n dns_lookup_realm = false\n ticket_lifetime = 24h\n renew_lifetime = 7d\n forwardable = true\n rdns = false\n default_realm = EXAMPLE.COM\n \n[realms]\n EXAMPLE.COM = {\n    kdc = localhost\n    admin_server = localhost\n }\n\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u90e8\u7f72apacheds",children:"\u90e8\u7f72ApacheDS"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://directory.apache.org/apacheds/kerberos-user-guide.html",children:"ApacheDS Kerberos"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://directory.apache.org/",children:"ApacheDS"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://directory.apache.org/apacheds/",children:"Download"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://directory.apache.org/studio",children:"Studio Client"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/apache/directory-server",children:"Apache Directory Server"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://hub.docker.com/r/itzg/apacheds",children:"itzg ApacheDS Docker"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1-\u5b89\u88c5-apacheds",children:"1. \u5b89\u88c5 ApacheDS"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"# docker stop apache-ds && docker remove apache-ds\ndocker run --detach \\\n  --publish 10389:10389 \\\n  --publish 10636:10636 \\\n  --publish 60088:60088 \\\n  --publish 60464:60464 \\\n  --ip 172.18.0.99 \\\n  --hostname ds.light.local \\\n  --add-host sp.light.local:10.106.136.62 \\\n  --network dev \\\n  --restart=no \\\n  --name apache-ds \\\n  itzg/apacheds:latest\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u547d\u4ee4\u884c\u6d4b\u8bd5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'# apache-ds\u955c\u50cf\u4e2d\u6ca1\u6709 ldapsearch \u53ef\u4ee5\u4f7f\u7528openldap\u6765\u6d4b\u8bd5\ndocker exec -it -u root openldap /bin/bash\nldapsearch -x -H ldap://apache-ds:10389 -b ou=system -D "uid=admin,ou=system" -w secret\n\ndocker exec openldap ldapsearch -x -H ldap://apache-ds:10389 -b ou=system -D "uid=admin,ou=system" -w secret\n\n# extended LDIF\n#\n# LDAPv3\n# base <ou=system> with scope subtree\n# filter: (objectclass=*)\n# requesting: ALL\n#\n\n# system\ndn: ou=system\nou: system\nobjectClass: top\nobjectClass: organizationalUnit\nobjectClass: extensibleObject\n\n# partitions, configuration, system\ndn: ou=partitions,ou=configuration,ou=system\nou: partitions\nobjectClass: top\nobjectClass: organizationalUnit\n\n# services, configuration, system\ndn: ou=services,ou=configuration,ou=system\nou: services\nobjectClass: top\nobjectClass: organizationalUnit\n\n# consumers, system\ndn: ou=consumers,ou=system\nou: consumers\nobjectclass: top\nobjectclass: organizationalUnit\n\n# interceptors, configuration, system\ndn: ou=interceptors,ou=configuration,ou=system\nou: interceptors\nobjectClass: top\nobjectClass: organizationalUnit\n\n# groups, system\ndn: ou=groups,ou=system\nou: groups\nobjectClass: top\nobjectClass: organizationalUnit\n\n# admin, system\ndn: uid=admin,ou=system\nkeyAlgorithm: RSA\nprivateKeyFormat: PKCS#8\ndisplayName: Directory Superuser\nsn: administrator\ncn: system administrator\nobjectClass: top\nobjectClass: person\nobjectClass: organizationalPerson\nobjectClass: inetOrgPerson\nobjectClass: tlsKeyInfo\nuserCertificate:: MIIBdzCCASECBgGOCFajizANBgkqhkiG9w0BAQUFADBCMQswCQYDVQQGEwJV\n UzEMMAoGA1UEChMDQVNGMRIwEAYDVQQLEwlEaXJlY3RvcnkxETAPBgNVBAMTCEFwYWNoZURTMB4XD\n TI0MDMwNDA3MjExOVoXDTI1MDMwNDA3MjExOVowRjELMAkGA1UEBhMCVVMxDDAKBgNVBAoTA0FTRj\n ESMBAGA1UECxMJRGlyZWN0b3J5MRUwEwYDVQQDEww1YmIyMWE4N2VmMGEwXDANBgkqhkiG9w0BAQE\n FAANLADBIAkEAl+N1WqoGyc+T/IJeLzpnj886ljvcEZitS+hO5FF6RIWoDcuy9qCI5aqbQpOlgGty\n skOoxSdMNiFkKyKgEhFHEQIDAQABMA0GCSqGSIb3DQEBBQUAA0EASM2e5vNZ9ByhgUbyBIV6oQgpD\n AL4vlCOGoTUYUPIkz1sTGzRzLTvRAHneURdy9GXXkwk3PZgraoPsJfOAdf9Jw==\nuserPassword:: c2VjcmV0\npublicKey:: MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAJfjdVqqBsnPk/yCXi86Z4/POpY73BGYrU\n voTuRRekSFqA3LsvagiOWqm0KTpYBrcrJDqMUnTDYhZCsioBIRRxECAwEAAQ==\npublicKeyFormat: X.509\nuid: admin\nprivateKey:: MIIBUwIBADANBgkqhkiG9w0BAQEFAASCAT0wggE5AgEAAkEAl+N1WqoGyc+T/IJeL\n zpnj886ljvcEZitS+hO5FF6RIWoDcuy9qCI5aqbQpOlgGtyskOoxSdMNiFkKyKgEhFHEQIDAQABAj\n 8jAUkKnCT0XeK9T05llBBKFHhsJ1+Qrp9B30hPVnfXUprtfqRU4LERq6gd/JcHYO5bGzsry6bmE8b\n JpAfll1ECIQDc88/f7H0livaDPXVCmChU1uCOgyotUaLvWzZCzxPbFQIhAK/7LWuobQzOSM8tt4WN\n R6EtqlF18N8iaiuiuRWBYEsNAiA89IZEoFlmIhAf5LSUyqVVwnHw3v6jwgHRRriRdc9kgQIhAKh1C\n bqnxJPgl+PzAF2Qq0PH4eUOwF/oordYklHaweG1AiB74pWqLejWwzwz54bw7SC1wKGSPNIrO5z/ng\n P6EfpoYw==\n\n# configuration, system\ndn: ou=configuration,ou=system\nou: configuration\nobjectClass: top\nobjectClass: organizationalUnit\n\n# sysPrefRoot, system\ndn: prefNodeName=sysPrefRoot,ou=system\nobjectClass: top\nobjectClass: organizationalUnit\nobjectClass: extensibleObject\nprefNodeName: sysPrefRoot\n\n# users, system\ndn: ou=users,ou=system\nou: users\nobjectClass: top\nobjectClass: organizationalUnit\n\n# Administrators, groups, system\ndn: cn=Administrators,ou=groups,ou=system\nuniqueMember: 0.9.2342.19200300.100.1.1=admin,2.5.4.11=system\ncn: Administrators\nobjectClass: top\nobjectClass: groupOfUniqueNames\n\n# search result\nsearch: 2\nresult: 0 Success\n\n# numResponses: 12\n# numEntries: 11\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Account","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"user: uid=admin,ou=system  password secret"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-\u5b89\u88c5-apacheds-studio",children:"2. \u5b89\u88c5 ApacheDS Studio"}),"\n",(0,s.jsx)(n.p,{children:"\u8981\u5b89\u88c5\u548c\u914d\u7f6eApacheDS\u4ee5\u53caLDAP\u548cKerberos\uff0c\u8bf7\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u64cd\u4f5c\uff1a"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"\u4e0b\u8f7dApacheDS\uff1a\u9996\u5148\uff0c\u4eceApacheDS\u5b98\u65b9\u7f51\u7ad9\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\u7684ApacheDS\u3002\u4e0b\u8f7d\u5b8c\u6210\u540e\uff0c\u89e3\u538b\u7f29\u6587\u4ef6\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u542f\u52a8ApacheDS\uff1a\u8fdb\u5165\u89e3\u538b\u7f29\u540e\u7684ApacheDS\u76ee\u5f55\uff0c\u5728\u547d\u4ee4\u884c\u4e2d\u8fd0\u884c./bin/apacheds.sh start\uff08\u5bf9\u4e8eWindows\u7528\u6237\uff0c\u8fd0\u884c./bin/apacheds.bat start\uff09\u3002\u8fd9\u5c06\u542f\u52a8ApacheDS\u670d\u52a1\u5668\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u8fd0\u884cApacheDS Studio\uff1aApacheDS Studio\u662f\u4e00\u4e2a\u7528\u4e8e\u7ba1\u7406\u548c\u914d\u7f6eLDAP\u76ee\u5f55\u7684\u56fe\u5f62\u5316\u5de5\u5177\u3002\u6253\u5f00ApacheDS Studio\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8fde\u63a5\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1-\u914d\u7f6e-ldap",children:"1. \u914d\u7f6e LDAP"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u521b\u5efaLDAP\u670d\u52a1\uff1a\u5728ApacheDS Studio\u4e2d\uff0c\u53f3\u952e\u5355\u51fb\u201cLDAP Servers\u201d\u6587\u4ef6\u5939\uff0c\u9009\u62e9\u201cNew\u201d -> \u201cLDAP Server\u201d\u3002\u586b\u5199\u4ee5\u4e0b\u4fe1\u606f\uff1a","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Server Name: \u8f93\u5165\u4e00\u4e2a\u540d\u79f0\u4ee5\u6807\u8bc6LDAP\u670d\u52a1\u5668\u3002"}),"\n",(0,s.jsx)(n.li,{children:"Host Name: \u8f93\u5165\u672c\u5730\u4e3b\u673a\u540d\u6216IP\u5730\u5740\u3002"}),"\n",(0,s.jsx)(n.li,{children:"Port: \u8f93\u5165LDAP\u670d\u52a1\u5668\u7684\u7aef\u53e3\u53f7\uff08\u9ed8\u8ba4\u662f389\uff09\u3002"}),"\n",(0,s.jsx)(n.li,{children:'User Name: \u8f93\u5165\u7ba1\u7406\u5458\u7528\u6237\u540d\uff08\u9ed8\u8ba4\u662f"uid=admin,ou=system"\uff09\u3002'}),"\n",(0,s.jsx)(n.li,{children:'Password: \u8f93\u5165\u7ba1\u7406\u5458\u5bc6\u7801\uff08\u9ed8\u8ba4\u662f"secret"\uff09\u3002'}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"\u70b9\u51fb\u201cNext\u201d\u5e76\u5b8c\u6210\u914d\u7f6e\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-\u914d\u7f6e-kerberos",children:"3. \u914d\u7f6e Kerberos"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u521b\u5efaKerberos\u670d\u52a1\uff1a\u5728ApacheDS Studio\u4e2d\uff0c\u53f3\u952e\u5355\u51fb\u201cKerberos Servers\u201d\u6587\u4ef6\u5939\uff0c\u9009\u62e9\u201cNew\u201d -> \u201cKerberos Server\u201d\u3002\u586b\u5199\u4ee5\u4e0b\u4fe1\u606f\uff1a","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Server Name: \u8f93\u5165\u4e00\u4e2a\u540d\u79f0\u4ee5\u6807\u8bc6Kerberos\u670d\u52a1\u5668\u3002"}),"\n",(0,s.jsx)(n.li,{children:"Host Name: \u8f93\u5165\u672c\u5730\u4e3b\u673a\u540d\u6216IP\u5730\u5740\u3002"}),"\n",(0,s.jsx)(n.li,{children:"Port: \u8f93\u5165Kerberos\u670d\u52a1\u5668\u7684\u7aef\u53e3\u53f7\uff08\u9ed8\u8ba4\u662f60088\uff09\u3002"}),"\n",(0,s.jsx)(n.li,{children:'User Name: \u8f93\u5165\u7ba1\u7406\u5458\u7528\u6237\u540d\uff08\u9ed8\u8ba4\u662f"uid=admin,ou=system"\uff09\u3002'}),"\n",(0,s.jsx)(n.li,{children:'Password: \u8f93\u5165\u7ba1\u7406\u5458\u5bc6\u7801\uff08\u9ed8\u8ba4\u662f"secret"\uff09\u3002'}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"\u70b9\u51fb\u201cNext\u201d\u5e76\u5b8c\u6210\u914d\u7f6e\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u914d\u7f6eLDAP\u548cKerberos\uff1a\u5728ApacheDS Studio\u4e2d\uff0c\u53cc\u51fbLDAP\u670d\u52a1\u5668\u548cKerberos\u670d\u52a1\u5668\u4ee5\u6253\u5f00\u76f8\u5e94\u7684\u914d\u7f6e\u754c\u9762\u3002\u5728\u8fd9\u4e9b\u754c\u9762\u4e0a\uff0c\u60a8\u53ef\u4ee5\u914d\u7f6eLDAP\u76ee\u5f55\u548cKerberos\u7684\u5404\u79cd\u5c5e\u6027\u548c\u8bbe\u7f6e\u3002\u6839\u636e\u60a8\u7684\u9700\u6c42\u8fdb\u884c\u76f8\u5e94\u7684\u914d\u7f6e\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u6d4b\u8bd5LDAP\u548cKerberos\uff1a\u4f7f\u7528ApacheDS Studio\u6216\u5176\u4ed6LDAP\u548cKerberos\u5ba2\u6237\u7aef\u5de5\u5177\uff0c\u8fde\u63a5\u5230ApacheDS\u670d\u52a1\u5668\u5e76\u8fdb\u884c\u6d4b\u8bd5\u3002\u60a8\u53ef\u4ee5\u6267\u884cLDAP\u67e5\u8be2\u3001Kerberos\u8ba4\u8bc1\u7b49\u64cd\u4f5c\u6765\u9a8c\u8bc1\u5b89\u88c5\u548c\u914d\u7f6e\u7684\u6b63\u786e\u6027\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u4e9b\u6b65\u9aa4\u5e94\u8be5\u80fd\u5e2e\u52a9\u60a8\u5b89\u88c5\u548c\u914d\u7f6eApacheDS\u3001LDAP\u548cKerberos\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u53ea\u662f\u57fa\u672c\u7684\u5b89\u88c5\u548c\u914d\u7f6e\u8fc7\u7a0b\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u6839\u636e\u60a8\u7684\u5177\u4f53\u9700\u6c42\u8fdb\u884c\u66f4\u8be6\u7ec6\u548c\u5b9a\u5236\u5316\u7684\u914d\u7f6e\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u90e8\u7f72apache-kerby",children:"\u90e8\u7f72Apache Kerby"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://directory.apache.org/kerby/",children:"Apache kerby"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/apache/directory-kerby",children:"Apache Kerby Github"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.baeldung.com/spring-security-kerberos",children:"Introduction to SPNEGO/Kerberos Authentication in Spring"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://coheigea.blogspot.com/2018/06/running-apache-kerby-kdc-in-docker.html",children:"Running the Apache Kerby KDC in docker"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1-\u51c6\u5907\u914d\u7f6e\u6587\u4ef6",children:"1. \u51c6\u5907\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,s.jsx)(n.p,{children:"/kerby/data/backend/json-backend.json"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-conf"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"docker pull coheigea/kerby\n\ndocker run -d \\\n  --publish 3088:88 \\\n  --volume //d/docker/kerby/data:/kerby-data \\\n  --net dev \\\n  --restart=no \\\n  --name kerby \\\n  coheigea/kerby\n\ndocker exec -it -u root kerby /bin/bash\n\nsh bin/kadmin.sh /kerby-data/conf/ -k /kerby-data/keytabs/admin.keytab\n\naddprinc -pw password alice@EXAMPLE.COM\n\n\nexport KRB5_CONFIG=D:\\docker\\kerby\\test\\krb5.conf\nkinit alice\nklist\n"})}),"\n",(0,s.jsx)(n.h2,{id:"kerberos\u8ba4\u8bc1\u4e00\u7b80\u660e\u8be6\u7ec6\u7684\u5b89\u88c5\u548c\u8bf4\u660e",children:"Kerberos\u8ba4\u8bc1\uff08\u4e00\uff09\u2014\u2014\u7b80\u660e\u8be6\u7ec6\u7684\u5b89\u88c5\u548c\u8bf4\u660e"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://blog.csdn.net/qq_36488175/article/details/111476800",children:"https://blog.csdn.net/qq_36488175/article/details/111476800"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.cnblogs.com/liugp/p/16468514.html",children:"https://www.cnblogs.com/liugp/p/16468514.html"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u51c6\u5907",children:"\u51c6\u5907"}),"\n",(0,s.jsx)(n.p,{children:"\u4e24\u53f0Centos7\u673a\u5668\uff1a"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u670d\u52a1"}),(0,s.jsx)(n.th,{children:"\u673a\u5668"}),(0,s.jsx)(n.th,{children:"\u4e3b\u673a\u540d"}),(0,s.jsx)(n.th,{children:"\u57df\u540d"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Kerberos server\uff08\u670d\u52a1\u7aef\uff09"}),(0,s.jsx)(n.td,{children:"192.168.2.55"}),(0,s.jsx)(n.td,{children:"kdc"}),(0,s.jsx)(n.td,{children:"kdc.light.local"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Kerberos client\uff08\u5ba2\u6237\u7aef\uff09"}),(0,s.jsx)(n.td,{children:"192.168.2.54"}),(0,s.jsx)(n.td,{children:"srv"}),(0,s.jsx)(n.td,{children:"srv.light.local"})]})]})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"cat >> /etc/hosts << EOF\n\n192.168.2.55  light.local\n192.168.2.55  kdc.light.local\n192.168.2.54  srv.light.local\nEOF\n\n# \u91cd\u542f\u7f51\u7edc\u670d\u52a1\nsystemctl restart network\n\n# \u5173\u95ed\u9632\u706b\u5899\nsystemctl stop firewalld\nsystemctl disable firewalld\nsystemctl status firewalld\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u4e00\u5b89\u88c5kerberos-server",children:"\u4e00\u3001\u5b89\u88c5Kerberos server"}),"\n",(0,s.jsx)(n.h4,{id:"\u5b89\u88c5\u6307\u4ee4",children:"\u5b89\u88c5\u6307\u4ee4"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"yum install -y krb5-server krb5-workstation krb5-libs\n\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"krb5-server"}),"\uff1aKerberos\u670d\u52a1\u7aef\u7a0b\u5e8f\uff0cKDC\u6240\u5728\u8282\u70b9\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"krb5-workstation"}),"\uff1a \u5305\u542b\u4e00\u4e9b\u57fa\u672cKerberos\u7a0b\u5e8f\uff0c\u6bd4\u5982(kinit, klist, kdestroy,kpasswd)\uff0c\u4f7f\u7528Kerberos\u7684\u6240\u6709\u8282\u70b9\u90fd\u5e94\u8be5\u90e8\u7f72\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"krb5-libs"}),"\uff1a\u5305\u542bKerberos\u7a0b\u5e8f\u7684\u5404\u79cd\u652f\u6301\u7c7b\u5e93\u7b49\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u5b89\u88c5\u5b8c\u4e4b\u540e\uff0c\u4f1a\u5728KDC\u4e3b\u673a\u4e0a\u751f\u6210\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"/etc/krb5.conf"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"/var/kerberos/krb5kdc/kdc.conf"})}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u4fee\u6539-krb5conf",children:"\u4fee\u6539 krb5.conf"}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u770b krb5.conf"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"cat /etc/krb5.conf"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-conf",children:"# Configuration snippets may be placed in this directory as well\nincludedir /etc/krb5.conf.d/\n\n[logging]\n default = FILE:/var/log/krb5libs.log\n kdc = FILE:/var/log/krb5kdc.log\n admin_server = FILE:/var/log/kadmind.log\n\n[libdefaults]\n dns_lookup_realm = false\n ticket_lifetime = 24h\n renew_lifetime = 7d\n forwardable = true\n rdns = false\n pkinit_anchors = FILE:/etc/pki/tls/certs/ca-bundle.crt\n# default_realm = EXAMPLE.COM\n default_ccache_name = KEYRING:persistent:%{uid}\n\n[realms]\n# EXAMPLE.COM = {\n#  kdc = kerberos.example.com\n#  admin_server = kerberos.example.com\n# }\n\n[domain_realm]\n# .example.com = EXAMPLE.COM\n# example.com = EXAMPLE.COM\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4fee\u6539 krb5.conf"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"vim /etc/krb5.conf"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-conf",children:"# Configuration snippets may be placed in this directory as well\nincludedir /etc/krb5.conf.d/\n\n# Kerberos\u5b88\u62a4\u8fdb\u7a0b\u7684\u65e5\u5fd7\u8bb0\u5f55\u65b9\u5f0f\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u8868\u793a server \u7aef\u7684\u65e5\u5fd7\u7684\u6253\u5370\u4f4d\u7f6e\u3002\n[logging]\n # krb5libs\u65e5\u5fd7\u5b58\u653e\u8def\u5f84\n default = FILE:/var/log/krb5libs.log\n # krb5kdc\u65e5\u5fd7\u5b58\u653e\u8def\u5f84\n kdc = FILE:/var/log/krb5kdc.log\n # kadmin\u670d\u52a1\u65e5\u5fd7\u5b58\u653e\u8def\u5f84\n admin_server = FILE:/var/log/kadmind.log\n\n# Kerberos\u4f7f\u7528\u7684\u9ed8\u8ba4\u503c\uff0c\u5f53\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u800c\u672a\u6307\u5b9aKerberos\u57df\u65f6\uff0c\u5219\u4f7f\u7528default_realm\u53c2\u6570\u6307\u5b9a\u7684Kerberos\u57df\u3002\u5373\u6bcf\u79cd\u8fde\u63a5\u7684\u9ed8\u8ba4\u914d\u7f6e\uff0c\u9700\u8981\u6ce8\u610f\u4ee5\u4e0b\u51e0\u4e2a\u5173\u952e\u7684\u914d\u7f6e\n[libdefaults]\n # DNS\u67e5\u627e\u57df\u540d\uff0c\u6211\u4eec\u53ef\u4ee5\u7406\u89e3\u4e3aDNS\u7684\u6b63\u5411\u89e3\u6790\uff0c\u8be5\u529f\u80fd\u6211\u6ca1\u6709\u53bb\u9a8c\u8bc1\u8fc7\uff0c\u9ed8\u8ba4\u7981\u7528\u3002\uff08\u6211\u731c\u6d4b\u8be5\u529f\u80fd\u548cdomain_realm\u914d\u7f6e\u6709\u5173\uff09\n dns_lookup_realm = false\n # \u51ed\u8bc1\u751f\u6548\u7684\u65f6\u9650\uff0c\u8bbe\u7f6e\u4e3a24h\u3002\n ticket_lifetime = 24h\n # \u51ed\u8bc1\u6700\u957f\u53ef\u4ee5\u88ab\u5ef6\u671f\u7684\u65f6\u9650\uff0c\u4e00\u822c\u4e3a7\u5929\u3002\u5f53\u51ed\u8bc1\u8fc7\u671f\u4e4b\u540e\uff0c\u5bf9\u5b89\u5168\u8ba4\u8bc1\u7684\u670d\u52a1\u7684\u540e\u7eed\u8bbf\u95ee\u5219\u4f1a\u5931\u8d25\u3002\n renew_lifetime = 7d\n # \u5982\u679c\u6b64\u53c2\u6570\u88ab\u8bbe\u7f6e\u4e3atrue\uff0c\u5219\u53ef\u4ee5\u8f6c\u53d1\u7968\u636e\uff0c\u8fd9\u610f\u5473\u7740\u5982\u679c\u5177\u6709TGT\u7684\u7528\u6237\u767b\u9646\u5230\u8fdc\u7a0b\u7cfb\u7edf\uff0c\u5219KDC\u53ef\u4ee5\u9881\u53d1\u65b0\u7684TGT\uff0c\u800c\u4e0d\u9700\u8981\u7528\u6237\u518d\u6b21\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\n forwardable = true\n # \u5728\u8fdb\u884cdns\u89e3\u6790\u7684\u65f6\u5019\uff0c\u6b63\u53cd\u5411\u90fd\u53ef\u4ee5\uff0c\u9ed8\u8ba4\u662ftrue\uff0c\u5982\u679cdns_canonicalize_hostname\u53c2\u6570\u88ab\u8bbe\u7f6e\u4e3afalse\uff0c\u90a3\u4e48rdns\u8fd9\u4e2a\u53c2\u6570\u5c06\u65e0\u6548\u3002\n rdns = false\n # \u5728KDC\u4e2d\u914d\u7f6epkinit\u7684\u4f4d\u7f6e\uff0c\u8be5\u53c2\u6570\u7684\u5177\u4f53\u529f\u80fd\u6211\u6ca1\u6709\u505a\u8fdb\u4e00\u6b65\u9a8c\u8bc1\u3002\n pkinit_anchors = FILE:/etc/pki/tls/certs/ca-bundle.crt\n # \u8bbe\u7f6e Kerberos \u5e94\u7528\u7a0b\u5e8f\u7684\u9ed8\u8ba4\u9886\u57df\u3002\u5982\u679c\u60a8\u6709\u591a\u4e2a\u9886\u57df\uff0c\u53ea\u9700\u5411 [realms] \u8282\u6dfb\u52a0\u5176\u4ed6\u7684\u8bed\u53e5\u3002\u5176\u4e2d\u9ed8\u8ba4EXAMPLE.COM\u53ef\u4ee5\u4e3a\u4efb\u610f\u540d\u5b57,\u63a8\u8350\u4e3a\u5927\u5199\uff0c\u8fd9\u91cc\u6211\u6539\u6210\u4e86LIGHT.LOCAL\u3002\u5fc5\u987b\u8ddf\u8981\u914d\u7f6e\u7684realm\u7684\u540d\u79f0\u4e00\u81f4\u3002\n default_realm = LIGHT.LOCAL\n # \u9ed8\u8ba4\u7f13\u5b58\u7684\u51ed\u636e\u540d\u79f0\uff0c\u4e0d\u63a8\u8350\u4f7f\u7528\uff0c\u5f53\u5728\u5ba2\u6237\u7aef\u914d\u7f6e\u8be5\u53c2\u6570\u7684\u65f6\u5019\uff0c\u4f1a\u63d0\u793a\u7f13\u5b58\u9519\u8bef\u4fe1\u606f\u3002\n default_ccache_name = KEYRING:persistent:%{uid}\n\n# \u914d\u7f6e\u9886\u57df\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u9ed8\u8ba4\u53ea\u6709\u4e00\u4e2a\uff0c\u53ef\u4ee5\u914d\u7f6e\u591a\u4e2a\n[realms]\nLIGHT.LOCAL = {\n # kdc\u670d\u52a1\u5668\u5730\u5740\u3002\u683c\u5f0f  \u673a\u5668\uff1a\u7aef\u53e3\uff0c \u9ed8\u8ba4\u7aef\u53e3\u662f88\uff0c\u9ed8\u8ba4\u7aef\u53e3\u53ef\u4e0d\u5199\n # kdc = 192.168.2.55:88 \n kdc = kdc.light.local:88\n # admin\u670d\u52a1\u5730\u5740 \u683c\u5f0f \u673a\u5668\uff1a\u7aef\u53e3\uff0c \u9ed8\u8ba4\u7aef\u53e3749\uff0c\u9ed8\u8ba4\u7aef\u53e3\u53ef\u4e0d\u5199\n # admin_server = 192.168.2.55:749\n admin_server = kdc.light.local:749\n # \u6307\u5b9a\u9ed8\u8ba4\u7684\u57df\u540d\n default_domain = LIGHT.LOCAL\n}\n\n# \u9ed8\u8ba4\u7684\u57df\u540d \u6307\u5b9aDNS\u57df\u540d\u548cKerberos\u57df\u540d\u4e4b\u95f4\u6620\u5c04\u5173\u7cfb\u3002\u6307\u5b9a\u670d\u52a1\u5668\u7684FQDN\uff0c\u5bf9\u5e94\u7684domain_realm\u503c\u51b3\u5b9a\u4e86\u4e3b\u673a\u6240\u5c5e\u7684\u57df\u3002\n[domain_realm]\n .light.local = LIGHT.LOCAL\n light.local = LIGHT.LOCAL\n\n# kdc\u7684\u914d\u7f6e\u4fe1\u606f,\u5373\u6307\u5b9akdc.conf\u7684\u4f4d\u7f6e(\u9ed8\u8ba4\u4e0d\u9700\u8981\u914d\u7f6e)\u3002\n[kdc]\n # kdc\u7684\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff0c\u9ed8\u8ba4\u6ca1\u6709\u914d\u7f6e\uff0c\u5982\u679c\u662f\u9ed8\u8ba4\u8def\u5f84\uff0c\u53ef\u4ee5\u4e0d\u5199\n profile = /var/kerberos/krb5kdc/kdc.conf\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u914d\u7f6e-kdcconf",children:"\u914d\u7f6e kdc.conf"}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u770b kdc.conf"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"cat /var/kerberos/krb5kdc/kdc.conf"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-conf",children:"[kdcdefaults]\n kdc_ports = 88\n kdc_tcp_ports = 88\n\n[realms]\n EXAMPLE.COM = {\n  #master_key_type = aes256-cts\n  acl_file = /var/kerberos/krb5kdc/kadm5.acl\n  dict_file = /usr/share/dict/words\n  admin_keytab = /var/kerberos/krb5kdc/kadm5.keytab\n  supported_enctypes = aes256-cts:normal aes128-cts:normal des3-hmac-sha1:normal arcfour-hmac:normal camellia256-cts:normal camellia128-cts:normal des-hmac-sha1:normal des-cbc-md5:normal des-cbc-crc:normal\n }\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4fee\u6539 kdc.conf"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"vim /var/kerberos/krb5kdc/kdc.conf"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-conf",children:"[kdcdefaults]\n # kdc\u9ed8\u8ba4\u7aef\u53e3\u3000\n kdc_ports = 88\n # kdc\u9ed8\u8ba4\u7684tcp\u7aef\u53e3\n kdc_tcp_ports = 88\n\n[realms]\n # \u914d\u7f6e\u6bcf\u4e2a\u57df\u7684\u5177\u4f53\u4fe1\u606f (relam \u8bf7\u7528\u5927\u5199)\n LIGHT.LOCAL = {\n  # \u548c supported_enctypes \u9ed8\u8ba4\u4f7f\u7528 aes256-cts\u3002\u7531\u4e8e\uff0cJAVA \u4f7f\u7528 aes256-cts \u9a8c\u8bc1\u65b9\u5f0f\u9700\u8981\u5b89\u88c5\u989d\u5916\u7684 jar \u5305\uff08\u540e\u9762\u518d\u505a\u8bf4\u660e\uff09\u3002\u63a8\u8350\u4e0d\u4f7f\u7528\uff0c\u5e76\u4e14\u5220\u9664 aes256-cts\u3002\uff08\u5efa\u8bae\u6ce8\u91ca\u6389\uff09\n  # master_key_type = aes256-cts\n  # \u6807\u6ce8admin\u7684\u7528\u6237\u6743\u9650\u3002\u82e5\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u9700\u8981\u7528\u6237\u81ea\u5df1\u521b\u5efa\u3002\u5373\u8be5\u53c2\u6570\u5141\u8bb8\u4e3a\u5177\u6709\u5bf9Kerberos\u6570\u636e\u5e93\u7684\u7ba1\u7406\u8bbf\u95ee\u6743\u9650\u7684UPN\u6307\u5b9aACL\u3002\n  acl_file = /var/kerberos/krb5kdc/kadm5.acl\n  # \u8be5\u53c2\u6570\u6307\u5411\u5305\u542b\u6f5c\u5728\u53ef\u731c\u6d4b\u6216\u53ef\u7834\u89e3\u5bc6\u7801\u7684\u6587\u4ef6\u3002\n  dict_file = /usr/share/dict/words\n  # KDC\u8fdb\u884c\u6821\u9a8c\u7684keytab\n  admin_keytab = /var/kerberos/krb5kdc/kadm5.keytab\n  # ticket \u7684\u9ed8\u8ba4\u751f\u547d\u5468\u671f\u4e3a24h\n  max_file = 24h\n  # \u8be5\u53c2\u6570\u6307\u5b9a\u5728\u591a\u957f\u65f6\u95f4\u5185\u53ef\u91cd\u83b7\u53d6\u7968\u636e\uff0c\u9ed8\u8ba4\u4e3a0\n  max_renewable_life = 7d\n  # \u652f\u6301\u7684\u6821\u9a8c\u65b9\u5f0f\n  supported_enctypes = aes256-cts:normal aes128-cts:normal des3-hmac-sha1:normal arcfour-hmac:normal camellia256-cts:normal camellia128-cts:normal des-hmac-sha1:normal des-cbc-md5:normal des-cbc-crc:normal\n }\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u914d\u7f6e-kadm5acl",children:"\u914d\u7f6e kadm5.acl"}),"\n",(0,s.jsx)(n.p,{children:"\u6743\u9650\u76f8\u5173\u914d\u7f6e"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"vim /var/kerberos/krb5kdc/kadm5.acl"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u5176\u4e2d\u524d\u4e00\u4e2a\u53f7\u662f\u901a\u914d\u7b26\uff0c\u8868\u793a\u50cf\u540d\u4e3a\u201cabc/admin\u201d\u6216\u201cxxx/admin\u201d\u7684\u4eba\u90fd\u53ef\u4ee5\u4f7f\u7528\u6b64\u5de5\u5177\uff08\u8fdc\u7a0b\u6216\u672c\u5730\uff09\u7ba1\u7406kerberos\u6570\u636e\u5e93\uff0c\u540e\u4e00\u4e2a\u8ddf\u6743\u9650\u6709\u5173\uff0c*\u8868\u793a\u6240\u6709\u6743\u9650\u3002LIGHT.LOCAL\u662f\u4e0a\u9762\u914d\u7f6e\u7684realm\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-conf",children:"# \u5f53\u524d\u7528\u6237admin \uff0c* \u8868\u793a\u5168\u90e8\u6743\u9650\u3002\u53ef\u4ee5\u65b0\u589e\u7528\u6237\u548c\u5206\u914d\u6743\u9650\n# \u914d\u7f6e\u8868\u793a\u4ee5/admin@WXAMPLE.COM\u7ed3\u5c3e\u7684\u7528\u6237\u62e5\u6709*(all \u4e5f\u5c31\u662f\u6240\u6709)\u6743\u9650\uff0c\u5177\u4f53\u914d\u7f6e\u53ef\u6839\u636e\u9879\u76ee\u6765\u662f\u5426\u7f29\u5c0f\u6743\u9650\u3002\n*/admin@LIGHT.LOCAL     *\n"})}),"\n",(0,s.jsx)(n.p,{children:"Kerberos kadmind \u4f7f\u7528\u8be5\u6587\u4ef6\u6765\u7ba1\u7406\u5bf9 Kerberos \u6570\u636e\u5e93\u7684\u8bbf\u95ee\u6743\u9650\u3002\u5bf9\u4e8e\u5f71\u54cd principa \u7684\u64cd\u4f5c\uff0cACL \u6587\u4ef6\u8fd8\u63a7\u5236\u54ea\u4e9b principal \u53ef\u4ee5\u5bf9\u54ea\u4e9b\u5176\u4ed6 principa \u8fdb\u884c\u64cd\u4f5c\u3002\u6587\u4ef6\u683c\u5f0f\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"principal  permissions  [target_principal  [restrictions] ]\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u76f8\u5173\u53c2\u6570\u8bf4\u660e\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"principal\uff1a\u8bbe\u7f6e\u8be5 principal \u7684\u6743\u9650\uff1bprincipal \u7684\u6bcf\u4e2a\u90e8\u5206\u90fd\u53ef\u4ee5\u4f7f\u7528 *\u3002"}),"\n",(0,s.jsxs)(n.li,{children:["permissions\uff1a \u6743\u9650\uff0c\u6307\u5b9a\u5339\u914d\u7279\u5b9a\u6761\u76ee\u7684\u4e3b\u4f53\u53ef\u4ee5\u6267\u884c\u6216\u4e0d\u53ef\u4ee5\u6267\u884c\u7684\u64cd\u4f5c \u3002\u5982\u679c\u5b57\u7b26\u662f\u5927\u5199\uff0c\u5219\u4e0d\u5141\u8bb8\u8be5\u64cd\u4f5c\u3002\u5982\u679c\u5b57\u7b26\u662f\u5c0f\u5199\uff0c\u5219\u5141\u8bb8\u8be5\u64cd\u4f5c\u3002\u6709\u5982\u4e0b\u4e00\u4e9b\u6743\u9650\uff1a","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"a\uff1a[\u4e0d]\u5141\u8bb8\u6dfb\u52a0\u4e3b\u4f53\u6216\u7b56\u7565\u3002"}),"\n",(0,s.jsx)(n.li,{children:"d\uff1a[\u4e0d]\u5141\u8bb8\u5220\u9664\u4e3b\u4f53\u6216\u7b56\u7565\u3002"}),"\n",(0,s.jsx)(n.li,{children:"m\uff1a[\u4e0d]\u5141\u8bb8\u4fee\u6539\u4e3b\u4f53\u6216\u7b56\u7565\u3002"}),"\n",(0,s.jsx)(n.li,{children:"c\uff1a[\u4e0d]\u5141\u8bb8\u66f4\u6539\u4e3b\u4f53\u7684\u53e3\u4ee4\u3002"}),"\n",(0,s.jsx)(n.li,{children:"i\uff1a[\u4e0d]\u5141\u8bb8\u67e5\u8be2 Kerberos \u6570\u636e\u5e93\u3002"}),"\n",(0,s.jsx)(n.li,{children:"l\uff1a[\u4e0d]\u5141\u8bb8\u5217\u51fa Kerberos \u6570\u636e\u5e93\u4e2d\u7684\u4e3b\u4f53\u6216\u7b56\u7565\u3002"}),"\n",(0,s.jsx)(n.li,{children:"x \u6216 *\uff1a\u5141\u8bb8\u6240\u6709\u6743\u9650\u3002"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"target_principal\uff1a\u76ee\u6807 principal\uff0c\u76ee\u6807 principal \u7684\u6bcf\u4e2a\u90e8\u5206\u90fd\u53ef\u4ee5\u4f7f\u7528 *\u3002\u3010\u53ef\u9009\u3011"}),"\n",(0,s.jsx)(n.li,{children:"restrictions\uff1a\u9488\u5bf9\u6743\u9650\u7684\u4e00\u4e9b\u8865\u5145\u9650\u5236\uff0c\u5982\uff1a\u9650\u5236\u521b\u5efa\u7684 principal \u7684\u7968\u636e\u6700\u957f\u65f6\u6548\u3002\u3010\u53ef\u9009\u3011"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"# kadm5.acl \u6587\u4ef6\u4e2d\u7684\u4ee5\u4e0b\u9879\u6388\u4e88 LIGHT.LOCAL \u9886\u57df\u4e2d\u5305\u542b admin \u5b9e\u4f8b\u7684\u4efb\u4f55\u4e3b\u4f53\u5bf9 Kerberos \u6570\u636e\u5e93\u7684\u6240\u6709\u6743\u9650\uff1a\n*/admin@LIGHT.LOCAL     *\n\n# kadm5.acl \u6587\u4ef6\u4e2d\u7684\u4ee5\u4e0b\u9879\u6388\u4e88 test@LIGHT.LOCAL \u4e3b\u4f53\u6dfb\u52a0\u3001\u5217\u51fa\u548c\u67e5\u8be2\u5305\u542b root \u5b9e\u4f8b\u7684\u4efb\u4f55\u4e3b\u4f53\u7684\u6743\u9650\u3002\ntest@LIGHT.LOCAL ali */root@LIGHT.LOCAL\n\n# kadm5.acl \u6587\u4ef6\u4e2d\u7684\u4ee5\u4e0b\u9879\u4e0d\u6388\u4e88 test@LIGHT.LOCAL \u4e3b\u4f53\u6dfb\u52a0\u3001\u5217\u51fa\u548c\u67e5\u8be2\u5305\u542b root \u5b9e\u4f8b\u7684\u4efb\u4f55\u4e3b\u4f53\u7684\u6743\u9650\u3002\ntest@LIGHT.LOCAL ALI */root@LIGHT.LOCAL\n\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8be6\u7ec6\u8bf4\u660e\u53ef\u53c2\u8003\u5b98\u7f51\u6587\u6863\uff1a",(0,s.jsx)(n.a,{href:"https://web.mit.edu/kerberos/krb5-latest/doc/admin/conf_files/kadm5_acl.html",children:"https://web.mit.edu/kerberos/krb5-latest/doc/admin/conf_files/kadm5_acl.html"})]}),"\n",(0,s.jsx)(n.h4,{id:"\u521b\u5efa\u6570\u636e\u5e93",children:"\u521b\u5efa\u6570\u636e\u5e93"}),"\n",(0,s.jsxs)(n.p,{children:["\u6ce8\u610f\uff1a \u6b64\u5904\u8bb0\u4f4f\u81ea\u5df1\u7684\u521d\u59cb\u5316\u7684\u5bc6\u7801~ ",(0,s.jsx)(n.code,{children:"kerberos"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"[root@kdc ~]# kdb5_util create -r LIGHT.LOCAL -s\nLoading random data\nInitializing database '/var/kerberos/krb5kdc/principal' for realm 'LIGHT.LOCAL',\nmaster key name 'K/M@LIGHT.LOCAL'\nYou will be prompted for the database Master Password.\nIt is important that you NOT FORGET this password.\nEnter KDC database master key:\nRe-enter KDC database master key to verify:\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u8bf4\u660e\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-s"})," \u8868\u793a\u751f\u6210stash file\uff0c\u5e76\u5728\u5176\u4e2d\u5b58\u50a8master server key\uff08krb5kdc\uff09"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-r"})," \u6765\u6307\u5b9a\u4e00\u4e2arealm name\uff0c\u5f53krb5.conf\u4e2d\u5b9a\u4e49\u4e86\u591a\u4e2arealm\u65f6\u4f7f\u7528"]}),"\n",(0,s.jsx)(n.li,{children:"\u5f53Kerberos database\u521b\u5efa\u597d\u4e86\u4e4b\u540e\uff0c\u5728 /var/kerberos/ \u4e2d\u53ef\u4ee5\u770b\u5230\u751f\u6210\u7684principal\u76f8\u5173\u6587\u4ef6"}),"\n",(0,s.jsx)(n.li,{children:"\u5982\u679c\u9047\u5230\u6570\u636e\u5e93\u5df2\u7ecf\u5b58\u5728\u7684\u63d0\u793a\uff0c\u53ef\u4ee5\u628a /var/kerberos/krb5kdc/ \u76ee\u5f55\u4e0b\u7684 principal \u7684\u76f8\u5173\u6587\u4ef6\u90fd\u5220\u9664\u6389\u3002\u9ed8\u8ba4\u7684\u6570\u636e\u5e93\u540d\u5b57\u90fd\u662f principal\u3002\u53ef\u4ee5\u4f7f\u7528 -d \u6307\u5b9a\u6570\u636e\u5e93\u540d\u5b57\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u542f\u52a8\u670d\u52a1",children:"\u542f\u52a8\u670d\u52a1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"# \u542f\u52a8\u670d\u52a1\nsystemctl start krb5kdc kadmin\n\n# \u67e5\u770b\u72b6\u6001\nsystemctl status krb5kdc kadmin\n\n# \u5f00\u542f\u81ea\u542f\nsystemctl enable krb5kdc kadmin\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u521b\u5efa\u7ba1\u7406\u5458",children:"\u521b\u5efa\u7ba1\u7406\u5458"}),"\n",(0,s.jsxs)(n.p,{children:["\u6ce8\u610f\uff1a \u8bb0\u4f4f\u81ea\u5df1\u8bbe\u7f6e\u7684\u5bc6\u7801 ",(0,s.jsx)(n.code,{children:"admin"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'[root@kdc ~]# kadmin.local -q "addprinc root/admin"\nAuthenticating as principal root/admin@LIGHT.LOCAL with password.\nWARNING: no policy specified for root/admin@LIGHT.LOCAL; defaulting to no policy\nEnter password for principal "root/admin@LIGHT.LOCAL":\nRe-enter password for principal "root/admin@LIGHT.LOCAL":\nPrincipal "root/admin@LIGHT.LOCAL" created.\n'})}),"\n",(0,s.jsx)(n.h4,{id:"kadminlocal",children:"kadmin.local"}),"\n",(0,s.jsx)(n.p,{children:"Kerberos \u670d\u52a1\u673a\u5668\u4e0a\u53ef\u4ee5\u4f7f\u7528 kadmin.local \u6765\u6267\u884c\u5404\u79cd\u7ba1\u7406\u7684\u64cd\u4f5c\u3002\u8fdb\u5165 kadmin.local\uff0c\u4e0d\u9700\u8981\u8f93\u5165\u5bc6\u7801\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"\u5e38\u7528\u64cd\u4f5c\uff1a"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u64cd\u4f5c"}),(0,s.jsx)(n.th,{children:"\u63cf\u8ff0"}),(0,s.jsx)(n.th,{children:"\u793a\u4f8b"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"add_principal, addprinc, ank"}),(0,s.jsx)(n.td,{children:"\u589e\u52a0 principal"}),(0,s.jsxs)(n.td,{children:["add_principal -randkey ",(0,s.jsx)(n.a,{href:"mailto:test@HADOOP.COM",children:"test@HADOOP.COM"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"cpw"}),(0,s.jsx)(n.td,{children:"\u4fee\u6539\u5bc6\u7801"}),(0,s.jsxs)(n.td,{children:["cpw ",(0,s.jsx)(n.a,{href:"mailto:test@HADOOP.COM",children:"test@HADOOP.COM"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"delete_principal, delprinc"}),(0,s.jsx)(n.td,{children:"\u5220\u9664 principal"}),(0,s.jsxs)(n.td,{children:["delete_principal ",(0,s.jsx)(n.a,{href:"mailto:test@HADOOP.COM",children:"test@HADOOP.COM"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"modify_principal, modprinc"}),(0,s.jsx)(n.td,{children:"\u4fee\u6539 principal"}),(0,s.jsxs)(n.td,{children:["modify_principal ",(0,s.jsx)(n.a,{href:"mailto:test@HADOOP.COM",children:"test@HADOOP.COM"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"rename_principal, renprinc"}),(0,s.jsx)(n.td,{children:"\u91cd\u547d\u540d principal"}),(0,s.jsxs)(n.td,{children:["rename_principal ",(0,s.jsx)(n.a,{href:"mailto:test@HADOOP.COM",children:"test@HADOOP.COM"})," ",(0,s.jsx)(n.a,{href:"mailto:test2@ABC.COM",children:"test2@ABC.COM"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"get_principal, getprinc"}),(0,s.jsx)(n.td,{children:"\u83b7\u53d6 principal"}),(0,s.jsxs)(n.td,{children:["get_principal ",(0,s.jsx)(n.a,{href:"mailto:test@HADOOP.COM",children:"test@HADOOP.COM"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"list_principals, listprincs, get_principals, getprincs"}),(0,s.jsx)(n.td,{children:"\u663e\u793a\u6240\u6709 principal"}),(0,s.jsx)(n.td,{children:"listprincs"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"ktadd, xst"}),(0,s.jsx)(n.td,{children:"\u5bfc\u51fa\u6761\u76ee\u5230 keytab"}),(0,s.jsxs)(n.td,{children:["xst -k /root/test.keytab ",(0,s.jsx)(n.a,{href:"mailto:test@HADOOP.COM",children:"test@HADOOP.COM"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"?"}),(0,s.jsx)(n.td,{children:"\u67e5\u770b\u5e2e\u52a9"}),(0,s.jsx)(n.td,{children:"?"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u6ce8\u610f"})," ",(0,s.jsx)(n.code,{children:"-randkey"}),"\u662f\u5bc6\u7801\u662f\u968f\u673a\u7684\uff0c",(0,s.jsx)(n.code,{children:"-nokey"}),"\u5bc6\u7801\u4e0d\u968f\u673a\u3010\u9ed8\u8ba4\u3011\uff0c\u5f97\u624b\u52a8\u8f93\u5165\u5bc6\u7801"]}),"\n",(0,s.jsx)(n.h3,{id:"\u4e8c\u5b89\u88c5kerberos-client",children:"\u4e8c\u3001\u5b89\u88c5Kerberos client"}),"\n",(0,s.jsx)(n.h4,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"yum -y install krb5-workstation krb5-devel\n\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"krb5-workstation"}),"\uff1a \u5305\u542b\u4e00\u4e9b\u57fa\u672cKerberos\u7a0b\u5e8f\uff0c\u6bd4\u5982(kinit, klist, kdestroy, kpasswd)\uff0c\u4f7f\u7528Kerberos\u7684\u6240\u6709\u8282\u70b9\u90fd\u5e94\u8be5\u90e8\u7f72\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"krb5-devel"}),"\uff1a\u5305\u542b\u7f16\u8bd1Kerberos\u7a0b\u5e8f\u7684\u5934\u6587\u4ef6\u548c\u4e00\u4e9b\u7c7b\u5e93\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u4fee\u6539\u914d\u7f6e",children:"\u4fee\u6539\u914d\u7f6e"}),"\n",(0,s.jsx)(n.p,{children:"\u914d\u7f6e\u8bf4\u660e\u8bf7\u770b\u4e0a\u9762\u7684 kerberos server \u7684\u914d\u7f6e"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"vim /etc/krb5.conf"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-conf",children:"# Configuration snippets may be placed in this directory as well\nincludedir /etc/krb5.conf.d/\n\n[logging]\n default = FILE:/var/log/krb5libs.log\n kdc = FILE:/var/log/krb5kdc.log\n admin_server = FILE:/var/log/kadmind.log\n\n[libdefaults]\n dns_lookup_realm = false\n ticket_lifetime = 24h\n renew_lifetime = 7d\n forwardable = true\n rdns = false\n pkinit_anchors = FILE:/etc/pki/tls/certs/ca-bundle.crt\n default_realm = LIGHT.LOCAL\n default_ccache_name = KEYRING:persistent:%{uid}\n\n[realms]\n LIGHT.LOCAL = {\n  # kdc = 192.168.2.55:88\n  # admin_server = 192.168.2.55:749\n  kdc = kdc.light.local:88\n  admin_server = kdc.light.local:749\n }\n\n[domain_realm]\n .light.local = LIGHT.LOCAL\n light.local = LIGHT.LOCAL\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u6d4b\u8bd5kadmin",children:"\u6d4b\u8bd5kadmin"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"# \u4e4b\u524d\u670d\u52a1\u7aef\u521b\u5efa\u7684\u7528\u6237-\u4f7f\u7528kadmin\u8ba4\u8bc1\n[root@srv ~]# kinit root/admin\nPassword for root/admin@LIGHT.LOCAL:\n\n[root@srv ~]# kadmin\nAuthenticating as principal root/admin@LIGHT.LOCAL with password.\nPassword for root/admin@LIGHT.LOCAL:\nkadmin:  \n\n# \u5217\u51fa\u7528\u6237\u4fe1\u606f\nkadmin:  listprincs\nK/M@LIGHT.LOCAL\nkadmin/admin@LIGHT.LOCAL\nkadmin/changepw@LIGHT.LOCAL\nkadmin/kdc.light.local@LIGHT.LOCAL\nkiprop/kdc.light.local@LIGHT.LOCAL\nkrbtgt/LIGHT.LOCAL@LIGHT.LOCAL\nroot/admin@LIGHT.LOCAL\nkadmin:  \nkadmin:  exit\n\n# \u6307\u5b9a\u7528\u6237\u8fde\u63a5\n[root@srv ~]# kadmin -p root/admin@LIGHT.LOCAL\nAuthenticating as principal root/admin@LIGHT.LOCAL with password.\nPassword for root/admin@LIGHT.LOCAL:\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u51fa\u73b0\u6743\u9650\u4e0d\u8db3\u62a5\u9519\uff0c\u5e94\u8be5\u4f7f\u7528\u7684\u975eroot\u7528\u6237\u3002\u4f7f\u7528root\u7528\u6237\u628a\u5bf9\u5e94\u6587\u4ef6\u8d4b\u6743\u540e\uff0c\u5728\u6267\u884c"}),"\n",(0,s.jsx)(n.h3,{id:"\u4e09\u5e38\u89c1\u64cd\u4f5c\u6307\u4ee4",children:"\u4e09\u3001\u5e38\u89c1\u64cd\u4f5c\u6307\u4ee4"}),"\n",(0,s.jsx)(n.h4,{id:"kerberos\u5e38\u7528\u547d\u4ee4",children:"Kerberos\u5e38\u7528\u547d\u4ee4"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u64cd\u4f5c"}),(0,s.jsx)(n.th,{children:"\u547d\u4ee4"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u542f\u52a8kdc\u670d\u52a1"}),(0,s.jsx)(n.td,{children:"systemctl start krb5kdc"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u542f\u52a8kadmin\u670d\u52a1"}),(0,s.jsx)(n.td,{children:"systemctl start kadmin"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u8fdb\u5165kadmin"}),(0,s.jsx)(n.td,{children:"kadmin.local / kadmin"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u521b\u5efa\u6570\u636e\u5e93"}),(0,s.jsx)(n.td,{children:"kdb5_util create -r EXAMPLE.COM -s"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u4fee\u6539\u5f53\u524d\u5bc6\u7801"}),(0,s.jsx)(n.td,{children:"kpasswd"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u6d4b\u8bd5keytab\u53ef\u7528\u6027"}),(0,s.jsxs)(n.td,{children:["kinit -k -t /home/xiaobai/xb.keytab ",(0,s.jsx)(n.a,{href:"mailto:xiaobai@EXAMPLE.COM",children:"xiaobai@EXAMPLE.COM"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u67e5\u770b\u5f53\u524d\u7968\u636e"}),(0,s.jsx)(n.td,{children:"klist"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u67e5\u770b"}),(0,s.jsx)(n.td,{children:"keytab klist -e -k -t /home/xiaobai/xb.keytab"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u901a\u8fc7keytab\u6587\u4ef6\u8ba4\u8bc1\u767b\u5f55"}),(0,s.jsxs)(n.td,{children:["kinit -kt /home/xiaobai/xb.keytab ",(0,s.jsx)(n.a,{href:"mailto:xiaobai@EXAMPLE.COM",children:"xiaobai@EXAMPLE.COM"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u901a\u8fc7\u5bc6\u7801\u8ba4\u8bc1\u767b\u5f55"}),(0,s.jsxs)(n.td,{children:["kinit ",(0,s.jsx)(n.a,{href:"mailto:xiaobai@EXAMPLE.COM",children:"xiaobai@EXAMPLE.COM"})," / kint xiaobai"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u6e05\u9664\u7f13\u5b58"}),(0,s.jsx)(n.td,{children:"kdestroy"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"kadmin\u6a21\u5f0f\u4e0b\u5e38\u7528\u547d\u4ee4",children:"kadmin\u6a21\u5f0f\u4e0b\u5e38\u7528\u547d\u4ee4"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u64cd\u4f5c"}),(0,s.jsx)(n.th,{children:"\u547d\u4ee4"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u67e5\u770b principal"}),(0,s.jsx)(n.td,{children:"listprincs"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u751f\u6210\u968f\u673akey\u7684principal"}),(0,s.jsx)(n.td,{children:"addprinc -randkey root/admin@EXAMPLE.COM"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u751f\u6210\u6307\u5b9akey\u7684principal"}),(0,s.jsx)(n.td,{children:"addprinc -pw xxx root/admin@EXAMPLE.COM"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u4fee\u6539root/admin\u7684\u5bc6\u7801"}),(0,s.jsx)(n.td,{children:"cpw -pw xxx root/admin"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u6dfb\u52a0/\u5220\u9664principal"}),(0,s.jsx)(n.td,{children:"addprinc/delprinc root/admin"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u76f4\u63a5\u751f\u6210\u5230keytab"}),(0,s.jsxs)(n.td,{children:["ktadd -k /home/xiaobai/xb.keytab ",(0,s.jsx)(n.a,{href:"mailto:xiaobai@EXAMPLE.COM",children:"xiaobai@EXAMPLE.COM"})," /xst -norandkey -k /home/xiaobai/xb.keytab      ",(0,s.jsx)(n.a,{href:"mailto:xiaobai@EXAMPLE.COM",children:"xiaobai@EXAMPLE.COM"}),' \u6ce8\u610f\uff1a\u5728\u751f\u6210keytab\u6587\u4ef6\u65f6\u9700\u8981\u52a0\u53c2\u6570"-norandkey"\uff0c\u5426\u5219\u5bfc\u81f4\u76f4\u63a5\u4f7f\u7528kinit ',(0,s.jsx)(n.a,{href:"mailto:xiaobai@EXAMPLE.COM",children:"xiaobai@EXAMPLE.COM"}),"\u521d\u59cb\u5316\u65f6\u63d0\u793a\u5bc6\u7801\u9519\u8bef\u3002"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u8bbe\u7f6e\u5bc6\u7801\u7b56\u7565(policy)"}),(0,s.jsx)(n.td,{children:"addpol -maxlife \u201c90 days\u201d -minlife \u201c75 days\u201d -minlength 8 -minclasses 3 -maxfailure 10 -history 10 user"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u4fee\u6539\u5bc6\u7801\u7b56\u7565"}),(0,s.jsx)(n.td,{children:"modpol -maxlife \u201c90 days\u201d -minlife \u201c75 days\u201d -minlength 8 -minclasses 3 -maxfailure 10 user"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u6dfb\u52a0\u5e26\u6709\u5bc6\u7801\u7b56\u7565"}),(0,s.jsx)(n.td,{children:"addprinc -policy user hello/admin@EXAMPLE.COM"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u4fee\u6539\u7528\u6237\u7684\u5bc6\u7801\u7b56\u7565"}),(0,s.jsx)(n.td,{children:"modprinc -policy user1 hello/admin@EXAMPLE.COM"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u5220\u9664\u5bc6\u7801\u7b56\u7565"}),(0,s.jsx)(n.td,{children:"delpol [-force] user"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"kadmin\u6570\u636e\u5e93\u7ba1\u7406",children:"kadmin\uff08\u6570\u636e\u5e93\u7ba1\u7406\uff09"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["Kerberos \u5ba2\u6237\u7aef\u673a\u5668\u4e0a\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"kadmin"})," \u6765\u6267\u884c\u5404\u79cd\u7ba1\u7406\u7684\u64cd\u4f5c\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"kadmin"})," \u548c ",(0,s.jsx)(n.code,{children:"kadmin.local"})," \u547d\u4ee4\u3002\u9700\u5148\u5728 Kerbers Server \u4e0a\u521b\u5efa\u767b\u5f55\u7684 principal\uff0c\u9ed8\u8ba4\u4e3a ",(0,s.jsx)(n.code,{children:"{\u5f53\u524d\u7528\u6237}/admin@realm"}),"\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u7ba1\u7406KDC\u6570\u636e\u5e93\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4e00\u79cd\u76f4\u63a5\u5728KDC\uff08server\u7aef\uff09\u76f4\u63a5\u6267\u884c\uff0c\u53ef\u4ee5\u4e0d\u9700\u8981\u8f93\u5165\u5bc6\u7801\u5c31\u53ef\u4ee5\u767b\u5f55\u3010\u547d\u4ee4\uff1akadmin.local\u3011"}),"\n",(0,s.jsx)(n.li,{children:"\u4e00\u79cd\u5219\u662f\u5ba2\u6237\u7aef\u547d\u4ee4\uff0c\u9700\u8981\u8f93\u5165\u5bc6\u7801\u3010\u547d\u4ee4\uff1akadmin\u3011\uff0c\u5728server\u7aef\u548cclient\u7aef\u90fd\u53ef\u4ee5\u4f7f\u7528\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u521b\u5efa\u7528\u6237\uff0c\u6ce8\u610f\u81ea\u5df1\u8bbe\u7f6e\u7684\u5bc6\u7801"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'# \u4ea4\u4e92\u5f0f\n$ kadmin.local\n\nadd_principal root/admin\n\n# \u975e\u4ea4\u4e92\u5f0f\n$ kadmin.local -q "add_principal root/admin"\n'})}),"\n",(0,s.jsx)(n.h4,{id:"kinit\u5728\u5ba2\u6237\u7aef\u8ba4\u8bc1\u7528\u6237",children:"kinit(\u5728\u5ba2\u6237\u7aef\u8ba4\u8bc1\u7528\u6237)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"$ kinit root/admin@LIGHT.LOCAL\n# \u67e5\u770b\u5f53\u524d\u7684\u8ba4\u8bc1\u7528\u6237\n$ klist\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u8f93\u51fa\u7ed3\u679c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"[root@srv ~]#  kinit root/admin@LIGHT.LOCAL\nPassword for root/admin@LIGHT.LOCAL:\n[root@srv ~]# klist\nTicket cache: KEYRING:persistent:0:0\nDefault principal: root/admin@LIGHT.LOCAL\n\nValid starting       Expires              Service principal\n2024-03-26T18:24:30  2024-03-27T18:24:30  krbtgt/LIGHT.LOCAL@LIGHT.LOCAL\n\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u5bfc\u51fakeytab\u8ba4\u8bc1\u6587\u4ef6\u5728kdc\u4f7f\u7528",children:"\u5bfc\u51fakeytab\u8ba4\u8bc1\u6587\u4ef6(\u5728KDC\u4f7f\u7528)"}),"\n",(0,s.jsx)(n.p,{children:"\u4f7f\u7528xst\u547d\u4ee4\u6216\u8005ktadd\u547d\u4ee4\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'# \u975e\u4ea4\u4e92\u5f0f\n$ kadmin.local -q "ktadd -norandkey -k /root/root.keytab root/admin"\n\n# \u4ea4\u4e92\u5f0f\n$ kadmin.local\n\nktadd -norandkey -k /root/root.keytab root/admin\n\u6216xst -k /root/v.keytab root/admin\n\u6216xst -norandkey -k /root/root.keytab root/admin\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u5176\u4e2d ",(0,s.jsx)(n.code,{children:"/root/root.keytab"})," \u4e3a\u81ea\u5df1\u6307\u5b9a\u7684\u8def\u5f84\u4e0e\u6587\u4ef6\u540d\uff0c\u4ee5",(0,s.jsx)(n.code,{children:".keytab"}),"\u7ed3\u5c3e\uff1b",(0,s.jsx)(n.code,{children:"root/admin"}),"\u4e3a\u4e4b\u524d\u521b\u5efa\u7684\u51ed\u8bc1\u7528\u6237"]}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u770b\u5bc6\u94a5\u6587\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"$ klist -kt /root/root.keytab\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u8f93\u51fa\u7ed3\u679c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'[root@kdc ~]# kadmin.local -q "ktadd -norandkey -k /root/root.keytab root/admin"\nAuthenticating as principal root/admin@LIGHT.LOCAL with password.\nEntry for principal root/admin with kvno 1, encryption type aes256-cts-hmac-sha1-96 added to keytab WRFILE:/root/root.keytab.\nEntry for principal root/admin with kvno 1, encryption type aes128-cts-hmac-sha1-96 added to keytab WRFILE:/root/root.keytab.\nEntry for principal root/admin with kvno 1, encryption type des3-cbc-sha1 added to keytab WRFILE:/root/root.keytab.\nEntry for principal root/admin with kvno 1, encryption type arcfour-hmac added to keytab WRFILE:/root/root.keytab.\nEntry for principal root/admin with kvno 1, encryption type camellia256-cts-cmac added to keytab WRFILE:/root/root.keytab.\nEntry for principal root/admin with kvno 1, encryption type camellia128-cts-cmac added to keytab WRFILE:/root/root.keytab.\nEntry for principal root/admin with kvno 1, encryption type des-hmac-sha1 added to keytab WRFILE:/root/root.keytab.\nEntry for principal root/admin with kvno 1, encryption type des-cbc-md5 added to keytab WRFILE:/root/root.keytab.\n\n[root@kdc ~]# klist -kt /root/root.keytab\nKeytab name: FILE:/root/root.keytab\nKVNO Timestamp           Principal\n---- ------------------- ------------------------------------------------------\n   1 2024-03-26T18:27:02 root/admin@LIGHT.LOCAL\n   1 2024-03-26T18:27:02 root/admin@LIGHT.LOCAL\n   1 2024-03-26T18:27:02 root/admin@LIGHT.LOCAL\n   1 2024-03-26T18:27:02 root/admin@LIGHT.LOCAL\n   1 2024-03-26T18:27:02 root/admin@LIGHT.LOCAL\n   1 2024-03-26T18:27:02 root/admin@LIGHT.LOCAL\n   1 2024-03-26T18:27:02 root/admin@LIGHT.LOCAL\n   1 2024-03-26T18:27:02 root/admin@LIGHT.LOCAL\n'})}),"\n",(0,s.jsx)(n.h4,{id:"4kdestroy\u5220\u9664\u5f53\u524d\u7684\u8ba4\u8bc1\u7f13\u5b58",children:"4\u3001kdestroy(\u5220\u9664\u5f53\u524d\u7684\u8ba4\u8bc1\u7f13\u5b58)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"$ kdestroy\n"})}),"\n",(0,s.jsx)(n.h4,{id:"5\u7528\u6237\u8ba4\u8bc1\u767b\u5f55",children:"5\u3001\u7528\u6237\u8ba4\u8bc1\uff08\u767b\u5f55\uff09"}),"\n",(0,s.jsx)(n.p,{children:"\u57fa\u4e8e\u5bc6\u7801\u8ba4\u8bc1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"$ klist\n$ kinit root/admin\n\u8f93\u5165\u5bc6\u7801\uff1aadmin\n\n$ klist\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u57fa\u4e8e\u5bc6\u94a5\u8ba4\u8bc1\uff08keytab\uff09"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"# \u5220\u9664\u5f53\u524d\u7528\u6237\u8ba4\u8bc1\n$ kdestroy\n\n# \u62ff\u5230\u4e0a\u9762\u751f\u6210\u7684keytab\u6587\u4ef6\n$ klist\n$ kinit -kt /root/root.keytab root/admin\n$ klist\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u8f93\u51fa\u7ed3\u679c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"[root@kdc ~]# klist\nklist: Credentials cache keyring 'persistent:0:0' not found\n\n[root@kdc ~]# kinit root/admin\nPassword for root/admin@LIGHT.LOCAL:\n\n[root@kdc ~]# klist\nTicket cache: KEYRING:persistent:0:0\nDefault principal: root/admin@LIGHT.LOCAL\n\nValid starting       Expires              Service principal\n2024-03-26T18:29:37  2024-03-27T18:29:37  krbtgt/LIGHT.LOCAL@LIGHT.LOCAL\n\n[root@kdc ~]# kdestroy\n\n[root@kdc ~]# klist\nklist: Credentials cache keyring 'persistent:0:0' not found\n\n[root@kdc ~]# kinit -kt /root/root.keytab root/admin\n\n[root@kdc ~]# klist\nTicket cache: KEYRING:persistent:0:0\nDefault principal: root/admin@LIGHT.LOCAL\n\nValid starting       Expires              Service principal\n2024-03-26T18:30:03  2024-03-27T18:30:03  krbtgt/LIGHT.LOCAL@LIGHT.LOCAL\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u56db\u5e38\u89c1\u9519\u8bef\u4fe1\u606f",children:"\u56db\u3001\u5e38\u89c1\u9519\u8bef\u4fe1\u606f"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.oracle.com/cd/E26926_01/html/E25889/trouble-2.html",children:"https://docs.oracle.com/cd/E26926_01/html/E25889/trouble-2.html"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/steveloughran/kerberos_and_hadoop/blob/master/sections/errors.md",children:"https://github.com/steveloughran/kerberos_and_hadoop/blob/master/sections/errors.md"})}),"\n"]}),"\n",(0,s.jsxs)(n.h4,{id:"1-kinit-cannot-contact-any-kdc-for-realm-lightlocal-while-getting-initial-credentials",children:["1. ",(0,s.jsx)(n.code,{children:"kinit: Cannot contact any KDC for realm 'LIGHT.LOCAL' while getting initial credentials"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"# \u542f\u52a8\u670d\u52a1\nsystemctl start krb5kdc kadmin\n\n\n# \u5173\u95ed\u9632\u706b\u5899\nsystemctl stop firewalld\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"2-client-not-found-in-kerberos-database-6---client_not_found",children:["2. ",(0,s.jsx)(n.code,{children:"Client not found in Kerberos database (6) - CLIENT_NOT_FOUND"})]}),"\n",(0,s.jsx)(n.h2,{id:"\u5176\u4ed6",children:"\u5176\u4ed6"})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);