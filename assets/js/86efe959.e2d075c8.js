"use strict";(self.webpackChunklight_docusaurus=self.webpackChunklight_docusaurus||[]).push([[64192],{10276:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>a,default:()=>d,frontMatter:()=>c,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"mysql/Mysql-Store-Function-Procedure","title":"Mysql-Store-Function-Procedure","description":"\u521b\u5efa\u5b58\u50a8\u51fd\u6570","source":"@site/middleware/mysql/2-Mysql-Store-Function-Procedure.md","sourceDirName":"mysql","slug":"/mysql/Mysql-Store-Function-Procedure","permalink":"/middleware/mysql/Mysql-Store-Function-Procedure","draft":false,"unlisted":false,"editUrl":"https://github.com/lorchr/light-docusaurus/tree/main/middleware/mysql/2-Mysql-Store-Function-Procedure.md","tags":[],"version":"current","lastUpdatedBy":"Lorchr","lastUpdatedAt":1746800534000,"sidebarPosition":2,"frontMatter":{},"sidebar":"middleware","previous":{"title":"Mysql-Install-On-Windows","permalink":"/middleware/mysql/Mysql-Install-On-Windows"},"next":{"title":"Mysql-Optimize-1","permalink":"/middleware/mysql/Mysql-Optimize-1"}}');var s=t(74848),l=t(28453);const c={},a=void 0,u={},o=[{value:"\u521b\u5efa\u5b58\u50a8\u51fd\u6570",id:"\u521b\u5efa\u5b58\u50a8\u51fd\u6570",level:2},{value:"\u521b\u5efa\u5b58\u50a8\u8fc7\u7a0b",id:"\u521b\u5efa\u5b58\u50a8\u8fc7\u7a0b",level:2}];function i(e){const n={code:"code",h2:"h2",pre:"pre",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"\u521b\u5efa\u5b58\u50a8\u51fd\u6570",children:"\u521b\u5efa\u5b58\u50a8\u51fd\u6570"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"use uap;\n\n-- ----------------------------\n-- Table structure for `sequence`\n-- ----------------------------\nDROP TABLE IF EXISTS sequence;\nCREATE TABLE sequence (\n\tseq_name VARCHAR(50) NOT NULL COMMENT '\u4e3b\u952e' ,\n\tcurrent_val INT NOT NULL COMMENT '\u5f53\u524d\u503c' ,\n    increment_val INT NOT NULL COMMENT '\u6b65\u957f',\n    note VARCHAR(200)  COMMENT '\u5907\u6ce8',\n    PRIMARY KEY (seq_name)\n) COMMENT '\u81ea\u589e\u961f\u5217';\n\n-- ----------------------------\n-- Records of sequence\n-- ----------------------------\nINSERT INTO sequence (seq_name, current_val, increment_val) VALUES\n('uap-a-pk', 1, 1),\n('uap-b-pk', 1, 3),\n('uap-c-pk', 1, 5);\n\nselect * from sequence;\n\n-- ----------------------------\n-- Function structure for `nextval`\n-- ----------------------------\n-- \u5220\u9664\u5df2\u6709\u7684\u5b58\u50a8\u51fd\u6570\nDROP FUNCTION IF EXISTS `nextval`;  \n-- \u5206\u9694\u7b26\nDELIMITER ;;\n-- \u521b\u5efa\u5b58\u50a8\u51fd\u6570 \n-- DEFINER \u751f\u547d\u521b\u5efa\u8005\u548c\u4f5c\u7528\u8303\u56f4\uff0c\u53ef\u7701\u7565\n-- nextval-\u51fd\u6570\u540d \n-- v_seq_name-\u5f62\u53c2\uff0c\u7c7b\u578b\u9ed8\u8ba4\u4e3aINT\nCREATE DEFINER=`zjft`@`%` FUNCTION `nextval`(v_seq_name VARCHAR(50)) \n-- \u5b9a\u4e49\u8fd4\u56de\u503c\u7c7b\u578b\nRETURNS int(11)\n-- \u58f0\u660e\u786e\u5b9a\u6027\nDETERMINISTIC\n-- \u5f00\u59cb\u4e66\u5199\u51fd\u6570\u4f53\nBEGIN\n-- \u903b\u8f91\u8bed\u53e5\n\tUPDATE sequence set current_val = current_val + increment_val where seq_name = v_seq_name;\n-- \u8fd4\u56de\u503c\uff0c\u8c03\u7528\u4e86currval\u51fd\u6570\n\treturn currval(v_seq_name);\n-- \u7ed3\u675f\u4e66\u5199\u51fd\u6570\u4f53\nEND\n;;\nDELIMITER ;\n\n-- ----------------------------\n-- Function structure for `currval`\n-- ----------------------------\nDROP FUNCTION IF EXISTS `currval`;\nDELIMITER ;;\nCREATE DEFINER=`zjft`@`%` FUNCTION `currval`(v_seq_name VARCHAR(50)) RETURNS int(11)\nDETERMINISTIC\nBEGIN\n\treturn (select current_val from sequence where seq_name = v_seq_name);\nEND\n;;\nDELIMITER ;\n\n-- \u51fd\u6570\u8c03\u7528\nselect nextval('uap-a-pk');\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u521b\u5efa\u5b58\u50a8\u8fc7\u7a0b",children:"\u521b\u5efa\u5b58\u50a8\u8fc7\u7a0b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql"})})]})}function d(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(i,{...e})}):i(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>a});var r=t(96540);const s={},l=r.createContext(s);function c(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);