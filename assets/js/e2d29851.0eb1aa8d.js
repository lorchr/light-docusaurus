"use strict";(self.webpackChunklight_docusaurus=self.webpackChunklight_docusaurus||[]).push([[83401],{26286:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>i});const o=JSON.parse('{"id":"note/caddy","title":"caddy","description":"- Caddy","source":"@site/diy/note/caddy.md","sourceDirName":"note","slug":"/note/caddy","permalink":"/diy/note/caddy","draft":false,"unlisted":false,"editUrl":"https://github.com/lorchr/light-docusaurus/tree/main/diy/note/caddy.md","tags":[],"version":"current","lastUpdatedBy":"Lorchr","lastUpdatedAt":1749279355000,"frontMatter":{}}');var s=t(74848),d=t(28453);const a={},r=void 0,c={},i=[];function l(n){const e={a:"a",code:"code",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://caddyserver.com/",children:"Caddy"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://github.com/caddyserver/caddy",children:"Caddy Github"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'# \u751f\u6210\u79c1\u94a5\uff0c\u9700\u8981\u8f93\u5165\u5bc6\u7801\nopenssl genrsa -des3 -out caddy.pass.key 2048\n# \u5220\u9664\u79c1\u94a5\u4e2d\u7684\u5bc6\u7801\nopenssl rsa -in caddy.pass.key -out caddy.key\n# \u751f\u6210CSR\nopenssl req -new -key caddy.key -out caddy.csr -subj "/C=CN/ST=Shanghai/L=Shanghai/O=light/OU=caddy/CN=caddy.light.local"\n# \u751f\u6210\u8bc1\u4e66\nopenssl x509 -req -days 3650 -in caddy.csr -signkey caddy.key -out caddy.crt\n\n\n# \u751f\u6210\u79c1\u94a5\uff0c\u9700\u8981\u8f93\u5165\u5bc6\u7801\nopenssl genrsa -des3 -out outline.pass.key 2048\n# \u5220\u9664\u79c1\u94a5\u4e2d\u7684\u5bc6\u7801\nopenssl rsa -in outline.pass.key -out outline.key\n# \u751f\u6210CSR\nopenssl req -new -key outline.key -out outline.csr -subj "/C=CN/ST=Shanghai/L=Shanghai/O=light/OU=outline/CN=outline.light.local"\n# \u751f\u6210\u8bc1\u4e66\nopenssl x509 -req -days 3650 -in outline.csr -signkey outline.key -out outline.crt\n'})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'version: "3.7"\n\nservices:\n  caddy:\n    image: caddy:2.8\n    restart: unless-stopped\n    cap_add:\n      - NET_ADMIN\n    ports:\n      - "80:80"\n      - "443:443"\n      - "443:443/udp"\n    volumes:\n      - ./Caddyfile:/etc/caddy/Caddyfile\n    #   - ./site:/srv\n      - caddy_config:/config\n      - caddy_data:/data\n\nvolumes:\n  caddy_config:\n  caddy_data:\n    external: true\n\n'})}),"\n",(0,s.jsx)(e.p,{children:"Caddyfile"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-conf",children:'# \u53cd\u4ee3Outline\noutline.light.local {\n    encode zstd gzip\n\n    # tls <\u4f60\u7684\u90ae\u7bb1>\n\n    header / {\n        X-Content-Type-Options nosniff\n        X-Frame-Options "SAMEORIGIN"\n        X-XSS-Protection "1; mode=block"\n        X-Robots-Tag none\n        X-Download-Options noopen\n        X-Permitted-Cross-Domain-Policies none\n        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"\n        -Server\n    }\n\n    # \u53cd\u4ee3Outline\u76843000\u7aef\u53e3\n    reverse_proxy 127.0.0.1:3000 {\n        header_up X-Real-IP {remote_host}\n    }\n}\n\n# \u53cd\u4ee3minio\nminio.light.local {\n    encode zstd gzip\n\n    # tls <\u4f60\u7684\u90ae\u7bb1>\n\n    # \u53cd\u4ee3minio\u76849001\u7aef\u53e3\n    reverse_proxy 127.0.0.1:9001 {\n        header_up X-Forwarded-Proto {http.request.scheme}\n        header_up X-Forwarded-Host {http.request.host}\n        header_up Host {http.request.host}\n        header_down Access-Control-Allow-Origin "*"\n    }\n}\n\n# \u53cd\u4ee3keycloak\nkeycloak.light.local {\n    encode zstd gzip\n\n    # tls <\u4f60\u7684\u90ae\u7bb1>\n\n    # \u53cd\u4ee3minio\u76849001\u7aef\u53e3\n    reverse_proxy 127.0.0.1:3679 {\n        header_up X-Forwarded-Proto {http.request.scheme}\n        header_up X-Forwarded-Host {http.request.host}\n        header_up Host {http.request.host}\n        header_down Access-Control-Allow-Origin "*"\n    }\n}\n\n'})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"docker compose -f caddy.yaml -p caddy up -d\n\ndocker compose -f caddy.yaml -p caddy down\n\n"})})]})}function u(n={}){const{wrapper:e}={...(0,d.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(l,{...n})}):l(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>a,x:()=>r});var o=t(96540);const s={},d=o.createContext(s);function a(n){const e=o.useContext(d);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:a(n.components),o.createElement(d.Provider,{value:e},n.children)}}}]);