"use strict";(self.webpackChunklight_docusaurus=self.webpackChunklight_docusaurus||[]).push([[8883],{24265:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>u,toc:()=>i});var r=t(85893),s=t(11151);const a={},l=void 0,u={id:"mysql/Mysql-Store-Function-Procedure",title:"Mysql-Store-Function-Procedure",description:"\u521b\u5efa\u5b58\u50a8\u51fd\u6570",source:"@site/middleware/mysql/2-Mysql-Store-Function-Procedure.md",sourceDirName:"mysql",slug:"/mysql/Mysql-Store-Function-Procedure",permalink:"/light-docusaurus/middleware/mysql/Mysql-Store-Function-Procedure",draft:!1,unlisted:!1,editUrl:"https://github.com/lorchr/light-docusaurus/tree/main/middleware/mysql/2-Mysql-Store-Function-Procedure.md",tags:[],version:"current",lastUpdatedBy:"liuhui",lastUpdatedAt:1703833110,formattedLastUpdatedAt:"2023\u5e7412\u670829\u65e5",sidebarPosition:2,frontMatter:{},sidebar:"middleware",previous:{title:"Mysql-Install-On-Windows",permalink:"/light-docusaurus/middleware/mysql/Mysql-Install-On-Windows"},next:{title:"Mysql-Optimize-1",permalink:"/light-docusaurus/middleware/mysql/Mysql-Optimize-1"}},c={},i=[{value:"\u521b\u5efa\u5b58\u50a8\u51fd\u6570",id:"\u521b\u5efa\u5b58\u50a8\u51fd\u6570",level:2},{value:"\u521b\u5efa\u5b58\u50a8\u8fc7\u7a0b",id:"\u521b\u5efa\u5b58\u50a8\u8fc7\u7a0b",level:2}];function o(e){const n={code:"code",h2:"h2",pre:"pre",...(0,s.ah)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\u521b\u5efa\u5b58\u50a8\u51fd\u6570",children:"\u521b\u5efa\u5b58\u50a8\u51fd\u6570"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"use uap;\n\n-- ----------------------------\n-- Table structure for `sequence`\n-- ----------------------------\nDROP TABLE IF EXISTS sequence;\nCREATE TABLE sequence (\n\tseq_name VARCHAR(50) NOT NULL COMMENT '\u4e3b\u952e' ,\n\tcurrent_val INT NOT NULL COMMENT '\u5f53\u524d\u503c' ,\n    increment_val INT NOT NULL COMMENT '\u6b65\u957f',\n    note VARCHAR(200)  COMMENT '\u5907\u6ce8',\n    PRIMARY KEY (seq_name)\n) COMMENT '\u81ea\u589e\u961f\u5217';\n\n-- ----------------------------\n-- Records of sequence\n-- ----------------------------\nINSERT INTO sequence (seq_name, current_val, increment_val) VALUES\n('uap-a-pk', 1, 1),\n('uap-b-pk', 1, 3),\n('uap-c-pk', 1, 5);\n\nselect * from sequence;\n\n-- ----------------------------\n-- Function structure for `nextval`\n-- ----------------------------\n-- \u5220\u9664\u5df2\u6709\u7684\u5b58\u50a8\u51fd\u6570\nDROP FUNCTION IF EXISTS `nextval`;  \n-- \u5206\u9694\u7b26\nDELIMITER ;;\n-- \u521b\u5efa\u5b58\u50a8\u51fd\u6570 \n-- DEFINER \u751f\u547d\u521b\u5efa\u8005\u548c\u4f5c\u7528\u8303\u56f4\uff0c\u53ef\u7701\u7565\n-- nextval-\u51fd\u6570\u540d \n-- v_seq_name-\u5f62\u53c2\uff0c\u7c7b\u578b\u9ed8\u8ba4\u4e3aINT\nCREATE DEFINER=`zjft`@`%` FUNCTION `nextval`(v_seq_name VARCHAR(50)) \n-- \u5b9a\u4e49\u8fd4\u56de\u503c\u7c7b\u578b\nRETURNS int(11)\n-- \u58f0\u660e\u786e\u5b9a\u6027\nDETERMINISTIC\n-- \u5f00\u59cb\u4e66\u5199\u51fd\u6570\u4f53\nBEGIN\n-- \u903b\u8f91\u8bed\u53e5\n\tUPDATE sequence set current_val = current_val + increment_val where seq_name = v_seq_name;\n-- \u8fd4\u56de\u503c\uff0c\u8c03\u7528\u4e86currval\u51fd\u6570\n\treturn currval(v_seq_name);\n-- \u7ed3\u675f\u4e66\u5199\u51fd\u6570\u4f53\nEND\n;;\nDELIMITER ;\n\n-- ----------------------------\n-- Function structure for `currval`\n-- ----------------------------\nDROP FUNCTION IF EXISTS `currval`;\nDELIMITER ;;\nCREATE DEFINER=`zjft`@`%` FUNCTION `currval`(v_seq_name VARCHAR(50)) RETURNS int(11)\nDETERMINISTIC\nBEGIN\n\treturn (select current_val from sequence where seq_name = v_seq_name);\nEND\n;;\nDELIMITER ;\n\n-- \u51fd\u6570\u8c03\u7528\nselect nextval('uap-a-pk');\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u521b\u5efa\u5b58\u50a8\u8fc7\u7a0b",children:"\u521b\u5efa\u5b58\u50a8\u8fc7\u7a0b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql"})})]})}function d(e={}){const{wrapper:n}={...(0,s.ah)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},11151:(e,n,t)=>{t.d(n,{ah:()=>a});var r=t(67294);const s=r.createContext({});function a(e){const n=r.useContext(s);return r.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}}}]);