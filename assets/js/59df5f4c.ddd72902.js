"use strict";(self.webpackChunklight_docusaurus=self.webpackChunklight_docusaurus||[]).push([[53285],{11744:(e,n,i)=>{i.d(n,{A:()=>a});const a=i.p+"assets/images/7-dc630992d47a3b9ad5c0cc501d39cbea.jpg"},25359:(e,n,i)=>{i.d(n,{A:()=>a});const a=i.p+"assets/images/4-b01f96cdb7eb6d4b19617efb93c6a912.jpg"},25441:(e,n,i)=>{i.d(n,{A:()=>a});const a=i.p+"assets/images/2-164e1a80dd3cf0eb17e86d31873b9e9a.jpg"},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>s});var a=i(96540);const t={},o=a.createContext(t);function r(e){const n=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),a.createElement(o.Provider,{value:n},e.children)}},32043:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"zh-cn/spring-boot/Spring-Boot-Hotswap-Aop","title":"Spring-Boot-Hotswap-Aop","description":"- Spring Boot \u5b9e\u73b0\u70ed\u63d2\u62d4 AOP\uff0c\u975e\u5e38\u5b9e\u7528\uff01","source":"@site/docs/zh-cn/spring-boot/24-Spring-Boot-Hotswap-Aop.md","sourceDirName":"zh-cn/spring-boot","slug":"/zh-cn/spring-boot/Spring-Boot-Hotswap-Aop","permalink":"/docs/zh-cn/spring-boot/Spring-Boot-Hotswap-Aop","draft":false,"unlisted":false,"editUrl":"https://github.com/lorchr/light-docusaurus/tree/main/docs/zh-cn/spring-boot/24-Spring-Boot-Hotswap-Aop.md","tags":[],"version":"current","sidebarPosition":24,"frontMatter":{},"sidebar":"troch","previous":{"title":"Spring-Boot-Integrate-SpringDoc-Aggregation","permalink":"/docs/zh-cn/spring-boot/Spring-Boot-Integrate-SpringDoc-Aggregation"},"next":{"title":"Customlize-Request-Trace","permalink":"/docs/zh-cn/spring-boot/Customlize-Request-Trace"}}');var t=i(74848),o=i(28453);const r={},s=void 0,l={},c=[{value:"\u524d\u7f6e\u77e5\u8bc6",id:"\u524d\u7f6e\u77e5\u8bc6",level:2},{value:"Advice:",id:"advice",level:3},{value:"Advisor:",id:"advisor",level:3},{value:"Advised:",id:"advised",level:3},{value:"\u70ed\u63d2\u62d4AOP\u6267\u884c\u6838\u5fc3\u903b\u8f91",id:"\u70ed\u63d2\u62d4aop\u6267\u884c\u6838\u5fc3\u903b\u8f91",level:2},{value:"\u6838\u5fc3\u5b9e\u73b0\u4ee3\u7801",id:"\u6838\u5fc3\u5b9e\u73b0\u4ee3\u7801",level:2},{value:"1\u3001\u52a8\u6001\u7ba1\u7406advice\u7aef\u70b9\u5b9e\u73b0",id:"1\u52a8\u6001\u7ba1\u7406advice\u7aef\u70b9\u5b9e\u73b0",level:3},{value:"2\u3001\u5229\u7528\u4e8b\u4ef6\u76d1\u542c\u673a\u5236\u6355\u83b7\u5b89\u88c5\u6216\u8005\u5378\u8f7d\u63d2\u4ef6",id:"2\u5229\u7528\u4e8b\u4ef6\u76d1\u542c\u673a\u5236\u6355\u83b7\u5b89\u88c5\u6216\u8005\u5378\u8f7d\u63d2\u4ef6",level:3},{value:"3\u3001\u5b89\u88c5\u63d2\u4ef6",id:"3\u5b89\u88c5\u63d2\u4ef6",level:3},{value:"4\u3001\u5b89\u88c5\u63d2\u4ef6\u6838\u5fc3\u5b9e\u73b0",id:"4\u5b89\u88c5\u63d2\u4ef6\u6838\u5fc3\u5b9e\u73b0",level:3},{value:"5\u3001\u5378\u8f7d\u63d2\u4ef6",id:"5\u5378\u8f7d\u63d2\u4ef6",level:3},{value:"6\u3001\u5378\u8f7d\u63d2\u4ef6\u6838\u5fc3\u5b9e\u73b0",id:"6\u5378\u8f7d\u63d2\u4ef6\u6838\u5fc3\u5b9e\u73b0",level:3},{value:"7\u3001\u64cd\u4f5cadvice\u5b9e\u73b0",id:"7\u64cd\u4f5cadvice\u5b9e\u73b0",level:3},{value:"\u70ed\u63d2\u62d4AOP\u6f14\u793a\u793a\u4f8b",id:"\u70ed\u63d2\u62d4aop\u6f14\u793a\u793a\u4f8b",level:2},{value:"1\u3001\u521b\u5efa\u4e00\u4e2aservice",id:"1\u521b\u5efa\u4e00\u4e2aservice",level:3},{value:"2\u3001\u521b\u5efa\u4e00\u4e2acontroller",id:"2\u521b\u5efa\u4e00\u4e2acontroller",level:3},{value:"3\u3001\u51c6\u5907\u4e00\u4e2a\u65e5\u5fd7\u5207\u9762jar",id:"3\u51c6\u5907\u4e00\u4e2a\u65e5\u5fd7\u5207\u9762jar",level:3},{value:"\u6d4b\u8bd5",id:"\u6d4b\u8bd5",level:2},{value:"\u573a\u666f\u4e00\uff1a\u672a\u6dfb\u52a0\u5207\u9762\u65f6 \u6d4f\u89c8\u5668\u8bbf\u95ee\uff1ahttp://localhost:8080/hello/zhangsan \u89c2\u5bdf\u63a7\u5236\u53f0",id:"\u573a\u666f\u4e00\u672a\u6dfb\u52a0\u5207\u9762\u65f6-\u6d4f\u89c8\u5668\u8bbf\u95eehttplocalhost8080hellozhangsan-\u89c2\u5bdf\u63a7\u5236\u53f0",level:3},{value:"\u573a\u666f\u4e8c\uff1a\u901a\u8fc7postman\u52a8\u6001\u64cd\u4f5c\u4ee3\u7406",id:"\u573a\u666f\u4e8c\u901a\u8fc7postman\u52a8\u6001\u64cd\u4f5c\u4ee3\u7406",level:3},{value:"1\u3001\u65b0\u589e\u4ee3\u7406",id:"1\u65b0\u589e\u4ee3\u7406",level:4},{value:"2\u3001\u5220\u9664\u4ee3\u7406",id:"2\u5220\u9664\u4ee3\u7406",level:4},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://mp.weixin.qq.com/s/HyVsVXOe-6gzgD7Ea4lHcg",children:"Spring Boot \u5b9e\u73b0\u70ed\u63d2\u62d4 AOP\uff0c\u975e\u5e38\u5b9e\u7528\uff01"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u73b0\u5728\u6709\u8fd9\u4e48\u4e00\u4e2a\u9700\u6c42\uff1a\u5c31\u662f\u6211\u4eec\u65e5\u5fd7\u7684\u5f00\u4e0e\u5173\u662f\u4ea4\u7ed9\u4f7f\u7528\u4eba\u5458\u6765\u63a7\u5236\u7684\uff0c\u800c\u4e0d\u662f\u7531\u6211\u4eec\u5f00\u53d1\u4eba\u5458\u56fa\u5b9a\u5199\u6b7b\u7684\u3002\u5927\u5bb6\u90fd\u77e5\u9053\u53ef\u4ee5\u7528aop\u6765\u5b9e\u73b0\u65e5\u5fd7\u7ba1\u7406\uff0c\u4f46\u662f\u5982\u4f55\u52a8\u6001\u7684\u6765\u5b9e\u73b0\u65e5\u5fd7\u7ba1\u7406\u5462\uff1faop\u6e90\u7801\u4e2d\u7684\u5b9e\u73b0\u903b\u8f91\u4e2d\u6709\u8fd9\u4e48\u4e00\u4e2a\u6b65\u9aa4\uff0c\u5c31\u662f\u4f1a\u4f9d\u6b21\u626b\u63cfAdvice\u7684\u5b9e\u73b0\u7c7b\uff0c\u7136\u540e\u6267\u884c\u3002\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u81ea\u5b9a\u4e49\u4e00\u4e2aadvice\u7684\u5b9e\u73b0\u7c7b\u7136\u540e\uff0c\u5728\u7528\u6237\u60f3\u8981\u5f00\u542f\u65e5\u5fd7\u7684\u65f6\u5019\u5c31\u628aadvice\u52a0\u5230\u9879\u76ee\u4e2d\u6765\uff0c\u5173\u95ed\u65e5\u5fd7\u7684\u65f6\u5019\u5c31\u628aadvice\u5254\u9664\u5c31\u884c\u4e86\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"\u524d\u7f6e\u77e5\u8bc6",children:"\u524d\u7f6e\u77e5\u8bc6"}),"\n",(0,t.jsx)(n.h3,{id:"advice",children:"Advice:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"org.aopalliance.aop.Advice\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u201c\u901a\u77e5\u201d\uff0c\u8868\u793a Aspect \u5728\u7279\u5b9a\u7684 Join point \u91c7\u53d6\u7684\u64cd\u4f5c\u3002\u5305\u62ec \u201caround\u201d, \u201cbefore\u201d and \u201cafter \u7b49 Advice\uff0c\u5927\u4f53\u4e0a\u5206\u4e3a\u4e86\u4e09\u7c7b\uff1aBeforeAdvice\u3001MethodInterceptor\u3001AfterAdvice"}),"\n",(0,t.jsx)(n.h3,{id:"advisor",children:"Advisor:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"org.springframework.aop.Advisor\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u201c\u901a\u77e5\u8005\u201d\uff0c\u5b83\u6301\u6709 Advice\uff0c\u662f Spring AOP \u7684\u4e00\u4e2a\u57fa\u7840\u63a5\u53e3\u3002\u5b83\u7684\u5b50\u63a5\u53e3 PointcutAdvisor \u662f\u4e00\u4e2a\u529f\u80fd\u5b8c\u5584\u63a5\u53e3\uff0c\u5b83\u6db5\u76d6\u4e86\u7edd\u5927\u90e8\u5206\u7684 Advisor\u3002"}),"\n",(0,t.jsx)(n.h3,{id:"advised",children:"Advised:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"org.springframework.aop.framework.Advised\n"})}),"\n",(0,t.jsx)(n.p,{children:"AOP \u4ee3\u7406\u5de5\u5382\u914d\u7f6e\u7c7b\u63a5\u53e3\u3002\u63d0\u4f9b\u4e86\u64cd\u4f5c\u548c\u7ba1\u7406 Advice \u548c Advisor \u7684\u80fd\u529b\u3002\u5b83\u7684\u5b9e\u73b0\u7c7b ProxyFactory \u662f Spring AOP \u4e3b\u8981\u7528\u4e8e\u521b\u5efa AOP \u4ee3\u7406\u7c7b\u7684\u6838\u5fc3\u7c7b\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"\u70ed\u63d2\u62d4aop\u6267\u884c\u6838\u5fc3\u903b\u8f91",children:"\u70ed\u63d2\u62d4AOP\u6267\u884c\u6838\u5fc3\u903b\u8f91"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(35862).A+"",width:"786",height:"1342"})}),"\n",(0,t.jsx)(n.h2,{id:"\u6838\u5fc3\u5b9e\u73b0\u4ee3\u7801",children:"\u6838\u5fc3\u5b9e\u73b0\u4ee3\u7801"}),"\n",(0,t.jsx)(n.h3,{id:"1\u52a8\u6001\u7ba1\u7406advice\u7aef\u70b9\u5b9e\u73b0",children:"1\u3001\u52a8\u6001\u7ba1\u7406advice\u7aef\u70b9\u5b9e\u73b0"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@RestControllerEndpoint(id = "proxy")\n@RequiredArgsConstructor\npublic class ProxyMetaDefinitionControllerEndPoint {\n\n    private final ProxyMetaDefinitionRepository proxyMetaDefinitionRepository;\n\n\n    @GetMapping("listMeta")\n    public List<ProxyMetaDefinition> getProxyMetaDefinitions(){\n       return proxyMetaDefinitionRepository.getProxyMetaDefinitions();\n    }\n\n    @GetMapping("{id}")\n    public ProxyMetaDefinition getProxyMetaDefinition(@PathVariable("id") String proxyMetaDefinitionId){\n        return proxyMetaDefinitionRepository.getProxyMetaDefinition(proxyMetaDefinitionId);\n    }\n\n    @PostMapping("save")\n    public String save(@RequestBody ProxyMetaDefinition definition){\n\n        try {\n            proxyMetaDefinitionRepository.save(definition);\n            return "success";\n        } catch (Exception e) {\n\n        }\n        return "fail";\n\n    }\n\n    @PostMapping("delete/{id}")\n    public String delete(@PathVariable("id")String proxyMetaDefinitionId){\n        try {\n            proxyMetaDefinitionRepository.delete(proxyMetaDefinitionId);\n            return "success";\n        } catch (Exception e) {\n\n        }\n        return "fail";\n    }\n\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"2\u5229\u7528\u4e8b\u4ef6\u76d1\u542c\u673a\u5236\u6355\u83b7\u5b89\u88c5\u6216\u8005\u5378\u8f7d\u63d2\u4ef6",children:"2\u3001\u5229\u7528\u4e8b\u4ef6\u76d1\u542c\u673a\u5236\u6355\u83b7\u5b89\u88c5\u6216\u8005\u5378\u8f7d\u63d2\u4ef6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@RequiredArgsConstructor\npublic class ProxyMetaDefinitionChangeListener {\n\n    private final AopPluginFactory aopPluginFactory;\n\n    @EventListener\n    public void listener(ProxyMetaDefinitionChangeEvent proxyMetaDefinitionChangeEvent){\n        ProxyMetaInfo proxyMetaInfo = aopPluginFactory.getProxyMetaInfo(proxyMetaDefinitionChangeEvent.getProxyMetaDefinition());\n        switch (proxyMetaDefinitionChangeEvent.getOperateEventEnum()){\n            case ADD:\n                aopPluginFactory.installPlugin(proxyMetaInfo);\n                break;\n            case DEL:\n                aopPluginFactory.uninstallPlugin(proxyMetaInfo.getId());\n                break;\n        }\n\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3\u5b89\u88c5\u63d2\u4ef6",children:"3\u3001\u5b89\u88c5\u63d2\u4ef6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"public void installPlugin(ProxyMetaInfo proxyMetaInfo){\n        if(StringUtils.isEmpty(proxyMetaInfo.getId())){\n            proxyMetaInfo.setId(proxyMetaInfo.getProxyUrl() + SPIILT + proxyMetaInfo.getProxyClassName());\n        }\n        AopUtil.registerProxy(defaultListableBeanFactory,proxyMetaInfo);\n    }\n"})}),"\n",(0,t.jsx)(n.h3,{id:"4\u5b89\u88c5\u63d2\u4ef6\u6838\u5fc3\u5b9e\u73b0",children:"4\u3001\u5b89\u88c5\u63d2\u4ef6\u6838\u5fc3\u5b9e\u73b0"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"public static void registerProxy(DefaultListableBeanFactory beanFactory,ProxyMetaInfo proxyMetaInfo){\n        AspectJExpressionPointcutAdvisor advisor = getAspectJExpressionPointcutAdvisor(beanFactory, proxyMetaInfo);\n        addOrDelAdvice(beanFactory,OperateEventEnum.ADD,advisor);\n\n    }\n\n    private static AspectJExpressionPointcutAdvisor getAspectJExpressionPointcutAdvisor(DefaultListableBeanFactory beanFactory, ProxyMetaInfo proxyMetaInfo) {\n        BeanDefinitionBuilder builder = BeanDefinitionBuilder.genericBeanDefinition();\n        GenericBeanDefinition beanDefinition = (GenericBeanDefinition) builder.getBeanDefinition();\n        beanDefinition.setBeanClass(AspectJExpressionPointcutAdvisor.class);\n        AspectJExpressionPointcutAdvisor advisor = new AspectJExpressionPointcutAdvisor();\n        advisor.setExpression(proxyMetaInfo.getPointcut());\n        advisor.setAdvice(Objects.requireNonNull(getMethodInterceptor(proxyMetaInfo.getProxyUrl(), proxyMetaInfo.getProxyClassName())));\n        beanDefinition.setInstanceSupplier((Supplier<AspectJExpressionPointcutAdvisor>) () -> advisor);\n        beanFactory.registerBeanDefinition(PROXY_PLUGIN_PREFIX + proxyMetaInfo.getId(),beanDefinition);\n\n        return advisor;\n    }\n"})}),"\n",(0,t.jsx)(n.h3,{id:"5\u5378\u8f7d\u63d2\u4ef6",children:"5\u3001\u5378\u8f7d\u63d2\u4ef6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'public void uninstallPlugin(String id){\n        String beanName = PROXY_PLUGIN_PREFIX + id;\n        if(defaultListableBeanFactory.containsBean(beanName)){\n           AopUtil.destoryProxy(defaultListableBeanFactory,id);\n        }else{\n            throw new NoSuchElementException("Plugin not found: " + id);\n        }\n    }\n'})}),"\n",(0,t.jsx)(n.h3,{id:"6\u5378\u8f7d\u63d2\u4ef6\u6838\u5fc3\u5b9e\u73b0",children:"6\u3001\u5378\u8f7d\u63d2\u4ef6\u6838\u5fc3\u5b9e\u73b0"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"public static void destoryProxy(DefaultListableBeanFactory beanFactory,String id){\n        String beanName = PROXY_PLUGIN_PREFIX + id;\n        if(beanFactory.containsBean(beanName)){\n            AspectJExpressionPointcutAdvisor advisor = beanFactory.getBean(beanName,AspectJExpressionPointcutAdvisor.class);\n            addOrDelAdvice(beanFactory,OperateEventEnum.DEL,advisor);\n            beanFactory.destroyBean(beanFactory.getBean(beanName));\n        }\n    }\n"})}),"\n",(0,t.jsx)(n.h3,{id:"7\u64cd\u4f5cadvice\u5b9e\u73b0",children:"7\u3001\u64cd\u4f5cadvice\u5b9e\u73b0"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'public static void addOrDelAdvice(DefaultListableBeanFactory beanFactory, OperateEventEnum operateEventEnum,AspectJExpressionPointcutAdvisor advisor){\n        AspectJExpressionPointcut pointcut = (AspectJExpressionPointcut) advisor.getPointcut();\n        for (String beanDefinitionName : beanFactory.getBeanDefinitionNames()) {\n            Object bean = beanFactory.getBean(beanDefinitionName);\n            if(!(bean instanceof Advised)){\n                if(operateEventEnum == OperateEventEnum.ADD){\n                    buildCandidateAdvised(beanFactory,advisor,bean,beanDefinitionName);\n                }\n                continue;\n            }\n            Advised advisedBean = (Advised) bean;\n            boolean isFindMatchAdvised = findMatchAdvised(advisedBean.getClass(),pointcut);\n            if(operateEventEnum == OperateEventEnum.DEL){\n                if(isFindMatchAdvised){\n                    advisedBean.removeAdvice(advisor.getAdvice());\n                    log.info("######################################### Remove Advice --\x3e\u3010{}\u3011 For Bean --\x3e\u3010{}\u3011 SUCCESS !",advisor.getAdvice().getClass().getName(),bean.getClass().getName());\n                }\n            }else if(operateEventEnum == OperateEventEnum.ADD){\n                if(isFindMatchAdvised){\n                    advisedBean.addAdvice(advisor.getAdvice());\n                    log.info("######################################### Add Advice --\x3e\u3010{}\u3011 For Bean --\x3e\u3010{}\u3011 SUCCESS !",advisor.getAdvice().getClass().getName(),bean.getClass().getName());\n                }\n            }\n\n\n        }\n    }\n'})}),"\n",(0,t.jsx)(n.h2,{id:"\u70ed\u63d2\u62d4aop\u6f14\u793a\u793a\u4f8b",children:"\u70ed\u63d2\u62d4AOP\u6f14\u793a\u793a\u4f8b"}),"\n",(0,t.jsx)(n.h3,{id:"1\u521b\u5efa\u4e00\u4e2aservice",children:"1\u3001\u521b\u5efa\u4e00\u4e2aservice"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Service\n@Slf4j\npublic class HelloService implements BeanNameAware, BeanFactoryAware {\n    private BeanFactory beanFactory;\n\n    private String beanName;\n\n    @SneakyThrows\n    public String sayHello(String message) {\n        Object bean = beanFactory.getBean(beanName);\n        log.info("============================ {} is Advised : {}",bean, bean instanceof Advised);\n        TimeUnit.SECONDS.sleep(new Random().nextInt(3));\n        log.info("============================ hello:{}",message);\n\n        return "hello:" + message;\n\n    }\n\n    @Override\n    public void setBeanFactory(BeanFactory beanFactory) throws BeansException {\n        this.beanFactory = beanFactory;\n    }\n\n    @Override\n    public void setBeanName(String name) {\n        this.beanName = name;\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"2\u521b\u5efa\u4e00\u4e2acontroller",children:"2\u3001\u521b\u5efa\u4e00\u4e2acontroller"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@RestController\n@RequestMapping("hello")\n@RequiredArgsConstructor\npublic class HelloController {\n\n    private final HelloService helloService;\n\n    @GetMapping("{message}")\n    public String sayHello(@PathVariable("message")String message){\n        return helloService.sayHello(message);\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"3\u51c6\u5907\u4e00\u4e2a\u65e5\u5fd7\u5207\u9762jar",children:"3\u3001\u51c6\u5907\u4e00\u4e2a\u65e5\u5fd7\u5207\u9762jar"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(25441).A+"",width:"798",height:"378"})}),"\n",(0,t.jsx)(n.p,{children:"\u5207\u9762\u5185\u5bb9\u4e3a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Slf4j\npublic class LogMethodInterceptor implements MethodInterceptor {\n    @Override\n    public Object invoke(MethodInvocation invocation) throws Throwable {\n        Object result;\n        try {\n            result = invocation.proceed();\n        } finally {\n           log.info(">>>>>>>>>>>>>>>>>>>>>>>>TargetClass:\u3010{}\u3011,method:\u3010{}\u3011,args:\u3010{}\u3011",invocation.getThis().getClass().getName(),invocation.getMethod().getName(), Arrays.toString(invocation.getArguments()));\n        }\n\n        return result;\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"\u6d4b\u8bd5",children:"\u6d4b\u8bd5"}),"\n",(0,t.jsxs)(n.h3,{id:"\u573a\u666f\u4e00\u672a\u6dfb\u52a0\u5207\u9762\u65f6-\u6d4f\u89c8\u5668\u8bbf\u95eehttplocalhost8080hellozhangsan-\u89c2\u5bdf\u63a7\u5236\u53f0",children:["\u573a\u666f\u4e00\uff1a\u672a\u6dfb\u52a0\u5207\u9762\u65f6 \u6d4f\u89c8\u5668\u8bbf\u95ee\uff1a",(0,t.jsx)(n.a,{href:"http://localhost:8080/hello/zhangsan",children:"http://localhost:8080/hello/zhangsan"})," \u89c2\u5bdf\u63a7\u5236\u53f0"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(47396).A+"",width:"1080",height:"83"})}),"\n",(0,t.jsx)(n.h3,{id:"\u573a\u666f\u4e8c\u901a\u8fc7postman\u52a8\u6001\u64cd\u4f5c\u4ee3\u7406",children:"\u573a\u666f\u4e8c\uff1a\u901a\u8fc7postman\u52a8\u6001\u64cd\u4f5c\u4ee3\u7406"}),"\n",(0,t.jsx)(n.h4,{id:"1\u65b0\u589e\u4ee3\u7406",children:"1\u3001\u65b0\u589e\u4ee3\u7406"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(25359).A+"",width:"1080",height:"569"})}),"\n",(0,t.jsx)(n.p,{children:"\u89c2\u5bdf\u63a7\u5236\u53f0"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"######################################### BuildCandidateAdvised --\x3e\u3010com.github.lybgeek.aop.test.hello.service.HelloService\u3011 With Advice --\x3e\u3010com.github.lybgeek.interceptor.LogMethodInterceptor\u3011 SUCCESS !\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u6b64\u65f6\u6d4f\u89c8\u5668\u8bbf\u95ee\uff1a",(0,t.jsx)(n.a,{href:"http://localhost:8080/hello/zhangsan",children:"http://localhost:8080/hello/zhangsan"})]}),"\n",(0,t.jsx)(n.p,{children:"\u518d\u6b21\u89c2\u5bdf\u63a7\u5236\u53f0"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(57426).A+"",width:"1080",height:"91"})}),"\n",(0,t.jsx)(n.p,{children:"\u51fa\u73b0\u4e86\u5207\u9762\u65e5\u5fd7\u4fe1\u606f\uff0c\u8bf4\u660e\u4ee3\u7406\u751f\u6548"}),"\n",(0,t.jsx)(n.h4,{id:"2\u5220\u9664\u4ee3\u7406",children:"2\u3001\u5220\u9664\u4ee3\u7406"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(67325).A+"",width:"1080",height:"536"})}),"\n",(0,t.jsx)(n.p,{children:"\u89c2\u5bdf\u63a7\u5236\u53f0"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"######################################### Remove Advice --\x3e\u3010com.github.lybgeek.interceptor.LogMethodInterceptor\u3011 For Bean --\x3e\u3010com.github.lybgeek.aop.test.hello.service.HelloService$$EnhancerBySpringCGLIB$$7bc75aa3\u3011 SUCCESS !\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u6b64\u65f6\u6d4f\u89c8\u5668\u8bbf\u95ee\uff1a",(0,t.jsx)(n.a,{href:"http://localhost:8080/hello/zhangsan",children:"http://localhost:8080/hello/zhangsan"})]}),"\n",(0,t.jsx)(n.p,{children:"\u518d\u6b21\u89c2\u5bdf\u63a7\u5236\u53f0"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(11744).A+"",width:"1080",height:"77"})}),"\n",(0,t.jsx)(n.p,{children:"\u6b64\u65f6\u6ca1\u6709\u51fa\u73b0\u5207\u9762\u65e5\u5fd7\u4fe1\u606f\uff0c\u8bf4\u660e\u4ee3\u7406\u5220\u9664\u6210\u529f"}),"\n",(0,t.jsx)(n.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,t.jsx)(n.p,{children:"\u672c\u6587\u5b9e\u73b0\u70ed\u63d2\u62d4AOP\u5c31\u5728\u4e8e\u5bf9advice\u3001advised\u3001advisor\u3001pointcut\u6982\u5ff5\u7684\u7406\u89e3\uff0c\u8fd9\u662f\u5b9e\u73b0\u70ed\u63d2\u62d4AOP\u7684\u524d\u63d0\uff0c\u5176\u6b21\u5c31\u662f\u5bf9\u81ea\u5b9a\u4e49classloader\u4e5f\u9700\u8981\u6709\u4e00\u5b9a\u7684\u4e86\u89e3\uff0c\u56e0\u4e3a\u6211\u4eecjar\u4e0d\u4e00\u5b9a\u4ececlasspath\u5e95\u4e0b\u52a0\u8f7d\uff0c\u4e5f\u6709\u53ef\u80fd\u6765\u6e90\u5176\u4ed6\u5730\u65b9\uff0c\u6bd4\u5982\u8fdc\u7a0b\u94fe\u63a5\u5565\u7684\uff0c\u6700\u540e\u5c31\u662f\u628a\u539f\u5148spring\u81ea\u52a8\u5e2e\u6211\u4eec\u5b9e\u73b0aop\uff0c\u6211\u4eec\u5229\u7528\u76f8\u5173\u7684api\uff0c\u81ea\u5df1\u624b\u52a8\u5b9e\u73b0\u4e00\u904d\uff0c\u793a\u4f8b\u4ee3\u7801\u7684api\u53ea\u662f\u5229\u7528spring api\u5176\u4e2d\u4e00\u79cd\u5b9e\u73b0\u65b9\u5f0f\uff0c\u5b83\u8fd8\u6709\u591a\u79cd\u5b9e\u73b0\u65b9\u5f0f\uff0c\u6bd4\u5982\u53ef\u4ee5\u5229\u7528TargetSource\uff0c\u611f\u5174\u8da3\u7684\u670b\u53cb\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5df1\u5b9e\u73b0\u4e00\u628a\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u81f3\u4e8e\u90a3\u4e2a\u4ee3\u7406\u589e\u5220\u6539\u67e5\u7aef\u70b9contoller\uff0c\u662f\u6211\u4e4b\u524d\u770bspringcloud gateway\u7684\u8def\u7531\u5b9a\u4f4d\u5668\u7aef\u70b9\u6e90\u7801\uff0c\u4e00\u76f4\u6ca1\u627e\u5230\u673a\u4f1a\u5b9e\u73b0\u4e00\u4e0b\uff0c\u5c31\u628a\u4ed6\u642c\u6765\u8fd9\u4e2a\u793a\u4f8b\u5b9e\u73b0\u4e00\u628a\uff0c\u52a0\u6df1\u4e00\u4e0b\u5370\u8c61\uff01"})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},35862:(e,n,i)=>{i.d(n,{A:()=>a});const a=i.p+"assets/images/1-e565177062a7c01b12d37ee41336ed6a.jpg"},47396:(e,n,i)=>{i.d(n,{A:()=>a});const a=i.p+"assets/images/3-82a73b669b51b8b4701f2998c2596aea.jpg"},57426:(e,n,i)=>{i.d(n,{A:()=>a});const a=i.p+"assets/images/5-777164fcaabca50c12d2e5ed76a88ab3.jpg"},67325:(e,n,i)=>{i.d(n,{A:()=>a});const a=i.p+"assets/images/6-994071aee71111fccb69d8e66d9a81f3.jpg"}}]);