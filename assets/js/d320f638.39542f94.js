"use strict";(self.webpackChunklight_docusaurus=self.webpackChunklight_docusaurus||[]).push([[869],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>k});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),m=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=m(e.components);return r.createElement(p.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},s=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,p=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=m(n),s=a,k=u["".concat(p,".").concat(s)]||u[s]||d[s]||l;return n?r.createElement(k,o(o({ref:t},c),{},{components:n})):r.createElement(k,o({ref:t},c))}));function k(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,o=new Array(l);o[0]=s;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i[u]="string"==typeof e?e:a,o[1]=i;for(var m=2;m<l;m++)o[m]=n[m];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}s.displayName="MDXCreateElement"},9398:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>i,toc:()=>m});var r=n(7462),a=(n(7294),n(3905));const l={},o=void 0,i={unversionedId:"zh-cn/devenv/Docker-EMQX",id:"zh-cn/devenv/Docker-EMQX",title:"Docker-EMQX",description:"EMQX Offical",source:"@site/docs/zh-cn/devenv/Docker-EMQX.md",sourceDirName:"zh-cn/devenv",slug:"/zh-cn/devenv/Docker-EMQX",permalink:"/light-docusaurus/docs/zh-cn/devenv/Docker-EMQX",draft:!1,editUrl:"https://github.com/lorchr/light-docusaurus/tree/main/docs/zh-cn/devenv/Docker-EMQX.md",tags:[],version:"current",frontMatter:{},sidebar:"troch",previous:{title:"Docker-InfluxDB",permalink:"/light-docusaurus/docs/zh-cn/devenv/Docker-InfluxDB"},next:{title:"Docker-MinIO",permalink:"/light-docusaurus/docs/zh-cn/devenv/Docker-MinIO"}},p={},m=[{value:"1. Docker\u5b89\u88c5",id:"1-docker\u5b89\u88c5",level:2},{value:"2. \u5171\u4eab\u8ba2\u9605",id:"2-\u5171\u4eab\u8ba2\u9605",level:2}],c={toc:m},u="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://www.emqx.io/"},"EMQX Offical"),"\n",(0,a.kt)("a",{parentName:"p",href:"https://www.emqx.io/docs/en/v4.4/getting-started/install.html#running-emqx-in-docker-contain-a-simple-docker-compose-cluster"},"EMQX Offical Docker"),"\n",(0,a.kt)("a",{parentName:"p",href:"https://hub.docker.com/_/emqx"},"EMQX Docker")),(0,a.kt)("h2",{id:"1-docker\u5b89\u88c5"},"1. Docker\u5b89\u88c5"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# \u521b\u5efaNetwork\ndocker network create dev\n\n# \u521b\u5efa\u6570\u636e\u5377\ndocker volume create emqx_data\n\ndocker run -d \\\n  --publish 18083:18083 \\\n  --publish 1883:1883 \\\n  --volume //d/docker/emqx/data:/opt/emqx/data \\\n  --volume //d/docker/emqx/conf:/opt/emqx/etc \\\n  --volume //d/docker/emqx/log:/opt/emqx/log \\\n  --env HOCON_ENV_OVERRIDE_PREFIX=DEV_ \\\n  --env DEV_EMQX_MQTT__SHARED_SUBSCRIPTION=true \\\n  --env DEV_EMQX_ZONE__EXTERNAL__SHARED_SUBSCRIPTION=true \\\n  --env DEV_EMQX_BROKER__SHARED_SUBSCRIPTION_STRATEGY=round_robin \\\n  --env DEV_EMQX_BROKER__SHARED_DISPATCH_ACK_ENABLE=true \\\n  --net dev \\\n  --restart=no \\\n  --name emqx \\\n  emqx:4.3\n\ndocker run -d \\\n  --publish 18084:18083 \\\n  --publish 1884:1883 \\\n  --volume //d/docker/emqx/data:/opt/emqx/data \\\n  --volume //d/docker/emqx/conf:/opt/emqx/etc \\\n  --volume //d/docker/emqx/log:/opt/emqx/log \\\n  --env EMQX_MQTT__SHARED_SUBSCRIPTION=true \\\n  --env EMQX_ZONE__EXTERNAL__SHARED_SUBSCRIPTION=true \\\n  --env EMQX_BROKER__SHARED_SUBSCRIPTION_STRATEGY=round_robin \\\n  --env EMQX_BROKER__SHARED_DISPATCH_ACK_ENABLE=true \\\n  --net dev \\\n  --restart=no \\\n  --name emqx2 \\\n  emqx:4.3\n\ndocker exec -it -u root emqx /bin/bash\n\n# \u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\nvim /etc/emqx/emqx.conf\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"http://localhost:18083"},"Dashboard"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"admin/public"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://mqttx.app/zh/downloads"},"MQTTX"))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u6ce8\uff1a")," \u4f7f\u7528\u73af\u5883\u53d8\u91cf\u4fee\u6539\u9ed8\u8ba4\u914d\u7f6e\u53ea\u652f\u6301",(0,a.kt)("a",{parentName:"p",href:"https://www.emqx.io/docs/en/v5.0/admin/cfg.html"},"Configuration Files"),"\u5217\u8868\u4e2d\u7684\u5c5e\u6027\uff0c\u5171\u4eab\u8ba2\u9605\u7684\u914d\u7f6e\u4f7f\u7528\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u65e0\u6548"),(0,a.kt)("h2",{id:"2-\u5171\u4eab\u8ba2\u9605"},"2. \u5171\u4eab\u8ba2\u9605"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.emqx.com/en/blog/introduction-to-mqtt5-protocol-shared-subscription"},"\u5171\u4eab\u8ba2\u9605 - MQTT 5.0 \u65b0\u7279\u6027")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.emqx.io/docs/en/v5.0/messaging/mqtt-concepts.html#shared-subscription"},"MQTT\u6838\u5fc3\u6982\u5ff5-\u5171\u4eab\u8ba2\u9605")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.emqx.io/docs/en/v5.0/messaging/mqtt-shared-subscription.html"},"\u53d1\u5e03\u8ba2\u9605-\u5171\u4eab\u8ba2\u9605")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.emqx.io/docs/en/v4.4/advanced/shared-subscriptions.html"},"MQTT\u9ad8\u7ea7\u7279\u6027-\u5171\u4eab\u8ba2\u9605 4.4")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.emqx.io/docs/en/v5.0/advanced/shared-subscriptions.html"},"MQTT\u9ad8\u7ea7\u7279\u6027-\u5171\u4eab\u8ba2\u9605 5.0"))),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u5f00\u542f\u5171\u4eab\u8ba2\u9605"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-conf"},"# \u5f00\u542f\u5171\u4eab\u8ba2\u9605\nmqtt.shared_subscription = true\nzone.external.shared_subscription = true\n\n# \u8d1f\u8f7d\u5747\u8861\u7b56\u7565 random round_robin sticky hash\nbroker.shared_subscription_strategy = round_robin\n\n# \u9002\u7528\u4e8e QoS1 QoS2 \u6d88\u606f\uff0c\u542f\u7528\u540e\uff0c\u5f53\u5ba2\u6237\u7aef\u79bb\u7ebf\u65f6\uff0c\u5c06\u6d88\u606f\u6d3e\u53d1\u7ed9\u8ba2\u9605\u7ec4\u5185\u5176\u4ed6\u5ba2\u6237\u7aef\nbroker.shared_dispatch_ack_enabled = true\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u5171\u4eab\u8ba2\u9605\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565"),(0,a.kt)("table",{parentName:"li"},(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u5747\u8861\u7b56\u7565"),(0,a.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"random"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5728\u6240\u6709\u8ba2\u9605\u8005\u4e2d\u968f\u673a\u9009\u62e9")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"round_robin"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6309\u7167\u8ba2\u9605\u987a\u5e8f")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"sticky"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4e00\u76f4\u53d1\u5f80\u4e0a\u6b21\u9009\u53d6\u7684\u8ba2\u9605\u8005")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"hash"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6309\u7167\u53d1\u5e03\u8005 ClientID \u7684\u54c8\u5e0c\u503c")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"hash_clientid"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6309\u7167\u53d1\u5e03\u8005 ClientID \u7684\u54c8\u5e0c\u503c")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"hash_topic"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6309\u7167topic \u7684\u54c8\u5e0c\u503c"))))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u5173\u4e8eTopic\u8def\u5f84"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"$share/<group-name>/<topic-name>(/<sub_topic-name>)*\n")),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"$share : \u5171\u4eab\u8ba2\u9605\u7684\u6807\u8bc6")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"group-name : \u5171\u4eab\u8ba2\u9605\u7684\u7ec4\u522b\u540d\u79f0 group-name")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"topic-name : \u5b9e\u9645\u7684topic\u540d\u79f0")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"topic-sub-name: topic\u540d\u79f0\uff0c\u53ef\u4ee5\u6709\u591a\u6bb5\u7ec4\u6210"),(0,a.kt)("table",{parentName:"li"},(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u793a\u4f8b"),(0,a.kt)("th",{parentName:"tr",align:null},"\u524d\u7f00"),(0,a.kt)("th",{parentName:"tr",align:null},"\u7ec4\u522b"),(0,a.kt)("th",{parentName:"tr",align:null},"Topic \u540d\u79f0"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"$share/abc/t/1"),(0,a.kt)("td",{parentName:"tr",align:null},"$share"),(0,a.kt)("td",{parentName:"tr",align:null},"abc"),(0,a.kt)("td",{parentName:"tr",align:null},"t/1")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"$share/group/topic/sub_topic"),(0,a.kt)("td",{parentName:"tr",align:null},"$share"),(0,a.kt)("td",{parentName:"tr",align:null},"group"),(0,a.kt)("td",{parentName:"tr",align:null},"topic/sub_topic")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"$queue/topic/sub_topic"),(0,a.kt)("td",{parentName:"tr",align:null},"$queue"),(0,a.kt)("td",{parentName:"tr",align:null},"-"),(0,a.kt)("td",{parentName:"tr",align:null},"topic/sub_topic")))))))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u6ce8\u610f\uff1a")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u5728\u8ba2\u9605Topic\u65f6\uff0c\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"li"},"$share/<group-name>/<topic-name>"),"\u6216",(0,a.kt)("inlineCode",{parentName:"li"},"$queue/<topic-name>")),(0,a.kt)("li",{parentName:"ul"},"\u5728\u53d1\u9001\u6d88\u606f\u65f6\uff0c\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"li"},"<topic-name>"),"\uff0c\u4e0d\u9700\u8981\u5e26",(0,a.kt)("inlineCode",{parentName:"li"},"\u524d\u7f00"),"\u53ca",(0,a.kt)("inlineCode",{parentName:"li"},"\u7ec4\u522b"))))}d.isMDXComponent=!0}}]);