"use strict";(self.webpackChunklight_docusaurus=self.webpackChunklight_docusaurus||[]).push([[67601],{12670:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>l});var i=t(74848),r=t(28453);const a={},c=void 0,s={id:"zh-cn/spring-boot/Spring-Boot-RSA-AES-Encryption",title:"Spring-Boot-RSA-AES-Encryption",description:"- SpringBoot-\u5b9e\u73b0RAS+AES\u81ea\u52a8\u63a5\u53e3\u89e3\u5bc6",source:"@site/docs/zh-cn/spring-boot/28-Spring-Boot-RSA-AES-Encryption.md",sourceDirName:"zh-cn/spring-boot",slug:"/zh-cn/spring-boot/Spring-Boot-RSA-AES-Encryption",permalink:"/docs/zh-cn/spring-boot/Spring-Boot-RSA-AES-Encryption",draft:!1,unlisted:!1,editUrl:"https://github.com/lorchr/light-docusaurus/tree/main/docs/zh-cn/spring-boot/28-Spring-Boot-RSA-AES-Encryption.md",tags:[],version:"current",sidebarPosition:28,frontMatter:{},sidebar:"troch",previous:{title:"ApiKey-design",permalink:"/docs/zh-cn/spring-boot/ApiKey-design"},next:{title:"Slim-Spring-Boot-FatJar",permalink:"/docs/zh-cn/spring-boot/Slim-Spring-Boot-FatJar"}},o={},l=[{value:"\u4e00\u3001\u8bb2\u4e2a\u4e8b\u6545",id:"\u4e00\u8bb2\u4e2a\u4e8b\u6545",level:2},{value:"\u4e8c\u3001RSA\u548cAES\u57fa\u7840\u77e5\u8bc6",id:"\u4e8crsa\u548caes\u57fa\u7840\u77e5\u8bc6",level:2},{value:"1\u3001\u975e\u5bf9\u79f0\u52a0\u5bc6\u548c\u5bf9\u79f0\u52a0\u5bc6",id:"1\u975e\u5bf9\u79f0\u52a0\u5bc6\u548c\u5bf9\u79f0\u52a0\u5bc6",level:3},{value:"\u975e\u5bf9\u79f0\u52a0\u5bc6",id:"\u975e\u5bf9\u79f0\u52a0\u5bc6",level:4},{value:"\u5bf9\u79f0\u52a0\u5bc6",id:"\u5bf9\u79f0\u52a0\u5bc6",level:4},{value:"2\u3001RSA\u57fa\u7840\u77e5\u8bc6",id:"2rsa\u57fa\u7840\u77e5\u8bc6",level:3},{value:"RSA\u52a0\u5bc6\u89e3\u5bc6\u7b97\u6cd5\u652f\u6301\u4e09\u79cd\u586b\u5145\u6a21\u5f0f\uff0c",id:"rsa\u52a0\u5bc6\u89e3\u5bc6\u7b97\u6cd5\u652f\u6301\u4e09\u79cd\u586b\u5145\u6a21\u5f0f",level:4},{value:"RSA \u5e38\u7528\u7684\u52a0\u5bc6\u586b\u5145\u6a21\u5f0f",id:"rsa-\u5e38\u7528\u7684\u52a0\u5bc6\u586b\u5145\u6a21\u5f0f",level:4},{value:"3\u3001AES\u57fa\u7840\u77e5\u8bc6",id:"3aes\u57fa\u7840\u77e5\u8bc6",level:3},{value:"<code>AES</code> \u7b80\u4ecb",id:"aes-\u7b80\u4ecb",level:4},{value:"AES\u52a0\u5bc6\u89e3\u5bc6",id:"aes\u52a0\u5bc6\u89e3\u5bc6",level:4},{value:"AES\u5e38\u89c1\u7684\u5de5\u4f5c\u6a21\u5f0f\uff1a",id:"aes\u5e38\u89c1\u7684\u5de5\u4f5c\u6a21\u5f0f",level:4},{value:"AES\u586b\u5145\u6a21\u5f0f",id:"aes\u586b\u5145\u6a21\u5f0f",level:4},{value:"AES\u5bc6\u94a5KEY\u548c\u521d\u59cb\u5316\u5411\u91cfIV",id:"aes\u5bc6\u94a5key\u548c\u521d\u59cb\u5316\u5411\u91cfiv",level:4},{value:"\u4e09\u3001\u52a0\u5bc6\u7b56\u7565",id:"\u4e09\u52a0\u5bc6\u7b56\u7565",level:2},{value:"1\u3001\u4e3b\u8981\u601d\u8def\uff1a",id:"1\u4e3b\u8981\u601d\u8def",level:3},{value:"2\u3001\u6d89\u53ca\u5de5\u5177\u7c7b\uff1a",id:"2\u6d89\u53ca\u5de5\u5177\u7c7b",level:3},{value:"3\u3001\u52a0\u5bc6\u7b56\u7565",id:"3\u52a0\u5bc6\u7b56\u7565",level:3},{value:"4\u3001\u4ea4\u4e92\u65b9\u5f0f",id:"4\u4ea4\u4e92\u65b9\u5f0f",level:3},{value:"\u524d\u7aef\uff1a",id:"\u524d\u7aef",level:4},{value:"\u540e\u7aef\uff1a",id:"\u540e\u7aef",level:4},{value:"\u56db\u3001\u670d\u52a1\u5668\u81ea\u52a8\u89e3\u5bc6",id:"\u56db\u670d\u52a1\u5668\u81ea\u52a8\u89e3\u5bc6",level:2},{value:"1\u3001\u81ea\u5b9a\u4e49\u89e3\u5bc6\u6ce8\u89e3\uff1a<code>@RequestRSA</code>",id:"1\u81ea\u5b9a\u4e49\u89e3\u5bc6\u6ce8\u89e3requestrsa",level:3},{value:"2\u3001\u521b\u5efa\u4e00\u4e2aaop\u5207\u7247",id:"2\u521b\u5efa\u4e00\u4e2aaop\u5207\u7247",level:3},{value:"3\u3001RequestDecryptionUtil \u89e3\u5bc6\u7c7b",id:"3requestdecryptionutil-\u89e3\u5bc6\u7c7b",level:3},{value:"4\u3001ActivityRSAUtil \u5de5\u5177\u7c7b",id:"4activityrsautil-\u5de5\u5177\u7c7b",level:3},{value:"5\u3001AES256Util \u5de5\u5177\u7c7b",id:"5aes256util-\u5de5\u5177\u7c7b",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://juejin.cn/post/7203931072260915259",children:"SpringBoot-\u5b9e\u73b0RAS+AES\u81ea\u52a8\u63a5\u53e3\u89e3\u5bc6"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://mp.weixin.qq.com/s/LuTB6wE_XFVKXZNZi-Q3rw",children:"SpringBoot \u5b9e\u73b0 RAS+AES \u81ea\u52a8\u63a5\u53e3\u89e3\u5bc6"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u4e00\u8bb2\u4e2a\u4e8b\u6545",children:"\u4e00\u3001\u8bb2\u4e2a\u4e8b\u6545"}),"\n",(0,i.jsxs)(n.p,{children:["\u63a5\u53e3\u5b89\u5168\u8001\u751f\u5e38\u8c08\u4e86\n\u8fc7\u5e74\u4e4b\u524d\u505a\u4e86\u8fc7\u4e00\u6b3e\u98de\u673a\u5927\u6218\u7684H5\u5c0f\u6e38\u620f\uff0c\u91cc\u9762\u65e0\u9650\u6a21\u5f0f-\u9700\u8981\u4fdd\u5b58\u7528\u6237\u7684\u79ef\u5206\uff0c\u56e0\u4e3a\u4f7f\u7528\u7684Body\u4f20\u53c2\uff0c\u53c2\u6570\u662f\u53ef\u89c1\u7684\uff0c\u4e3a\u4e86\u63a5\u53e3\u5b89\u5168\u6211\uff0c\u6211\u548c\u524d\u7aef\u7ea6\u5b9a\u4e86\u4f20\u9012\u53c2\u6570\u662f\uff1a",(0,i.jsx)(n.code,{children:"\u7528\u6237\u65e0\u9650\u6a21\u5f0f\u7684\u79ef\u5206+\u201c\u6211\u4eec\u7ea6\u5b9a\u7684\u4e00\u4e2a\u6570\u5b57\u201d+\u7528\u6237id\u7684\u548c"}),"\uff0c\u5728\u7528",(0,i.jsx)(n.code,{children:"Base64"}),"\u52a0\u5bc6\uff0c\u8bf7\u6c42\u5230\u670d\u52a1\u5668\u6211\u518d\u89e3\u5bc6\uff0c\u51fa\u7528\u6237\u65e0\u9650\u6a21\u5f0f\u7684\u79ef\u5206\uff1b\u5982\u4e0b\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n \xa0 \xa0"integral": "MTExMTM0NzY5NQ==",\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u53ef\u662f\u8fc7\u5e74\u7684\u65f6\u5019\uff0c\u8fd0\u8425\u7a81\u7136\u627e\u6211\u8bf4\u65e0\u9650\u6a21\u5f0f\u79ef\u5206\u6392\u884c\u699c\u5206\u6570\u4e0d\u5bf9\uff1a"}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u5c31\u5f88\u8be1\u5f02\u4e86\uff0c\u7b2c\u4e8c\u540d\u624d\u4e00\u4e07\u591a\u5206\uff0c\u7b2c\u4e00\u540d\u5c3140\u591a\u4e07\u5206\uff01\uff01\uff01\uff01\n\u4e00\u5f00\u59cb\u6211\u4ee5\u4e3a\u662f\u6211\u89e3\u5bc6\u6709\u95ee\u9898\uff0c\u53cd\u590d\u770b\u4e86\u597d\u51e0\u53d8\uff0c\u53ef\u5c31\u4e24\u4e09\u884c\u4ee3\u7801\u4e0d\u53ef\u80fd\u6709\u95ee\u9898\u7684\uff01\uff01\uff01\n\u6ca1\u529e\u6cd5\u6211\u53bb\u7ffb\u4e86\u597d\u4e45\u7684\u65e5\u5fd7\uff0c\u624d\u53d1\u73b0\u8fd9\u4e2a\u7528\u6237\u628a\u6211\u63a5\u53e3\u53c2\u6570\u7ed9\u6539\u4e86\u3002\u3002\u3002\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u4ed6\u628a",(0,i.jsx)(n.code,{children:"Base64"}),"\u63a5\u53e3\u53c2\u6570\u6539\u4e86"]}),"\n",(0,i.jsx)(n.p,{children:"\u4e8b\u5df2\u81f3\u6b64\uff0c\u6211\u4e5f\u4e0d\u80fd\u602a\u7528\u6237\uff0c\u8c01\u8ba9\u6211\u628a\u4eba\u5bb6\u60f3\u5f97\u592a\u7b80\u5355\uff0c\u63a5\u53e3\u5b89\u5168\u4e5f\u6ca1\u5230\u4f4d\n\u6240\u4ee5\u5e74\u540e\u4e0a\u73ed\u7b2c\u4e00\u4ef6\u662f\u5c31\u662f\u628a\u63a5\u53e3\u52a0\u5bc6\u7684\u5de5\u4f5c\u641e\u8d77\u6765\n\u76ee\u524d\u5e38\u7528\u7684\u52a0\u5bc6\u65b9\u5f0f\u5c31\u5bf9\u79f0\u6027\u52a0\u5bc6\u548c\u975e\u5bf9\u79f0\u6027\u52a0\u5bc6\uff0c\u52a0\u5bc6\u89e3\u5bc6\u7684\u64cd\u4f5c\u7684\u80af\u5b9a\u662f\u5927\u5bb6\u77e5\u9053\u7684\uff0c\u6700\u91cd\u8981\u7684\u4f7f\u7528\u4ec0\u4e48\u52a0\u5bc6\u89e3\u5bc6\u65b9\u5f0f\uff0c\u5236\u5b9a\u4ec0\u4e48\u6837\u7684\u52a0\u5bc6\u7b56\u7565\uff1b\u8003\u8651\u5230\u6211\u6280\u672f\u6c34\u5e73\u548c\u63a5\u53e3\u7684\u901f\u5ea6\uff0c\u91c7\u7528\u7684\u662fRAS\u975e\u5bf9\u79f0\u52a0\u5bc6\u548cAES\u5bf9\u79f0\u52a0\u5bc6\u4e00\u8d77\u7528\uff01\uff01\uff01\uff01"}),"\n",(0,i.jsx)(n.h2,{id:"\u4e8crsa\u548caes\u57fa\u7840\u77e5\u8bc6",children:"\u4e8c\u3001RSA\u548cAES\u57fa\u7840\u77e5\u8bc6"}),"\n",(0,i.jsx)(n.h3,{id:"1\u975e\u5bf9\u79f0\u52a0\u5bc6\u548c\u5bf9\u79f0\u52a0\u5bc6",children:"1\u3001\u975e\u5bf9\u79f0\u52a0\u5bc6\u548c\u5bf9\u79f0\u52a0\u5bc6"}),"\n",(0,i.jsx)(n.h4,{id:"\u975e\u5bf9\u79f0\u52a0\u5bc6",children:"\u975e\u5bf9\u79f0\u52a0\u5bc6"}),"\n",(0,i.jsx)(n.p,{children:"\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u662f\u4e00\u79cd\u5bc6\u94a5\u7684\u4fdd\u5bc6\u65b9\u6cd5\u3002 \u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u9700\u8981\u4e24\u4e2a\u5bc6\u94a5\uff1a\u516c\u5f00\u5bc6\u94a5\uff08publickey:\u7b80\u79f0\u516c\u94a5\uff09\u548c\u79c1\u6709\u5bc6\u94a5\uff08privatekey:\u7b80\u79f0\u79c1\u94a5\uff09\u3002 \u516c\u94a5\u4e0e\u79c1\u94a5\u662f\u4e00\u5bf9\uff0c\u5982\u679c\u7528\u516c\u94a5\u5bf9\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\uff0c\u53ea\u6709\u7528\u5bf9\u5e94\u7684\u79c1\u94a5\u624d\u80fd\u89e3\u5bc6\u3002 \u56e0\u4e3a\u52a0\u5bc6\u548c\u89e3\u5bc6\u4f7f\u7528\u7684\u662f\u4e24\u4e2a\u4e0d\u540c\u7684\u5bc6\u94a5\uff0c\u6240\u4ee5\u8fd9\u79cd\u7b97\u6cd5\u53eb\u4f5c\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"\u5bf9\u79f0\u52a0\u5bc6",children:"\u5bf9\u79f0\u52a0\u5bc6"}),"\n",(0,i.jsx)(n.p,{children:"\u52a0\u5bc6\u79d8\u94a5\u548c\u89e3\u5bc6\u79d8\u94a5\u662f\u4e00\u6837\uff0c\u5f53\u4f60\u7684\u5bc6\u94a5\u88ab\u522b\u4eba\u77e5\u9053\u540e\uff0c\u5c31\u6ca1\u6709\u79d8\u5bc6\u53ef\u8a00\u4e86"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"AES \u662f\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u4f18\u70b9\uff1a\u52a0\u5bc6\u901f\u5ea6\u5feb\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u7f3a\u70b9\uff1a\u5982\u679c\u79d8\u94a5\u4e22\u5931\uff0c\u5c31\u5bb9\u6613\u89e3\u5bc6\u5bc6\u6587\uff0c\u5b89\u5168\u6027\u76f8\u5bf9\u6bd4\u8f83\u5dee"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"RSA \u662f\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u4f18\u70b9\uff1a\u5b89\u5168 \uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u7f3a\u70b9\uff1a\u52a0\u5bc6\u901f\u5ea6\u6162"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2rsa\u57fa\u7840\u77e5\u8bc6",children:"2\u3001RSA\u57fa\u7840\u77e5\u8bc6"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"RSA"}),"\u2014\u2014\u975e\u5bf9\u79f0\u52a0\u5bc6\uff0c\u4f1a\u4ea7\u751f\u516c\u94a5\u548c\u79c1\u94a5\uff0c\u516c\u94a5\u5728\u5ba2\u6237\u7aef\uff0c\u79c1\u94a5\u5728\u670d\u52a1\u7aef\u3002\u516c\u94a5\u7528\u4e8e\u52a0\u5bc6\uff0c\u79c1\u94a5\u7528\u4e8e\u89e3\u5bc6\u3002\n\u5927\u6982\u7684\u6d41\u7a0b\uff1a"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u53d1\u9001\u6d88\u606f\uff1a\u5ba2\u6237\u7aef\u7528\u516c\u94a5\u52a0\u5bc6\u4fe1\u606f\uff0c\u53d1\u9001\u7ed9\u670d\u52a1\u7aef\uff0c\u670d\u52a1\u7aef\u518d\u7528\u79c1\u94a5\u673a\u5bc6\n\u670d\u52a1\u5668\u5411\u5ba2\u6237\u7aef\u53d1\u9001\u6d88\u606f\uff1a\u670d\u52a1\u7aef\u7528\u79c1\u94a5\u52a0\u5bc6\u4fe1\u606f\uff0c\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\uff0c\u5ba2\u6237\u7aef\u518d\u7528\u516c\u94a5\u673a\u5bc6"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u5f53\u7136\u4e2d\u95f4\u8981\u4fdd\u969c\u5bc6\u94a5\u7684\u5b89\u5168\uff0c\u8fd8\u6709\u5f88\u591a\u4e3a\u4e86\u4fdd\u969c\u6570\u636e\u5b89\u5168\u7684\u64cd\u4f5c\uff0c\u6bd4\u5982\u6570\u5b57\u7b7e\u540d\uff0c\u8bc1\u4e66\u7b7e\u540d\u7b49\u7b49\uff0c\u5728\u8fd9\u6211\u4eec\u5c31\u5148\u4e0d\u8bf4\u4e86\uff1b"}),"\n",(0,i.jsx)(n.h4,{id:"rsa\u52a0\u5bc6\u89e3\u5bc6\u7b97\u6cd5\u652f\u6301\u4e09\u79cd\u586b\u5145\u6a21\u5f0f",children:"RSA\u52a0\u5bc6\u89e3\u5bc6\u7b97\u6cd5\u652f\u6301\u4e09\u79cd\u586b\u5145\u6a21\u5f0f\uff0c"}),"\n",(0,i.jsxs)(n.p,{children:["\u5206\u522b\u662f",(0,i.jsx)(n.code,{children:"ENCRYPTION_OAEP"}),"\u3001",(0,i.jsx)(n.code,{children:"ENCRYPTION_PKCS1"}),"\u3001",(0,i.jsx)(n.code,{children:"ENCRYPTION_NONE"}),"\uff0cRSA\u586b\u5145\u662f\u4e3a\u4e86\u548c\u516c\u94a5\u7b49\u957f\u3002"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ENCRYPTION_OAEP"}),"\uff1a\u6700\u4f18\u975e\u5bf9\u79f0\u52a0\u5bc6\u586b\u5145\uff0c\u662fRSA\u52a0\u5bc6\u548cRSA\u89e3\u5bc6\u6700\u65b0\u6700\u5b89\u5168\u7684\u63a8\u8350\u586b\u5145\u6a21\u5f0f\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ENCRYPTION_PKCS1"}),"\uff1a\u968f\u673a\u586b\u5145\u6570\u636e\u6a21\u5f0f\uff0c\u6bcf\u6b21\u52a0\u5bc6\u7684\u7ed3\u679c\u90fd\u4e0d\u4e00\u6837\uff0c\u662fRSA\u52a0\u5bc6\u548cRSA\u89e3\u5bc6\u4f7f\u7528\u6700\u4e3a\u5e7f\u6cdb\u7684\u586b\u5145\u6a21\u5f0f\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ENCRYPTION_NONE"}),"\uff1a\u4e0d\u586b\u5145\u6a21\u5f0f\uff0c\u662fRSA\u52a0\u5bc6\u548cRSA\u89e3\u5bc6\u4f7f\u7528\u8f83\u5c11\u7684\u586b\u5145\u6a21\u5f0f\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"rsa-\u5e38\u7528\u7684\u52a0\u5bc6\u586b\u5145\u6a21\u5f0f",children:"RSA \u5e38\u7528\u7684\u52a0\u5bc6\u586b\u5145\u6a21\u5f0f"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"RSA/None/PKCS1Padding"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"RSA/ECB/PKCS1Padding"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u77e5\u8bc6\u70b9\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Java \u9ed8\u8ba4\u7684 ",(0,i.jsx)(n.code,{children:"RSA"})," \u5b9e\u73b0\u662f ",(0,i.jsx)(n.code,{children:"RSA/None/PKCS1Padding"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u5728\u521b\u5efa",(0,i.jsx)(n.code,{children:"RSA"}),"\u79d8\u94a5\u5bf9\u65f6\uff0c\u957f\u5ea6\u6700\u597d\u9009\u62e9 2048 \u7684\u6574\u6570\u500d\uff0c\u957f\u5ea6\u4e3a1024\u5728\u5df2\u7ecf\u4e0d\u5f88\u5b89\u5168\u4e86"]}),"\n",(0,i.jsx)(n.li,{children:"\u4e00\u822c\u7531\u670d\u52a1\u5668\u521b\u5efa\u79d8\u94a5\u5bf9\uff0c\u79c1\u94a5\u4fdd\u5b58\u5728\u670d\u52a1\u5668\uff0c\u516c\u94a5\u4e0b\u53d1\u81f3\u5ba2\u6237\u7aef"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"DER"}),"\u662f",(0,i.jsx)(n.code,{children:"RSA"}),"\u5bc6\u94a5\u7684\u4e8c\u8fdb\u5236\u683c\u5f0f\uff0c",(0,i.jsx)(n.code,{children:"PEM"}),"\u662f",(0,i.jsx)(n.code,{children:"DER"}),"\u8f6c\u7801\u4e3a",(0,i.jsx)(n.code,{children:"Base64"}),"\u7684\u5b57\u7b26\u683c\u5f0f\uff0c\u7531\u4e8e",(0,i.jsx)(n.code,{children:"DER"}),"\u662f\u4e8c\u8fdb\u5236\u683c\u5f0f\uff0c\u4e0d\u4fbf\u4e8e\u9605\u8bfb\u548c\u7406\u89e3\u3002\u4e00\u822c\u800c\u8a00\uff0c\u5bc6\u94a5\u90fd\u662f\u901a\u8fc7",(0,i.jsx)(n.code,{children:"PEM"}),"\u7684\u683c\u5f0f\u8fdb\u884c\u5b58\u50a8\u7684"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'/**\n\xa0 * \u751f\u6210\u5bc6\u94a5\u5bf9\n * @param keyLength  \u5bc6\u94a5\u957f\u5ea6\n * @return KeyPair\n */\npublic static KeyPair getKeyPair(int keyLength) {\n \xa0 \xa0try {\n \xa0 \xa0 \xa0 \xa0KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance("RSA"); \xa0 //\u9ed8\u8ba4:RSA/None/PKCS1Padding\n \xa0 \xa0 \xa0 \xa0keyPairGenerator.initialize(keyLength);\n \xa0 \xa0 \xa0 \xa0return keyPairGenerator.generateKeyPair();\n \xa0  } catch (NoSuchAlgorithmException e) {\n \xa0 \xa0 \xa0 \xa0throw new RuntimeException("\u751f\u6210\u5bc6\u94a5\u5bf9\u65f6\u9047\u5230\u5f02\u5e38" + \xa0e.getMessage());\n \xa0  }\n}\n\n/**\n\xa0 * \u83b7\u53d6\u516c\u94a5\n */\npublic static byte[] getPublicKey(KeyPair keyPair) {\n \xa0 \xa0RSAPublicKey rsaPublicKey = (RSAPublicKey) keyPair.getPublic();\n \xa0 \xa0return rsaPublicKey.getEncoded();\n}\n\n/**\n\xa0 * \u83b7\u53d6\u79c1\u94a5\n */\npublic static byte[] getPrivateKey(KeyPair keyPair) {\n \xa0 \xa0RSAPrivateKey rsaPrivateKey = (RSAPrivateKey) keyPair.getPrivate();\n \xa0 \xa0return rsaPrivateKey.getEncoded();\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"3aes\u57fa\u7840\u77e5\u8bc6",children:"3\u3001AES\u57fa\u7840\u77e5\u8bc6"}),"\n",(0,i.jsxs)(n.h4,{id:"aes-\u7b80\u4ecb",children:[(0,i.jsx)(n.code,{children:"AES"})," \u7b80\u4ecb"]}),"\n",(0,i.jsx)(n.p,{children:"AES\u52a0\u5bc6\u89e3\u5bc6\u7b97\u6cd5\u662f\u4e00\u79cd\u53ef\u9006\u7684\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\uff0c\u8fd9\u7c7b\u7b97\u6cd5\u5728\u52a0\u5bc6\u548cAES\u89e3\u5bc6\u65f6\u4f7f\u7528\u76f8\u540c\u7684\u5bc6\u94a5\uff0c\u6216\u662f\u4f7f\u7528\u4e24\u4e2a\u53ef\u4ee5\u7b80\u5355\u5730\u76f8\u4e92\u63a8\u7b97\u7684\u5bc6\u94a5\uff0c\u4e00\u822c\u7528\u4e8e\u670d\u52a1\u7aef\u5bf9\u670d\u52a1\u7aef\u4e4b\u95f4\u5bf9\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\u89e3\u5bc6\u3002\u5b83\u662f\u4e00\u79cd\u4e3a\u4e86\u66ff\u4ee3\u539f\u5148DES\u30013DES\u800c\u5efa\u7acb\u7684\u9ad8\u7ea7\u52a0\u5bc6\u6807\u51c6\uff08Advanced Encryption Standard\uff09\u3002\u4f5c\u4e3a\u53ef\u9006\u4e14\u5bf9\u79f0\u7684\u5757\u52a0\u5bc6\uff0cAES\u52a0\u5bc6\u7b97\u6cd5\u7684\u901f\u5ea6\u6bd4\u516c\u94a5\u52a0\u5bc6\u7b49\u52a0\u5bc6\u7b97\u6cd5\u5feb\u5f88\u591a\uff0c\u5728\u5f88\u591a\u573a\u5408\u90fd\u9700\u8981AES\u5bf9\u79f0\u52a0\u5bc6\uff0c\u4f46\u662f\u8981\u6c42\u52a0\u5bc6\u7aef\u548c\u89e3\u5bc6\u7aef\u53cc\u65b9\u90fd\u4f7f\u7528\u76f8\u540c\u7684\u5bc6\u94a5\u662fAES\u7b97\u6cd5\u7684\u4e3b\u8981\u7f3a\u70b9\u4e4b\u4e00\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"aes\u52a0\u5bc6\u89e3\u5bc6",children:"AES\u52a0\u5bc6\u89e3\u5bc6"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"AES\u52a0\u5bc6\u9700\u8981\uff1a\u660e\u6587 + \u5bc6\u94a5+ \u504f\u79fb\u91cf\uff08IV\uff09+\u5bc6\u7801\u6a21\u5f0f(\u7b97\u6cd5/\u6a21\u5f0f/\u586b\u5145)"}),"\n",(0,i.jsx)(n.li,{children:"AES\u89e3\u5bc6\u9700\u8981\uff1a\u5bc6\u6587 + \u5bc6\u94a5+ \u504f\u79fb\u91cf\uff08IV\uff09+\u5bc6\u7801\u6a21\u5f0f(\u7b97\u6cd5/\u6a21\u5f0f/\u586b\u5145)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["AES\u7684\u7b97\u6cd5\u6a21\u5f0f\u4e00\u822c\u4e3a ",(0,i.jsx)(n.code,{children:"AES/CBC/PKCS5Padding"})," \u6216 ",(0,i.jsx)(n.code,{children:"AES/CBC/PKCS7Padding"})]}),"\n",(0,i.jsx)(n.h4,{id:"aes\u5e38\u89c1\u7684\u5de5\u4f5c\u6a21\u5f0f",children:"AES\u5e38\u89c1\u7684\u5de5\u4f5c\u6a21\u5f0f\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u7535\u7801\u672c\u6a21\u5f0f(ECB)"}),"\n",(0,i.jsx)(n.li,{children:"\u5bc6\u7801\u5206\u7ec4\u94fe\u63a5\u6a21\u5f0f(CBC)"}),"\n",(0,i.jsx)(n.li,{children:"\u8ba1\u7b97\u5668\u6a21\u5f0f(CTR)"}),"\n",(0,i.jsx)(n.li,{children:"\u5bc6\u7801\u53cd\u9988\u6a21\u5f0f(CFB)"}),"\n",(0,i.jsx)(n.li,{children:"\u8f93\u51fa\u53cd\u9988\u6a21\u5f0f(OFB)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"\u9664\u4e86ECB\u65e0\u987b\u8bbe\u7f6e\u521d\u59cb\u5316\u5411\u91cfIV\u800c\u4e0d\u5b89\u5168\u4e4b\u5916\uff0c\u5176\u5b83AES\u5de5\u4f5c\u6a21\u5f0f\u90fd\u5fc5\u987b\u8bbe\u7f6e\u5411\u91cfIV\uff0c\u5176\u4e2dGCM\u5de5\u4f5c\u6a21\u5f0f\u8f83\u4e3a\u7279\u6b8a\u3002"})}),"\n",(0,i.jsx)(n.h4,{id:"aes\u586b\u5145\u6a21\u5f0f",children:"AES\u586b\u5145\u6a21\u5f0f"}),"\n",(0,i.jsx)(n.p,{children:"\u5757\u5bc6\u7801\u53ea\u80fd\u5bf9\u786e\u5b9a\u957f\u5ea6\u7684\u6570\u636e\u5757\u8fdb\u884c\u5904\u7406\uff0c\u800c\u6d88\u606f\u7684\u957f\u5ea6\u901a\u5e38\u662f\u53ef\u53d8\u7684\uff0c\u56e0\u6b64\u9700\u8981\u9009\u62e9\u586b\u5145\u6a21\u5f0f\u3002"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"\u586b\u5145\u533a\u522b"}),"\uff1a\u5728ECB\u3001CBC\u5de5\u4f5c\u6a21\u5f0f\u4e0b\u6700\u540e\u4e00\u5757\u8981\u5728\u52a0\u5bc6\u524d\u8fdb\u884c\u586b\u5145\uff0c\u5176\u5b83\u4e0d\u7528\u9009\u62e9\u586b\u5145\u6a21\u5f0f\uff1b"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"\u586b\u5145\u6a21\u5f0f"}),"\uff1aAES\u652f\u6301\u7684\u586b\u5145\u6a21\u5f0f\u4e3aPKCS7\u548cNONE\u4e0d\u586b\u5145\u3002\u5176\u4e2dPKCS7\u6807\u51c6\u662f\u4e3b\u6d41\u52a0\u5bc6\u7b97\u6cd5\u90fd\u9075\u5faa\u7684\u6570\u636e\u586b\u5145\u7b97\u6cd5\u3002AES\u6807\u51c6\u89c4\u5b9a\u7684\u533a\u5757\u957f\u5ea6\u4e3a\u56fa\u5b9a\u503c128Bit\uff0c\u5bf9\u5e94\u7684\u5b57\u8282\u957f\u5ea6\u4e3a16\u4f4d\uff0c\u8fd9\u660e\u663e\u548cPKCS5\u6807\u51c6\u89c4\u5b9a\u4f7f\u7528\u7684\u56fa\u5b9a\u503c8\u4f4d\u4e0d\u7b26\uff0c\u867d\u7136\u6709\u4e9b\u6846\u67b6\u7279\u6b8a\u5904\u7406\u540e\u53ef\u4ee5\u901a\u7528PKCS5\uff0c\u4f46\u662f\u4ece\u957f\u8fdc\u548c\u517c\u5bb9\u6027\u8003\u8651\uff0c\u63a8\u8350PKCS7\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"aes\u5bc6\u94a5key\u548c\u521d\u59cb\u5316\u5411\u91cfiv",children:"AES\u5bc6\u94a5KEY\u548c\u521d\u59cb\u5316\u5411\u91cfIV"}),"\n",(0,i.jsx)(n.p,{children:"\u521d\u59cb\u5316\u5411\u91cfIV\u53ef\u4ee5\u6709\u6548\u63d0\u5347\u5b89\u5168\u6027\uff0c\u4f46\u662f\u5728\u5b9e\u9645\u7684\u4f7f\u7528\u573a\u666f\u4e2d\uff0c\u5b83\u4e0d\u80fd\u50cf\u5bc6\u94a5KEY\u90a3\u6837\u76f4\u63a5\u4fdd\u5b58\u5728\u914d\u7f6e\u6587\u4ef6\u6216\u56fa\u5b9a\u5199\u6b7b\u5728\u4ee3\u7801\u4e2d\uff0c\u4e00\u822c\u6b63\u786e\u7684\u5904\u7406\u65b9\u5f0f\u4e3a\uff1a\u5728\u52a0\u5bc6\u7aef\u5c06IV\u8bbe\u7f6e\u4e3a\u4e00\u4e2a16\u4f4d\u7684\u968f\u673a\u503c\uff0c\u7136\u540e\u548c\u52a0\u5bc6\u6587\u672c\u4e00\u8d77\u8fd4\u7ed9\u89e3\u5bc6\u7aef\u5373\u53ef\u3002"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"\u5bc6\u94a5KEY"}),"\uff1aAES\u6807\u51c6\u89c4\u5b9a\u533a\u5757\u957f\u5ea6\u53ea\u6709\u4e00\u4e2a\u503c\uff0c\u56fa\u5b9a\u4e3a128Bit\uff0c\u5bf9\u5e94\u7684\u5b57\u8282\u4e3a16\u4f4d\u3002AES\u7b97\u6cd5\u89c4\u5b9a\u5bc6\u94a5\u957f\u5ea6\u53ea\u6709\u4e09\u4e2a\u503c\uff0c128Bit\u3001192Bit\u3001256Bit\uff0c\u5bf9\u5e94\u7684\u5b57\u8282\u4e3a16\u4f4d\u300124\u4f4d\u548c32\u4f4d\uff0c\u5176\u4e2d\u5bc6\u94a5KEY\u4e0d\u80fd\u516c\u5f00\u4f20\u8f93\uff0c\u7528\u4e8e\u52a0\u5bc6\u89e3\u5bc6\u6570\u636e\uff1b"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"\u521d\u59cb\u5316\u5411\u91cfIV"}),"\uff1a\u8be5\u5b57\u6bb5\u53ef\u4ee5\u516c\u5f00\uff0c\u7528\u4e8e\u5c06\u52a0\u5bc6\u968f\u673a\u5316\u3002\u540c\u6837\u7684\u660e\u6587\u88ab\u591a\u6b21\u52a0\u5bc6\u4e5f\u4f1a\u4ea7\u751f\u4e0d\u540c\u7684\u5bc6\u6587\uff0c\u907f\u514d\u4e86\u8f83\u6162\u7684\u91cd\u65b0\u4ea7\u751f\u5bc6\u94a5\u7684\u8fc7\u7a0b\uff0c\u521d\u59cb\u5316\u5411\u91cf\u4e0e\u5bc6\u94a5\u76f8\u6bd4\u6709\u4e0d\u540c\u7684\u5b89\u5168\u6027\u9700\u6c42\uff0c\u56e0\u6b64IV\u901a\u5e38\u65e0\u987b\u4fdd\u5bc6\u3002\u7136\u800c\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e2d\uff0c\u4e0d\u5e94\u5f53\u5728\u4f7f\u7528\u540c\u4e00\u5bc6\u94a5\u7684\u60c5\u51b5\u4e0b\u4e24\u6b21\u4f7f\u7528\u540c\u4e00\u4e2aIV\uff0c\u4e00\u822c\u63a8\u8350\u521d\u59cb\u5316\u5411\u91cfIV\u4e3a16\u4f4d\u7684\u968f\u673a\u503c\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u4e09\u52a0\u5bc6\u7b56\u7565",children:"\u4e09\u3001\u52a0\u5bc6\u7b56\u7565"}),"\n",(0,i.jsx)(n.p,{children:"RAS\u3001AES\u52a0\u5bc6\u89e3\u5bc6\u7684\u64cd\u4f5c\u90fd\u662f\u4e00\u6837\uff0c\u5982\u679c\u6709\u6548\u7684\u7ed3\u5408\u5230\u4e00\u8d77\u624d\u80fd\u8fbe\u5230\u66f4\u597d\u7684\u52a0\u5bc6\u6548\u679c\u5f88\u91cd\u8981\uff1b"}),"\n",(0,i.jsx)(n.p,{children:"\u4e0a\u9762\u8bf4\u5230\uff1a"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"AES \u662f\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u4f18\u70b9\uff1a\u52a0\u5bc6\u901f\u5ea6\u5feb\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u7f3a\u70b9\uff1a\u5982\u679c\u79d8\u94a5\u4e22\u5931\uff0c\u5c31\u5bb9\u6613\u89e3\u5bc6\u5bc6\u6587\uff0c\u5b89\u5168\u6027\u76f8\u5bf9\u6bd4\u8f83\u5dee"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"RSA \u662f\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u4f18\u70b9\uff1a\u5b89\u5168 \uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u7f3a\u70b9\uff1a\u52a0\u5bc6\u901f\u5ea6\u6162"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"1\u4e3b\u8981\u601d\u8def",children:"1\u3001\u4e3b\u8981\u601d\u8def\uff1a"}),"\n",(0,i.jsx)(n.p,{children:"\u90a3\u4e48\u6211\u4eec\u5c31\u7ed3\u54082\u4e2a\u52a0\u5bc6\u7b97\u6cd5\u7684\u4f18\u70b9\u6765\u64cd\u4f5c\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"1\u3001\u56e0\u4e3a\u63a5\u53e3\u4f20\u9012\u7684\u53c2\u6570\u6709\u591a\u6709\u5c11\uff0c\u5f53\u63a5\u53e3\u4f20\u9012\u7684\u53c2\u6570\u8fc7\u591a\u65f6\uff0c\u4f7f\u7528RSA\u52a0\u5bc6\u4f1a\u5bfc\u81f4\u52a0\u5bc6\u901f\u5ea6\u6162\uff0c\u6240\u4ee5\u6211\u4eec\u4f7f\u7528AES\u52a0\u5bc6\u52a0\u5bc6\u63a5\u53e3\u53c2\u6570"}),"\n",(0,i.jsx)(n.li,{children:"2\u3001\u56e0\u4e3aAES\u7684\u5bc6\u94a5key\u548c\u504f\u79fb\u91cfVI\u90fd\u662f\u56fa\u5b9a\u7684\u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528RSA\u52a0\u5bc6"}),"\n",(0,i.jsx)(n.li,{children:"3\u3001\u5ba2\u6237\u7aef\u5c06AES\u52a0\u5bc6\u540e\u7684\u5bc6\u6587\u548cRSA\u52a0\u5bc6\u540e\u7684\u5bc6\u6587\uff0c\u4f20\u9012\u7ed9\u670d\u52a1\u5668\u5373\u53ef\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2\u6d89\u53ca\u5de5\u5177\u7c7b",children:"2\u3001\u6d89\u53ca\u5de5\u5177\u7c7b\uff1a"}),"\n",(0,i.jsx)(n.p,{children:"util\u5305\u4e0b\uff1a"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"ActivityRSAUtil"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"AES256Util"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"RequestDecryptionUtil"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"3\u52a0\u5bc6\u7b56\u7565",children:"3\u3001\u52a0\u5bc6\u7b56\u7565"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:t(10689).A+"",width:"538",height:"441"})}),"\n",(0,i.jsx)(n.h3,{id:"4\u4ea4\u4e92\u65b9\u5f0f",children:"4\u3001\u4ea4\u4e92\u65b9\u5f0f"}),"\n",(0,i.jsx)(n.h4,{id:"\u524d\u7aef",children:"\u524d\u7aef\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"1\u3001\u5ba2\u6237\u7aef\u968f\u673a\u751f\u62102\u4e2a16\u4e3a\u7684AES\u5bc6\u94a5\u548cAES\u504f\u79fb\u91cf"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"2\u3001\u4f7f\u7528AES\u52a0\u5bc6\u7b97\u6cd5\u52a0\u5bc6\u771f\u5b9e\u4f20\u9012\u53c2\u6570\uff0c\u5f97\u5230\u53c2\u6570\u5bc6\u6587\u201casy\u201d"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"3\u3001\u5c06AES\u5bc6\u94a5\u3001AES\u504f\u79fb\u91cf\u548c\u5f53\u524d\u65f6\u95f4\u6233\uff0c\u683c\u5f0f\u5982\u4e0b\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"key\uff1a\u5bc6\u94a5"}),"\n",(0,i.jsx)(n.li,{children:"keyVI\uff1a\u504f\u79fb\u91cf"}),"\n",(0,i.jsx)(n.li,{children:"time\uff1a\u8bf7\u6c42\u65f6\u95f4\uff0c\u7528\u6237\u5224\u65ad\u662f\u5426\u91cd\u590d\u8bf7\u6c42"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "key":"0t7FtCDKofbEVpSZS",\n \xa0"keyVI":"0t7WESMofbEVpSZS",\n \xa0"time":211213232323323\n}\n//\u8f6c\u6210JSON\u5b57\u7b26\u4e32\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"4\u3001AES\u4fe1\u606f\u5bc6\u94a5\u4fe1\u606f\uff0c\u518d\u4f7f\u7528RSA\u516c\u94a5\u52a0\u5bc6\uff0c\u5f97\u5230AES\u5bc6\u94a5\u7684\u5bc6\u6587\u201csym\u201d"}),"\n",(0,i.jsx)(n.li,{children:"5\u3001\u5c06\u201csym\u201d\u548c\u201casy\u201d\u4f5c\u4e3abody\u53c2\u6570\uff0c\u8c03\u7528\u63a5\u53e3"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:t(59358).A+"",width:"1512",height:"526"})}),"\n",(0,i.jsx)(n.h4,{id:"\u540e\u7aef",children:"\u540e\u7aef\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"1\u3001\u5728\u63a5\u53e3\u63a5\u6536\u53c2\u6570\u4e2d\uff0c\u591a\u589e\u52a02\u4e2a\u5b57\u6bb5\u63a5\u6536\u52a0\u5bc6\u540e\u7684\u201csym\u201d\u548c\u201casy\u201d \uff08\u540d\u5b57\u53ef\u4ee5\u81ea\u5df1\u5b9a\uff0c\u80fd\u63a5\u6536\u5230\u5c31\u884c\uff09"}),"\n",(0,i.jsx)(n.li,{children:"2\u3001\u4f7f\u7528RequestDecryptionUtil.getRequestDecryption\uff08\uff09\u65b9\u6cd5\u89e3\u5bc6\uff0c\u8fd4\u56de\u89e3\u5bc6\u540e\u7684\u771f\u5b9e\u4f20\u9012\u53c2\u6570"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u56db\u670d\u52a1\u5668\u81ea\u52a8\u89e3\u5bc6",children:"\u56db\u3001\u670d\u52a1\u5668\u81ea\u52a8\u89e3\u5bc6"}),"\n",(0,i.jsx)(n.p,{children:"\u56e0\u4e3a\u4e0d\u662f\u6bcf\u4e2a\u63a5\u53e3\u90fd\u9700\u6c42\u52a0\u5bc6\u89e3\u5bc6\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4e00\u4e2a\u6ce8\u89e3\uff0c\u5c06\u9700\u8981\u89e3\u5bc6\u7684\u63a5\u53e3\u4e0a\u52a0\u4e00\u4e2a\u8fd9\u4e2a\u6ce8\u89e3\uff0c"}),"\n",(0,i.jsxs)(n.h3,{id:"1\u81ea\u5b9a\u4e49\u89e3\u5bc6\u6ce8\u89e3requestrsa",children:["1\u3001\u81ea\u5b9a\u4e49\u89e3\u5bc6\u6ce8\u89e3\uff1a",(0,i.jsx)(n.code,{children:"@RequestRSA"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"import java.lang.annotation.Documented;\nimport java.lang.annotation.ElementType;\nimport java.lang.annotation.Retention;\nimport java.lang.annotation.RetentionPolicy;\nimport java.lang.annotation.Target;\n\u200b\n\u200b\n@Target({ElementType.TYPE, ElementType.METHOD})\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\npublic @interface RequestRSA {\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"2\u521b\u5efa\u4e00\u4e2aaop\u5207\u7247",children:"2\u3001\u521b\u5efa\u4e00\u4e2aaop\u5207\u7247"}),"\n",(0,i.jsxs)(n.p,{children:["1\u3001AOP\u5224\u65adcontroller\u63a5\u6536\u5230\u8bf7\u6c42\u662f\u5426\u5e26\u6709",(0,i.jsx)(n.code,{children:"@RequestRSA"}),"\u6ce8\u89e3\n2\u3001\u5982\u679c\u5e26\u6709\u6ce8\u89e3\uff0c\u901a\u8fc7",(0,i.jsx)(n.code,{children:"ProceedingJoinPoint"}),"\u7c7b",(0,i.jsx)(n.code,{children:"getArgs()"}),"\u65b9\u6cd5\u83b7\u53d6\u8bf7\u6c42\u7684body\u53c2\u6570\uff0c\n3\u3001\u5c06body\u53c2\u6570\uff0c\u4f20\u4e3a",(0,i.jsx)(n.code,{children:"JSONObject"}),'\u7c7b\uff0c\u83b7\u53d6\u5230"asy"\u548c"sym"\u5c5e\u6027\uff0c\u518d\u8c03\u7528RequestDecryptionUtil\u89e3\u5bc6\u83b7\u53d6\u63a5\u53e3\u4f20\u9012\u7684\u771f\u5b9e\u53c2\u6570\n4\u3001\u83b7\u53d6\u63a5\u53e3\u5165\u53c2\u7684\u7c7b\n5\u3001\u5c06\u83b7\u53d6\u89e3\u5bc6\u540e\u7684\u771f\u5b9e\u53c2\u6570\uff0c\u5c01\u88c5\u5230\u63a5\u53e3\u5165\u53c2\u7684\u7c7b\u4e2d']}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'import com.alibaba.fastjson.JSONObject;\nimport app.activity.common.interceptor.RequestRSA;\nimport app.activity.util.RequestDecryptionUtil;\nimport lombok.extern.slf4j.Slf4j;\nimport org.aspectj.lang.ProceedingJoinPoint;\nimport org.aspectj.lang.annotation.Around;\nimport org.aspectj.lang.annotation.Aspect;\nimport org.aspectj.lang.annotation.Pointcut;\nimport org.aspectj.lang.reflect.MethodSignature;\nimport org.springframework.core.annotation.Order;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.bind.annotation.RequestBody;\n\u200b\nimport java.lang.reflect.Method;\nimport java.lang.reflect.Parameter;\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.Objects;\n\u200b\n/**\n * @module\n * @author: qingxu.liu\n * @date: 2023-02-08 16:41\n * @copyright  \u8bf7\u6c42\u9a8c\u8bc1RSA & AES  \u7edf\u4e00\u9a8c\u8bc1\u5207\u9762\n **/\n@Aspect\n@Component\n@Order(2)\n@Slf4j\npublic class RequestRSAAspect {\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * 1> \u83b7\u53d6\u8bf7\u6c42\u53c2\u6570\n \xa0 \xa0 * 2> \u83b7\u53d6\u88ab\u8bf7\u6c42\u63a5\u53e3\u7684\u5165\u53c2\u7c7b\u578b\n \xa0 \xa0 * 3> \u5224\u65ad\u662f\u5426\u4e3aget\u8bf7\u6c42 \u662f\u5219\u8df3\u8fc7AES\u89e3\u5bc6\u5224\u65ad\n \xa0 \xa0 * 4> \u8bf7\u6c42\u53c2\u6570\u89e3\u5bc6->\u5c01\u88c5\u5230\u63a5\u53e3\u7684\u5165\u53c2\n \xa0 \xa0 */\n\u200b\n \xa0 \xa0@Pointcut("execution(public * app.activity.controller.*.*(..))")\n \xa0 \xa0public void requestRAS() {\n \xa0  }\n\u200b\n \xa0 \xa0@Around("requestRAS()")\n \xa0 \xa0public Object doAround(ProceedingJoinPoint joinPoint) throws Throwable {\n \xa0 \xa0 \xa0 \xa0//=======AOP\u89e3\u5bc6\u5207\u9762\u901a\u77e5=======\n \xa0 \xa0 \xa0 \xa0MethodSignature methodSignature = (MethodSignature) joinPoint.getSignature();\n \xa0 \xa0 \xa0 \xa0Method methods = methodSignature.getMethod();\n \xa0 \xa0 \xa0 \xa0RequestRSA annotation = methods.getAnnotation(RequestRSA.class);\n \xa0 \xa0 \xa0 \xa0if (Objects.nonNull(annotation)){\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0//\u83b7\u53d6\u8bf7\u6c42\u7684body\u53c2\u6570\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0Object data = getParameter(methods, joinPoint.getArgs());\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0String body = JSONObject.toJSONString(data);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0//\u83b7\u53d6asy\u548csym\u7684\u503c\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0JSONObject jsonObject = JSONObject.parseObject(body);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0String asy = jsonObject.get("asy").toString();\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0String sym = jsonObject.get("sym").toString();\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0//\u8c03\u7528RequestDecryptionUtil\u65b9\u6cd5\u89e3\u5bc6\uff0c\u83b7\u53d6\u89e3\u5bc6\u540e\u7684\u771f\u5b9e\u53c2\u6570\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0JSONObject decryption = RequestDecryptionUtil.getRequestDecryption(sym, asy);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0//\u83b7\u53d6\u63a5\u53e3\u5165\u53c2\u7684\u7c7b\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0String typeName = joinPoint.getArgs()[0].getClass().getTypeName();\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0System.out.println("\u53c2\u6570\u503c\u7c7b\u578b\uff1a"+ typeName);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0Class<?> aClass = joinPoint.getArgs()[0].getClass();\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0//\u5c06\u83b7\u53d6\u89e3\u5bc6\u540e\u7684\u771f\u5b9e\u53c2\u6570\uff0c\u5c01\u88c5\u5230\u63a5\u53e3\u5165\u53c2\u7684\u7c7b\u4e2d\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0Object o = JSONObject.parseObject(decryption.toJSONString(), aClass);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0Object[] as = {o};\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return joinPoint.proceed(as);\n \xa0 \xa0 \xa0  }\n \xa0 \xa0 \xa0 \xa0return joinPoint.proceed();\n \xa0  }\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * \u6839\u636e\u65b9\u6cd5\u548c\u4f20\u5165\u7684\u53c2\u6570\u83b7\u53d6\u8bf7\u6c42\u53c2\u6570 \u83b7\u53d6\u7684\u662f\u63a5\u53e3\u7684\u5165\u53c2\n \xa0 \xa0 */\n \xa0 \xa0private Object getParameter(Method method, Object[] args) {\n \xa0 \xa0 \xa0 \xa0List<Object> argList = new ArrayList<>();\n \xa0 \xa0 \xa0 \xa0Parameter[] parameters = method.getParameters();\n \xa0 \xa0 \xa0 \xa0for (int i = 0; i < parameters.length; i++) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0//\u5c06RequestBody\u6ce8\u89e3\u4fee\u9970\u7684\u53c2\u6570\u4f5c\u4e3a\u8bf7\u6c42\u53c2\u6570\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0RequestBody requestBody = parameters[i].getAnnotation(RequestBody.class);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0if (requestBody != null) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0argList.add(args[i]);\n \xa0 \xa0 \xa0 \xa0 \xa0  }\n \xa0 \xa0 \xa0  }\n \xa0 \xa0 \xa0 \xa0if (argList.size() == 0) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return null;\n \xa0 \xa0 \xa0  } else if (argList.size() == 1) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return argList.get(0);\n \xa0 \xa0 \xa0  } else {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return argList;\n \xa0 \xa0 \xa0  }\n \xa0  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"3requestdecryptionutil-\u89e3\u5bc6\u7c7b",children:"3\u3001RequestDecryptionUtil \u89e3\u5bc6\u7c7b"}),"\n",(0,i.jsxs)(n.p,{children:["1\u3001\u4f7f\u7528",(0,i.jsx)(n.code,{children:"privateKey"}),"\u79c1\u94a5\u5bf9\u201dsym\u201c\u89e3\u5bc6\u83b7\u53d6\u5230\u5ba2\u6237\u7aef\u52a0\u5bc6\u7684AES\u5bc6\u94a5\uff0c\u504f\u79fb\u91cf\u3001\u65f6\u95f4\u7b49\u4fe1\u606f"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "key":"0t7FtSMofbEVpSZS",\n \xa0"keyVI":"0t7FtSMofbEVpSZS",\n \xa0"time":211213232323323\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"2\u3001\u83b7\u53d6\u5f53\u524d\u65f6\u95f4\u6233\uff0c\u4e0etime\u6bd4\u8f83\u662f\u5426\u8d85\u8fc7\u4e00\u5206\u949f\uff086000\u6beb\u79d2\uff09\uff0c\u8d85\u8fc7\u5c31\u629b\u51fa\u201cRequest timed out, please try again\u201d\u5f02\u5e38\n3\u3001\u6ca1\u6709\u8d85\u65f6\uff0c\u5c06\u83b7\u53d6\u7684\u5230AES\u5bc6\u94a5\u548c\u504f\u79fb\u91cf\uff0c\u518d\u5bf9\u201casy\u201d\u89e3\u5bc6\u83b7\u53d6\u63a5\u53e3\u4f20\u9012\u7684\u771f\u5b9e\u53c2\u6570"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'import com.alibaba.fastjson.JSONObject;\nimport app.activity.common.rsa.RSADecodeData;\nimport app.common.exception.ServiceException;\n\u200b\nimport java.security.interfaces.RSAPrivateKey;\nimport java.util.Objects;\n\u200b\n/**\n * @module\n * @author: qingxu.liu\n * @date: 2023-02-09 17:43\n * @copyright\n **/\npublic class RequestDecryptionUtil {\n\u200b\n \xa0 \xa0private final static String publicKey = "RSA\u751f\u6210\u7684\u516c\u94a5";\n \xa0 \xa0private final static String privateKey = "RSA\u751f\u6210\u7684\u79c1\u94a5";\n \xa0 \xa0private final static Integer timeout = 60000;\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 *\n \xa0 \xa0 * @param sym RSA \u5bc6\u6587\n \xa0 \xa0 * @param asy AES \u5bc6\u6587\n \xa0 \xa0 * @param clazz \u63a5\u53e3\u5165\u53c2\u7c7b\n \xa0 \xa0 * @return Object\n \xa0 \xa0 */\n \xa0 \xa0public static <T> Object getRequestDecryption(String sym, String asy, Class<T> clazz){\n \xa0 \xa0 \xa0 \xa0//\u9a8c\u8bc1\u5bc6\u94a5\n \xa0 \xa0 \xa0 \xa0try {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0//\u89e3\u5bc6RSA\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0RSAPrivateKey rsaPrivateKey = ActivityRSAUtil.getRSAPrivateKeyByString(privateKey);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0String RSAJson = ActivityRSAUtil.privateDecrypt(sym, rsaPrivateKey);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0RSADecodeData rsaDecodeData = JSONObject.parseObject(RSAJson, RSADecodeData.class);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0boolean isTimeout = Objects.nonNull(rsaDecodeData) \xa0&& Objects.nonNull(rsaDecodeData.getTime()) && System.currentTimeMillis() - \xa0rsaDecodeData.getTime() < timeout;\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0if (!isTimeout){\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0throw new ServiceException("Request timed out, please try again."); //\u8bf7\u6c42\u8d85\u65f6\n \xa0 \xa0 \xa0 \xa0 \xa0  }\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0//\u89e3\u5bc6AES\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0String AESJson = AES256Util.decode(rsaDecodeData.getKey(),asy,rsaDecodeData.getKeyVI());\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0System.out.println("AESJson: "+AESJson);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return JSONObject.parseObject(AESJson,clazz);\n \xa0 \xa0 \xa0  } catch (Exception e) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0throw new RuntimeException("RSA decryption Exception:  " +e.getMessage());\n \xa0 \xa0 \xa0  }\n \xa0  }\n\u200b\n \xa0 \xa0public static JSONObject getRequestDecryption(String sym, String asy){\n \xa0 \xa0 \xa0 \xa0//\u9a8c\u8bc1\u5bc6\u94a5\n \xa0 \xa0 \xa0 \xa0try {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0//\u89e3\u5bc6RSA\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0RSAPrivateKey rsaPrivateKey = ActivityRSAUtil.getRSAPrivateKeyByString(privateKey);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0String RSAJson = ActivityRSAUtil.privateDecrypt(sym, rsaPrivateKey);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0RSADecodeData rsaDecodeData = JSONObject.parseObject(RSAJson, RSADecodeData.class);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0boolean isTimeout = Objects.nonNull(rsaDecodeData) \xa0&& Objects.nonNull(rsaDecodeData.getTime()) && System.currentTimeMillis() - \xa0rsaDecodeData.getTime() < timeout;\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0if (!isTimeout){\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0throw new ServiceException("Request timed out, please try again."); //\u8bf7\u6c42\u8d85\u65f6\n \xa0 \xa0 \xa0 \xa0 \xa0  }\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0//\u89e3\u5bc6AES\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0String AESJson = AES256Util.decode(rsaDecodeData.getKey(),asy,rsaDecodeData.getKeyVI());\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0System.out.println("AESJson: "+AESJson);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return JSONObject.parseObject(AESJson);\n \xa0 \xa0 \xa0  } catch (Exception e) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0throw new RuntimeException("RSA decryption Exception:  " +e.getMessage());\n \xa0 \xa0 \xa0  }\n \xa0  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"4activityrsautil-\u5de5\u5177\u7c7b",children:"4\u3001ActivityRSAUtil \u5de5\u5177\u7c7b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'import org.apache.commons.io.IOUtils;\nimport javax.crypto.Cipher;\nimport java.io.ByteArrayOutputStream;\nimport java.security.*;\nimport java.security.interfaces.RSAPrivateKey;\nimport java.security.interfaces.RSAPublicKey;\nimport java.security.spec.PKCS8EncodedKeySpec;\nimport java.security.spec.X509EncodedKeySpec;\nimport java.util.Base64;\n\u200b\n/**\n * @module\n * @author: qingxu.liu\n * @date: 2023-02-07 16:54\n * @copyright\n **/\npublic class ActivityRSAUtil {\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * \u5b57\u7b26\u96c6\n \xa0 \xa0 */\n \xa0 \xa0public static String CHARSET = "UTF-8";\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * \u751f\u6210\u5bc6\u94a5\u5bf9\n \xa0 \xa0 * @param keyLength  \u5bc6\u94a5\u957f\u5ea6\n \xa0 \xa0 * @return KeyPair\n \xa0 \xa0 */\n \xa0 \xa0public static KeyPair getKeyPair(int keyLength) {\n \xa0 \xa0 \xa0 \xa0try {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance("RSA"); \xa0 //\u9ed8\u8ba4:RSA/None/PKCS1Padding\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0keyPairGenerator.initialize(keyLength);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return keyPairGenerator.generateKeyPair();\n \xa0 \xa0 \xa0  } catch (NoSuchAlgorithmException e) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0throw new RuntimeException("\u751f\u6210\u5bc6\u94a5\u5bf9\u65f6\u9047\u5230\u5f02\u5e38" + \xa0e.getMessage());\n \xa0 \xa0 \xa0  }\n \xa0  }\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * \u83b7\u53d6\u516c\u94a5\n \xa0 \xa0 */\n \xa0 \xa0public static byte[] getPublicKey(KeyPair keyPair) {\n \xa0 \xa0 \xa0 \xa0RSAPublicKey rsaPublicKey = (RSAPublicKey) keyPair.getPublic();\n \xa0 \xa0 \xa0 \xa0return rsaPublicKey.getEncoded();\n \xa0  }\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * \u83b7\u53d6\u79c1\u94a5\n \xa0 \xa0 */\n \xa0 \xa0public static byte[] getPrivateKey(KeyPair keyPair) {\n \xa0 \xa0 \xa0 \xa0RSAPrivateKey rsaPrivateKey = (RSAPrivateKey) keyPair.getPrivate();\n \xa0 \xa0 \xa0 \xa0return rsaPrivateKey.getEncoded();\n \xa0  }\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * \u516c\u94a5\u5b57\u7b26\u4e32\u8f6cPublicKey\u5b9e\u4f8b\n \xa0 \xa0 * @param publicKey \u516c\u94a5\u5b57\u7b26\u4e32\n \xa0 \xa0 * @return \xa0 \xa0 \xa0 \xa0  PublicKey\n \xa0 \xa0 * @throws Exception e\n \xa0 \xa0 */\n \xa0 \xa0public static PublicKey getPublicKey(String publicKey) throws Exception {\n \xa0 \xa0 \xa0 \xa0byte[] publicKeyBytes = Base64.getDecoder().decode(publicKey.getBytes());\n \xa0 \xa0 \xa0 \xa0X509EncodedKeySpec keySpec = new X509EncodedKeySpec(publicKeyBytes);\n \xa0 \xa0 \xa0 \xa0KeyFactory keyFactory = KeyFactory.getInstance("RSA");\n \xa0 \xa0 \xa0 \xa0return keyFactory.generatePublic(keySpec);\n \xa0  }\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * \u79c1\u94a5\u5b57\u7b26\u4e32\u8f6cPrivateKey\u5b9e\u4f8b\n \xa0 \xa0 * @param privateKey  \u79c1\u94a5\u5b57\u7b26\u4e32\n \xa0 \xa0 * @return PrivateKey\n \xa0 \xa0 * @throws Exception e\n \xa0 \xa0 */\n \xa0 \xa0public static PrivateKey getPrivateKey(String privateKey) throws Exception {\n \xa0 \xa0 \xa0 \xa0byte[] privateKeyBytes = Base64.getDecoder().decode(privateKey.getBytes());\n \xa0 \xa0 \xa0 \xa0PKCS8EncodedKeySpec keySpec = new PKCS8EncodedKeySpec(privateKeyBytes);\n \xa0 \xa0 \xa0 \xa0KeyFactory keyFactory = KeyFactory.getInstance("RSA");\n \xa0 \xa0 \xa0 \xa0return keyFactory.generatePrivate(keySpec);\n \xa0  }\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * \u83b7\u53d6\u516c\u94a5\u5b57\u7b26\u4e32\n \xa0 \xa0 * @param keyPair KeyPair\n \xa0 \xa0 * @return  \u516c\u94a5\u5b57\u7b26\u4e32\n \xa0 \xa0 */\n \xa0 \xa0public static String getPublicKeyString(KeyPair keyPair){\n \xa0 \xa0 \xa0 \xa0RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic(); \xa0// \u5f97\u5230\u516c\u94a5\n \xa0 \xa0 \xa0 \xa0return new String(org.apache.commons.codec.binary.Base64.encodeBase64(publicKey.getEncoded()));\n \xa0  }\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * \u83b7\u53d6\u79c1\u94a5\u5b57\u7b26\u4e32\n \xa0 \xa0 * @param keyPair  KeyPair\n \xa0 \xa0 * @return \u79c1\u94a5\u5b57\u7b26\u4e32\n \xa0 \xa0 */\n \xa0 \xa0public static String getPrivateKeyString(KeyPair keyPair){\n \xa0 \xa0 \xa0 \xa0RSAPrivateKey privateKey = (RSAPrivateKey) keyPair.getPrivate(); \xa0 // \u5f97\u5230\u79c1\u94a5\n \xa0 \xa0 \xa0 \xa0return new String(org.apache.commons.codec.binary.Base64.encodeBase64((privateKey.getEncoded())));\n \xa0  }\n\u200b\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * \u516c\u94a5\u52a0\u5bc6\n \xa0 \xa0 * @param data \xa0 \xa0 \xa0  \u660e\u6587\n \xa0 \xa0 * @param publicKey \xa0 \u516c\u94a5\n \xa0 \xa0 * @return \xa0 \xa0 \xa0 \xa0 \xa0  \u5bc6\u6587\n \xa0 \xa0 */\n \xa0 \xa0public static String publicEncrypt(String data, RSAPublicKey publicKey) {\n \xa0 \xa0 \xa0 \xa0try {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0Cipher cipher = Cipher.getInstance("RSA");\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0cipher.init(Cipher.ENCRYPT_MODE, publicKey);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0byte[] bytes = rsaSplitCodec(cipher, Cipher.ENCRYPT_MODE, data.getBytes(CHARSET), publicKey.getModulus().bitLength());\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return new String(org.apache.commons.codec.binary.Base64.encodeBase64(bytes));\n \xa0 \xa0 \xa0  } catch (Exception e) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0throw new RuntimeException("\u52a0\u5bc6\u5b57\u7b26\u4e32[" + data + "]\u65f6\u9047\u5230\u5f02\u5e38"+ \xa0e.getMessage());\n \xa0 \xa0 \xa0  }\n \xa0  }\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * \u79c1\u94a5\u89e3\u5bc6\n \xa0 \xa0 * @param data \xa0 \xa0 \xa0  \u5bc6\u6587\n \xa0 \xa0 * @param privateKey  \u79c1\u94a5\n \xa0 \xa0 * @return \xa0 \xa0 \xa0 \xa0 \xa0  \u660e\u6587\n \xa0 \xa0 */\n \xa0 \xa0public static String privateDecrypt(String data, RSAPrivateKey privateKey) {\n \xa0 \xa0 \xa0 \xa0try {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0Cipher cipher = Cipher.getInstance("RSA");\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0cipher.init(Cipher.DECRYPT_MODE, privateKey);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return new String(rsaSplitCodec(cipher, Cipher.DECRYPT_MODE, Base64.getDecoder().decode(data), privateKey.getModulus().bitLength()), CHARSET);\n \xa0 \xa0 \xa0  } catch (Exception e) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0throw new RuntimeException("privateKey\u89e3\u5bc6\u5b57\u7b26\u4e32[" + data + "]\u65f6\u9047\u5230\u5f02\u5e38"+ \xa0e.getMessage());\n \xa0 \xa0 \xa0  }\n \xa0  }\n\u200b\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * \u79c1\u94a5\u52a0\u5bc6\n \xa0 \xa0 * @param content \u660e\u6587\n \xa0 \xa0 * @param privateKey \u79c1\u94a5\n \xa0 \xa0 * @return \u5bc6\u6587\n \xa0 \xa0 */\n \xa0 \xa0public static String encryptByPrivateKey(String content, RSAPrivateKey privateKey){\n\u200b\n \xa0 \xa0 \xa0 \xa0try {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0Cipher cipher = Cipher.getInstance("RSA");\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0cipher.init(Cipher.ENCRYPT_MODE, privateKey);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0byte[] bytes = rsaSplitCodec(cipher, Cipher.ENCRYPT_MODE,content.getBytes(CHARSET), privateKey.getModulus().bitLength());\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return new String(org.apache.commons.codec.binary.Base64.encodeBase64(bytes));\n \xa0 \xa0 \xa0  } catch (Exception e) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0throw new RuntimeException("privateKey\u52a0\u5bc6\u5b57\u7b26\u4e32[" + content + "]\u65f6\u9047\u5230\u5f02\u5e38" + \xa0e.getMessage());\n \xa0 \xa0 \xa0  }\n \xa0  }\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * \u516c\u94a5\u89e3\u5bc6\n \xa0 \xa0 * @param content  \u5bc6\u6587\n \xa0 \xa0 * @param publicKey \u79c1\u94a5\n \xa0 \xa0 * @return  \u660e\u6587\n \xa0 \xa0 */\n \xa0 \xa0public static String decryByPublicKey(String content, RSAPublicKey publicKey){\n \xa0 \xa0 \xa0 \xa0try {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0Cipher cipher = Cipher.getInstance("RSA");\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0cipher.init(Cipher.DECRYPT_MODE, publicKey);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return new String(rsaSplitCodec(cipher, Cipher.DECRYPT_MODE, Base64.getDecoder().decode(content), publicKey.getModulus().bitLength()), CHARSET);\n \xa0 \xa0 \xa0  } catch (Exception e) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0throw new RuntimeException("publicKey\u89e3\u5bc6\u5b57\u7b26\u4e32[" + content + "]\u65f6\u9047\u5230\u5f02\u5e38" +e.getMessage());\n \xa0 \xa0 \xa0  }\n \xa0  }\n\u200b\n \xa0 \xa0public static RSAPublicKey getRSAPublicKeyByString(String publicKey){\n \xa0 \xa0 \xa0 \xa0try {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0X509EncodedKeySpec keySpec = new X509EncodedKeySpec(Base64.getDecoder().decode(publicKey));\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0KeyFactory keyFactory = KeyFactory.getInstance("RSA");\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return (RSAPublicKey)keyFactory.generatePublic(keySpec);\n \xa0 \xa0 \xa0  } catch (Exception e) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0throw new RuntimeException("String\u8f6cPublicKey\u51fa\u9519" + e.getMessage());\n \xa0 \xa0 \xa0  }\n \xa0  }\n\u200b\n\u200b\n \xa0 \xa0public static RSAPrivateKey getRSAPrivateKeyByString(String privateKey){\n \xa0 \xa0 \xa0 \xa0try {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0PKCS8EncodedKeySpec pkcs8EncodedKeySpec = new PKCS8EncodedKeySpec(Base64.getDecoder().decode(privateKey));\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0KeyFactory keyFactory = KeyFactory.getInstance("RSA");\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return (RSAPrivateKey)keyFactory.generatePrivate(pkcs8EncodedKeySpec);\n \xa0 \xa0 \xa0  } catch (Exception e) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0throw new RuntimeException("String\u8f6cPrivateKey\u51fa\u9519" + e.getMessage());\n \xa0 \xa0 \xa0  }\n \xa0  }\n\u200b\n\u200b\n \xa0 \xa0//rsa\u5207\u5272\u89e3\u7801  , ENCRYPT_MODE,\u52a0\u5bc6\u6570\u636e \xa0 ,DECRYPT_MODE,\u89e3\u5bc6\u6570\u636e\n \xa0 \xa0private static byte[] rsaSplitCodec(Cipher cipher, int opmode, byte[] datas, int keySize) {\n \xa0 \xa0 \xa0 \xa0int maxBlock = 0; \xa0//\u6700\u5927\u5757\n \xa0 \xa0 \xa0 \xa0if (opmode == Cipher.DECRYPT_MODE) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0maxBlock = keySize / 8;\n \xa0 \xa0 \xa0  } else {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0maxBlock = keySize / 8 - 11;\n \xa0 \xa0 \xa0  }\n \xa0 \xa0 \xa0 \xa0ByteArrayOutputStream out = new ByteArrayOutputStream();\n \xa0 \xa0 \xa0 \xa0int offSet = 0;\n \xa0 \xa0 \xa0 \xa0byte[] buff;\n \xa0 \xa0 \xa0 \xa0int i = 0;\n \xa0 \xa0 \xa0 \xa0try {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0while (datas.length > offSet) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0if (datas.length - offSet > maxBlock) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0//\u53ef\u4ee5\u8c03\u7528\u4ee5\u4e0b\u7684doFinal\uff08\uff09\u65b9\u6cd5\u5b8c\u6210\u52a0\u5bc6\u6216\u89e3\u5bc6\u6570\u636e\uff1a\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0buff = cipher.doFinal(datas, offSet, maxBlock);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  } else {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0buff = cipher.doFinal(datas, offSet, datas.length - offSet);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0  }\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0out.write(buff, 0, buff.length);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0i++;\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0offSet = i * maxBlock;\n \xa0 \xa0 \xa0 \xa0 \xa0  }\n \xa0 \xa0 \xa0  } catch (Exception e) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0throw new RuntimeException("\u52a0\u89e3\u5bc6\u9600\u503c\u4e3a[" + maxBlock + "]\u7684\u6570\u636e\u65f6\u53d1\u751f\u5f02\u5e38: " + e.getMessage());\n \xa0 \xa0 \xa0  }\n \xa0 \xa0 \xa0 \xa0byte[] resultDatas = out.toByteArray();\n \xa0 \xa0 \xa0 \xa0IOUtils.closeQuietly(out);\n \xa0 \xa0 \xa0 \xa0return resultDatas;\n \xa0  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"5aes256util-\u5de5\u5177\u7c7b",children:"5\u3001AES256Util \u5de5\u5177\u7c7b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'import org.bouncycastle.jce.provider.BouncyCastleProvider;\nimport javax.crypto.Cipher;\nimport javax.crypto.spec.SecretKeySpec;\nimport java.nio.charset.StandardCharsets;\nimport java.security.Security;\nimport java.util.Base64;\n\u200b\n/**\n * @module\n * @author: qingxu.liu\n * @date: 2023-02-07 16:14\n * @copyright\n **/\n\u200b\npublic class AES256Util {\n\u200b\n \xa0 \xa0private static final String AES = "AES";\n \xa0 \xa0/**\n \xa0 \xa0 * \u521d\u59cb\u5411\u91cfIV, \u521d\u59cb\u5411\u91cfIV\u7684\u957f\u5ea6\u89c4\u5b9a\u4e3a128\u4f4d16\u4e2a\u5b57\u8282, \u521d\u59cb\u5411\u91cf\u7684\u6765\u6e90\u4e3a\u968f\u673a\u751f\u6210.\n \xa0 \xa0 */\n \xa0 \xa0/**\n \xa0 \xa0 * \u52a0\u5bc6\u89e3\u5bc6\u7b97\u6cd5/\u52a0\u5bc6\u6a21\u5f0f/\u586b\u5145\u65b9\u5f0f\n \xa0 \xa0 */\n \xa0 \xa0private static final String CIPHER_ALGORITHM = "AES/CBC/PKCS7Padding";\n\u200b\n \xa0 \xa0private static final Base64.Encoder base64Encoder = java.util.Base64.getEncoder();\n \xa0 \xa0private static final Base64.Decoder base64Decoder = java.util.Base64.getDecoder();\n\u200b\n \xa0 \xa0//\u901a\u8fc7\u5728\u8fd0\u884c\u73af\u5883\u4e2d\u8bbe\u7f6e\u4ee5\u4e0b\u5c5e\u6027\u542f\u7528AES-256\u652f\u6301\n \xa0 \xa0static {\n \xa0 \xa0 \xa0 \xa0Security.setProperty("crypto.policy", "unlimited");\n \xa0  }\n \xa0 \xa0/*\n \xa0 \xa0 * \u89e3\u51b3java\u4e0d\u652f\u6301AES/CBC/PKCS7Padding\u6a21\u5f0f\u89e3\u5bc6\n \xa0 \xa0 */\n \xa0 \xa0static {\n \xa0 \xa0 \xa0 \xa0Security.addProvider(new BouncyCastleProvider());\n \xa0  }\n \xa0 \xa0/**\n \xa0 \xa0 * AES\u52a0\u5bc6\n \xa0 \xa0 */\n \xa0 \xa0public static String encode(String key, String content,String keyVI) {\n \xa0 \xa0 \xa0 \xa0try {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0javax.crypto.SecretKey secretKey = new javax.crypto.spec.SecretKeySpec(key.getBytes(), AES);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0javax.crypto.Cipher cipher = javax.crypto.Cipher.getInstance(CIPHER_ALGORITHM);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0cipher.init(javax.crypto.Cipher.ENCRYPT_MODE, secretKey, new javax.crypto.spec.IvParameterSpec(keyVI.getBytes()));\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0// \u83b7\u53d6\u52a0\u5bc6\u5185\u5bb9\u7684\u5b57\u8282\u6570\u7ec4(\u8fd9\u91cc\u8981\u8bbe\u7f6e\u4e3autf-8)\u4e0d\u7136\u5185\u5bb9\u4e2d\u5982\u679c\u6709\u4e2d\u6587\u548c\u82f1\u6587\u6df7\u5408\u4e2d\u6587\u5c31\u4f1a\u89e3\u5bc6\u4e3a\u4e71\u7801\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0byte[] byteEncode = content.getBytes(java.nio.charset.StandardCharsets.UTF_8);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0// \u6839\u636e\u5bc6\u7801\u5668\u7684\u521d\u59cb\u5316\u65b9\u5f0f\u52a0\u5bc6\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0byte[] byteAES = cipher.doFinal(byteEncode);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0// \u5c06\u52a0\u5bc6\u540e\u7684\u6570\u636e\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return base64Encoder.encodeToString(byteAES);\n \xa0 \xa0 \xa0  } catch (Exception e) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0e.printStackTrace();\n \xa0 \xa0 \xa0  }\n \xa0 \xa0 \xa0 \xa0return null;\n \xa0  }\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * AES\u89e3\u5bc6\n \xa0 \xa0 */\n \xa0 \xa0public static String decode(String key, String content,String keyVI) {\n \xa0 \xa0 \xa0 \xa0try {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0javax.crypto.SecretKey secretKey = new javax.crypto.spec.SecretKeySpec(key.getBytes(), AES);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0javax.crypto.Cipher cipher = javax.crypto.Cipher.getInstance(CIPHER_ALGORITHM);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0cipher.init(javax.crypto.Cipher.DECRYPT_MODE, secretKey, new javax.crypto.spec.IvParameterSpec(keyVI.getBytes()));\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0// \u5c06\u52a0\u5bc6\u5e76\u7f16\u7801\u540e\u7684\u5185\u5bb9\u89e3\u7801\u6210\u5b57\u8282\u6570\u7ec4\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0byte[] byteContent = base64Decoder.decode(content);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0// \u89e3\u5bc6\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0byte[] byteDecode = cipher.doFinal(byteContent);\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0return new String(byteDecode, java.nio.charset.StandardCharsets.UTF_8);\n \xa0 \xa0 \xa0  } catch (Exception e) {\n \xa0 \xa0 \xa0 \xa0 \xa0 \xa0e.printStackTrace();\n \xa0 \xa0 \xa0  }\n \xa0 \xa0 \xa0 \xa0return null;\n \xa0  }\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * AES\u52a0\u5bc6ECB\u6a21\u5f0fPKCS7Padding\u586b\u5145\u65b9\u5f0f\n \xa0 \xa0 * @param str \u5b57\u7b26\u4e32\n \xa0 \xa0 * @param key \u5bc6\u94a5\n \xa0 \xa0 * @return \u52a0\u5bc6\u5b57\u7b26\u4e32\n \xa0 \xa0 * @throws Exception \u5f02\u5e38\u4fe1\u606f\n \xa0 \xa0 */\n \xa0 \xa0public static String aes256ECBPkcs7PaddingEncrypt(String str, String key) throws Exception {\n \xa0 \xa0 \xa0 \xa0Cipher cipher = Cipher.getInstance("AES/ECB/PKCS7Padding");\n \xa0 \xa0 \xa0 \xa0byte[] keyBytes = key.getBytes(StandardCharsets.UTF_8);\n \xa0 \xa0 \xa0 \xa0cipher.init(Cipher.ENCRYPT_MODE, new SecretKeySpec(keyBytes, AES));\n \xa0 \xa0 \xa0 \xa0byte[] doFinal = cipher.doFinal(str.getBytes(StandardCharsets.UTF_8));\n \xa0 \xa0 \xa0 \xa0return new String(Base64.getEncoder().encode(doFinal));\n \xa0  }\n\u200b\n \xa0 \xa0/**\n \xa0 \xa0 * AES\u89e3\u5bc6ECB\u6a21\u5f0fPKCS7Padding\u586b\u5145\u65b9\u5f0f\n \xa0 \xa0 * @param str \u5b57\u7b26\u4e32\n \xa0 \xa0 * @param key \u5bc6\u94a5\n \xa0 \xa0 * @return \u89e3\u5bc6\u5b57\u7b26\u4e32\n \xa0 \xa0 * @throws Exception \u5f02\u5e38\u4fe1\u606f\n \xa0 \xa0 */\n \xa0 \xa0public static String aes256ECBPkcs7PaddingDecrypt(String str, String key) throws Exception {\n \xa0 \xa0 \xa0 \xa0Cipher cipher = Cipher.getInstance("AES/ECB/PKCS7Padding");\n \xa0 \xa0 \xa0 \xa0byte[] keyBytes = key.getBytes(StandardCharsets.UTF_8);\n \xa0 \xa0 \xa0 \xa0cipher.init(Cipher.DECRYPT_MODE, new SecretKeySpec(keyBytes, AES));\n \xa0 \xa0 \xa0 \xa0byte[] doFinal = cipher.doFinal(Base64.getDecoder().decode(str));\n \xa0 \xa0 \xa0 \xa0return new String(doFinal);\n \xa0  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u4eb2\u6d4b100%\u53ef\u7528~~~"})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},10689:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/28-1-3f494ef104667301c990ee5aa2d65d4a.awebp"},59358:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/28-2-20b5c620dd4d3181fd74edaf78d0fad9.awebp"},28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>s});var i=t(96540);const r={},a=i.createContext(r);function c(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);