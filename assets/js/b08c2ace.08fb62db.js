"use strict";(self.webpackChunklight_docusaurus=self.webpackChunklight_docusaurus||[]).push([[3730],{28319:(n,e,l)=>{l.r(e),l.d(e,{assets:()=>a,contentTitle:()=>r,default:()=>x,frontMatter:()=>s,metadata:()=>c,toc:()=>t});var d=l(85893),i=l(11151);const s={},r=void 0,c={id:"zh-cn/devenv/Docker-InfluxDB",title:"Docker-InfluxDB",description:"- InfluxDB Offical",source:"@site/docs/zh-cn/devenv/15-Docker-InfluxDB.md",sourceDirName:"zh-cn/devenv",slug:"/zh-cn/devenv/Docker-InfluxDB",permalink:"/light-docusaurus/docs/zh-cn/devenv/Docker-InfluxDB",draft:!1,unlisted:!1,editUrl:"https://github.com/lorchr/light-docusaurus/tree/main/docs/zh-cn/devenv/15-Docker-InfluxDB.md",tags:[],version:"current",sidebarPosition:15,frontMatter:{},sidebar:"troch",previous:{title:"Docker-Redis",permalink:"/light-docusaurus/docs/zh-cn/devenv/Docker-Redis"},next:{title:"Docker-Elasticsearch",permalink:"/light-docusaurus/docs/zh-cn/devenv/Docker-Elasticsearch"}},a={},t=[{value:"1. Docker\u5b89\u88c5",id:"1-docker\u5b89\u88c5",level:2},{value:"2. Windows\u5b89\u88c5InfluxDB\u53ca\u8bbe\u7f6e\u7528\u6237\u6743\u9650\u8bf4\u660e",id:"2-windows\u5b89\u88c5influxdb\u53ca\u8bbe\u7f6e\u7528\u6237\u6743\u9650\u8bf4\u660e",level:2},{value:"\u5b89\u88c5Influxdb",id:"\u5b89\u88c5influxdb",level:3},{value:"InfluxDB\u589e\u52a0\u7528\u6237\u53ca\u6743\u9650",id:"influxdb\u589e\u52a0\u7528\u6237\u53ca\u6743\u9650",level:3},{value:"3. \u5907\u4efd\u548c\u8fd8\u539f",id:"3-\u5907\u4efd\u548c\u8fd8\u539f",level:2},{value:"1. \u5907\u4efd",id:"1-\u5907\u4efd",level:3},{value:"2. \u6062\u590d",id:"2-\u6062\u590d",level:3},{value:"4. \u5e38\u7528\u547d\u4ee4\u884c\u64cd\u4f5c",id:"4-\u5e38\u7528\u547d\u4ee4\u884c\u64cd\u4f5c",level:2}];function o(n){const e={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.ah)(),...n.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.a,{href:"https://www.influxdata.com",children:"InfluxDB Offical"})}),"\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.a,{href:"https://docs.influxdata.com/influxdb/v2.0/install/?t=Docker",children:"InfluxDB Offical Docker"})}),"\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.a,{href:"https://hub.docker.com/_/influxdb",children:"InfluxDB Docker"})}),"\n"]}),"\n",(0,d.jsx)(e.h2,{id:"1-docker\u5b89\u88c5",children:"1. Docker\u5b89\u88c5"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"# \u521b\u5efaNetwork\ndocker network create dev\n\n# \u521b\u5efa\u6570\u636e\u5377\ndocker volume create influx_data;\n\n# \u521b\u5efa\u6587\u4ef6\u5939\nmkdir -p //d/docker/influxdb/{conf,data,logs}\n\n# docker run -i --rm influxdb:1.8 influxd config > D:/docker/influxdb/conf/influxdb.conf\n\n# \u83b7\u53d6\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\ndocker run -d --name influxdb_temp influxdb:1.8 \\\n&& docker exec -it influxdb_temp influxd config /etc/influxdb/influxdb.conf \\\n&& docker cp influxdb_temp:/etc/influxdb/influxdb.conf D:/docker/influxdb/conf/influxdb.conf \\\n&& docker stop influxdb_temp && docker rm influxdb_temp\n\n# \u8fd0\u884c\u5bb9\u5668\ndocker run -d \\\n  --publish 8086:8086 \\\n  --volume //d/docker/influxdb/data:/var/lib/influxdb \\\n  --volume //d/docker/influxdb/conf/influxdb.conf:/etc/influxdb/influxdb.conf:ro \\\n  --env DOCKER_INFLUXDB_INIT_USERNAME=admin \\\n  --env DOCKER_INFLUXDB_INIT_PASSWORD=admin@123 \\\n  --net dev \\\n  --restart=no \\\n  --name influxdb \\\n  influxdb:1.8 -config /etc/influxdb/influxdb.conf\n\ndocker exec -it -u root influxdb /bin/bash\n\n# \u4fee\u6539\u914d\u7f6e\napt update && apt-get install -y vim\n\nvim /etc/influxdb/influxdb.conf\n[http]\n  enable=true\n  auth-enable=true\n\ncat << EOF >> /etc/influxdb/influxdb.conf\n[http]\n  enable=true\n  auth-enable=true\nEOF\n\n# \u521b\u5efa\u7528\u6237\ninflux\n\nSHOW DATABASES;\nUSE _internal;\nCREATE USER \"root\" WITH PASSWORD '123456' WITH ALL PRIVILEGES;\nSHOW USERS;\n\n# \u91cd\u542f\u4f7f\u914d\u7f6e\u751f\u6548\ndocker container restart influxdb\n\n# \u67e5\u8be2\u7248\u672c\nSHOW DIAGNOSTICS;\nSHOW STAT;\n\n# \u67e5\u8be2tag\u5b57\u6bb5\u548cfield\u5b57\u6bb5\nshow tag keys from cpu\n\nshow field keys from cpu\n"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:["Account","\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"admin/admin@123"}),"\n",(0,d.jsx)(e.li,{children:"root/123456"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(e.h2,{id:"2-windows\u5b89\u88c5influxdb\u53ca\u8bbe\u7f6e\u7528\u6237\u6743\u9650\u8bf4\u660e",children:"2. Windows\u5b89\u88c5InfluxDB\u53ca\u8bbe\u7f6e\u7528\u6237\u6743\u9650\u8bf4\u660e"}),"\n",(0,d.jsx)(e.h3,{id:"\u5b89\u88c5influxdb",children:"\u5b89\u88c5Influxdb"}),"\n",(0,d.jsxs)(e.ol,{children:["\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsxs)(e.p,{children:["\u8fdb\u5165\u7f51\u5740",(0,d.jsx)(e.a,{href:"https://portal.influxdata.com/downloads/1.8",children:"https://portal.influxdata.com/downloads/1.8"})]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsxs)(e.p,{children:["\u5c06",(0,d.jsx)(e.code,{children:"influxdb"}),"\u7684zip\u538b\u7f29\u6587\u4ef6\uff0c\u89e3\u538b\u5230\u6307\u5b9a\u76ee\u5f55\u4e2d"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.code,{children:"\u7ba1\u7406\u5458\u8eab\u4efd"}),"\u8fd0\u884ccmd\u8fdb\u5165",(0,d.jsx)(e.code,{children:"influxdb"}),"\u7684\u6587\u4ef6\u5939\u5185"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsxs)(e.p,{children:["\u751f\u6210",(0,d.jsx)(e.code,{children:"influxdb"}),"\u6570\u636e\u7684\u9ed8\u8ba4\u914d\u7f6econfig\u6587\u4ef6"]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsxs)(e.p,{children:["\u8f93\u5165\u547d\u4ee4 ",(0,d.jsx)(e.code,{children:"influxd config > influxd.config"})]}),"\n"]}),"\n",(0,d.jsxs)(e.ol,{start:"5",children:["\n",(0,d.jsxs)(e.li,{children:["\u7f16\u8f91\u65b0\u751f\u6210\u7684",(0,d.jsx)(e.code,{children:"influxd.config"}),"\u6587\u4ef6\uff0c\u4fee\u6539influxdb\u5b58\u653e\u6570\u636e\u7684\u8def\u5f84"]}),"\n"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:'  [meta]\t\n    dir = "D:\\\\influxdb\\\\influxdatas\\\\meta"\n    \xb7\xb7\xb7  \xb7\xb7\xb7  \xb7\xb7\xb7  \xb7\xb7\xb7\n  [data]\n    dir = "D:\\\\influxdb\\\\influxdatas\\\\data"\t\n    \xb7\xb7\xb7  \xb7\xb7\xb7  \xb7\xb7\xb7  \xb7\xb7\xb7\n    wal-dir = "D:\\\\influxdb\\\\influxdatas\\\\wal"\n'})}),"\n",(0,d.jsxs)(e.ol,{start:"6",children:["\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsxs)(e.p,{children:["\u7f16\u8f91\u5b8c\u6bd5\u540e\u62a4\u4fdd\u5b58\u9000\u51fa\uff0c\u5728cmd\u5185\u8f93\u5165\u547d\u4ee4",(0,d.jsx)(e.code,{children:"influxd -config influxd.config"})]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsx)(e.p,{children:"\u4f1a\u8f93\u51fa InfluxDB \u7684Logo\uff0c\u8fd0\u884cInfluxDB\u65f6\u4e0d\u53ef\u5173\u95ed\u6b64\u547d\u4ee4\u7a97\u53e3"}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsxs)(e.p,{children:["\u53cc\u51fb\u6253\u5f00",(0,d.jsx)(e.code,{children:"influx.exe"}),"\u6587\u4ef6\uff0c\u8fdb\u884c\u7b80\u5355\u7684\u64cd\u4f5c\u3002 \u8f93\u5165 ",(0,d.jsx)(e.code,{children:"SHOW DATABASES"})]}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(e.h3,{id:"influxdb\u589e\u52a0\u7528\u6237\u53ca\u6743\u9650",children:"InfluxDB\u589e\u52a0\u7528\u6237\u53ca\u6743\u9650"}),"\n",(0,d.jsxs)(e.ol,{children:["\n",(0,d.jsxs)(e.li,{children:["\u5c06",(0,d.jsx)(e.code,{children:"influxd.config"}),"\u6587\u4ef6\u91cc\uff0c",(0,d.jsx)(e.code,{children:"auth-enabled = false"}),"\u6539\u4e3a",(0,d.jsx)(e.code,{children:"true"})]}),"\n",(0,d.jsxs)(e.li,{children:["\u5173\u95ed\u4e4b\u524d\u542f\u52a8\u7684",(0,d.jsx)(e.code,{children:"influxd.exe"}),"\u547d\u4ee4\u7a97\u53e3"]}),"\n",(0,d.jsxs)(e.li,{children:["\u4ee5\u7ba1\u7406\u5458\u6a21\u5f0f\u6253\u5f00cmd\u7a97\u53e3\uff0c\u91cd\u65b0\u8fdb\u5165",(0,d.jsx)(e.code,{children:"influxdb-1.x.x-1"}),"\u7684\u6587\u4ef6\u5939\u5185"]}),"\n",(0,d.jsxs)(e.li,{children:["\u8f93\u5165\u542f\u52a8\u670d\u52a1\u547d\u4ee4",(0,d.jsx)(e.code,{children:"influxd -config influxd.config"})]}),"\n",(0,d.jsxs)(e.li,{children:["\u53cc\u51fb\u6253\u5f00",(0,d.jsx)(e.code,{children:"influx.exe"}),"\u6587\u4ef6\uff0c \u8f93\u5165 ",(0,d.jsx)(e.code,{children:"SHOW DATABASES"}),"\uff0c\u5982\u679c\u62a5\u9519\u8bf4\u660e\u8eab\u4efd\u8ba4\u8bc1\u529f\u80fd\u5df2\u6253\u5f00"]}),"\n",(0,d.jsxs)(e.li,{children:["\u521b\u5efaadmin\u7ba1\u7406\u5458\u7528\u6237",(0,d.jsx)(e.code,{children:"CREATE USER influxdb WITH PASSWORD 'influxdb' WITH ALL PRIVILEGES"})]}),"\n",(0,d.jsxs)(e.li,{children:["\u9a8c\u8bc1\u8d26\u6237\u662f\u5426\u521b\u5efa\u6210\u529f\uff0c\u8f93\u5165",(0,d.jsx)(e.code,{children:"auth"}),"\u540e\u6309\u56de\u8f66,\u6839\u636e\u63d0\u793a\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002\u767b\u5f55\u540e\u8f93\u5165",(0,d.jsx)(e.code,{children:"SHOW DATABASES"}),"\uff0c\u5982\u6709\u8f93\u51fa\u6570\u636e\u5e93\u540d\u79f0\u5373\u4e3a\u5b89\u88c5\u6210\u529f"]}),"\n"]}),"\n",(0,d.jsx)(e.h2,{id:"3-\u5907\u4efd\u548c\u8fd8\u539f",children:"3. \u5907\u4efd\u548c\u8fd8\u539f"}),"\n",(0,d.jsx)(e.p,{children:"\u4e3a\u4e86\u9632\u6b62\u56e0\u4e3a\u64cd\u4f5c\u9519\u8bef\u6216\u673a\u5668\u6545\u969c\u5bfc\u81f4\u6570\u636e\u4e22\u5931\uff0cInfluxDB\u4f01\u4e1a\u7248\u63d0\u4f9b\u4e86\u4e24\u4e2a\u5de5\u5177\u96c6\uff1a\u5907\u4efd\u548c\u8fd8\u539f\n\u5907\u4efd\u5de5\u5177\u96c6\uff1b\u5bfc\u51fa\u548c\u5bfc\u5165\u6570\u636e\u5de5\u5177\u96c6\u3002\u8fd9\u4e24\u4e2a\u5de5\u5177\u96c6\u90fd\u53ef\u4ee5\u7528\u4e8e\u6570\u636e\u5907\u4efd\u548c\u8fd8\u539f\uff0c\u4f46\u4fa7\u91cd\u70b9\u53c8\u6709\u6240\u4e0d\n\u540c\u3002"}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"\u5907\u4efd\u548c\u8fd8\u539f\u5907\u4efd\u5de5\u5177\u96c6\uff1a\u9002\u7528\u4e8e\u5927\u591a\u6570\u573a\u666f\uff0c\u662f\u901a\u7528\u578b\u5de5\u5177\u3002"}),"\n",(0,d.jsx)(e.li,{children:"\u5bfc\u51fa\u548c\u5bfc\u5165\u6570\u636e\u5de5\u5177\u96c6\uff1a\u9488\u5bf9\u6d77\u91cf\u6570\u636e\u96c6\uff08100G\u4ee5\u4e0a\uff09\u573a\u666f\u8865\u5145\u8bbe\u8ba1\u7684\u5907\u4efd\u5de5\u5177\u3002"}),"\n"]}),"\n",(0,d.jsx)(e.p,{children:"\u4e0a\u8ff0\u4e24\u4e2a\u5de5\u5177\u96c6\u53ef\u7528\u4e8e\u4ee5\u4e0b\u573a\u666f\uff1a"}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"\u5728\u610f\u5916\u6545\u969c\u5bfc\u81f4\u6570\u636e\u635f\u574f\u540e\u8fdb\u884c\u707e\u96be\u6062\u590d\u3002"}),"\n",(0,d.jsx)(e.li,{children:"\u5c06\u6570\u636e\u8fc1\u79fb\u5230\u65b0\u73af\u5883\u6216\u65b0\u670d\u52a1\u5668\u3002"}),"\n",(0,d.jsx)(e.li,{children:"\u5c06\u96c6\u7fa4\u8fd8\u539f\u5230\u4e00\u81f4\u6027\u72b6\u6001\u3002"}),"\n"]}),"\n",(0,d.jsx)(e.p,{children:"\u5907\u4efd\u548c\u8fd8\u539f\u5907\u4efd\u5de5\u5177\u96c6\u652f\u6301\u4ee5\u6570\u636e\u5e93\u3001\u4fdd\u7559\u7b56\u7565\u3001\u5206\u72473\u4e2a\u7ef4\u5ea6\u9009\u5b9a\u8981\u64cd\u4f5c\u7684\u6570\u636e\uff0c\u8fdb\u884c\u5907\u4efd\u6216\n\u8fd8\u539f\u5907\u4efd\u64cd\u4f5c\uff0c\u4e00\u822c\u63a8\u8350\u4f7f\u7528\u5907\u4efd\u548c\u8fd8\u539f\u5907\u4efd\u5de5\u5177\u96c6\u3002"}),"\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsxs)(e.p,{children:["\u6ce8\u610f\uff1a\u5bf9\u4e8e\u5927\u578b\u6570\u636e\u96c6\uff08100G\u4ee5\u4e0a\uff09\uff0c\u63a8\u8350\u4f7f\u7528\u5bfc\u51fa\u548c\u5bfc\u5165\u6570\u636e\u5de5\u5177\u96c6\u3002\nInflux \u4f01\u4e1a\u7ea7\u7248\u672c\u5907\u4efd\u6062\u590d\u5b98\u65b9\u6587\u6863\uff1a",(0,d.jsx)(e.a,{href:"https://docs.influxdata.com/enterprise_influxdb/v1.10/administration/backup-and-restore/",children:"Back up and restore | InfluxDB Enterprise 1.10\nDocumentation"})]}),"\n"]}),"\n",(0,d.jsx)(e.h3,{id:"1-\u5907\u4efd",children:"1. \u5907\u4efd"}),"\n",(0,d.jsx)(e.p,{children:"\u5907\u4efd\u662f\u6307\u521b\u5efa\u5b58\u653e\u5728META\u8282\u70b9\u4e0a\u7684\u5143\u6570\u636e\u548cDATA\u8282\u70b9\u4e0a\u7684\u5206\u7247\u6570\u636e\u7684\u526f\u672c\uff0c\u5e76\u5c06\u8be5\u526f\u672c\u5b58\u50a8\u5728\n\u6307\u5b9a\u76ee\u5f55\u4e2d\u3002\u9664\u4e86\u6307\u5b9a\u7684\u6570\u636e\u526f\u672c\uff0c\u4e00\u4e2a\u5b8c\u6574\u7684\u5907\u4efd\u8fd8\u5305\u62ec\u4e00\u4e2aJSON\u683c\u5f0f\u7684\u5907\u4efd\u63cf\u8ff0\u6587\u4ef6\uff0c\u63cf\u8ff0\u5177\n\u4f53\u7684\u5907\u4efd\u5185\u5bb9\u3002\u6240\u6709\u5907\u4efd\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u5305\u542b\u4e00\u4e2aUTC\u65f6\u95f4\u6233\uff0c\u8868\u793a\u521b\u5efa\u5907\u4efd\u7684\u65f6\u95f4\u3002"}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:["META\u8282\u70b9\u7684\u5143\u6570\u636e\u5907\u4efd\uff1a",(0,d.jsx)(e.code,{children:"20221108T034621Z.meta"})]}),"\n",(0,d.jsxs)(e.li,{children:["DATA\u8282\u70b9\u7684\u5206\u7247\u6570\u636e\u5907\u4efd\uff1a",(0,d.jsx)(e.code,{children:"20221108T034621Z.<shard_id>.tar.gz"})]}),"\n",(0,d.jsxs)(e.li,{children:["\u5907\u4efd\u63cf\u8ff0\u6587\u4ef6\uff1a",(0,d.jsx)(e.code,{children:"20221108T034621Z.manifest"})]}),"\n"]}),"\n",(0,d.jsx)(e.p,{children:"\u5907\u4efd\u53ef\u4ee5\u662f\u5b8c\u6574\u5907\u4efd\u6216\u589e\u91cf\u5907\u4efd\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u751f\u6210\u7684\u5907\u4efd\u662f\u589e\u91cf\u5907\u4efd\u3002\u589e\u91cf\u5907\u4efd\u4f1a\u521b\u5efa\u81ea\u4e0a\u6b21\n\u589e\u91cf\u5907\u4efd\u4ee5\u6765\u5df2\u66f4\u6539\u7684\u5143\u6570\u636e\u548c\u5206\u7247\u6570\u636e\u7684\u526f\u672c\u3002\u5982\u679c\u5f53\u524d\u76ee\u5f55\u4e0b\u4e0d\u5b58\u5728\u589e\u91cf\u5907\u4efd\uff0c\u7cfb\u7edf\u5c06\u81ea\u52a8\u505a\u5b8c\n\u6574\u5907\u4efd\u3002"}),"\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u56e0\u4e3a\u8fd8\u539f\u5b8c\u6574\u5907\u4efd\u7684\u547d\u4ee4\u4e0e\u8fd8\u539f\u589e\u91cf\u5907\u4efd\u7684\u547d\u4ee4\u4e0d\u540c\uff0c\u4e3a\u9632\u6b62\u8fd8\u539f\u5907\u4efd\u65f6\u51fa\u9519\uff0c\u5efa\u8bae\u5c06\u5b8c\n\u6574\u5907\u4efd\u548c\u589e\u91cf\u5907\u4efd\u653e\u7f6e\u5728\u4e0d\u540c\u7684\u76ee\u5f55\u4e2d\u3002"}),"\n"]}),"\n",(0,d.jsxs)(e.p,{children:["\u53c2\u8003\u5b98\u65b9\u6587\u6863\u8fde\u63a5\uff1a",(0,d.jsx)(e.a,{href:"https://docs.influxdata.com/influxdb/v1.8/administration/backup_and_restore/#time-based-backups",children:"Back up and restore data in InfluxDB v1.8 | InfluxDB OSS 1.8 Documentation"})]}),"\n",(0,d.jsx)(e.p,{children:"\u5907\u4efd\u547d\u4ee4\u57fa\u672c\u8bed\u6cd5\uff1a"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"influxd backup\n[ -database <db_name> ] # \u6307\u5b9a\u9700\u8981\u5907\u4efd\u7684\u6570\u636e\u5e93\u540d\u79f0\uff0c\u53ef\u9009\uff0c\u82e5\u6ca1\u6709\u6307\u5b9a\uff0c\u5c06\u5907\u4efd\u6240\u6709\u6570\u636e\n\u5e93\n[ -portable ] # \u8868\u793a\u5728\u7ebf\u5907\u4efd\uff0c\u5fc5\u9009\n[ -host <host:port> ] # influxdb\u670d\u52a1\u6240\u5728\u7684\u673a\u5668\uff0c\u9ed8\u8ba4\u4e3a 127.0.0.1:8088\n[ -retention <rp_name> ] | [ -shard <shard_ID> -retention <rp_name> ] # \u5907\u4efd\u7684\u4fdd\u7559\u7b56\u7565\uff0c\u6ce8\u610fshard\u662f\u6302\u5728rp\u4e0b\u7684\uff1b\u6211\u4eec\u9700\u8981\u5907\u4efd\u7684\u5c31\u662fshard\u4e2d\u7684\u6570\u636e\n[ -start <timestamp> [ -end <timestamp> ] | -since <timestamp> ] # \u5907\u4efd\u6307\u5b9a\u65f6\u95f4\u6bb5\u7684\u6570\u636e\n<path-to-backup> # \u5907\u4efd\u6587\u4ef6\u7684\u8f93\u51fa\u5730\u5740\n# \u8865\u5145\n-host: fluxdb\u7ed1\u5b9a\u5730\u5740(\u4ec5\u5f53\u4ece\u8fdc\u7a0bfluxdb\u4e3b\u673a\u521b\u5efa\u5907\u4efd\u65f6\u9700\u8981)\n-database/db:\u6570\u636e\u5e93\u540d\u79f0(\u5982\u679c\u4e0d\u6307\u5b9a\u6570\u636e\u5e93\u540d\u79f0\uff0c\u5219\u5907\u4efd\u6240\u6709\u6570\u636e\u5e93)\n-rp:\u4fdd\u7559\u7b56\u7565\u540d\u79f0(\u5982\u679c\u4e0d\u6307\u5b9a\u4fdd\u7559\u7b56\u7565\uff0c\u5219\u5907\u4efd\u6240\u6709\u4fdd\u7559\u7b56\u7565)\n-shard:\u5206\u7247ID(\u5982\u679c\u4e0d\u6307\u5b9a\u5206\u7247ID\uff0c\u5219\u5907\u4efd\u6240\u6709\u5206\u7247)\u3002\u9700\u8981\u4fdd\u7559\u7b56\u7565\u3002)\n-start:\u8d77\u59cb\u65f6\u95f4(\u5982\u679c\u4e0d\u6307\u5b9a\u8d77\u59cb\u65f6\u95f4\uff0c\u5219\u5907\u4efd\u6240\u6709\u65f6\u95f4\u7684\u6570\u636e\u3002)\n-end/stop:\u505c\u6b62\u65f6\u95f4(\u5982\u679c\u4e0d\u6307\u5b9a\u505c\u6b62\u65f6\u95f4\uff0c\u5219\u5907\u4efd\u5230\u5f53\u524d\u65f6\u95f4)\u3002\n"})}),"\n",(0,d.jsxs)(e.ol,{children:["\n",(0,d.jsxs)(e.li,{children:["\u5907\u4efd\u6240\u6709\u7684\u6570\u636e\u5e93\n\u5c06 ",(0,d.jsx)(e.a,{href:"https://so.csdn.net/so/search?q=influxdb&spm=1001.2101.3001.7020",children:"influxdb"})," \u4e2d\u7684\u6240\u6709\u7684\u6570\u636e\u5e93\u90fd\u5907\u4efd\u5230 /path/to/backup-directory \u76ee\u5f55\u4e0b\uff1a","\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"influxd backup -portable /path/to/backup-directory"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\u4ece\u8fdc\u7a0bInfluxDB\u5b9e\u4f8b\u5907\u4efd\u6240\u6709\u6570\u636e","\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"influxd backup -portable -host 203.0.113.0:8088 /path/to/backup-directory"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\u5907\u4efd\u6307\u5b9a\u6570\u636e\u5e93\n\u5047\u8bbe\u6b64\u65f6 influxdb \u4e2d\u6709\u6570\u636e\u5e93 monitor\uff0c\u5c06\u6570\u636e\u5e93monitor\u4e2d\u7684\u6240\u6709\u6570\u636e\u5b8c\u6574\u5907\u4efd\u5230\u6307\u5b9a\u76ee\u5f55\u4e2d\uff1a","\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"influxd backup -portable -db monitor /path/to/backup-directory"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\u5907\u4efd\u7279\u5b9a\u7684\u65f6\u95f4\u8303\u56f4\n\u5907\u4efd2022-01-01\u52302022-02-01\u5185\u7684\u6570\u636e\uff1a","\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"influxd backup -portable -start 2022-01-01T00:00:00Z -stop 2022-02-01T00:00:00Z /path/to/backup-directory"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\u5907\u4efd\u6307\u5b9a\u65f6\u95f4\u5230\u73b0\u5728\u7684\u6570\u636e","\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"influxd backup -portable -start 2022-01-01T00:00:00Z /path/to/backup-directory"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\u5907\u4efd\u7279\u5b9a\u7684\u4fdd\u7559\u7b56\u7565","\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"influxd backup -portable -db example-db -rp example-retention-policy /path/to/backupdirectory"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\u5907\u4efd\u7279\u5b9a\u7684shard","\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"influxd backup -portable -rp example-retention-policy -shard 123 /path/to/backup-directory"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.p,{children:["\u5982\u4f55\u67e5\u770bshard id \u53c2\u8003\u5b98\u65b9\u6587\u6863\uff1a",(0,d.jsx)(e.a,{href:"https://docs.influxdata.com/influxdb/v1.8/query_language/spec/#show-shards",children:"InfluxQuery Language (InfluxQL) reference | InfluxDB OSS 1.8\nDocumentation"})]}),"\n",(0,d.jsx)(e.h3,{id:"2-\u6062\u590d",children:"2. \u6062\u590d"}),"\n",(0,d.jsx)(e.p,{children:"\u6062\u590d\u547d\u4ee4\u57fa\u672c\u8bed\u6cd5\uff1a"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"influxd restore [ -db <db_name> ] # \u5f85\u6062\u590d\u7684\u6570\u636e\u5e93(\u5907\u4efd\u4e2d\u7684\u6570\u636e\u5e93\u540d)\n-portable | -online\n[ -host <host:port> ] # influxdb \u7684\u670d\u52a1\u5668\n[ -newdb <newdb_name> ] # \u6062\u590d\u5230influxdb\u4e2d\u7684\u6570\u636e\u5e93\u540d\n[ -rp <rp_name> ] # \u5907\u4efd\u4e2d\u7684\u4fdd\u7559\u7b56\u7565\n[ -newrp <newrp_name> ] # \u6062\u590d\u7684\u4fdd\u7559\u7b56\u7565\n[ -shard <shard_ID> ]\n<path-to-backup-files>\n# \u8865\u5145\u8bf4\u660e\n-host: fluxdb\u7ed1\u5b9a\u5730\u5740(\u4ec5\u5728\u5c06\u5907\u4efd\u6062\u590d\u5230\u8fdc\u7a0bfluxdb\u4e3b\u673a\u65f6\u9700\u8981)\n-db:\u6570\u636e\u5e93\u540d\u79f0(\u5982\u679c\u4e0d\u6307\u5b9a\u6570\u636e\u5e93\u540d\u79f0\uff0c\u5219\u6062\u590d\u6240\u6709\u6570\u636e\u5e93)\n-newdb:\u65b0\u7684\u6570\u636e\u5e93\u540d\u79f0(\u5f53\u6062\u590d\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u6570\u636e\u5e93\u65f6\u9700\u8981)\n-rp:\u4fdd\u7559\u7b56\u7565\u540d\u79f0(\u5982\u679c\u4e0d\u6307\u5b9a\u4fdd\u7559\u7b56\u7565\uff0c\u5219\u6062\u590d\u6240\u6709\u4fdd\u7559\u7b56\u7565)\n-newrp:\u65b0\u7684\u4fdd\u7559\u7b56\u7565\u540d\u79f0(\u5728\u6062\u590d\u5df2\u7ecf\u5b58\u5728\u7684\u4fdd\u7559\u7b56\u7565\u65f6\u9700\u8981)\n-shard:\u5206\u7247ID(\u5982\u679c\u4e0d\u6307\u5b9a\u5206\u7247ID\uff0c\u5219\u5907\u4efd\u6240\u6709\u5206\u7247)\u3002\u9700\u8981\u4fdd\u7559\u7b56\u7565\u3002)\n"})}),"\n",(0,d.jsxs)(e.ol,{children:["\n",(0,d.jsxs)(e.li,{children:["\u6062\u590d\u6240\u6709\u6570\u636e\u5e93","\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"influxd restore -portable /path/to/backup-directory"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\u5c06\u6240\u6709\u6570\u636e\u6062\u590d\u5230\u8fdc\u7a0bInfluxDB\u5b9e\u4f8b","\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"influxd restore -portable -host 203.0.113.0:8088 /path/to/backup-directory"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\u6062\u590d\u4e00\u4e2a\u7279\u5b9a\u7684\u6570\u636e\u5e93","\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"influxd restore -portable -db example-db /path/to/backup-directory"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\u4ece\u5df2\u7ecf\u5b58\u5728\u7684\u6570\u636e\u5e93\u4e2d\u6062\u590d\u6570\u636e\n\u5982\u679c\u60f3\u5c06\u5907\u4efd\u6062\u590d\u5230\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684database\u4e2d\u65f6\uff0c\u5e76\u4e0d\u662f\u90a3\u4e48\u7b80\u5355\u7684\uff0c\u8fd9\u91cc\u91c7\u7528\u7684\u4e00\u4e2a\u7b56\u7565\u662f\n\u5148\u5907\u4efd\u5230\u4e00\u4e2a\u4e34\u65f6\u7684db\u4e2d\uff0c\u7136\u540e\u5c06\u4e34\u65f6DB\u4e2d\u7684\u6570\u636e\u5199\u5165\u5df2\u5b58\u5728\u7684db\u4e2d\u3002","\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:'# 1. \u5c06\u5907\u4efd\u6062\u590d\u5230\u4e34\u65f6\u6570\u636e\u5e93example-tmp-db\u4e2d\ninfluxd restore -portable -db example-db -newdb example-tmp-db /path/to/backup-directory\n# 2. \u767b\u5f55\u8fde\u63a5influx\u5ba2\u6237\u7aef\uff0c\u4ece\u4e34\u65f6\u6570\u636e\u5e93\u67e5\u8be2\u6570\u636e\uff0c\u5e76\u5c06\u5176\u5199\u56de\u73b0\u6709\u6570\u636e\u5e93test\u4e2d\nSELECT * INTO "test".autogen.:MEASUREMENT FROM "example-tmp-db".autogen./.*/ GROUP BY *\n# 3. \u5220\u9664\u4e34\u65f6\u6570\u636e\u5e93example-tmp-db\nDROP DATABASE "example-tmp-db"\n'})}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\u6062\u590d\u6307\u5b9a\u7684\u4fdd\u7559\u7b56\u7565","\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"influxd backup -portable -db example-db -rp example-retention-policy /path/to/backupdirectory"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\u4ece\u5df2\u7ecf\u5b58\u5728\u7684\u4fdd\u7559\u7b56\u7565\u4e2d\u6062\u590d\u6570\u636e","\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"influxd restore -portable -db example-db -rp example-rp -newrp example-new-rp /path/to/backup-directory"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\u6062\u590d\u6307\u5b9a\u7684\u5206\u7247","\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"influxd backup -portable -db example-db -rp example-rp -shard 123 /path/to/backup-directory"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(e.h2,{id:"4-\u5e38\u7528\u547d\u4ee4\u884c\u64cd\u4f5c",children:"4. \u5e38\u7528\u547d\u4ee4\u884c\u64cd\u4f5c"}),"\n",(0,d.jsxs)(e.ol,{children:["\n",(0,d.jsx)(e.li,{children:"\u8fde\u63a5influxdb"}),"\n"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"# \u767b\u5f55\ninflux\n# \u767b\u5f55\u65f6\u6307\u5b9aip port\ninflux -host localhost -port 8086 \n\n\n# \u8ba4\u8bc1 \u8f93\u5165\u8d26\u53f7\u5bc6\u7801\nauth\n# \u4e5f\u53ef\u4ee5\u5728\u767b\u5f55\u65f6\u8ba4\u8bc1\ninflux -username name -password pwd\n\n\n# \u8bbe\u7f6e\u65f6\u95f4\u683c\u5f0f\nprecision rfc3339\n# \u4e5f\u53ef\u4ee5\u5728\u767b\u5f55\u65f6\u8bbe\u7f6e\ninflux -precision rfc3339\n\n\n# \u5b8c\u6574\u547d\u4ee4\ninflux -host localhost -port 8086 -username influxdb -password influxdb -precision rfc3339\n"})}),"\n",(0,d.jsxs)(e.ol,{start:"2",children:["\n",(0,d.jsx)(e.li,{children:"\u6570\u636e\u5e93\u64cd\u4f5c"}),"\n"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"# \u663e\u793a\u6240\u6709\u6570\u636e\u5e93\nSHOW DATABASES;\n\n# \u4f7f\u7528\u67d0\u4e2a\u6570\u636e\u5e93\nUSE <database name>;\n\n# \u5220\u9664\u67d0\u4e2a\u6570\u636e\u5e93\nDROP DATABASE <database name>;\n"})}),"\n",(0,d.jsxs)(e.ol,{start:"3",children:["\n",(0,d.jsx)(e.li,{children:"\u6570\u636e\u8868\u64cd\u4f5c"}),"\n"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"# \u663e\u793a\u6240\u6709\u6570\u636e\u8868\nSHOW MEASUREMENTS;\n\n# InfluxDB\u4e2d\u6ca1\u6709\u663e\u5f0f\u7684\u65b0\u5efa\u8868\u7684\u8bed\u53e5\uff0c\u53ea\u80fd\u901a\u8fc7insert\u6570\u636e\u7684\u65b9\u5f0f\u6765\u5efa\u7acb\u65b0\u8868\u3002\nINSERT <measurement name>,tag=tag_value field=field_value timestamp;\n\n# \u5220\u9664\u67d0\u4e2a\u6570\u636e\u8868\nDROP MEASUREMENT <measurement name>;\n"})}),"\n",(0,d.jsxs)(e.ol,{start:"4",children:["\n",(0,d.jsx)(e.li,{children:"\u6570\u636e\u4fdd\u5b58\u7b56\u7565"}),"\n"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:'# \u67e5\u770b\u5f53\u524d\u4fdd\u5b58\u7b56\u7565\nSHOW RETENTION POLICIES ON <database name>;\n\n# \u521b\u5efa\u65b0\u7684\u4fdd\u5b58\u7b56\u7565\n# rp_name\uff1a\u7b56\u7565\u540d\uff1b\n# db_name\uff1a\u5177\u4f53\u7684\u6570\u636e\u5e93\u540d\uff1b\n# 3w\uff1a\u4fdd\u5b583\u5468\uff0c3\u5468\u4e4b\u524d\u7684\u6570\u636e\u5c06\u88ab\u5220\u9664\uff0cinfluxdb\u5177\u6709\u5404\u79cd\u4e8b\u4ef6\u53c2\u6570\uff0c\u6bd4\u5982\uff1ah\uff08\u5c0f\u65f6\uff09\uff0cd\uff08\u5929\uff09\uff0cw\uff08\u661f\u671f\uff09\uff1b\n# replication 1\uff1a\u526f\u672c\u4e2a\u6570\uff0c\u4e00\u822c\u4e3a1\u5c31\u53ef\u4ee5\u4e86\uff1b\n# default\uff1a\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u7b56\u7565\nCREATE RETENTION POLICY "rp_name" ON "db_name" duration 3w REPLICATION 1 default;\n\n# \u4fee\u6539\u4fdd\u5b58\u7b56\u7565\nALTER RETENTION POLICY "rp_name" ON "db_name" DURATION 30d default;\n\n# \u5220\u9664\u4fdd\u5b58\u7b56\u7565\nDROP RETENTION POLICY "rp_name" ON "db_name";\n'})}),"\n",(0,d.jsxs)(e.ol,{start:"5",children:["\n",(0,d.jsx)(e.li,{children:"\u6570\u636e\u67e5\u8be2\u64cd\u4f5c"}),"\n"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"# \u666e\u901a\u67e5\u8be2\nSELECT * FROM <measurement name>;\n\n# \u6761\u4ef6\u67e5\u8be2 5\u5206\u949f\u5185\nSELECT * FROM <measurement name> WHERE time > now() - 5m tz('Asia/Shanghai');\n\n# \u5206\u9875\u67e5\u8be2 \u901a\u8fc7 LIMIT \u548c OFFSET \u914d\u5408\u53ef\u4ee5\u5b9e\u73b0\u5206\u9875\nSELECT * FROM <measurement name> LIMIT 5 OFFSET 5 tz('Asia/Shanghai');\n\n# \u6a21\u7cca\u67e5\u8be2\n# starts with\nSELECT field FROM <measurement name> WHERE field=~/^\u7ed9\u5b9a\u5b57\u6bb5/ tz('Asia/Shanghai');\n\n# ends with\nSELECT field FROM <measurement name> WHERE field=~/\u7ed9\u5b9a\u5b57\u6bb5$/ tz('Asia/Shanghai');\n\n# contains\nSELECT field FROM <measurement name> WHERE field=~/\u7ed9\u5b9a\u5b57\u6bb5/ tz('Asia/Shanghai');\n"})})]})}function x(n={}){const{wrapper:e}={...(0,i.ah)(),...n.components};return e?(0,d.jsx)(e,{...n,children:(0,d.jsx)(o,{...n})}):o(n)}},11151:(n,e,l)=>{l.d(e,{ah:()=>s});var d=l(67294);const i=d.createContext({});function s(n){const e=d.useContext(i);return d.useMemo((()=>"function"==typeof n?n(e):{...e,...n}),[e,n])}}}]);