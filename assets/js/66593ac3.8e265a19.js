"use strict";(self.webpackChunklight_docusaurus=self.webpackChunklight_docusaurus||[]).push([[90587],{51831:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>r,default:()=>m,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var i=t(74848),a=t(28453);const s={},r=void 0,l={id:"zh-cn/spring-authorization-server/SAS-Saml2-Login-Grant",title:"SAS-Saml2-Login-Grant",description:"- Saml Tool",source:"@site/docs/zh-cn/spring-authorization-server/25-SAS-Saml2-Login-Grant.md",sourceDirName:"zh-cn/spring-authorization-server",slug:"/zh-cn/spring-authorization-server/SAS-Saml2-Login-Grant",permalink:"/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Saml2-Login-Grant",draft:!1,unlisted:!1,editUrl:"https://github.com/lorchr/light-docusaurus/tree/main/docs/zh-cn/spring-authorization-server/25-SAS-Saml2-Login-Grant.md",tags:[],version:"current",sidebarPosition:25,frontMatter:{},sidebar:"troch",previous:{title:"LDAP-Grant-Type",permalink:"/light-docusaurus/docs/zh-cn/spring-authorization-server/LDAP-Grant-Type"},next:{title:"SAS-Build-GraalVM-Native-Image",permalink:"/light-docusaurus/docs/zh-cn/spring-authorization-server/SAS-Build-GraalVM-Native-Image"}},o={},c=[{value:"\u4e00\u3001\u524d\u8a00",id:"\u4e00\u524d\u8a00",level:2},{value:"\u4e8c\u3001\u5206\u6790",id:"\u4e8c\u5206\u6790",level:2},{value:"\u4e09\u3001\u51c6\u5907",id:"\u4e09\u51c6\u5907",level:2},{value:"1. \u57df\u540d\u51c6\u5907",id:"1-\u57df\u540d\u51c6\u5907",level:3},{value:"2. \u90e8\u7f72\u4e00\u4e2aSAML2 Identity Provider (IdP)",id:"2-\u90e8\u7f72\u4e00\u4e2asaml2-identity-provider-idp",level:3},{value:"3. \u751f\u6210\u5ba2\u6237\u7aef\u8bc1\u4e66\u79d8\u94a5",id:"3-\u751f\u6210\u5ba2\u6237\u7aef\u8bc1\u4e66\u79d8\u94a5",level:3},{value:"\u4e09\u3001\u7f16\u7801",id:"\u4e09\u7f16\u7801",level:2},{value:"1. \u5f15\u5165\u4f9d\u8d56",id:"1-\u5f15\u5165\u4f9d\u8d56",level:3},{value:"2. \u914d\u7f6e application.yaml",id:"2-\u914d\u7f6e-applicationyaml",level:3},{value:"3. SamlAuthenticationConfig",id:"3-samlauthenticationconfig",level:3},{value:"4. SamlLoginAuthenticationProvider",id:"4-samlloginauthenticationprovider",level:3},{value:"5. SamlParameterNames",id:"5-samlparameternames",level:3},{value:"6. CORS\u914d\u7f6e",id:"6-cors\u914d\u7f6e",level:3},{value:"7. \u767b\u5f55\u9875\u6dfb\u52a0SAML\u767b\u5f55",id:"7-\u767b\u5f55\u9875\u6dfb\u52a0saml\u767b\u5f55",level:3},{value:"8. \u9996\u9875\u6d4b\u8bd5\u63a5\u53e3",id:"8-\u9996\u9875\u6d4b\u8bd5\u63a5\u53e3",level:3},{value:"9. saml\u9996\u9875",id:"9-saml\u9996\u9875",level:3},{value:"\u56db\u3001\u6d4b\u8bd5",id:"\u56db\u6d4b\u8bd5",level:2},{value:"1. Keycloak\u767b\u5f55",id:"1-keycloak\u767b\u5f55",level:3},{value:"2. Keycloak\u767b\u51fa",id:"2-keycloak\u767b\u51fa",level:3}];function d(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://www.samltool.com/",children:"Saml Tool"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://jwt.io/",children:"JWT Tool By Okta"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://samltool.io/",children:"Saml Tool By Okta"})}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"SpringBoot\u96c6\u6210\u6587\u6863"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/spring-projects/spring-security",children:"Spring Security Github"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/spring-projects/spring-security-samples",children:"Spring Security Samples Github"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/spring-projects/spring-security-samples/tree/main/servlet/spring-boot/java/saml2",children:"Spring Security Samples SAML2 Github"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://docs.spring.io/spring-security",children:"Spring Security Document"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://docs.spring.io/spring-security/reference/servlet/saml2/login/overview.html",children:"Spring Security Document SAML2"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/spring-projects/spring-security/wiki/SAML-2.0-Migration-Guide",children:"SAML-2.0-Migration-Guide"})}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6587\u7ae0"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://docs.keeper.io/sso-connect-cloud/identity-provider-setup/ad-fs-keeper",children:"How to configure Keeper SSO Connect Cloud with Microsoft AD FS for seamless and secure SAML 2.0 authentication"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://learn.microsoft.com/zh-cn/windows-server/identity/ad-fs/ad-fs-overview",children:"Active Directory \u8054\u5408\u8eab\u4efd\u9a8c\u8bc1\u670d\u52a1\u6982\u8ff0"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://cloud.tencent.com/developer/article/2367225",children:"\u5982\u4f55\u5c06Spring Security \u96c6\u6210 SAML2 ADFS \u5b9e\u73b0SSO\u5355\u70b9\u767b\u5f55?"})}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"SAML\u8ba4\u8bc1 Demo"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/spring-projects/spring-security-samples/tree/main/servlet/spring-boot/java/saml2/login",children:"Spring Security SAML Login Logout"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/jzheaux/spring-security-saml-migrate/tree/main/login-logout",children:"Spring Security SAML Migrate"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/Kahen/spring-security-saml2-azure-ad-example",children:"spring-security-saml2-azure-ad-example"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://gitee.com/pearl-organization/study-spring-security-demo",children:"https://download.csdn.net/blog/column/12259144/131198433"})}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u4e00\u4e9b\u53ef\u672c\u5730\u90e8\u7f72\u7684Idp\u670d\u52a1"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://www.keycloak.org/docs/latest/securing_apps/index.html#using-saml-to-secure-applications-and-services",children:"Keyclock SAML2"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://seamlessaccess.atlassian.net/wiki/spaces/DOCUMENTAT/pages/84738190/Integrating+the+Login+Button+with+your+SAML+SP",children:"SeamlessAccess SAML2"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://shibboleth.atlassian.net/wiki/spaces/IDP5/overview",children:"Shibboleth Idp"})}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Okta"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://developer.okta.com/docs/guides/build-sso-integration/saml2/main/",children:"Okta"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://developer.okta.com/code/java/spring_security_saml/",children:"Okta Spring Security SAML"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://blog.csdn.net/qq_43169127/article/details/127772766",children:"Springboot\u3001React\u96c6\u6210Okta SAML2\u5355\u70b9\u767b\u5f55"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://developer.okta.com/blog/2022/08/05/spring-boot-saml",children:"Get Started with Spring Boot and SAML"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/oktadev/okta-spring-boot-saml-example",children:"Okta Spring Boot SAML Example Github"})}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u4e00\u524d\u8a00",children:"\u4e00\u3001\u524d\u8a00"}),"\n",(0,i.jsx)(e.h2,{id:"\u4e8c\u5206\u6790",children:"\u4e8c\u3001\u5206\u6790"}),"\n",(0,i.jsx)(e.h2,{id:"\u4e09\u51c6\u5907",children:"\u4e09\u3001\u51c6\u5907"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://www.keycloak.org/",children:"keycloak\u5b98\u7f51"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://simplesamlphp.org/",children:"SimpleSAMLphp"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://developer.okta.com/docs/guides/build-sso-integration/saml2/main/",children:"Okta SAML 2.0 IDP"})}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"1-\u57df\u540d\u51c6\u5907",children:"1. \u57df\u540d\u51c6\u5907"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u6a21\u5757"}),(0,i.jsx)(e.th,{children:"\u57df\u540d"}),(0,i.jsx)(e.th,{children:"IP\u5730\u5740"}),(0,i.jsx)(e.th,{children:"\u5907\u6ce8"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"IDP"}),(0,i.jsx)(e.td,{children:"idp.light.local"}),(0,i.jsx)(e.td,{children:"172.18.0.99"}),(0,i.jsx)(e.td,{children:"Docker\u5bb9\u5668"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"SP"}),(0,i.jsx)(e.td,{children:"sp.light.local"}),(0,i.jsx)(e.td,{children:"192.168.137.1"}),(0,i.jsx)(e.td,{children:"\u7269\u7406\u673a"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:"\u9700\u8981\u5c06\u6b64Hosts\u914d\u7f6e\u5230IDP\u548cSP\u670d\u52a1\u4e0a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"cat >> /etc/hosts << EOF\n\n172.18.0.99     idp.light.local\n192.168.137.1   sp.light.local\nEOF\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u56e0\u4e3aDocker\u5bb9\u5668\u7684IP\u6620\u5c04\u5230\u4e86\u7269\u7406\u673a\u4e0a\uff0c\u6240\u4ee5\u7269\u7406\u673a\u7684Hosts\u4e2dIP\u53ef\u4ee5\u90fd\u8bbe\u7f6e\u4e3a ",(0,i.jsx)(e.code,{children:"127.0.0.1"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"\n172.18.0.99     idp.light.local\n192.168.137.1   sp.light.local\n"})}),"\n",(0,i.jsx)(e.h3,{id:"2-\u90e8\u7f72\u4e00\u4e2asaml2-identity-provider-idp",children:"2. \u90e8\u7f72\u4e00\u4e2aSAML2 Identity Provider (IdP)"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://quay.io/repository/keycloak/keycloak",children:"KeyCloak Container"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://www.keycloak.org/server/containers",children:"KeyCloak Container\u6587\u6863"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://www.keycloak.org/server/hostname",children:"KeyCloak \u4fee\u6539\u7aef\u53e3"})}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"docker run --detach \\\n  --publish 8880:8080 \\\n  --env KEYCLOAK_ADMIN=admin \\\n  --env KEYCLOAK_ADMIN_PASSWORD=admin \\\n  --env KC_HOSTNAME_PORT=8880 \\\n  --ip 172.18.0.99 \\\n  --hostname idp.light.local \\\n  --add-host sp.light.local:192.168.137.1 \\\n  --network dev \\\n  --restart=no \\\n  --name keycloak \\\n  quay.io/keycloak/keycloak:24.0 start-dev\n\ndocker exec -it -u root keycloak /bin/bash\n\n# \u67e5\u770b\u57df\u540d\u89e3\u6790\ncat /etc/hosts\n# idp\u7684ip\u4e3a\u5bb9\u5668\u865a\u62dfip\uff0c\u7528\u4e8e\u81ea\u8eab\u8bc6\u522b\n# sp\u7684ip\u4e3a\u7269\u7406\u673a\u7684ip\uff0c\u7528\u4e8e\u8bbf\u95eesp\n172.18.0.99     idp.light.local\n192.168.137.1   sp.light.local\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"http://idp.light.local:8880",children:"Dashboard"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"admin / admin"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u5173\u4e8eKeycloak\u7684\u4f7f\u7528\u914d\u7f6e\u89c1",(0,i.jsx)(e.a,{href:"/light-docusaurus/docs/zh-cn/spring-security/Spring-Security-Saml-With-Keycloak",children:"Spring-Security-Saml-With-Keycloak"})]}),"\n",(0,i.jsx)(e.h3,{id:"3-\u751f\u6210\u5ba2\u6237\u7aef\u8bc1\u4e66\u79d8\u94a5",children:"3. \u751f\u6210\u5ba2\u6237\u7aef\u8bc1\u4e66\u79d8\u94a5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"openssl req -newkey rsa:2048 -nodes -keyout sp-private.key -x509 -days 365 -out sp-certificate.crt\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u751f\u6210\u5907\u7528"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u5c06\u79c1\u94a5\u548c\u8bc1\u4e66\u590d\u5236\u5230SpringBoot\u9879\u76ee\u4e2d\uff0c\u5728SP\u6536\u53d1IDP\u4fe1\u606f\u65f6\u52a0\u89e3\u5bc6\u4f7f\u7528"}),"\n",(0,i.jsx)(e.li,{children:"\u5c06\u8bc1\u4e66\u5bfc\u5165\u5230SAML IDP\u670d\u52a1\u5668\u4e2d"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u4e09\u7f16\u7801",children:"\u4e09\u3001\u7f16\u7801"}),"\n",(0,i.jsx)(e.h3,{id:"1-\u5f15\u5165\u4f9d\u8d56",children:"1. \u5f15\u5165\u4f9d\u8d56"}),"\n",(0,i.jsxs)(e.p,{children:["\u6dfb\u52a0OpenSAML\u4ed3\u5e93\u5730\u5740\uff0c\u539f\u56e0\u89c1",(0,i.jsx)(e.a,{href:"https://shibboleth.atlassian.net/wiki/spaces/DEV/pages/1123844333/Use+of+Maven+Central",children:"Why Shibboleth DONOT publish jar to Maven Central"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<repository>\n    <id>shibboleth-repos</id>\n    <name>Shibboleth Repository</name>\n    <url>https://build.shibboleth.net/maven/releases/</url>\n</repository>\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6dfb\u52a0SAML2\u96c6\u6210\u4f9d\u8d56"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.security</groupId>\n    <artifactId>spring-security-saml2-service-provider</artifactId>\n</dependency>\n"})}),"\n",(0,i.jsx)(e.h3,{id:"2-\u914d\u7f6e-applicationyaml",children:"2. \u914d\u7f6e application.yaml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:'spring:\n  security:\n    saml2:\n      relyingparty:\n        registration:\n          # \u4f9d\u8d56\u65b9\u7684\u5b9e\u4f53ID\uff0c\u4efb\u610f\u7684\u503c\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u5b83\u6765\u533a\u5206\u4e0d\u540c\u7684\u6ce8\u518c\n          # SP\u5143\u6570\u636e\uff1ahttp://sp.light.local:8080/saml2/service-provider-metadata/keycloak\n          keycloak:\n            # entity-id \u9700\u8981\u548ckeycloak\u7684client_id\u4fdd\u6301\u4e00\u81f4\uff0c\u5426\u5219\u4f1a\u8ba4\u8bc1\u5931\u8d25\n            # entity-id: "{baseUrl}"\n            entity-id: "saml_client"\n            # \u7528\u4e8e\u6784\u5efa\u7b7e\u540d\u548c\u89e3\u5bc6\u7684 Saml2X509Credential\n            signing:\n              credentials:\n                - private-key-location: classpath:credentials/rp-private.key\n                  # \u8bc1\u4e66\u6587\u4ef6\u9700\u8981\u5bfc\u5165\u5230Client\u4e2d\n                  certificate-location: classpath:credentials/rp-certificate.crt\n            acs:\n              # \u767b\u5f55\u7684\u56de\u8c03\u5730\u5740\uff0c\u5373\u5ba2\u6237\u7aef\u7684 Master SAML Processing URL\n              location: "{baseUrl}/login/saml2/sso/{registrationId}"\n            # \u767b\u51fa\u914d\u7f6e\n            singlelogout:\n              binding: POST\n              # \u9000\u51fa\u767b\u5f55\u7684\u56de\u8c03\u5730\u5740 Valid post logout redirect URIs\n              url: "{baseUrl}/logout/saml2/slo"\n              responseUrl: "{baseUrl}/logout/saml2/slo"\n            assertingparty:\n              entity-id: http://idp.light.local:8880/realms/Test\n              # IDP\u7684 \u5143\u6570\u636e\u8bbf\u95ee\u5730\u5740\n              metadata-uri: http://idp.light.local:8880/realms/Test/protocol/saml/descriptor\n              singlesignon:\n                # \u767b\u5f55\u8ba4\u8bc1\u7684\u5730\u5740\uff0c\u4ece\u5143\u6570\u636e\u4e2d\u83b7\u53d6\n                url: http://idp.light.local:8880/auth/realms/Test/protocol/saml\n                sign-request: false\n              # \u6b64\u8bc1\u4e66\u914d\u7f6e\u53ef\u4ee5\u4e0d\u8981\uff0c\u5143\u6570\u636e\u4e2d\u6709\u8bc1\u4e66\u4fe1\u606f\n              verification:\n                credentials:\n                  # IDP \u7684\u8bc1\u4e66\uff0c\u4ece\u5143\u6570\u636e\u4e2d\u83b7\u53d6\n                  - certificate-location: classpath:credentials/keycloak/keycloak.crt\n\n'})}),"\n",(0,i.jsx)(e.h3,{id:"3-samlauthenticationconfig",children:"3. SamlAuthenticationConfig"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'package com.light.sas.authorization.saml2;\n\nimport jakarta.annotation.Resource;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.boot.autoconfigure.security.saml2.Saml2RelyingPartyProperties;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.core.convert.converter.Converter;\nimport org.springframework.security.authentication.AuthenticationProvider;\nimport org.springframework.security.authentication.ProviderManager;\nimport org.springframework.security.config.Customizer;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.core.GrantedAuthority;\nimport org.springframework.security.core.authority.SimpleGrantedAuthority;\nimport org.springframework.security.saml2.core.Saml2X509Credential;\nimport org.springframework.security.saml2.provider.service.authentication.OpenSaml4AuthenticationProvider;\nimport org.springframework.security.saml2.provider.service.authentication.Saml2AuthenticatedPrincipal;\nimport org.springframework.security.saml2.provider.service.authentication.Saml2Authentication;\nimport org.springframework.security.saml2.provider.service.registration.InMemoryRelyingPartyRegistrationRepository;\nimport org.springframework.security.saml2.provider.service.registration.RelyingPartyRegistration;\nimport org.springframework.security.saml2.provider.service.registration.RelyingPartyRegistrations;\nimport org.springframework.security.web.SecurityFilterChain;\n\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.security.cert.CertificateException;\nimport java.security.cert.CertificateFactory;\nimport java.security.cert.X509Certificate;\nimport java.security.interfaces.RSAPrivateKey;\nimport java.util.ArrayList;\nimport java.util.HashSet;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Set;\n\n@Configuration\npublic class SamlAuthenticationConfig {\n\n    @Resource\n    private ProviderManager authenticationManager;\n\n    @Resource\n    private OpenSaml4AuthenticationProvider openSaml4AuthenticationProvider;\n\n    @Bean\n    public SecurityFilterChain samlSecurityFilterChain(HttpSecurity http) throws Exception {\n        List<AuthenticationProvider> providers = authenticationManager.getProviders();\n        providers.add(new SamlLoginAuthenticationProvider(openSaml4AuthenticationProvider));\n\n        // SAML2\n        http\n                .saml2Login((saml2) ->\n                        saml2.loginPage("/saml2/login")\n                                .loginProcessingUrl("/login/saml2/sso/{registrationId}")\n                                .authenticationManager(authenticationManager)\n                )\n                .saml2Logout(Customizer.withDefaults())\n                .saml2Metadata(Customizer.withDefaults());\n\n        return http.build();\n    }\n\n    //@Bean\n    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n        // @formatter:off\n        http\n                .authorizeHttpRequests((authorize) -> authorize\n                        .requestMatchers("/error").permitAll()\n                        .anyRequest().authenticated()\n                )\n                // \u81ea\u5b9a\u4e49URL\u793a\u4f8b\n                // .saml2Login((saml2) -> saml2.loginProcessingUrl("/saml/SSO"))\n                // .saml2Logout((saml2) -> saml2.logoutRequest((request) -> request.logoutUrl("/saml/logout")))\n                // .saml2Logout((saml2) -> saml2.logoutResponse((response) -> response.logoutUrl("/saml/SingleLogout")))\n                // .saml2Metadata((saml2) -> saml2.metadataUrl("/saml/metadata"))\n                // \u4f7f\u7528\u9ed8\u8ba4\u7684URL\u793a\u4f8b\n                // /login/saml2/sso/{registrationId}\n                .saml2Login(Customizer.withDefaults())\n                // /logout/saml2/slo\n                .saml2Logout(Customizer.withDefaults())\n                // /saml2/service-provider-metadata/{registrationId}\n                .saml2Metadata(Customizer.withDefaults());\n        // @formatter:on\n        return http.build();\n    }\n\n    @Bean\n    public OpenSaml4AuthenticationProvider openSaml4AuthenticationProvider() {\n        OpenSaml4AuthenticationProvider authenticationProvider = new OpenSaml4AuthenticationProvider();\n        authenticationProvider.setResponseAuthenticationConverter(groupsConverter());\n\n        return authenticationProvider;\n    }\n\n    @Bean\n    public InMemoryRelyingPartyRegistrationRepository repositories(Saml2RelyingPartyProperties properties,\n              @Value("classpath:credentials/rp-private.key") RSAPrivateKey key,\n              @Value("classpath:credentials/rp-certificate.crt") File cert) {\n        List<RelyingPartyRegistration> registrationList = new ArrayList<>();\n\n        Saml2X509Credential credential = Saml2X509Credential.signing(key, x509Certificate(cert));\n\n        Map<String, Saml2RelyingPartyProperties.Registration> registrationMap = properties.getRegistration();\n        for (Map.Entry<String, Saml2RelyingPartyProperties.Registration> entry : registrationMap.entrySet()) {\n            String registrationId = entry.getKey();\n            Saml2RelyingPartyProperties.Registration registration = entry.getValue();\n\n            List<RelyingPartyRegistration> registrations = RelyingPartyRegistrations\n                    .collectionFromMetadataLocation(registration.getAssertingparty().getMetadataUri())\n                    .stream().map((builder) -> builder.registrationId(registrationId)\n                            .entityId(registration.getEntityId())\n                            .assertionConsumerServiceLocation(registration.getAcs().getLocation())\n                            .singleLogoutServiceLocation(registration.getSinglelogout().getUrl())\n                            .singleLogoutServiceResponseLocation(registration.getSinglelogout().getResponseUrl())\n                            .signingX509Credentials((credentials) -> credentials.add(credential)).build()\n                    ).toList();\n\n            registrationList.addAll(registrations);\n        }\n        return new InMemoryRelyingPartyRegistrationRepository(registrationList);\n    }\n\n    private Converter<OpenSaml4AuthenticationProvider.ResponseToken, Saml2Authentication> groupsConverter() {\n\n        Converter<OpenSaml4AuthenticationProvider.ResponseToken, Saml2Authentication> delegate =\n                OpenSaml4AuthenticationProvider.createDefaultResponseAuthenticationConverter();\n\n        return (responseToken) -> {\n            Saml2Authentication authentication = delegate.convert(responseToken);\n            Saml2AuthenticatedPrincipal principal = (Saml2AuthenticatedPrincipal) authentication.getPrincipal();\n            List<String> groups = principal.getAttribute("groups");\n            Set<GrantedAuthority> authorities = new HashSet<>();\n            if (groups != null) {\n                groups.stream().map(SimpleGrantedAuthority::new).forEach(authorities::add);\n            } else {\n                authorities.addAll(authentication.getAuthorities());\n            }\n            return new Saml2Authentication(principal, authentication.getSaml2Response(), authorities);\n        };\n    }\n\n    public X509Certificate x509Certificate(File location) {\n        try (InputStream source = new FileInputStream(location)) {\n            return (X509Certificate) CertificateFactory.getInstance("X.509").generateCertificate(source);\n        } catch (CertificateException | IOException ex) {\n            throw new IllegalArgumentException(ex);\n        }\n    }\n}\n\n'})}),"\n",(0,i.jsx)(e.h3,{id:"4-samlloginauthenticationprovider",children:"4. SamlLoginAuthenticationProvider"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'package com.light.sas.authorization.saml2;\n\nimport cn.hutool.core.util.ArrayUtil;\nimport com.light.sas.constant.SamlParameterNames;\nimport com.light.sas.constant.SecurityConstants;\nimport jakarta.servlet.http.Cookie;\nimport jakarta.servlet.http.HttpServletRequest;\nimport org.springframework.security.authentication.AuthenticationProvider;\nimport org.springframework.security.core.Authentication;\nimport org.springframework.security.core.AuthenticationException;\nimport org.springframework.security.saml2.provider.service.authentication.DefaultSaml2AuthenticatedPrincipal;\nimport org.springframework.security.saml2.provider.service.authentication.OpenSaml4AuthenticationProvider;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.context.request.RequestContextHolder;\nimport org.springframework.web.context.request.ServletRequestAttributes;\n\nimport java.util.Arrays;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Objects;\n\n/**\n * SAML\u767b\u5f55\u8ba4\u8bc1\u63d0\u4f9b\u8005\n * @see OpenSaml4AuthenticationProvider\n */\npublic class SamlLoginAuthenticationProvider implements AuthenticationProvider {\n\n    private final OpenSaml4AuthenticationProvider delegate;\n\n    public SamlLoginAuthenticationProvider(OpenSaml4AuthenticationProvider delegate) {\n        this.delegate = delegate;\n    }\n\n    @Override\n    public boolean supports(Class<?> authentication) {\n        String loginType = getLoginType(SecurityConstants.LOGIN_TYPE_NAME);\n        return delegate.supports(authentication) || SamlParameterNames.THIRD_LOGIN_SAML.equalsIgnoreCase(loginType);\n    }\n\n    @Override\n    public Authentication authenticate(Authentication authentication) throws AuthenticationException {\n        Authentication authenticate = delegate.authenticate(authentication);\n\n        if (Objects.nonNull(authenticate) && authenticate.isAuthenticated()) {\n            syncSamlUser(authenticate.getPrincipal());\n        }\n        return authenticate;\n    }\n\n    /**\n     * \u5c06SAML\u7528\u6237\u540c\u6b65\u5230\u7cfb\u7edf\n     *\n     * @param principal\n     */\n    public void syncSamlUser(Object principal) {\n        Map<String, Object> userInfo = new HashMap<>();\n        if (principal instanceof DefaultSaml2AuthenticatedPrincipal saml2Principal) {\n            String name = saml2Principal.getName();\n            Map<String, List<Object>> attributes = saml2Principal.getAttributes();\n            List<String> sessionIndexes = saml2Principal.getSessionIndexes();\n            String relyingPartyRegistrationId = saml2Principal.getRelyingPartyRegistrationId();\n\n            userInfo.put(SecurityConstants.LOGIN_TYPE_NAME, SamlParameterNames.THIRD_LOGIN_SAML);\n\n            userInfo.put(SamlParameterNames.NAME, name);\n            userInfo.put(SamlParameterNames.REGISTRATION_ID, relyingPartyRegistrationId);\n            userInfo.putAll(attributes);\n        }\n        // TODO \u4fdd\u5b58\u5230\u6570\u636e\u5e93\n        System.out.println("\u540c\u6b65\u7528\u6237\u4fe1\u606f\uff1a" + userInfo);\n    }\n\n    /**\n     * \u4eceQuery\u53c2\u6570\uff0cHeader Cookie\u4e2d\u4f9d\u6b21\u8bfb\u53d6\u8bf7\u6c42\u7c7b\u578b\n     *\n     * @param name \u53c2\u6570\u540d\u79f0\n     * @return \u53c2\u6570\u503c\n     */\n    public String getLoginType(String name) {\n        ServletRequestAttributes requestAttributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();\n        HttpServletRequest request = requestAttributes.getRequest();\n        // \u4ece\u53c2\u6570\u8bfb\u53d6\n        String value = request.getParameter(name);\n        if (!StringUtils.hasText(value)) {\n            // \u4eceHeader\u8bfb\u53d6\n            value = request.getHeader(name);\n        }\n        Cookie[] cookies = request.getCookies();\n        if (!StringUtils.hasText(value) && ArrayUtil.isNotEmpty(cookies)) {\n            // \u4eceCookie\u8bfb\u53d6\n            value = Arrays.stream(cookies)\n                    .filter(cookie -> cookie.getName().equals(name))\n                    .findFirst().map(Cookie::getName).orElse(null);\n        }\n        return value;\n    }\n\n}\n\n'})}),"\n",(0,i.jsx)(e.h3,{id:"5-samlparameternames",children:"5. SamlParameterNames"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'package com.light.sas.constant;\n\n/**\n * Saml\u8ba4\u8bc1\u76f8\u5173\u5e38\u91cf\u53c2\u6570\n */\npublic class SamlParameterNames {\n\n    /**\n     * \u4e09\u65b9\u767b\u5f55\u7c7b\u578b\u2014\u2014Saml\n     */\n    public static final String THIRD_LOGIN_SAML = "saml";\n\n    /**\n     * \u81ea\u5b9a\u4e49 grant type \u2014\u2014 Saml\n     */\n    public static final String GRANT_TYPE_LDAP = "urn:ietf:params:oauth:grant-type:saml";\n\n    public static final String NAME = "name";\n    public static final String REGISTRATION_ID = "registrationId";\n\n}\n\n'})}),"\n",(0,i.jsx)(e.h3,{id:"6-cors\u914d\u7f6e",children:"6. CORS\u914d\u7f6e"}),"\n",(0,i.jsxs)(e.p,{children:["Keycloak \u8ba4\u8bc1\u54cd\u5e94\u5934\u4e2d ",(0,i.jsx)(e.code,{children:"Origin: null"})," \uff0c\u9700\u8981\u5728\u8de8\u57df\u914d\u7f6e\u4e2d\u5141\u8bb8\u8fd9\u4e2aOrigin\uff0c\u5426\u5219\u4f1a\u51fa\u73b0 ",(0,i.jsx)(e.code,{children:"403 Forbidden Invalid CORS Request"})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'package com.light.sas.config;\n\nimport com.light.sas.authorization.baisc.BasicAuthorizationRequestResolver;\nimport com.light.sas.authorization.baisc.adapter.AuthorizationRequestCustomizerAdapter;\nimport com.light.sas.authorization.baisc.adapter.OAuth2AccessTokenResponseClientAdapter;\nimport com.light.sas.authorization.baisc.adapter.OAuth2UserRequestEntityConverterAdapter;\nimport com.light.sas.authorization.baisc.delegator.AuthorizationRequestCustomizerDelegator;\nimport com.light.sas.authorization.baisc.delegator.OAuth2AccessTokenResponseClientDelegator;\nimport com.light.sas.authorization.baisc.delegator.OAuth2UserRequestEntityConverterDelegator;\nimport org.springframework.boot.context.properties.EnableConfigurationProperties;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.oauth2.client.registration.ClientRegistrationRepository;\nimport org.springframework.security.oauth2.client.web.DefaultOAuth2AuthorizationRequestResolver;\nimport org.springframework.security.oauth2.client.web.OAuth2AuthorizationRequestRedirectFilter;\nimport org.springframework.web.cors.CorsConfiguration;\nimport org.springframework.web.cors.UrlBasedCorsConfigurationSource;\nimport org.springframework.web.filter.CorsFilter;\n\nimport java.util.List;\n\n/**\n * \u5c06bean\u6ce8\u5165\u81f3ioc\u7684\u914d\u7f6e\u7c7b\n */\n@Configuration\n@EnableConfigurationProperties\npublic class BeanConfig {\n\n    /**\n     * \u8de8\u57df\u8fc7\u6ee4\u5668\u914d\u7f6e\n     *\n     * @return CorsFilter\n     */\n    @Bean\n    public CorsFilter corsFilter() {\n\n        // \u521d\u59cb\u5316cors\u914d\u7f6e\u5bf9\u8c61\n        CorsConfiguration configuration = new CorsConfiguration();\n\n        // \u8bbe\u7f6e\u5141\u8bb8\u8de8\u57df\u7684\u57df\u540d,\u5982\u679c\u5141\u8bb8\u643a\u5e26cookie\u7684\u8bdd,\u8def\u5f84\u5c31\u4e0d\u80fd\u5199*\u53f7, *\u8868\u793a\u6240\u6709\u7684\u57df\u540d\u90fd\u53ef\u4ee5\u8de8\u57df\u8bbf\u95ee\n        configuration.addAllowedOrigin("http://127.0.0.1:5173");\n        configuration.addAllowedOrigin("http://192.168.3.49:5173");\n        configuration.addAllowedOrigin("null");\n        // \u8bbe\u7f6e\u8de8\u57df\u8bbf\u95ee\u53ef\u4ee5\u643a\u5e26cookie\n        configuration.setAllowCredentials(true);\n        // \u5141\u8bb8\u6240\u6709\u7684\u8bf7\u6c42\u65b9\u6cd5 ==> GET POST PUT Delete\n        configuration.addAllowedMethod("*");\n        // \u5141\u8bb8\u643a\u5e26\u4efb\u4f55\u5934\u4fe1\u606f\n        configuration.addAllowedHeader("*");\n\n        // \u521d\u59cb\u5316cors\u914d\u7f6e\u6e90\u5bf9\u8c61\n        UrlBasedCorsConfigurationSource configurationSource = new UrlBasedCorsConfigurationSource();\n\n        // \u7ed9\u914d\u7f6e\u6e90\u5bf9\u8c61\u8bbe\u7f6e\u8fc7\u6ee4\u7684\u53c2\u6570\n        // \u53c2\u6570\u4e00: \u8fc7\u6ee4\u7684\u8def\u5f84 == > \u6240\u6709\u7684\u8def\u5f84\u90fd\u8981\u6c42\u6821\u9a8c\u662f\u5426\u8de8\u57df\n        // \u53c2\u6570\u4e8c: \u914d\u7f6e\u7c7b\n        configurationSource.registerCorsConfiguration("/**", configuration);\n\n        // \u8fd4\u56de\u914d\u7f6e\u597d\u7684\u8fc7\u6ee4\u5668\n        return new CorsFilter(configurationSource);\n    }\n\n    /**\n     * \u8ba4\u8bc1\u8bf7\u6c42\u59d4\u6258\u7c7b\uff0c\u652f\u6301\u591a\u4e2a\u8ba4\u8bc1\u8bf7\u6c42\u81ea\u5b9a\u4e49\n     * @param customizers \u81ea\u5b9a\u4e49\u7684\u8ba4\u8bc1\u8bf7\u6c42\u5904\u7406\u7c7b\uff0c\u5982\uff1a\u5fae\u4fe1 \u4f01\u4e1a\u5fae\u4fe1 \u9489\u9489\u7b49\n     * @return \u8ba4\u8bc1\u8bf7\u6c42\u59d4\u6258\u5bf9\u8c61\n     */\n    @Bean\n    public AuthorizationRequestCustomizerDelegator authorizationRequestCustomizerDelegator(List<AuthorizationRequestCustomizerAdapter> customizers) {\n        return new AuthorizationRequestCustomizerDelegator(customizers);\n    }\n\n    /**\n     * Token\u54cd\u5e94\u59d4\u6258\u7c7b\uff0c\u652f\u6301\u591a\u4e2aToken\u54cd\u5e94\u81ea\u5b9a\u4e49\n     * @param clients \u81ea\u5b9a\u4e49\u7684Token\u54cd\u5e94\u5904\u7406\u7c7b\uff0c\u5982\uff1a\u5fae\u4fe1 \u4f01\u4e1a\u5fae\u4fe1 \u9489\u9489\u7b49\n     * @return Token\u54cd\u5e94\u59d4\u6258\u5bf9\u8c61\n     */\n    @Bean\n    public OAuth2AccessTokenResponseClientDelegator accessTokenResponseClientDelegator(List<OAuth2AccessTokenResponseClientAdapter> clients) {\n        return new OAuth2AccessTokenResponseClientDelegator(clients);\n    }\n\n    /**\n     * \u7528\u6237\u8bf7\u6c42\u59d4\u6258\u7c7b\uff0c\u652f\u6301\u591a\u4e2a\u7528\u6237\u8bf7\u6c42\u81ea\u5b9a\u4e49\n     * @param converters \u81ea\u5b9a\u4e49\u7684\u7528\u6237\u8bf7\u6c42\u8f6c\u6362\u5668\uff0c\u5982\uff1a\u5fae\u4fe1 \u4f01\u4e1a\u5fae\u4fe1 \u9489\u9489\u7b49\n     * @return \u7528\u6237\u8bf7\u6c42\u59d4\u6258\u5bf9\u8c61\n     */\n    @Bean\n    public OAuth2UserRequestEntityConverterDelegator requestEntityConverterDelegator(List<OAuth2UserRequestEntityConverterAdapter> converters) {\n        return new OAuth2UserRequestEntityConverterDelegator(converters);\n    }\n\n    /**\n     * \u8ba4\u8bc1\u8bf7\u6c42\u89e3\u6790\u7c7b\n     * @param clientRegistrationRepository \u8ba4\u8bc1\u5ba2\u6237\u7aef\u6301\u4e45\u5c42\u5bf9\u8c61\n     * @param authorizationRequestCustomizerDelegator \u8ba4\u8bc1\u8bf7\u6c42\u59d4\u6258\u5bf9\u8c61\n     * @return \u8ba4\u8bc1\u8bf7\u6c42\u89e3\u6790\u5bf9\u8c61\n     */\n    @Bean\n    public BasicAuthorizationRequestResolver basicAuthorizationRequestResolver(\n            ClientRegistrationRepository clientRegistrationRepository,\n            AuthorizationRequestCustomizerDelegator authorizationRequestCustomizerDelegator) {\n        // DI\u901a\u8fc7\u6784\u9020\u5668\u81ea\u52a8\u6ce8\u5165clientRegistrationRepository\uff0c\u5b9e\u4f8b\u5316DefaultOAuth2AuthorizationRequestResolver\u5904\u7406\n        DefaultOAuth2AuthorizationRequestResolver authorizationRequestResolver = new DefaultOAuth2AuthorizationRequestResolver(clientRegistrationRepository,\n                OAuth2AuthorizationRequestRedirectFilter.DEFAULT_AUTHORIZATION_REQUEST_BASE_URI);\n        // \u517c\u5bb9\u5fae\u4fe1\u767b\u5f55\u6388\u6743\u7533\u8bf7\n        authorizationRequestResolver.setAuthorizationRequestCustomizer(authorizationRequestCustomizerDelegator);\n        return new BasicAuthorizationRequestResolver(authorizationRequestResolver);\n    }\n\n}\n\n'})}),"\n",(0,i.jsx)(e.h3,{id:"7-\u767b\u5f55\u9875\u6dfb\u52a0saml\u767b\u5f55",children:"7. \u767b\u5f55\u9875\u6dfb\u52a0SAML\u767b\u5f55"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-html",children:'<!DOCTYPE html>\n<html lang="zh-CN">\n\n<head>\n    <meta charset="UTF-8">\n    <meta http-equiv="X-UA-Compatible" content="IE=edge">\n    <meta name="viewport"\n          content="width=device-width, initial-scale=1 minimum-scale=1 maximum-scale=1 user-scalable=no"/>\n    <link rel="stylesheet" href="./assets/css/style.css" type="text/css"/>\n    <title>\u7edf\u4e00\u8ba4\u8bc1\u5e73\u53f0</title>\n</head>\n\n<body>\n<div class="bottom-container">\n</div>\n\x3c!-- <div th:if="${error}" class="alert" id="alert">\n<div class="error-alert">\n<img src="./image/logo.png" alt="logo" width="30">\n<div th:text="${error}">\n\n</div>\n</div>\n</div> --\x3e\n<div id="error_box">\n</div>\n<div class="form-container">\n\n    <form class="form-signin" method="post" th:action="@{/login}">\n        <input type="hidden" id="loginType" name="loginType" value="passwordLogin"/>\n        <input type="hidden" id="captchaId" name="captchaId" value=""/>\n        \x3c!-- <div th:if="${param.error}" class="alert alert-danger" role="alert" th:text="${param}">\nInvalid username or password.\n</div>\n<div th:if="${param.logout}" class="alert alert-success" role="alert">\n\u4f60\u5df2\u7ecf\u767b\u51fa\u6210\u529f.\n</div> --\x3e\n\n        \x3c!--        <div class="text-placeholder" style="padding-bottom: 20px;">--\x3e\n        \x3c!--            \u5e73\u53f0\u767b\u5f55--\x3e\n        \x3c!--        </div>--\x3e\n        <div class="welcome-text">\n            <img src="./assets/img/logo.png" alt="logo" width="60">\n            <span>\n                    \u7edf\u4e00\u8ba4\u8bc1\u5e73\u53f0\n                </span>\n        </div>\n        <div>\n            <input type="text" id="username" name="username" class="form-control" placeholder="\u624b\u673a / \u90ae\u7bb1"\n                   autofocus onblur="leave()"/>\n        </div>\n        <div id="passContainer">\n            <input type="password" id="password" name="password" class="form-control" placeholder="\u8bf7\u8f93\u5165\u5bc6\u7801"\n                   onblur="leave()"/>\n        </div>\n        <div class="code-container" id="codeContainer">\n            <input type="text" id="code" name="code" class="form-control" placeholder="\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"\n                   onblur="leave()"/>\n            <img src="" id="code-image" onclick="getVerifyCode()"/>\n        </div>\n        <div style="display: none; margin-bottom: 0" class="code-container" id="smsContainer">\n            <input type="text" name="" class="form-control" placeholder="\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801" onblur="leave()"/>\n            <a id="getSmsCaptchaBtn" class="btn btn-light btn-block bg-white getCaptcha"\n               href="javascript:getSmsCaptcha()">\u83b7\u53d6\u9a8c\u8bc1\u7801</a>\n        </div>\n        <div class="change-login-type">\n            <div></div>\n            <a id="changeLoginType" href="javascript:showSmsCaptchaPage()">\u77ed\u4fe1\u9a8c\u8bc1\u767b\u5f55</a>\n        </div>\n        <button class="btn btn-lg btn-primary btn-block" type="submit">\u767b&nbsp;&nbsp;&nbsp;&nbsp;\u5f55</button>\n        <div class="text-placeholder">\n            \u7b2c\u4e09\u65b9\u767b\u5f55\n        </div>\n        \x3c!-- <a class="btn btn-light btn-block bg-white" href="/oauth2/authorization/gitee" role="link"\n            style="text-transform: none;">\n            Sign in with Gitee\n        </a>\n        <div>\n            <a class="btn btn-light bg-white" href="/oauth2/authorization/github" role="link"\n                style="text-transform: none;">\n                <img width="24" style="margin-right: 5px;" alt="Sign in with GitHub"\n                    src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" />\n                Github\n            </a>\n        </div> --\x3e\n        <div class="third-box">\n            <a href="/oauth2/authorization/gitee" title="Gitee\u767b\u5f55">\n                <svg width="32" height="32" xmlns="http://www.w3.org/2000/svg" name="zi_tmGitee"\n                     viewBox="0 0 2000 2000">\n                    <path fill="red"\n                          d="M898 1992q183 0 344-69.5t283-191.5q122-122 191.5-283t69.5-344q0-183-69.5-344T1525 477q-122-122-283-191.5T898 216q-184 0-345 69.5T270 477Q148 599 78.5 760T9 1104q0 183 69.5 344T270 1731q122 122 283 191.5t345 69.5zm199-400H448q-17 0-30.5-14t-13.5-30V932q0-89 43.5-163.5T565 649q74-45 166-45h616q17 0 30.5 14t13.5 31v111q0 16-13.5 30t-30.5 14H731q-54 0-93.5 39.5T598 937v422q0 17 14 30.5t30 13.5h416q55 0 94.5-39.5t39.5-93.5v-22q0-17-14-30.5t-31-13.5H842q-17 0-30.5-14t-13.5-31v-111q0-16 13.5-30t30.5-14h505q17 0 30.5 14t13.5 30v250q0 121-86.5 207.5T1097 1592z"/>\n                </svg>\n            </a>\n\n            <a href="/oauth2/authorization/github" title="GitHub\u767b\u5f55">\n                <img width="36" style="margin-right: 5px;" alt="Sign in with GitHub"\n                     src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png"/>\n            </a>\n\n            <a href="/oauth2/authorization/wechat" title="Wechat\u767b\u5f55">\n                <img width="28" style="margin-right: 5px; position: static;" alt="Sign in with Wechat"\n                     src="./assets/img/wechat_login.png"/>\n            </a>\n            <a href="/saml2/authenticate/keycloak" title="Keycloak\u767b\u5f55">\n                <img width="28" style="margin-right: 5px; position: static;" alt="Sign in with Keycloak"\n                     src="./assets/img/keycloak.png"/>\n            </a>\n        </div>\n    </form>\n</div>\n</body>\n\n</html>\n<script>\n    function showSmsCaptchaPage() {\n        // \u9690\u85cf\u5bc6\u7801\u6846\n        let passContainer = document.getElementById(\'passContainer\');\n        passContainer.style.display = \'none\';\n        // \u8bbe\u7f6epassword\u8f93\u5165\u6846\u7684name\u4e3a\u7a7a\n        passContainer.children[0].setAttribute(\'name\', \'\')\n        // \u9690\u85cf\u9a8c\u8bc1\u7801\u6846\n        let codeContainer = document.getElementById(\'codeContainer\');\n        codeContainer.style.display = \'none\';\n        // \u8bbe\u7f6e\u767b\u5f55\u7c7b\u578b\u4e3a\u77ed\u4fe1\u9a8c\u8bc1\u7801\n        let loginType = document.getElementById(\'loginType\');\n        loginType.value = \'smsCaptcha\';\n        // \u663e\u793a\u83b7\u53d6\u77ed\u4fe1\u9a8c\u8bc1\u7801\u6309\u94ae\u4e0e\u8f93\u5165\u6846\n        let smsContainer = document.getElementById(\'smsContainer\');\n        smsContainer.style.display = \'\';\n        smsContainer.children[0].setAttribute(\'name\', \'password\')\n        // \u8bbe\u7f6e\u5207\u6362\u6309\u94ae\u6587\u5b57\u4e0e\u70b9\u51fb\u6548\u679c\n        let changeLoginType = document.getElementById(\'changeLoginType\');\n        changeLoginType.innerText = \'\u8d26\u53f7\u5bc6\u7801\u767b\u5f55\';\n        changeLoginType.setAttribute(\'href\', \'javascript:showPasswordPage()\')\n        changeLoginType.style.paddingTop = \'25px\';\n        changeLoginType.style.paddingBottom = \'5px\';\n    }\n\n    function showPasswordPage() {\n        // \u663e\u793a\u5bc6\u7801\u6846\n        let passContainer = document.getElementById(\'passContainer\');\n        passContainer.style.display = \'\';\n        // \u8bbe\u7f6epassword\u8f93\u5165\u6846\n        passContainer.children[0].setAttribute(\'name\', \'password\')\n        // \u663e\u793a\u9a8c\u8bc1\u7801\u6846\n        let codeContainer = document.getElementById(\'codeContainer\');\n        codeContainer.style.display = \'\';\n        // \u8bbe\u7f6e\u767b\u5f55\u7c7b\u578b\u4e3a\u8d26\u53f7\u5bc6\u7801\n        let loginType = document.getElementById(\'loginType\');\n        loginType.value = \'passwordLogin\';\n        // \u9690\u85cf\u83b7\u53d6\u77ed\u4fe1\u9a8c\u8bc1\u7801\u6309\u94ae\u4e0e\u8f93\u5165\u6846\n        let smsContainer = document.getElementById(\'smsContainer\');\n        smsContainer.style.display = \'none\';\n        smsContainer.children[0].setAttribute(\'name\', \'\')\n        // \u8bbe\u7f6e\u5207\u6362\u6309\u94ae\u6587\u5b57\u4e0e\u70b9\u51fb\u6548\u679c\n        let changeLoginType = document.getElementById(\'changeLoginType\');\n        changeLoginType.innerText = \'\u77ed\u4fe1\u9a8c\u8bc1\u767b\u5f55\'\n        changeLoginType.setAttribute(\'href\', \'javascript:showSmsCaptchaPage()\')\n        changeLoginType.style.paddingTop = \'0\';\n    }\n\n    function leave() {\n        document.body.scrollTop = document.documentElement.scrollTop = 0;\n    }\n\n    function getVerifyCode() {\n        let requestOptions = {\n            method: \'GET\',\n            redirect: \'follow\'\n        };\n\n        fetch(`${window.location.origin}/getCaptcha`, requestOptions)\n            .then(response => response.text())\n            .then(r => {\n                if (r) {\n                    let result = JSON.parse(r);\n                    document.getElementById(\'captchaId\').value = result.data.captchaId\n                    document.getElementById(\'code-image\').src = result.data.imageData\n                    document.getElementById(\'code\').value = result.data.code\n                    document.getElementById(\'username\').value = "admin"\n                    document.getElementById(\'password\').value = "123456"\n                }\n            })\n            .catch(error => console.log(\'error\', error));\n    }\n\n    function getSmsCaptcha() {\n\n        let phone = document.getElementById(\'username\').value;\n        if (phone === null || phone === \'\' || typeof phone === \'undefined\') {\n            showError(\'\u624b\u673a\u53f7\u7801\u4e0d\u80fd\u4e3a\u7a7a.\')\n            return;\n        }\n\n        // \u7981\u7528\u6309\u94ae\n        let getSmsCaptchaBtn = document.getElementById(\'getSmsCaptchaBtn\');\n        getSmsCaptchaBtn.style.pointerEvents = \'none\';\n        // \u5f00\u59cb1\u5206\u949f\u5012\u8ba1\u65f6\n        resetBtn(getSmsCaptchaBtn);\n\n        let requestOptions = {\n            method: \'GET\',\n            redirect: \'follow\'\n        };\n\n        fetch(`${window.location.origin}/getSmsCaptcha?phone=${phone}`, requestOptions)\n            .then(response => response.text())\n            .then(r => {\n                if (r) {\n                    let result = JSON.parse(r);\n                    if (result.success) {\n                        document.getElementById(\'username\').value = "admin"\n                        document.getElementsByName(\'password\')[0].value = "1234"\n                        showError(\'\u83b7\u53d6\u9a8c\u8bc1\u7801\u6210\u529f.\u56fa\u5b9a\u4e3a\uff1a\' + result.data)\n                    }\n                }\n            })\n            .catch(error => console.log(\'error\', error));\n    }\n\n    /**\n     * 1\u5206\u949f\u5012\u8ba1\u65f6\n     */\n    function resetBtn(getSmsCaptchaBtn) {\n        let s = 60;\n        getSmsCaptchaBtn.innerText = `\u91cd\u65b0\u83b7\u53d6(${--s})`\n        // \u5b9a\u65f6\u5668 \u6bcf\u9694\u4e00\u79d2\u53d8\u5316\u4e00\u6b21\uff081000ms = 1s\uff09\n        let t = setInterval(() => {\n            getSmsCaptchaBtn.innerText = `\u91cd\u65b0\u83b7\u53d6(${--s})`\n            if (s === 0) {\n                clearInterval(t)\n                getSmsCaptchaBtn.innerText = \'\u83b7\u53d6\u9a8c\u8bc1\u7801\'\n                getSmsCaptchaBtn.style.pointerEvents = \'\';\n            }\n        }, 1000);\n\n    }\n\n    getVerifyCode();\n<\/script>\n<script th:inline="javascript">\n\n    function showError(message) {\n        let errorBox = document.getElementById("error_box");\n        errorBox.innerHTML = message;\n        errorBox.style.display = "block";\n        setTimeout(() => {\n            closeError();\n        }, 3000)\n    }\n\n    function closeError() {\n        let errorBox = document.getElementById("error_box");\n        errorBox.style.display = "none";\n    }\n\n    let error = [[${ error }]]\n    if (error) {\n        if (window.Notification) {\n            Notification.requestPermission(function () {\n                if (Notification.permission === \'granted\') {\n                    // \u7528\u6237\u70b9\u51fb\u4e86\u5141\u8bb8\n                    let n = new Notification(\'\u767b\u5f55\u5931\u8d25\', {\n                        body: error,\n                        icon: \'./assets/img/logo.png\'\n                    })\n\n                    setTimeout(() => {\n                        n.close();\n                    }, 3000)\n                } else {\n                    showError(error);\n                }\n            })\n        }\n    }\n<\/script>\n'})}),"\n",(0,i.jsx)(e.h3,{id:"8-\u9996\u9875\u6d4b\u8bd5\u63a5\u53e3",children:"8. \u9996\u9875\u6d4b\u8bd5\u63a5\u53e3"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'package com.light.sas.controller;\n\nimport org.springframework.security.core.annotation.AuthenticationPrincipal;\nimport org.springframework.security.saml2.provider.service.authentication.Saml2AuthenticatedPrincipal;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\n\n@Controller\n@RequestMapping("saml")\npublic class SamlController {\n\n    @GetMapping("/home")\n    public String home(@AuthenticationPrincipal Saml2AuthenticatedPrincipal principal, Model model) {\n        model.addAttribute("name", principal.getName());\n        model.addAttribute("emailAddress", principal.getFirstAttribute("email"));\n        model.addAttribute("userAttributes", principal.getAttributes());\n        return "saml";\n    }\n}\n\n'})}),"\n",(0,i.jsx)(e.h3,{id:"9-saml\u9996\u9875",children:"9. saml\u9996\u9875"}),"\n",(0,i.jsx)(e.p,{children:"\u663e\u793a\u767b\u5f55\u7528\u6237\u4fe1\u606f saml.html"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-html",children:'\x3c!--\n  ~ Copyright 2002-2021 the original author or authors.\n  ~\n  ~ Licensed under the Apache License, Version 2.0 (the "License");\n  ~ you may not use this file except in compliance with the License.\n  ~ You may obtain a copy of the License at\n  ~\n  ~      https://www.apache.org/licenses/LICENSE-2.0\n  ~\n  ~ Unless required by applicable law or agreed to in writing, software\n  ~ distributed under the License is distributed on an "AS IS" BASIS,\n  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n  ~ See the License for the specific language governing permissions and\n  ~ limitations under the License.\n  --\x3e\n\n<!doctype html>\n<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org" xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">\n<head>\n    <title>Spring Security - SAML 2.0 Login & Logout</title>\n    <meta charset="utf-8" />\n    <style>\n        span, dt {\n            font-weight: bold;\n        }\n    </style>\n    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">\n</head>\n<body>\n<div class="container">\n    <ul class="nav">\n        <li class="nav-item">\n            <form th:action="@{/logout}" method="post">\n                <button class="btn btn-primary" id="rp_logout_button" type="submit">\n                    RP-initiated Logout\n                </button>\n            </form>\n        </li>\n    </ul>\n</div>\n<main role="main" class="container">\n    <h1 class="mt-5">SAML 2.0 Login & Single Logout with Spring Security</h1>\n    <p class="lead">You are successfully logged in as <span sec:authentication="name"></span></p>\n    <p class="lead">You\'re email address is <span th:text="${emailAddress}"></span></p>\n    <h2 class="mt-2">All Your Attributes</h2>\n    <dl th:each="userAttribute : ${userAttributes}">\n        <dt th:text="${userAttribute.key}"></dt>\n        <dd th:text="${userAttribute.value}"></dd>\n    </dl>\n\n    <h6>Visit the <a href="https://docs.spring.io/spring-security/site/docs/current/reference/html5/#servlet-saml2" target="_blank">SAML 2.0 Login & Logout</a> documentation for more details.</h6>\n</main>\n</div>\n</body>\n</html>\n\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u56db\u6d4b\u8bd5",children:"\u56db\u3001\u6d4b\u8bd5"}),"\n",(0,i.jsx)(e.h3,{id:"1-keycloak\u767b\u5f55",children:"1. Keycloak\u767b\u5f55"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u6d4f\u89c8\u5668\u8bbf\u95ee ",(0,i.jsx)(e.code,{children:"http://sp.light.local:8080/saml/home"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bf7\u6c42\u672a\u8ba4\u8bc1\uff0c\u8df3\u8f6c\u5230\u8ba4\u8bc1\u7aef\u70b9  ",(0,i.jsx)(e.code,{children:"http://sp.light.local:8080/saml2/authenticate/keycloak"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8ba4\u8bc1\u7aef\u70b9\u6784\u5efa\u8bf7\u6c42XML\u5e76\u8df3\u8f6c\u5230 IDP \u8fdb\u884c\u8ba4\u8bc1 ",(0,i.jsx)(e.code,{children:"http://idp.light.local:8880/realms/Test/protocol/saml"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"SAMLRequest: PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c2FtbDJwOkF1dGhuUmVxdWVzdCB4bWxuczpzYW1sMnA9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCIgQXNzZXJ0aW9uQ29uc3VtZXJTZXJ2aWNlVVJMPSJodHRwOi8vc3AubGlnaHQubG9jYWw6ODA4MC9sb2dpbi9zYW1sMi9zc28va2V5Y2xvYWsiIERlc3RpbmF0aW9uPSJodHRwOi8vaWRwLmxpZ2h0LmxvY2FsOjg4ODAvcmVhbG1zL1Rlc3QvcHJvdG9jb2wvc2FtbCIgRm9yY2VBdXRobj0iZmFsc2UiIElEPSJBUlFlNzAxMmUyLWIwODYtNDBlMi05MzI3LTI5MDllZDlkNjg1NiIgSXNQYXNzaXZlPSJmYWxzZSIgSXNzdWVJbnN0YW50PSIyMDI0LTAzLTI3VDEyOjE2OjEwLjIwNloiIFByb3RvY29sQmluZGluZz0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmJpbmRpbmdzOkhUVFAtUE9TVCIgVmVyc2lvbj0iMi4wIj48c2FtbDI6SXNzdWVyIHhtbG5zOnNhbWwyPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj5zYW1sX2NsaWVudDwvc2FtbDI6SXNzdWVyPjxkczpTaWduYXR1cmUgeG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPgo8ZHM6U2lnbmVkSW5mbz4KPGRzOkNhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz4KPGRzOlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI3JzYS1zaGEyNTYiLz4KPGRzOlJlZmVyZW5jZSBVUkk9IiNBUlFlNzAxMmUyLWIwODYtNDBlMi05MzI3LTI5MDllZDlkNjg1NiI+CjxkczpUcmFuc2Zvcm1zPgo8ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiLz4KPGRzOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIvPgo8L2RzOlRyYW5zZm9ybXM+CjxkczpEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNzaGEyNTYiLz4KPGRzOkRpZ2VzdFZhbHVlPjh0Y1ZPS1p3NUZnNFgyVVhzQ3pPMnZTOTNBeHRMWlFRMkVKQWp2T25tdnM9PC9kczpEaWdlc3RWYWx1ZT4KPC9kczpSZWZlcmVuY2U+CjwvZHM6U2lnbmVkSW5mbz4KPGRzOlNpZ25hdHVyZVZhbHVlPgpoay8ybUZsdmtNdGZNZ3c0UU0xVkcyQkE2MER3Z0FGOHRvRXZVYTN2TVNaWk92UTFGNnJNa1JxcjMwdnhmd3RCSlhML2dIR2NKYmxzJiMxMzsKZDJWcXpkRjhHenJYY1pNdkh2bkNDWlAzakZ2SXA3cGNSczZLREdmckJTWnZDaDVLZmMwcE9vOEw1ZERqNm43U053N05TK2R1RDl6aSYjMTM7CitKRG51K0NxNkkzTy9CUTRpMGc9CjwvZHM6U2lnbmF0dXJlVmFsdWU+CjxkczpLZXlJbmZvPjxkczpYNTA5RGF0YT48ZHM6WDUwOUNlcnRpZmljYXRlPk1JSUNnVENDQWVvQ0NRQ3VWenlxRmdNU3lEQU5CZ2txaGtpRzl3MEJBUXNGQURDQmhERUxNQWtHQTFVRUJoTUNWVk14RXpBUkJnTlYKQkFnTUNsZGhjMmhwYm1kMGIyNHhFakFRQmdOVkJBY01DVlpoYm1OdmRYWmxjakVkTUJzR0ExVUVDZ3dVVTNCeWFXNW5JRk5sWTNWeQphWFI1SUZOQlRVd3hDekFKQmdOVkJBc01Bbk53TVNBd0hnWURWUVFEREJkemNDNXpjSEpwYm1jdWMyVmpkWEpwZEhrdWMyRnRiREFlCkZ3MHhPREExTVRReE5ETXdORFJhRncweU9EQTFNVEV4TkRNd05EUmFNSUdFTVFzd0NRWURWUVFHRXdKVlV6RVRNQkVHQTFVRUNBd0sKVjJGemFHbHVaM1J2YmpFU01CQUdBMVVFQnd3SlZtRnVZMjkxZG1WeU1SMHdHd1lEVlFRS0RCUlRjSEpwYm1jZ1UyVmpkWEpwZEhrZwpVMEZOVERFTE1Ba0dBMVVFQ3d3Q2MzQXhJREFlQmdOVkJBTU1GM053TG5Od2NtbHVaeTV6WldOMWNtbDBlUzV6WVcxc01JR2ZNQTBHCkNTcUdTSWIzRFFFQkFRVUFBNEdOQURDQmlRS0JnUURSdTcvRUkwQmxOek1FQkZWQWNieCtsTG9zdnpJV1UrMDFkR1RZOGdCZGhNUU4KWUtaOTJsTWNlbzJDdVZKNjZjVVVSUHltM2k3bkdHem9TbkF4QXJlKzBZSU0rVTByYXpyV3RBVUU3MzVia2NxRUxaa09UWkxlbGFvTwp6dG1XcVJiZTVPdUVtcGV3SDdjeCtrTmdjVmpkY3RPR3kzUTZ4K0k0cWFrWS85cWhCUUlEQVFBQk1BMEdDU3FHU0liM0RRRUJDd1VBCkE0R0JBQWVWaVR2SE95UW9wV0VpWE9mSTJaOWV1a3dyU2tuRHdxL3pzY1IwWXh3d3FEQk10L1FkQU9EZlN3QWZuY2lpWUxrbUVqbG8KeldSdE9lTitxSzdVRmdQMWJSbDVxa3NyWVg1UzB6MmlHSmgwR3ZvbkxVdDNlMjBTc2ZsNXRURUREbkFFVU1MZkJreWF4RUhEUlovbgpiVEo3VlRlWk9TeVJvVm41WEhocHVKMEI8L2RzOlg1MDlDZXJ0aWZpY2F0ZT48L2RzOlg1MDlEYXRhPjwvZHM6S2V5SW5mbz48L2RzOlNpZ25hdHVyZT48L3NhbWwycDpBdXRoblJlcXVlc3Q+\nRelayState: 9ccfda8a-be93-49e2-bd3b-f469a64af9ba\n\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u4f7f\u7528",(0,i.jsx)(e.a,{href:"https://www.samltool.com",children:"SamlTool"}),"\u7684",(0,i.jsx)(e.a,{href:"https://www.samltool.com/decode.php",children:"Base64 Decode + Inflate"}),"\u89e3\u6790\u5e76",(0,i.jsx)(e.a,{href:"https://www.sojson.com/xml.html",children:"\u683c\u5f0f\u5316"}),"\u540e\u5f97\u5230\u8bf7\u6c42\u7684XML\u4fe1\u606f"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<saml2p:AuthnRequest\n    xmlns:saml2p="urn:oasis:names:tc:SAML:2.0:protocol" AssertionConsumerServiceURL="http://sp.light.local:8080/login/saml2/sso/keycloak" Destination="http://idp.light.local:8880/realms/Test/protocol/saml" ForceAuthn="false" ID="ARQe7012e2-b086-40e2-9327-2909ed9d6856" IsPassive="false" IssueInstant="2024-03-27T12:16:10.206Z" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" Version="2.0">\n    <saml2:Issuer\n        xmlns:saml2="urn:oasis:names:tc:SAML:2.0:assertion">saml_client\n    </saml2:Issuer>\n    <ds:Signature\n        xmlns:ds="http://www.w3.org/2000/09/xmldsig#">\n        <ds:SignedInfo>\n            <ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>\n            <ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>\n            <ds:Reference URI="#ARQe7012e2-b086-40e2-9327-2909ed9d6856">\n                <ds:Transforms>\n                    <ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>\n                    <ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>\n                </ds:Transforms>\n                <ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>\n                <ds:DigestValue>8tcVOKZw5Fg4X2UXsCzO2vS93AxtLZQQ2EJAjvOnmvs=</ds:DigestValue>\n            </ds:Reference>\n        </ds:SignedInfo>\n        <ds:SignatureValue>\nhk/2mFlvkMtfMgw4QM1VG2BA60DwgAF8toEvUa3vMSZZOvQ1F6rMkRqr30vxfwtBJXL/gHGcJbls&#13;\nd2VqzdF8GzrXcZMvHvnCCZP3jFvIp7pcRs6KDGfrBSZvCh5Kfc0pOo8L5dDj6n7SNw7NS+duD9zi&#13;\n+JDnu+Cq6I3O/BQ4i0g=\n</ds:SignatureValue>\n        <ds:KeyInfo>\n            <ds:X509Data>\n                <ds:X509Certificate>MIICgTCCAeoCCQCuVzyqFgMSyDANBgkqhkiG9w0BAQsFADCBhDELMAkGA1UEBhMCVVMxEzARBgNV\nBAgMCldhc2hpbmd0b24xEjAQBgNVBAcMCVZhbmNvdXZlcjEdMBsGA1UECgwUU3ByaW5nIFNlY3Vy\naXR5IFNBTUwxCzAJBgNVBAsMAnNwMSAwHgYDVQQDDBdzcC5zcHJpbmcuc2VjdXJpdHkuc2FtbDAe\nFw0xODA1MTQxNDMwNDRaFw0yODA1MTExNDMwNDRaMIGEMQswCQYDVQQGEwJVUzETMBEGA1UECAwK\nV2FzaGluZ3RvbjESMBAGA1UEBwwJVmFuY291dmVyMR0wGwYDVQQKDBRTcHJpbmcgU2VjdXJpdHkg\nU0FNTDELMAkGA1UECwwCc3AxIDAeBgNVBAMMF3NwLnNwcmluZy5zZWN1cml0eS5zYW1sMIGfMA0G\nCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRu7/EI0BlNzMEBFVAcbx+lLosvzIWU+01dGTY8gBdhMQN\nYKZ92lMceo2CuVJ66cUURPym3i7nGGzoSnAxAre+0YIM+U0razrWtAUE735bkcqELZkOTZLelaoO\nztmWqRbe5OuEmpewH7cx+kNgcVjdctOGy3Q6x+I4qakY/9qhBQIDAQABMA0GCSqGSIb3DQEBCwUA\nA4GBAAeViTvHOyQopWEiXOfI2Z9eukwrSknDwq/zscR0YxwwqDBMt/QdAODfSwAfnciiYLkmEjlo\nzWRtOeN+qK7UFgP1bRl5qksrYX5S0z2iGJh0GvonLUt3e20Ssfl5tTEDDnAEUMLfBkyaxEHDRZ/n\nbTJ7VTeZOSyRoVn5XHhpuJ0B</ds:X509Certificate>\n            </ds:X509Data>\n        </ds:KeyInfo>\n    </ds:Signature>\n</saml2p:AuthnRequest>\n\n'})}),"\n",(0,i.jsxs)(e.ol,{start:"4",children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8df3\u8f6c\u5230IDP\u7684\u767b\u5f55\u9875\u9762 ",(0,i.jsx)(e.code,{children:"http://idp.light.local:8880/realms/Test/login-actions/authenticate?client_id=saml_client&tab_id=L6L4GCZwIbs"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8f93\u5165\u8d26\u53f7\u5bc6\u7801\u767b\u5f55\uff0c\u53c2\u6570\u5730\u5740 ",(0,i.jsx)(e.code,{children:"http://idp.light.local:8880/realms/Test/login-actions/authenticate?session_code=c7TyMa_ucHhKFCmvKt8DBioWzWJulh_lWNGiW5Pmm5I&execution=aafd808a-c8f5-43e9-86f9-b8b972bcef00&client_id=saml_client&tab_id=L6L4GCZwIbs"})," \u643a\u5e26\u7684Form\u8868\u5355\u53c2\u6570\u4e3a ",(0,i.jsx)(e.code,{children:"username=light&password=light&credentialId="})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8ba4\u8bc1\u6210\u529f\uff0c\u56de\u8c03\u5230SP\u7684\u8ba4\u8bc1\u7aef\u70b9 ",(0,i.jsx)(e.code,{children:"http://sp.light.local:8080/login/saml2/sso/keycloak"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"SAMLResponse: PHNhbWxwOlJlc3BvbnNlIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIHhtbG5zOnNhbWw9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iIERlc3RpbmF0aW9uPSJodHRwOi8vc3AubGlnaHQubG9jYWw6ODA4MC9sb2dpbi9zYW1sMi9zc28va2V5Y2xvYWsiIElEPSJJRF8wY2Y0MTk3NC0xOTY3LTRiZjYtOWYxNy1kYTJjMDQ4MDU3NDciIEluUmVzcG9uc2VUbz0iQVJRZTcwMTJlMi1iMDg2LTQwZTItOTMyNy0yOTA5ZWQ5ZDY4NTYiIElzc3VlSW5zdGFudD0iMjAyNC0wMy0yN1QxMjoxODozNy42MjNaIiBWZXJzaW9uPSIyLjAiPjxzYW1sOklzc3Vlcj5odHRwOi8vaWRwLmxpZ2h0LmxvY2FsOjg4ODAvcmVhbG1zL1Rlc3Q8L3NhbWw6SXNzdWVyPjxzYW1scDpTdGF0dXM+PHNhbWxwOlN0YXR1c0NvZGUgVmFsdWU9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpzdGF0dXM6U3VjY2VzcyIvPjwvc2FtbHA6U3RhdHVzPjxzYW1sOkFzc2VydGlvbiB4bWxucz0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiIgSUQ9IklEXzY0NjY0ZDk2LTA4YWMtNDk0YS1iNWY2LWM0YTczNDU3YmQyOCIgSXNzdWVJbnN0YW50PSIyMDI0LTAzLTI3VDEyOjE4OjM3LjYyM1oiIFZlcnNpb249IjIuMCI+PHNhbWw6SXNzdWVyPmh0dHA6Ly9pZHAubGlnaHQubG9jYWw6ODg4MC9yZWFsbXMvVGVzdDwvc2FtbDpJc3N1ZXI+PGRzaWc6U2lnbmF0dXJlIHhtbG5zOmRzaWc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPjxkc2lnOlNpZ25lZEluZm8+PGRzaWc6Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuI1dpdGhDb21tZW50cyIvPjxkc2lnOlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI3JzYS1zaGEyNTYiLz48ZHNpZzpSZWZlcmVuY2UgVVJJPSIjSURfNjQ2NjRkOTYtMDhhYy00OTRhLWI1ZjYtYzRhNzM0NTdiZDI4Ij48ZHNpZzpUcmFuc2Zvcm1zPjxkc2lnOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNlbnZlbG9wZWQtc2lnbmF0dXJlIi8+PGRzaWc6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+PC9kc2lnOlRyYW5zZm9ybXM+PGRzaWc6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhMjU2Ii8+PGRzaWc6RGlnZXN0VmFsdWU+d2NrL01qMlVwVE8rTHNRNDBCN051MXdwTDNCeDNkdDE3RG16TW9wWjFPWT08L2RzaWc6RGlnZXN0VmFsdWU+PC9kc2lnOlJlZmVyZW5jZT48L2RzaWc6U2lnbmVkSW5mbz48ZHNpZzpTaWduYXR1cmVWYWx1ZT5tSUdTeVRDVW1nVEJoYSt1Q0oxVS84RFZuSjZqcS80SVNoUGtvODBiT3Z4Y3poOU1YQlIvN00ybUF6TnM0UGZ4dEZqUHlXbDd6YzdEYVhNeUJSTm11SmpMMENCK2tqbWV3RE4wRWFFanV1NVNYSkd5Qk03cFRPbVJ1RElRMWJpR241RHZ5KzdqekR0Skl5VTNRelhjMVVUMUFSMmdTRFhDbi9SYUxQM2ZqRzlyMEd4NzdPdlNlNC8vQ0RmNUpEakF6SkdGcHBMdytUODN3dHhPQklQL0E2bU1GUVIySmNFVGFpTEFVMFUzclpXS2lHVU95Z3k3NEVhMVlPQ1NMZkg1TnZESmxjTFVBZERKelBlVVdQRUdaejZPc0E2RnhqWGNIUnhFYzFBbkhYbkZYa0xrSERqbFA4elM2bFRFWWNSTk5EeWJzbUJiZUF5MGIxSzJJbk0xOHc9PTwvZHNpZzpTaWduYXR1cmVWYWx1ZT48ZHNpZzpLZXlJbmZvPjxkc2lnOktleU5hbWU+bHdsRi13TnY3OVVSUTNxeVoxRG1salVzSGNWcjlBMkF0YzNBV3dfLWRiVTwvZHNpZzpLZXlOYW1lPjxkc2lnOlg1MDlEYXRhPjxkc2lnOlg1MDlDZXJ0aWZpY2F0ZT5NSUlDbHpDQ0FYOENCZ0dPZjVUb3dEQU5CZ2txaGtpRzl3MEJBUXNGQURBUE1RMHdDd1lEVlFRRERBUlVaWE4wTUI0WERUSTBNRE15TnpFeE1ESXlPVm9YRFRNME1ETXlOekV4TURRd09Wb3dEekVOTUFzR0ExVUVBd3dFVkdWemREQ0NBU0l3RFFZSktvWklodmNOQVFFQkJRQURnZ0VQQURDQ0FRb0NnZ0VCQU1RdngwTWR1R1JOM0JVOHRwMlFjRDRVTlorY2FLOGpyRGNzUTRVQjVCNkFHWTN2TEVwd1ZXMjNOUnMzYjN6KzU2NFlRQU53cmZVVUpvODd2ZXE0V0U3UkZWNHhCT0gxVjlMdEtjdGc2QnNqMStZOWtkbEthZEtyeEl0YXg3OXhBRFp3TDdSdTk1ZytIM0NuZkc3YUk1cHZFWGcyZmxHZlM5MHVCc2dkTG9PQnFCRHBnTkpiVmVTcHpKOERwakFGRmMzVUFHYUdOdGJlUWlFUGo5TjVXcTBtenlkbG5TeE5HdHo1ejQ3eXo1MHo2Y05BdERFbTNXM09iaGJjVzRvTEtWZUQwdWZMVkZjL0dxVFJIbUNzbGhPaHc2RFQ5bkVIRC9XY2VpaS92NkxQQmhCdXRkVEZjbHVOTmI3Y3B2cDA0bGsyN1JEQ2F6Yi8wM1pxOEpGckVrVUNBd0VBQVRBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQVFFQUJDR043ZEZPYjV3b1NZQzRqWlpSenhHc2c3Ni9iZWd0SUYwdFVXZHlrWDZKT3g0T1Z6S3owbmxTRUp6MjA5bjdNWUxBS1lXRFlOVlhFYnVxd0NIRG5GTEdJNW13RDl4OE8vT0dFTlRCcm10SDJCWmc4V2trc281aDBJekU1dW4rUHJ1VnR4alBJRlRqeTB2SzFNTndJWGxFQ1RxakFhRHd4Z0lJcjJ1NHdEb0NWYTVXMktDZDJlaXRmYVBwVWpZTkZEMnVaSi94YVl2VU1DR3UrVjU3WEgyQUhNZjBSZzh1UWFEbTZTcnJSU0ZETk5hWHFPYWdSV24xRFBPYTVZSTZwVVQ4RVRTNjA4ZTJVZy9IMlBoY3VBRXJXUjcwdEx6TDhSdkFhamVWVjlXZER4UEFFcVhoaFhSNXRuZTI3LzU1QnZhYnZtUkJnTGZLU3JzcU1Ib0FQUT09PC9kc2lnOlg1MDlDZXJ0aWZpY2F0ZT48L2RzaWc6WDUwOURhdGE+PC9kc2lnOktleUluZm8+PC9kc2lnOlNpZ25hdHVyZT48c2FtbDpTdWJqZWN0PjxzYW1sOk5hbWVJRCBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjEuMTpuYW1laWQtZm9ybWF0OnVuc3BlY2lmaWVkIj5saWdodDwvc2FtbDpOYW1lSUQ+PHNhbWw6U3ViamVjdENvbmZpcm1hdGlvbiBNZXRob2Q9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpjbTpiZWFyZXIiPjxzYW1sOlN1YmplY3RDb25maXJtYXRpb25EYXRhIEluUmVzcG9uc2VUbz0iQVJRZTcwMTJlMi1iMDg2LTQwZTItOTMyNy0yOTA5ZWQ5ZDY4NTYiIE5vdE9uT3JBZnRlcj0iMjAyNC0wMy0yN1QxMjoyMzozNS42MjNaIiBSZWNpcGllbnQ9Imh0dHA6Ly9zcC5saWdodC5sb2NhbDo4MDgwL2xvZ2luL3NhbWwyL3Nzby9rZXljbG9hayIvPjwvc2FtbDpTdWJqZWN0Q29uZmlybWF0aW9uPjwvc2FtbDpTdWJqZWN0PjxzYW1sOkNvbmRpdGlvbnMgTm90QmVmb3JlPSIyMDI0LTAzLTI3VDEyOjE4OjM1LjYyM1oiIE5vdE9uT3JBZnRlcj0iMjAyNC0wMy0yN1QxMjoxOTozNS42MjNaIj48c2FtbDpBdWRpZW5jZVJlc3RyaWN0aW9uPjxzYW1sOkF1ZGllbmNlPnNhbWxfY2xpZW50PC9zYW1sOkF1ZGllbmNlPjwvc2FtbDpBdWRpZW5jZVJlc3RyaWN0aW9uPjwvc2FtbDpDb25kaXRpb25zPjxzYW1sOkF0dHJpYnV0ZVN0YXRlbWVudD48c2FtbDpBdHRyaWJ1dGUgTmFtZT0iUm9sZSIgTmFtZUZvcm1hdD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmF0dHJuYW1lLWZvcm1hdDpiYXNpYyI+PHNhbWw6QXR0cmlidXRlVmFsdWUgeG1sbnM6eHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hIiB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiB4c2k6dHlwZT0ieHM6c3RyaW5nIj5vZmZsaW5lX2FjY2Vzczwvc2FtbDpBdHRyaWJ1dGVWYWx1ZT48L3NhbWw6QXR0cmlidXRlPjxzYW1sOkF0dHJpYnV0ZSBOYW1lPSJSb2xlIiBOYW1lRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXR0cm5hbWUtZm9ybWF0OmJhc2ljIj48c2FtbDpBdHRyaWJ1dGVWYWx1ZSB4bWxuczp4cz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiIHhzaTp0eXBlPSJ4czpzdHJpbmciPm1hbmFnZS1hY2NvdW50LWxpbmtzPC9zYW1sOkF0dHJpYnV0ZVZhbHVlPjwvc2FtbDpBdHRyaWJ1dGU+PHNhbWw6QXR0cmlidXRlIE5hbWU9IlJvbGUiIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6YmFzaWMiPjxzYW1sOkF0dHJpYnV0ZVZhbHVlIHhtbG5zOnhzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYSIgeG1sbnM6eHNpPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZSIgeHNpOnR5cGU9InhzOnN0cmluZyI+ZGVmYXVsdC1yb2xlcy10ZXN0PC9zYW1sOkF0dHJpYnV0ZVZhbHVlPjwvc2FtbDpBdHRyaWJ1dGU+PHNhbWw6QXR0cmlidXRlIE5hbWU9IlJvbGUiIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6YmFzaWMiPjxzYW1sOkF0dHJpYnV0ZVZhbHVlIHhtbG5zOnhzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYSIgeG1sbnM6eHNpPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZSIgeHNpOnR5cGU9InhzOnN0cmluZyI+dW1hX2F1dGhvcml6YXRpb248L3NhbWw6QXR0cmlidXRlVmFsdWU+PC9zYW1sOkF0dHJpYnV0ZT48c2FtbDpBdHRyaWJ1dGUgTmFtZT0iUm9sZSIgTmFtZUZvcm1hdD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmF0dHJuYW1lLWZvcm1hdDpiYXNpYyI+PHNhbWw6QXR0cmlidXRlVmFsdWUgeG1sbnM6eHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hIiB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiB4c2k6dHlwZT0ieHM6c3RyaW5nIj5tYW5hZ2UtYWNjb3VudDwvc2FtbDpBdHRyaWJ1dGVWYWx1ZT48L3NhbWw6QXR0cmlidXRlPjxzYW1sOkF0dHJpYnV0ZSBOYW1lPSJSb2xlIiBOYW1lRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXR0cm5hbWUtZm9ybWF0OmJhc2ljIj48c2FtbDpBdHRyaWJ1dGVWYWx1ZSB4bWxuczp4cz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiIHhzaTp0eXBlPSJ4czpzdHJpbmciPnZpZXctcHJvZmlsZTwvc2FtbDpBdHRyaWJ1dGVWYWx1ZT48L3NhbWw6QXR0cmlidXRlPjwvc2FtbDpBdHRyaWJ1dGVTdGF0ZW1lbnQ+PC9zYW1sOkFzc2VydGlvbj48L3NhbWxwOlJlc3BvbnNlPg==\nRelayState: 9ccfda8a-be93-49e2-bd3b-f469a64af9ba\n\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u4f7f\u7528",(0,i.jsx)(e.a,{href:"https://www.samltool.com",children:"SamlTool"}),"\u7684",(0,i.jsx)(e.a,{href:"https://www.samltool.com/decode.php",children:"Base64 Decode + Inflate"}),"\u89e3\u6790\u5e76",(0,i.jsx)(e.a,{href:"https://www.sojson.com/xml.html",children:"\u683c\u5f0f\u5316"}),"\u540e\u5f97\u5230\u8bf7\u6c42\u7684XML\u4fe1\u606f"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\n<samlp:Response\n    xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol"\n    xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" Destination="http://sp.light.local:8080/login/saml2/sso/keycloak" ID="ID_0cf41974-1967-4bf6-9f17-da2c04805747" InResponseTo="ARQe7012e2-b086-40e2-9327-2909ed9d6856" IssueInstant="2024-03-27T12:18:37.623Z" Version="2.0">\n    <saml:Issuer>http://idp.light.local:8880/realms/Test</saml:Issuer>\n    <samlp:Status>\n        <samlp:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success"/>\n    </samlp:Status>\n    <saml:Assertion\n        xmlns="urn:oasis:names:tc:SAML:2.0:assertion" ID="ID_64664d96-08ac-494a-b5f6-c4a73457bd28" IssueInstant="2024-03-27T12:18:37.623Z" Version="2.0">\n        <saml:Issuer>http://idp.light.local:8880/realms/Test</saml:Issuer>\n        <dsig:Signature\n            xmlns:dsig="http://www.w3.org/2000/09/xmldsig#">\n            <dsig:SignedInfo>\n                <dsig:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#WithComments"/>\n                <dsig:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>\n                <dsig:Reference URI="#ID_64664d96-08ac-494a-b5f6-c4a73457bd28">\n                    <dsig:Transforms>\n                        <dsig:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>\n                        <dsig:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>\n                    </dsig:Transforms>\n                    <dsig:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>\n                    <dsig:DigestValue>wck/Mj2UpTO+LsQ40B7Nu1wpL3Bx3dt17DmzMopZ1OY=</dsig:DigestValue>\n                </dsig:Reference>\n            </dsig:SignedInfo>\n            <dsig:SignatureValue>mIGSyTCUmgTBha+uCJ1U/8DVnJ6jq/4IShPko80bOvxczh9MXBR/7M2mAzNs4PfxtFjPyWl7zc7DaXMyBRNmuJjL0CB+kjmewDN0EaEjuu5SXJGyBM7pTOmRuDIQ1biGn5Dvy+7jzDtJIyU3QzXc1UT1AR2gSDXCn/RaLP3fjG9r0Gx77OvSe4//CDf5JDjAzJGFppLw+T83wtxOBIP/A6mMFQR2JcETaiLAU0U3rZWKiGUOygy74Ea1YOCSLfH5NvDJlcLUAdDJzPeUWPEGZz6OsA6FxjXcHRxEc1AnHXnFXkLkHDjlP8zS6lTEYcRNNDybsmBbeAy0b1K2InM18w==</dsig:SignatureValue>\n            <dsig:KeyInfo>\n                <dsig:KeyName>lwlF-wNv79URQ3qyZ1DmljUsHcVr9A2Atc3AWw_-dbU</dsig:KeyName>\n                <dsig:X509Data>\n                    <dsig:X509Certificate>MIIClzCCAX8CBgGOf5TowDANBgkqhkiG9w0BAQsFADAPMQ0wCwYDVQQDDARUZXN0MB4XDTI0MDMyNzExMDIyOVoXDTM0MDMyNzExMDQwOVowDzENMAsGA1UEAwwEVGVzdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMQvx0MduGRN3BU8tp2QcD4UNZ+caK8jrDcsQ4UB5B6AGY3vLEpwVW23NRs3b3z+564YQANwrfUUJo87veq4WE7RFV4xBOH1V9LtKctg6Bsj1+Y9kdlKadKrxItax79xADZwL7Ru95g+H3CnfG7aI5pvEXg2flGfS90uBsgdLoOBqBDpgNJbVeSpzJ8DpjAFFc3UAGaGNtbeQiEPj9N5Wq0mzydlnSxNGtz5z47yz50z6cNAtDEm3W3ObhbcW4oLKVeD0ufLVFc/GqTRHmCslhOhw6DT9nEHD/Wceii/v6LPBhButdTFcluNNb7cpvp04lk27RDCazb/03Zq8JFrEkUCAwEAATANBgkqhkiG9w0BAQsFAAOCAQEABCGN7dFOb5woSYC4jZZRzxGsg76/begtIF0tUWdykX6JOx4OVzKz0nlSEJz209n7MYLAKYWDYNVXEbuqwCHDnFLGI5mwD9x8O/OGENTBrmtH2BZg8Wkkso5h0IzE5un+PruVtxjPIFTjy0vK1MNwIXlECTqjAaDwxgIIr2u4wDoCVa5W2KCd2eitfaPpUjYNFD2uZJ/xaYvUMCGu+V57XH2AHMf0Rg8uQaDm6SrrRSFDNNaXqOagRWn1DPOa5YI6pUT8ETS608e2Ug/H2PhcuAErWR70tLzL8RvAajeVV9WdDxPAEqXhhXR5tne27/55BvabvmRBgLfKSrsqMHoAPQ==</dsig:X509Certificate>\n                </dsig:X509Data>\n            </dsig:KeyInfo>\n        </dsig:Signature>\n        <saml:Subject>\n            <saml:NameID Format="urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified">light</saml:NameID>\n            <saml:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer">\n                <saml:SubjectConfirmationData InResponseTo="ARQe7012e2-b086-40e2-9327-2909ed9d6856" NotOnOrAfter="2024-03-27T12:23:35.623Z" Recipient="http://sp.light.local:8080/login/saml2/sso/keycloak"/>\n            </saml:SubjectConfirmation>\n        </saml:Subject>\n        <saml:Conditions NotBefore="2024-03-27T12:18:35.623Z" NotOnOrAfter="2024-03-27T12:19:35.623Z">\n            <saml:AudienceRestriction>\n                <saml:Audience>saml_client</saml:Audience>\n            </saml:AudienceRestriction>\n        </saml:Conditions>\n        <saml:AttributeStatement>\n            <saml:Attribute Name="Role" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic">\n                <saml:AttributeValue\n                    xmlns:xs="http://www.w3.org/2001/XMLSchema"\n                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">offline_access\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute Name="Role" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic">\n                <saml:AttributeValue\n                    xmlns:xs="http://www.w3.org/2001/XMLSchema"\n                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">manage-account-links\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute Name="Role" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic">\n                <saml:AttributeValue\n                    xmlns:xs="http://www.w3.org/2001/XMLSchema"\n                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">default-roles-test\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute Name="Role" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic">\n                <saml:AttributeValue\n                    xmlns:xs="http://www.w3.org/2001/XMLSchema"\n                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">uma_authorization\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute Name="Role" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic">\n                <saml:AttributeValue\n                    xmlns:xs="http://www.w3.org/2001/XMLSchema"\n                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">manage-account\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute Name="Role" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic">\n                <saml:AttributeValue\n                    xmlns:xs="http://www.w3.org/2001/XMLSchema"\n                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">view-profile\n                </saml:AttributeValue>\n            </saml:Attribute>\n        </saml:AttributeStatement>\n    </saml:Assertion>\n</samlp:Response>\n\n'})}),"\n",(0,i.jsxs)(e.ol,{start:"7",children:["\n",(0,i.jsxs)(e.li,{children:["\u8ba4\u8bc1\u6210\u529f\uff0c\u8df3\u8f6c\u5230\u767b\u5f55\u524d\u9875\u9762 ",(0,i.jsx)(e.code,{children:"http://sp.light.local:8080/saml/home?continue"})]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"\nSAML 2.0 Login & Single Logout with Spring Security\nYou are successfully logged in as light\n\nYou're email address is\n\nAll Your Attributes\nRole\n[default-roles-test, manage-account-links, offline_access, manage-account, uma_authorization, view-profile]\nVisit the [SAML 2.0 Login & Logout](https://docs.spring.io/spring-security/site/docs/current/reference/html5/#servlet-saml2) documentation for more details.\n\n"})}),"\n",(0,i.jsx)(e.h3,{id:"2-keycloak\u767b\u51fa",children:"2. Keycloak\u767b\u51fa"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u70b9\u51fb\u9875\u9762\u7684 ",(0,i.jsx)(e.code,{children:"RP-initiated Logout"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee ",(0,i.jsx)(e.code,{children:"http://sp.light.local:8080/logout"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["\u8df3\u8f6c ",(0,i.jsx)(e.code,{children:"http://idp.light.local:8880/realms/Test/protocol/saml"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"SAMLRequest: PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c2FtbDJwOkxvZ291dFJlcXVlc3QgeG1sbnM6c2FtbDJwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIERlc3RpbmF0aW9uPSJodHRwOi8vaWRwLmxpZ2h0LmxvY2FsOjg4ODAvcmVhbG1zL1Rlc3QvcHJvdG9jb2wvc2FtbCIgSUQ9IkxSNDNjODY2NmYtYWZiNi00NjUzLWE3NDQtMWYzZWQ5YWQyN2E4IiBJc3N1ZUluc3RhbnQ9IjIwMjQtMDMtMjdUMTI6MjE6MDcuMjY0WiIgVmVyc2lvbj0iMi4wIj48c2FtbDI6SXNzdWVyIHhtbG5zOnNhbWwyPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj5zYW1sX2NsaWVudDwvc2FtbDI6SXNzdWVyPjxkczpTaWduYXR1cmUgeG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPgo8ZHM6U2lnbmVkSW5mbz4KPGRzOkNhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz4KPGRzOlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI3JzYS1zaGEyNTYiLz4KPGRzOlJlZmVyZW5jZSBVUkk9IiNMUjQzYzg2NjZmLWFmYjYtNDY1My1hNzQ0LTFmM2VkOWFkMjdhOCI+CjxkczpUcmFuc2Zvcm1zPgo8ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiLz4KPGRzOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIvPgo8L2RzOlRyYW5zZm9ybXM+CjxkczpEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNzaGEyNTYiLz4KPGRzOkRpZ2VzdFZhbHVlPmlZYXVUa0s1M1VLQzE3WU52OG5YaVF6MXQyenA3K3VlUGp4UFlwQ21wTnM9PC9kczpEaWdlc3RWYWx1ZT4KPC9kczpSZWZlcmVuY2U+CjwvZHM6U2lnbmVkSW5mbz4KPGRzOlNpZ25hdHVyZVZhbHVlPgpndTFXTzRKY3BBMFo3MGZoZkYvdVI4cGwrNkhTR0t5U28xdDBmVWNuYWx6YytuS285dm02WDNicWU5RXhrdksxekxZckRBWlUxL1U1JiMxMzsKdXFwSEdWc2t1UmFqVHRJbnpjM2ZqVUpscTRhdlI0VzVIYjFqdDhqL2ljRXF4V0lCWTErOWdzSG83K1hYbUdZZG9CSENFVSs3RGdXOSYjMTM7Cm41cUNqOFRDUmdZdUJZWk9SRDQ9CjwvZHM6U2lnbmF0dXJlVmFsdWU+CjxkczpLZXlJbmZvPjxkczpYNTA5RGF0YT48ZHM6WDUwOUNlcnRpZmljYXRlPk1JSUNnVENDQWVvQ0NRQ3VWenlxRmdNU3lEQU5CZ2txaGtpRzl3MEJBUXNGQURDQmhERUxNQWtHQTFVRUJoTUNWVk14RXpBUkJnTlYKQkFnTUNsZGhjMmhwYm1kMGIyNHhFakFRQmdOVkJBY01DVlpoYm1OdmRYWmxjakVkTUJzR0ExVUVDZ3dVVTNCeWFXNW5JRk5sWTNWeQphWFI1SUZOQlRVd3hDekFKQmdOVkJBc01Bbk53TVNBd0hnWURWUVFEREJkemNDNXpjSEpwYm1jdWMyVmpkWEpwZEhrdWMyRnRiREFlCkZ3MHhPREExTVRReE5ETXdORFJhRncweU9EQTFNVEV4TkRNd05EUmFNSUdFTVFzd0NRWURWUVFHRXdKVlV6RVRNQkVHQTFVRUNBd0sKVjJGemFHbHVaM1J2YmpFU01CQUdBMVVFQnd3SlZtRnVZMjkxZG1WeU1SMHdHd1lEVlFRS0RCUlRjSEpwYm1jZ1UyVmpkWEpwZEhrZwpVMEZOVERFTE1Ba0dBMVVFQ3d3Q2MzQXhJREFlQmdOVkJBTU1GM053TG5Od2NtbHVaeTV6WldOMWNtbDBlUzV6WVcxc01JR2ZNQTBHCkNTcUdTSWIzRFFFQkFRVUFBNEdOQURDQmlRS0JnUURSdTcvRUkwQmxOek1FQkZWQWNieCtsTG9zdnpJV1UrMDFkR1RZOGdCZGhNUU4KWUtaOTJsTWNlbzJDdVZKNjZjVVVSUHltM2k3bkdHem9TbkF4QXJlKzBZSU0rVTByYXpyV3RBVUU3MzVia2NxRUxaa09UWkxlbGFvTwp6dG1XcVJiZTVPdUVtcGV3SDdjeCtrTmdjVmpkY3RPR3kzUTZ4K0k0cWFrWS85cWhCUUlEQVFBQk1BMEdDU3FHU0liM0RRRUJDd1VBCkE0R0JBQWVWaVR2SE95UW9wV0VpWE9mSTJaOWV1a3dyU2tuRHdxL3pzY1IwWXh3d3FEQk10L1FkQU9EZlN3QWZuY2lpWUxrbUVqbG8KeldSdE9lTitxSzdVRmdQMWJSbDVxa3NyWVg1UzB6MmlHSmgwR3ZvbkxVdDNlMjBTc2ZsNXRURUREbkFFVU1MZkJreWF4RUhEUlovbgpiVEo3VlRlWk9TeVJvVm41WEhocHVKMEI8L2RzOlg1MDlDZXJ0aWZpY2F0ZT48L2RzOlg1MDlEYXRhPjwvZHM6S2V5SW5mbz48L2RzOlNpZ25hdHVyZT48c2FtbDI6TmFtZUlEIHhtbG5zOnNhbWwyPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj5saWdodDwvc2FtbDI6TmFtZUlEPjwvc2FtbDJwOkxvZ291dFJlcXVlc3Q+\nRelayState: e7bd99d7-d9ae-4c8d-a928-23a19457b283\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u4f7f\u7528",(0,i.jsx)(e.a,{href:"https://www.samltool.com",children:"SamlTool"}),"\u7684",(0,i.jsx)(e.a,{href:"https://www.samltool.com/decode.php",children:"Base64 Decode + Inflate"}),"\u89e3\u6790\u5e76",(0,i.jsx)(e.a,{href:"https://www.sojson.com/xml.html",children:"\u683c\u5f0f\u5316"}),"\u540e\u5f97\u5230\u8bf7\u6c42\u7684XML\u4fe1\u606f"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<saml2p:LogoutRequest\n    xmlns:saml2p="urn:oasis:names:tc:SAML:2.0:protocol" Destination="http://idp.light.local:8880/realms/Test/protocol/saml" ID="LR43c8666f-afb6-4653-a744-1f3ed9ad27a8" IssueInstant="2024-03-27T12:21:07.264Z" Version="2.0">\n    <saml2:Issuer\n        xmlns:saml2="urn:oasis:names:tc:SAML:2.0:assertion">saml_client\n    </saml2:Issuer>\n    <ds:Signature\n        xmlns:ds="http://www.w3.org/2000/09/xmldsig#">\n        <ds:SignedInfo>\n            <ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>\n            <ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>\n            <ds:Reference URI="#LR43c8666f-afb6-4653-a744-1f3ed9ad27a8">\n                <ds:Transforms>\n                    <ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>\n                    <ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>\n                </ds:Transforms>\n                <ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>\n                <ds:DigestValue>iYauTkK53UKC17YNv8nXiQz1t2zp7+uePjxPYpCmpNs=</ds:DigestValue>\n            </ds:Reference>\n        </ds:SignedInfo>\n        <ds:SignatureValue>\ngu1WO4JcpA0Z70fhfF/uR8pl+6HSGKySo1t0fUcnalzc+nKo9vm6X3bqe9ExkvK1zLYrDAZU1/U5&#13;\nuqpHGVskuRajTtInzc3fjUJlq4avR4W5Hb1jt8j/icEqxWIBY1+9gsHo7+XXmGYdoBHCEU+7DgW9&#13;\nn5qCj8TCRgYuBYZORD4=\n</ds:SignatureValue>\n        <ds:KeyInfo>\n            <ds:X509Data>\n                <ds:X509Certificate>MIICgTCCAeoCCQCuVzyqFgMSyDANBgkqhkiG9w0BAQsFADCBhDELMAkGA1UEBhMCVVMxEzARBgNV\nBAgMCldhc2hpbmd0b24xEjAQBgNVBAcMCVZhbmNvdXZlcjEdMBsGA1UECgwUU3ByaW5nIFNlY3Vy\naXR5IFNBTUwxCzAJBgNVBAsMAnNwMSAwHgYDVQQDDBdzcC5zcHJpbmcuc2VjdXJpdHkuc2FtbDAe\nFw0xODA1MTQxNDMwNDRaFw0yODA1MTExNDMwNDRaMIGEMQswCQYDVQQGEwJVUzETMBEGA1UECAwK\nV2FzaGluZ3RvbjESMBAGA1UEBwwJVmFuY291dmVyMR0wGwYDVQQKDBRTcHJpbmcgU2VjdXJpdHkg\nU0FNTDELMAkGA1UECwwCc3AxIDAeBgNVBAMMF3NwLnNwcmluZy5zZWN1cml0eS5zYW1sMIGfMA0G\nCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRu7/EI0BlNzMEBFVAcbx+lLosvzIWU+01dGTY8gBdhMQN\nYKZ92lMceo2CuVJ66cUURPym3i7nGGzoSnAxAre+0YIM+U0razrWtAUE735bkcqELZkOTZLelaoO\nztmWqRbe5OuEmpewH7cx+kNgcVjdctOGy3Q6x+I4qakY/9qhBQIDAQABMA0GCSqGSIb3DQEBCwUA\nA4GBAAeViTvHOyQopWEiXOfI2Z9eukwrSknDwq/zscR0YxwwqDBMt/QdAODfSwAfnciiYLkmEjlo\nzWRtOeN+qK7UFgP1bRl5qksrYX5S0z2iGJh0GvonLUt3e20Ssfl5tTEDDnAEUMLfBkyaxEHDRZ/n\nbTJ7VTeZOSyRoVn5XHhpuJ0B</ds:X509Certificate>\n            </ds:X509Data>\n        </ds:KeyInfo>\n    </ds:Signature>\n    <saml2:NameID\n        xmlns:saml2="urn:oasis:names:tc:SAML:2.0:assertion">light\n    </saml2:NameID>\n</saml2p:LogoutRequest>\n\n'})}),"\n",(0,i.jsxs)(e.ol,{start:"4",children:["\n",(0,i.jsxs)(e.li,{children:["\u9000\u51fa\u54cd\u5e94 ",(0,i.jsx)(e.code,{children:"http://sp.light.local:8080/login/saml2/sso/keycloak"})]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"SAMLResponse: PHNhbWxwOkxvZ291dFJlc3BvbnNlIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIHhtbG5zPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiB4bWxuczpzYW1sPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIiBEZXN0aW5hdGlvbj0iaHR0cDovL3NwLmxpZ2h0LmxvY2FsOjgwODAvbG9naW4vc2FtbDIvc3NvL2tleWNsb2FrIiBJRD0iSURfZGI3MGI3YTAtYTkwMC00MjhkLTgwMDAtZjMxNzFmNTI1ZDk5IiBJblJlc3BvbnNlVG89IkxSNDNjODY2NmYtYWZiNi00NjUzLWE3NDQtMWYzZWQ5YWQyN2E4IiBJc3N1ZUluc3RhbnQ9IjIwMjQtMDMtMjdUMTI6MjE6MDcuMjk4WiIgVmVyc2lvbj0iMi4wIj48SXNzdWVyPmh0dHA6Ly9pZHAubGlnaHQubG9jYWw6ODg4MC9yZWFsbXMvVGVzdDwvSXNzdWVyPjxzYW1scDpTdGF0dXM+PHNhbWxwOlN0YXR1c0NvZGUgVmFsdWU9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpzdGF0dXM6U3VjY2VzcyIvPjwvc2FtbHA6U3RhdHVzPjwvc2FtbHA6TG9nb3V0UmVzcG9uc2U+\nRelayState: e7bd99d7-d9ae-4c8d-a928-23a19457b283\n\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u4f7f\u7528",(0,i.jsx)(e.a,{href:"https://www.samltool.com",children:"SamlTool"}),"\u7684",(0,i.jsx)(e.a,{href:"https://www.samltool.com/decode.php",children:"Base64 Decode + Inflate"}),"\u89e3\u6790\u5e76",(0,i.jsx)(e.a,{href:"https://www.sojson.com/xml.html",children:"\u683c\u5f0f\u5316"}),"\u540e\u5f97\u5230\u8bf7\u6c42\u7684XML\u4fe1\u606f"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<samlp:LogoutResponse\n    xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol"\n    xmlns="urn:oasis:names:tc:SAML:2.0:assertion"\n    xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" Destination="http://sp.light.local:8080/login/saml2/sso/keycloak" ID="ID_db70b7a0-a900-428d-8000-f3171f525d99" InResponseTo="LR43c8666f-afb6-4653-a744-1f3ed9ad27a8" IssueInstant="2024-03-27T12:21:07.298Z" Version="2.0">\n    <Issuer>http://idp.light.local:8880/realms/Test</Issuer>\n    <samlp:Status>\n        <samlp:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success"/>\n    </samlp:Status>\n</samlp:LogoutResponse>\n\n'})})]})}function m(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>r,x:()=>l});var i=t(96540);const a={},s=i.createContext(a);function r(n){const e=i.useContext(s);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:r(n.components),i.createElement(s.Provider,{value:e},n.children)}}}]);