"use strict";(self.webpackChunklight_docusaurus=self.webpackChunklight_docusaurus||[]).push([[34421],{18259:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>s,metadata:()=>c,toc:()=>a});var l=r(74848),d=r(28453);const s={},t=void 0,c={id:"network/Cloudflare-DDNS-Proxy-IPv4",title:"Cloudflare-DDNS-Proxy-IPv4",description:"\u81ea\u5efaDDNS\u89e3\u51b3\u52a8\u6001IP\u670d\u52a1\u5668\u8bbf\u95ee\u95ee\u9898",source:"@site/diy/network/2-Cloudflare-DDNS-Proxy-IPv4.md",sourceDirName:"network",slug:"/network/Cloudflare-DDNS-Proxy-IPv4",permalink:"/light-docusaurus/diy/network/Cloudflare-DDNS-Proxy-IPv4",draft:!1,unlisted:!1,editUrl:"https://github.com/lorchr/light-docusaurus/tree/main/diy/network/2-Cloudflare-DDNS-Proxy-IPv4.md",tags:[],version:"current",lastUpdatedBy:"Lorchr",lastUpdatedAt:1713357975e3,sidebarPosition:2,frontMatter:{},sidebar:"diy",previous:{title:"Aliyun-Domain-Config",permalink:"/light-docusaurus/diy/network/Aliyun-Domain-Config"},next:{title:"Cloudflare-DDNS-Proxy-IPv6",permalink:"/light-docusaurus/diy/network/Cloudflare-DDNS-Proxy-IPv6"}},o={},a=[{value:"1. \u628a\u57df\u540d\u63a5\u5165cloudflare",id:"1-\u628a\u57df\u540d\u63a5\u5165cloudflare",level:2},{value:"2. \u83b7\u53d6Global API Key",id:"2-\u83b7\u53d6global-api-key",level:2},{value:"3. \u8bbe\u7f6e\u7528\u4e8e DDNS \u89e3\u6790\u7684\u4e8c\u7ea7\u57df\u540d\uff0c\u6d41\u91cf\u4e0d\u7ecf\u8fc7CDN(\u4e91\u6735\u53d8\u7070)",id:"3-\u8bbe\u7f6e\u7528\u4e8e-ddns-\u89e3\u6790\u7684\u4e8c\u7ea7\u57df\u540d\u6d41\u91cf\u4e0d\u7ecf\u8fc7cdn\u4e91\u6735\u53d8\u7070",level:2},{value:"4. \u4e0b\u8f7d DNNS \u811a\u672c",id:"4-\u4e0b\u8f7d-dnns-\u811a\u672c",level:2},{value:"5. \u4fee\u6539 DDNS \u811a\u672c\u5e76\u8865\u5145\u76f8\u5173\u4fe1\u606f",id:"5-\u4fee\u6539-ddns-\u811a\u672c\u5e76\u8865\u5145\u76f8\u5173\u4fe1\u606f",level:2},{value:"6. \u8bbe\u7f6e\u5b9a\u65f6\u4efb\u52a1",id:"6-\u8bbe\u7f6e\u5b9a\u65f6\u4efb\u52a1",level:2},{value:"7. \u5b89\u88c5 crontab",id:"7-\u5b89\u88c5-crontab",level:2}];function i(e){const n={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,d.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://www.dmgls.com/1358.html",children:"\u81ea\u5efaDDNS\u89e3\u51b3\u52a8\u6001IP\u670d\u52a1\u5668\u8bbf\u95ee\u95ee\u9898"})}),"\n",(0,l.jsx)(n.h2,{id:"1-\u628a\u57df\u540d\u63a5\u5165cloudflare",children:"1. \u628a\u57df\u540d\u63a5\u5165cloudflare"}),"\n",(0,l.jsxs)(n.p,{children:["\u6253\u5f00",(0,l.jsx)(n.a,{href:"https://www.cloudflare.com/zh-cn/",children:"Cloudflare"}),"\uff0c\u767b\u9646\u8d26\u53f7\u6dfb\u52a0\u7f51\u7ad9\u6309\u7167\u63d0\u793a\u64cd\u4f5c"]}),"\n",(0,l.jsx)(n.h2,{id:"2-\u83b7\u53d6global-api-key",children:"2. \u83b7\u53d6Global API Key"}),"\n",(0,l.jsxs)(n.p,{children:["\u8bbf\u95ee ",(0,l.jsx)(n.a,{href:"https://dash.cloudflare.com/profile",children:"Dashboard"})," \u5728\u9875\u9762\u4e0b\u65b9\u627e\u5230 ",(0,l.jsx)(n.code,{children:"Global API Key"}),"\uff0c\u70b9\u51fb\u53f3\u4fa7\u7684 ",(0,l.jsx)(n.code,{children:"View"})," \u67e5\u770b Key\uff0c\u5e76\u4fdd\u5b58\u4e0b\u6765"]}),"\n",(0,l.jsx)(n.h2,{id:"3-\u8bbe\u7f6e\u7528\u4e8e-ddns-\u89e3\u6790\u7684\u4e8c\u7ea7\u57df\u540d\u6d41\u91cf\u4e0d\u7ecf\u8fc7cdn\u4e91\u6735\u53d8\u7070",children:"3. \u8bbe\u7f6e\u7528\u4e8e DDNS \u89e3\u6790\u7684\u4e8c\u7ea7\u57df\u540d\uff0c\u6d41\u91cf\u4e0d\u7ecf\u8fc7CDN(\u4e91\u6735\u53d8\u7070)"}),"\n",(0,l.jsxs)(n.p,{children:["\u6dfb\u52a0\u4e00\u6761A\u8bb0\u5f55\uff0c\u4f8b\u5982\uff1a",(0,l.jsx)(n.code,{children:"hkt.test.com"}),"\uff0cProxy status\u8bbe\u7f6e\u6210",(0,l.jsx)(n.code,{children:"DNS only"})]}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Type"}),(0,l.jsx)(n.th,{children:"Name"}),(0,l.jsx)(n.th,{children:"IPv4 address"}),(0,l.jsx)(n.th,{children:"TTL"}),(0,l.jsx)(n.th,{children:"Proxy status"})]})}),(0,l.jsx)(n.tbody,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"A"}),(0,l.jsx)(n.td,{children:"hkt"}),(0,l.jsx)(n.td,{children:"1.1.1.1"}),(0,l.jsx)(n.td,{children:"Auto"}),(0,l.jsx)(n.td,{children:"DNS only"})]})})]}),"\n",(0,l.jsx)(n.h2,{id:"4-\u4e0b\u8f7d-dnns-\u811a\u672c",children:"4. \u4e0b\u8f7d DNNS \u811a\u672c"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"curl https://raw.githubusercontent.com/aipeach/cloudflare-api-v4-ddns/master/cf-v4-ddns.sh > /root/cf-v4-ddns.sh && chmod +x /root/cf-v4-ddns.sh\n"})}),"\n",(0,l.jsx)(n.h2,{id:"5-\u4fee\u6539-ddns-\u811a\u672c\u5e76\u8865\u5145\u76f8\u5173\u4fe1\u606f",children:"5. \u4fee\u6539 DDNS \u811a\u672c\u5e76\u8865\u5145\u76f8\u5173\u4fe1\u606f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"nano cf-v4-ddns.sh\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"# incorrect api-key results in E_UNAUTH error\n# \u586b\u5199 Global API Key\nCFKEY=\n\n# Username, eg: user@example.com\n# \u586b\u5199 CloudFlare \u767b\u9646\u90ae\u7bb1\nCFUSER=\n\n# Zone name, eg: example.com\n# \u586b\u5199\u9700\u8981\u7528\u6765 DDNS \u7684\u4e00\u7ea7\u57df\u540d\nCFZONE_NAME=\n\n# Hostname to update, eg: homeserver.example.com\n# \u586b\u5199 DDNS \u7684\u4e8c\u7ea7\u57df\u540d(\u53ea\u9700\u586b\u5199\u524d\u7f00)\nCFRECORD_NAME=\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u9996\u6b21\u8fd0\u884c\u811a\u672c,\u8f93\u51fa\u5185\u5bb9\u4f1a\u663e\u793a\u5f53\u524dIP\uff0c\u8fdb\u5165cloudflare\u67e5\u770b \u786e\u4fddIP\u5df2\u53d8\u66f4\u4e3a\u5f53\u524dIP"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"./cf-v4-ddns.sh\n"})}),"\n",(0,l.jsx)(n.h2,{id:"6-\u8bbe\u7f6e\u5b9a\u65f6\u4efb\u52a1",children:"6. \u8bbe\u7f6e\u5b9a\u65f6\u4efb\u52a1"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"crontab -e\n*/2 * * * * /root/cf-v4-ddns.sh >/dev/null 2>&1\n# \u5982\u679c\u9700\u8981\u65e5\u5fd7\uff0c\u66ff\u6362\u4e0a\u4e00\u884c\u4ee3\u7801\n*/2 * * * * /root/cf-v4-ddns.sh >> /var/log/cf-ddns.log 2>&1\n"})}),"\n",(0,l.jsx)(n.p,{children:"2 \u5206\u949f\u68c0\u6d4b\u4e00\u6b21\uff0cIP \u662f\u5426\u6539\u53d8\u3002"}),"\n",(0,l.jsx)(n.h2,{id:"7-\u5b89\u88c5-crontab",children:"7. \u5b89\u88c5 crontab"}),"\n",(0,l.jsx)(n.p,{children:"\u53ef\u80fd\u63d0\u793a\u6ca1\u6709\u5b89\u88c5 crontab\uff0c\u6240\u4ee5\u9700\u8981\u8fd0\u884c\u4e0b\u9762\u7684\u5185\u5bb9"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"apt-get install vixie-cron  #\u62a5\u9519\u5c31\u62a5\u9519\uff0c\u6ca1\u5173\u7cfb\u7684\uff0c\u4e0b\u4e00\u6b65\napt-get install crontabs\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7b49\u6dfb\u52a0\u4e86\u4efb\u52a1\u4e4b\u540e\uff0c\u518d\u624b\u52a8\u8fd0\u884c crontab"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"service crond start  #\u8fd0\u884c crontab\nservice crond status  #\u67e5\u770b crontab \u72b6\u6001\nchkconfig crond on  #Centos6 \u5141\u8bb8 crontab \u81ea\u542f\u52a8\nsystemctl enable crond.service  #Centos7 \u5141\u8bb8 crontab \u81ea\u542f\u52a8\n"})})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(i,{...e})}):i(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>c});var l=r(96540);const d={},s=l.createContext(d);function t(e){const n=l.useContext(s);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:t(e.components),l.createElement(s.Provider,{value:n},e.children)}}}]);