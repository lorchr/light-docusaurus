"use strict";(self.webpackChunklight_docusaurus=self.webpackChunklight_docusaurus||[]).push([[9215],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>d});var a=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var o=a.createContext({}),p=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(o.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,r=e.originalType,o=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=p(n),h=l,d=c["".concat(o,".").concat(h)]||c[h]||m[h]||r;return n?a.createElement(d,s(s({ref:t},u),{},{components:n})):a.createElement(d,s({ref:t},u))}));function d(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=n.length,s=new Array(r);s[0]=h;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i[c]="string"==typeof e?e:l,s[1]=i;for(var p=2;p<r;p++)s[p]=n[p];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},2795:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>p});var a=n(7462),l=(n(7294),n(3905));const r={},s=void 0,i={unversionedId:"homeassistant/Install-HA-Core-With-LinuxDeploy",id:"homeassistant/Install-HA-Core-With-LinuxDeploy",title:"Install-HA-Core-With-LinuxDeploy",description:"- Offical",source:"@site/diy/homeassistant/Install-HA-Core-With-LinuxDeploy.md",sourceDirName:"homeassistant",slug:"/homeassistant/Install-HA-Core-With-LinuxDeploy",permalink:"/light-docusaurus/diy/homeassistant/Install-HA-Core-With-LinuxDeploy",draft:!1,editUrl:"https://github.com/lorchr/light-docusaurus/tree/main/diy/homeassistant/Install-HA-Core-With-LinuxDeploy.md",tags:[],version:"current",lastUpdatedBy:"Hui Liu",lastUpdatedAt:1696816806,formattedLastUpdatedAt:"2023\u5e7410\u67089\u65e5",frontMatter:{},sidebar:"diy",previous:{title:"Home Assistant",permalink:"/light-docusaurus/diy/category/home-assistant"},next:{title:"Router",permalink:"/light-docusaurus/diy/category/router"}},o={},p=[{value:"1. \u5b89\u88c5HA Core",id:"1-\u5b89\u88c5ha-core",level:2},{value:"1. \u51c6\u5907\u5de5\u4f5c",id:"1-\u51c6\u5907\u5de5\u4f5c",level:3},{value:"2. \u5b89\u88c5\u4f9d\u8d56",id:"2-\u5b89\u88c5\u4f9d\u8d56",level:3},{value:"3. \u521b\u5efa <code>homeassistant</code> \u7528\u6237",id:"3-\u521b\u5efa-homeassistant-\u7528\u6237",level:3},{value:"4. \u521b\u5efa\u865a\u62df\u8fd0\u884c\u73af\u5883",id:"4-\u521b\u5efa\u865a\u62df\u8fd0\u884c\u73af\u5883",level:3},{value:"5. \u5b89\u88c5HA Core",id:"5-\u5b89\u88c5ha-core",level:3},{value:"6. \u542f\u52a8 HA",id:"6-\u542f\u52a8-ha",level:3},{value:"2. \u5b89\u88c5\u9047\u5230\u7684\u95ee\u9898",id:"2-\u5b89\u88c5\u9047\u5230\u7684\u95ee\u9898",level:2}],u={toc:p},c="wrapper";function m(e){let{components:t,...n}=e;return(0,l.kt)(c,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.home-assistant.io"},"Offical")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.home-assistant.io/installation/raspberrypi"},"Offical Raspberry Pi")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.home-assistant.io/installation/#linux"},"Offical Linux")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.bilibili.com/read/cv17279212"},"\u65e7\u624b\u673a\u642d\u5efaHome Assistant\uff08\u57fa\u4e8eLinux Deploy\uff09"))),(0,l.kt)("h2",{id:"1-\u5b89\u88c5ha-core"},"1. \u5b89\u88c5HA Core"),(0,l.kt)("h3",{id:"1-\u51c6\u5907\u5de5\u4f5c"},"1. \u51c6\u5907\u5de5\u4f5c"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5728 ",(0,l.kt)("inlineCode",{parentName:"li"},"/etc")," \u76ee\u5f55\u4e0b\u521b\u5efa ",(0,l.kt)("inlineCode",{parentName:"li"},"pip.conf")," \u6587\u4ef6\uff0c\u4f7f\u7528\u56fd\u5185\u6e90")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-conf"},"[global]\ntimeout=100\nindex-url=https://mirrors.aliyun.com/pypi/simple/\nextra-index-url=https://www.piwheels.org/simple\n[install]\ntrusted-host=\n    pypi.mirrors.ustc.edu.cn\n    mirrors.aliyun.com\n")),(0,l.kt)("ol",{start:2},(0,l.kt)("li",{parentName:"ol"},"\u975e\u9ed8\u8ba4\u7528\u6237ping\u4e0d\u901a\u5916\u7f51\u7684\u95ee\u9898")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"# \u5b89\u88c5\u5de5\u5177\u5305\napt install vim wget net-tools\n\n# \u4fee\u6539DNS \u6dfb\u52a0 nameserver 8.8.8.8\nvim /etc/resolv.conf \n\n# \u5982\u679c\u6dfb\u52a0DNS\u540e\u8fd8\u662fping\u4e0d\u901a\u5916\u7f51\u7ee7\u7eed\u4e0b\u9762\u64cd\u4f5c\n\n# \u67e5\u770b\u8def\u7531\u4e2d\u7684\u7f51\u5173\u8bbe\u7f6e\nnetstat -rn \n\n# \u6dfb\u52a0\u8def\u7531\u7f51\u5173\uff08\u4e34\u65f6\uff09\nroute add default gw 192.168.0.1\n\n# \u9759\u6001\u8def\u7531\u52a0\u5230 /etc/sysconfig/static-routes \u6587\u4ef6\u4e2d\uff08\u6c38\u4e45\uff09\nroute add default gw 192.168.0.1\nany net default gw 192.168.0.1\n\n# \u7f16\u8f91\u7f51\u5361\nvim /etc/network/interfaces\n\n# \u91cd\u542f\u7f51\u5361\nservice network restart\n")),(0,l.kt)("p",null,"\u4fee\u6539\u65e0\u6548\u540e\u7eed\u76f4\u63a5\u7528Root\u7528\u6237\u64cd\u4f5c"),(0,l.kt)("ol",{start:3},(0,l.kt)("li",{parentName:"ol"},"\u5b89\u88c5 ",(0,l.kt)("a",{parentName:"li",href:"https://www.sqlite.org/download.html"},"SQLite")," ")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"wget https://www.sqlite.org/2023/sqlite-autoconf-3420000.tar.gz\ntar -zxvf sqlite-autoconf-3420000.tar.gz\ncd sqlite-autoconf-3420000\n./configure\nmake && make install\n\nsqlite3 --version\n")),(0,l.kt)("ol",{start:4},(0,l.kt)("li",{parentName:"ol"},"\u5b89\u88c5 ",(0,l.kt)("a",{parentName:"li",href:"https://www.python.org/downloads/source/"},"Python 3.10"),"\nHA\u5b89\u88c5\u5bf9Python\u7684\u7248\u672c\u6709\u8981\u6c42\uff0c\u5f53\u524d\u7248\u672c\u8981\u6c42 >= 3.10")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'# \u5b89\u88c5\u4f9d\u8d56\nsudo apt install build-essential zlib1g-dev libncurses5-dev libgdbm-dev libnss3-dev libssl-dev libreadline-dev libffi-dev wget\n\n# openssl\u7248\u672c\u9700\u8981\u57281.1.1\u4ee5\u4e0a\nopenssl version\n\n# \u521b\u5efa\u5b89\u88c5\u76ee\u5f55\n# \u5728\u914d\u7f6e\u6587\u4ef6\u65f6\u901a\u8fc7--prefix\u6307\u5b9a\u5b89\u88c5\u8def\u5f84\nmkdir /usr/local/python3.10\n\n# \u4e0b\u8f7d\u5b89\u88c5\u5305\ncd /tmp\nwget https://www.python.org/ftp/python/3.10.0/Python-3.10.0.tgz\ntar -xvf Python-3.10.0.tgz\n\n# \u6267\u884c\u914d\u7f6e\u6587\u4ef6 \ncd /tmp/Python-3.10.0\n./configure --prefix=/usr/local/python3.10\n#\u6839\u636e\u63d0\u793a\u6267\u884c\u5982\u4e0b\u4ee3\u7801\u5bf9python\u89e3\u91ca\u5668\u8fdb\u884c\u4f18\u5316\n#\u6267\u884c\u540e\u65e0\u5e8f\u989d\u5916\u914d\u7f6e\u53ef\u76f4\u63a5\u4f7f\u7528python3\u8c03\u7528python\u7f16\u8f91\u5668\n./configure --enable-optimizations\n\n# \u53e6\u4e00\u79cd\u914d\u7f6e\nLD_RUN_PATH=/usr/local/lib ./configure LDFLAGS="-L/usr/local/lib" CPPFLAGS="-I/usr/local/include"\nLD_RUN_PATH=/usr/local/lib make\nsudo make install\n\n# \u7f16\u8bd1 \u5b89\u88c5Python\nmake && make install\n\n# \u67e5\u770b\u7248\u672c\npython3 --version\npip3 --version\n\n#\u5347\u7ea7pip\u7248\u672c\npip3 install --upgrade pip\n')),(0,l.kt)("p",null,"\u67e5\u770bpython\u4f7f\u7528\u7684sqlite\u7248\u672c"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"python3\n>>> import sqlite3\n>>> sqlite3.sqlite_version\n'3.42.0'\n>>> quit()\n")),(0,l.kt)("h3",{id:"2-\u5b89\u88c5\u4f9d\u8d56"},"2. \u5b89\u88c5\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"# \u5207\u6362root\u7528\u6237\nsu -\n\n# \u66f4\u65b0\u8f6f\u4ef6\u6e90\napt update\n\n# \u5347\u7ea7\u8f6f\u4ef6\u5305\napt upgrade -y\n\n# \u5b89\u88c5\u4f9d\u8d56\napt install -y python3 python3-dev python3-venv python3-pip bluez libffi-dev libssl-dev libjpeg-dev zlib1g-dev autoconf build-essential libopenjp2-7 libtiff5 libturbojpeg0-dev tzdata ffmpeg liblapack3 liblapack-dev libatlas-base-dev\n\n# \u7248\u672c\u4e0d\u5bf9\u9700\u8981\u5378\u8f7d\napt remove -y python3 python3-dev python3-venv python3-pip\n")),(0,l.kt)("h3",{id:"3-\u521b\u5efa-homeassistant-\u7528\u6237"},"3. \u521b\u5efa ",(0,l.kt)("inlineCode",{parentName:"h3"},"homeassistant")," \u7528\u6237"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"useradd -rm homeassistant\n")),(0,l.kt)("h3",{id:"4-\u521b\u5efa\u865a\u62df\u8fd0\u884c\u73af\u5883"},"4. \u521b\u5efa\u865a\u62df\u8fd0\u884c\u73af\u5883"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u521b\u5efa\u5b89\u88c5\u76ee\u5f55\u53ca\u66f4\u6539\u6388\u6743")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"# \u521b\u5efa\u76ee\u5f55\nmkdir /srv/homeassistant\n\n# \u4fee\u6539\u76ee\u5f55\u6388\u6743\u5230 homeassistant \u7528\u6237\nchown homeassistant:homeassistant /srv/homeassistant\n")),(0,l.kt)("ol",{start:2},(0,l.kt)("li",{parentName:"ol"},"\u521b\u5efa\u5e76\u8f6c\u5230 HA Core\u7684\u865a\u62df\u73af\u5883")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"# \u5207\u6362\u5230 homeassistant \u7528\u6237\nsudo -u homeassistant -H -s\n\n# \u8fdb\u5165\u5b89\u88c5\u76ee\u5f55\ncd /srv/homeassistant\n\n# \u521d\u59cb\u5316\u865a\u62df\u73af\u5883\npython3 -m venv .\n\n# \u6fc0\u6d3b\u73af\u5883\nsource bin/activate\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6ce8\uff1a")," \u540e\u7eed\u64cd\u4f5c\u5931\u8d25\u53ef\u4ee5\u76f4\u63a5\u7528root\u7528\u6237"),(0,l.kt)("h3",{id:"5-\u5b89\u88c5ha-core"},"5. \u5b89\u88c5HA Core"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5b89\u88c5Python\u4f9d\u8d56")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"# \u5347\u7ea7pip\u7248\u672c\uff0c\u5e76\u6539\u6210\u56fd\u5185\u6e90\u52a0\u5feb\u4e0b\u8f7d\u901f\u5ea6\npython3 -m pip install --upgrade pip\npip3 config set global.index-url https://mirrors.aliyun.com/pypi/simple/\n\n# \u66f4\u65b0setuptools\u548cwheel\u7684\u7248\u672c\npython3 -m pip install --upgrade setuptools\npython3 -m pip install --upgrade wheel\n")),(0,l.kt)("ol",{start:2},(0,l.kt)("li",{parentName:"ol"},"\u5b89\u88c5 HA Core")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"pip3 install homeassistant==2023.7.3\n")),(0,l.kt)("h3",{id:"6-\u542f\u52a8-ha"},"6. \u542f\u52a8 HA"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u8fd0\u884c")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"hass\n")),(0,l.kt)("ol",{start:2},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u8bbf\u95ee",(0,l.kt)("a",{parentName:"p",href:"http://192.168.0.101:8123"},"\u63a7\u5236\u53f0")," ")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u5176\u4ed6\u547d\u4ee4"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"# \u540e\u53f0\u8fd0\u884chass\nnohup hass > hass.log 2>&1 &\n\n# tail\u67e5\u770b\u65e5\u5fd7\ntail hass.log\n\n# \u4ee5\u540essh\u8fde\u63a5\u540e\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u6fc0\u6d3b\u865a\u62df\u73af\u5883\nsource /srv/homeassistant/bin/activate\n\n# \u9000\u51fa\u865a\u62df\u73af\u5883\ndeactivate\n")),(0,l.kt)("h2",{id:"2-\u5b89\u88c5\u9047\u5230\u7684\u95ee\u9898"},"2. \u5b89\u88c5\u9047\u5230\u7684\u95ee\u9898"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u975e\u9ed8\u8ba4\u7528\u6237Ping\u4e0d\u901a\u5916\u7f51"),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("a",{parentName:"li",href:"https://blog.csdn.net/qq_48901063/article/details/129559593"},"https://blog.csdn.net/qq_48901063/article/details/129559593")),(0,l.kt)("li",{parentName:"ol"},"\u4f7f\u7528root\u6216\u9ed8\u8ba4\u7528\u6237\u5b89\u88c5"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Python\u7248\u672c\u8fc7\u4f4e "),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},"\u624b\u52a8\u7f16\u8bd1\u5b89\u88c5\u65b0\u7248"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"home-assistant\u5b89\u88c5\u5931\u8d25 error: can't find Rust compiler"),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},"\u5b89\u88c5Rust")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"apt install -y curl\n# \u5b89\u88c5\ncurl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh\n# \u914d\u7f6e\u73af\u5883\u53d8\u91cf\nvim /etc/profile \n~/.cargo/bin\nsource /etc/profile\n# \u67e5\u770b\u7248\u672c\nrustc --version\n# \u5378\u8f7d\nrustup self uninstall\n\nhttps://static.rust-lang.org/rustup/dist/armv7-linux-android-gnueabihf/rustup-init\n")))))}m.isMDXComponent=!0}}]);