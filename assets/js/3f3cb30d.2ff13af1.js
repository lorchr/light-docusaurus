"use strict";(self.webpackChunklight_docusaurus=self.webpackChunklight_docusaurus||[]).push([[5278],{16372:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>l,metadata:()=>t,toc:()=>o});var r=s(85893),i=s(11151);const l={title:"Docusaurus With Algolia",authors:["lorchr"],tags:["docusaurus","algolia","docsearch","crawler"],image:"../img/docusaurus.png",date:new Date("2023-08-07T00:00:00.000Z")},a=void 0,t={permalink:"/light-docusaurus/blog/2023/08/07/docusaurus-with-aglolia",editUrl:"https://github.com/lorchr/light-docusaurus/tree/main/blog/2023-08-07-docusaurus-with-aglolia/index.md",source:"@site/blog/2023-08-07-docusaurus-with-aglolia/index.md",title:"Docusaurus With Algolia",description:"- Alogolia Offical",date:"2023-08-07T00:00:00.000Z",formattedDate:"2023\u5e748\u67087\u65e5",tags:[{label:"docusaurus",permalink:"/light-docusaurus/blog/tags/docusaurus"},{label:"algolia",permalink:"/light-docusaurus/blog/tags/algolia"},{label:"docsearch",permalink:"/light-docusaurus/blog/tags/docsearch"},{label:"crawler",permalink:"/light-docusaurus/blog/tags/crawler"}],readingTime:4.78,hasTruncateMarker:!1,authors:[{name:"Hui Liu",title:"Author",url:"https://github.com/lorchr",twitter:"lorchr",email:"whitetulips@163.com",imageURL:"https://github.com/lorchr.png",key:"lorchr"}],frontMatter:{title:"Docusaurus With Algolia",authors:["lorchr"],tags:["docusaurus","algolia","docsearch","crawler"],image:"../img/docusaurus.png",date:"2023-08-07T00:00:00.000Z"},unlisted:!1,prevItem:{title:"Spring Boot Slice Upload with Minio(S3) and LocalFileSystem",permalink:"/light-docusaurus/blog/2023/12/22/file-slice-upload"},nextItem:{title:"Welcome",permalink:"/light-docusaurus/blog/welcome"}},c={authorsImageUrls:[void 0]},o=[{value:"1. \u6ce8\u518cAlgolia\u8d26\u53f7\uff0c\u7533\u8bf7 Docsearch",id:"1-\u6ce8\u518calgolia\u8d26\u53f7\u7533\u8bf7-docsearch",level:2},{value:"2. \u521b\u5efa Application",id:"2-\u521b\u5efa-application",level:2},{value:"3. Web\u7aef\u90e8\u7f72\u722c\u866b",id:"3-web\u7aef\u90e8\u7f72\u722c\u866b",level:2},{value:"4. \u914d\u7f6e Docusaurus",id:"4-\u914d\u7f6e-docusaurus",level:2},{value:"5. \u6267\u884c\u722c\u866b\u7a0b\u5e8f - docsearch-scraper",id:"5-\u6267\u884c\u722c\u866b\u7a0b\u5e8f---docsearch-scraper",level:2},{value:"1. \u672c\u5730 \u6267\u884c\u722c\u866b",id:"1-\u672c\u5730-\u6267\u884c\u722c\u866b",level:3},{value:"2. GitHub Actions \u6267\u884c\u722c\u866b",id:"2-github-actions-\u6267\u884c\u722c\u866b",level:3}];function h(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.ah)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.algolia.com/",children:"Alogolia Offical"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/algolia",children:"Alogolia Github"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://docsearch.algolia.com/",children:"Algolia Docsearch \u5f00\u53d1\u8005\u8bd5\u7528"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://crawler.algolia.com/admin/users/login",children:"Algolia Crawler \u722c\u866b"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://docusaurus.io/zh-CN/docs/search#using-algolia-docsearch",children:"Algolia DocSearch \u63d2\u4ef6\u6587\u6863"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://docusaurus.io/zh-CN/docs/api/plugins/@docusaurus/plugin-sitemap",children:"sitemap \u63d2\u4ef6\u6587\u6863"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://docusaurus.io/docs/search#using-algolia-docsearch",children:"Docusaurus integrate Algolia"})}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"1-\u6ce8\u518calgolia\u8d26\u53f7\u7533\u8bf7-docsearch",children:"1. \u6ce8\u518cAlgolia\u8d26\u53f7\uff0c\u7533\u8bf7 Docsearch"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://docusaurus.io/zh-CN/docs/search#using-algolia-docsearch",children:"Docusaurus\u96c6\u6210Algolia"})}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\u4f7f\u7528Github\u8d26\u53f7\u6ce8\u518c",(0,r.jsx)(e.a,{href:"https://dashboard.algolia.com/users/sign_in",children:"Algolia"})]}),"\n",(0,r.jsxs)(e.li,{children:["\u53bb",(0,r.jsx)(e.a,{href:"https://docsearch.algolia.com/",children:"Docsearch"}),"\u7533\u8bf7\uff0c\u9700\u8981\u586b\u5199\u4ee5\u4e0b\u5185\u5bb9","\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["Github pages \u5730\u5740: ",(0,r.jsx)(e.a,{href:"https://lorchr.github.io/light-docusaurus/",children:"https://lorchr.github.io/light-docusaurus/"})]}),"\n",(0,r.jsxs)(e.li,{children:["\u90ae\u7bb1 ",(0,r.jsx)(e.a,{href:"mailto:whitetulips@163.com",children:"whitetulips@163.com"})]}),"\n",(0,r.jsxs)(e.li,{children:["\u4ed3\u5e93\u5730\u5740 ",(0,r.jsx)(e.a,{href:"https://github.com/lorchr/light-docusaurus",children:"https://github.com/lorchr/light-docusaurus"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"\u7b49\u5f85\u5ba1\u6838\uff0c\u5ba1\u6838\u901a\u8fc7\u4f1a\u6536\u5230\u4e00\u5c01\u90ae\u4ef6"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"2-\u521b\u5efa-application",children:"2. \u521b\u5efa Application"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\u767b\u5f55",(0,r.jsx)(e.a,{href:"https://dashboard.algolia.com/users/sign_in",children:"Algolia\u5b98\u7f51"})]}),"\n",(0,r.jsx)(e.li,{children:"\u521b\u5efaApplication\uff0c\u8bbe\u7f6e\u540d\u79f0\uff0c\u9009\u62e9\u514d\u8d39\u8ba1\u5212"}),"\n",(0,r.jsxs)(e.li,{children:["\u63a7\u5236\u53f0\u6253\u5f00\uff0c\u8bbe\u7f6e\u9875\u9762\uff0c\u70b9\u51fb API Keys\uff0c\u8bb0\u5f55\u4ee5\u4e0b\u5185\u5bb9","\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:"Application ID"}),"\n",(0,r.jsx)(e.li,{children:"Search-Only API Key"}),"\n",(0,r.jsx)(e.li,{children:"Admin API Key"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"3-web\u7aef\u90e8\u7f72\u722c\u866b",children:"3. Web\u7aef\u90e8\u7f72\u722c\u866b"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\u5728DocSearch\u5ba1\u6838\u901a\u8fc7\u540e\uff0c\u5efa\u7acb\u5e94\u7528\u53ca\u7d22\u5f15\uff0c\u83b7\u53d6",(0,r.jsx)(e.code,{children:"APPLICAITON_ID"}),"\u53ca",(0,r.jsx)(e.code,{children:"API_KEY"})]}),"\n",(0,r.jsxs)(e.li,{children:["\u4f7f\u7528Algolia\u8d26\u53f7\u767b\u5f55",(0,r.jsx)(e.a,{href:"https://crawler.algolia.com/admin/users/login",children:"Algolia Crawler"})]}),"\n",(0,r.jsxs)(e.li,{children:["\u4f7f\u7528\u5b98\u65b9\u6a21\u677f\u914d\u7f6e",(0,r.jsx)(e.a,{href:"https://docsearch.algolia.com/docs/templates#docusaurus-v3-template",children:"Docusaurus v3 template"}),"\u90e8\u7f72\u722c\u866b"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"new Crawler({\n  appId: 'TLGHDZ3Y2I',\n  apiKey: '0b9a9b1f4fd5fbe9a1962088169c1262',\n  rateLimit: 8,\n  maxDepth: 10,\n  startUrls: ['https://lorchr.github.io/light-docusaurus/'],\n  sitemaps: ['https://lorchr.github.io/light-docusaurus/sitemap.xml'],\n  ignoreCanonicalTo: true,\n  discoveryPatterns: ['https://lorchr.github.io/light-docusaurus/**'],\n  actions: [\n    {\n      indexName: 'light-docusaurus',\n      pathsToMatch: ['https://lorchr.github.io/light-docusaurus/**'],\n      recordExtractor: ({ $, helpers }) => {\n        // priority order: deepest active sub list header -> navbar active item -> 'Documentation'\n        const lvl0 =\n          $(\n            '.menu__link.menu__link--sublist.menu__link--active, .navbar__item.navbar__link--active'\n          )\n            .last()\n            .text() || 'Documentation';\n\n        return helpers.docsearch({\n          recordProps: {\n            lvl0: {\n              selectors: '',\n              defaultValue: lvl0,\n            },\n            lvl1: ['header h1', 'article h1'],\n            lvl2: 'article h2',\n            lvl3: 'article h3',\n            lvl4: 'article h4',\n            lvl5: 'article h5, article td:first-child',\n            lvl6: 'article h6',\n            content: 'article p, article li, article td:last-child',\n          },\n          indexHeadings: true,\n          aggregateContent: true,\n          recordVersion: 'v3',\n        });\n      },\n    },\n  ],\n  initialIndexSettings: {\n    YOUR_INDEX_NAME: {\n      attributesForFaceting: [\n        'type',\n        'lang',\n        'language',\n        'version',\n        'docusaurus_tag',\n      ],\n      attributesToRetrieve: [\n        'hierarchy',\n        'content',\n        'anchor',\n        'url',\n        'url_without_anchor',\n        'type',\n      ],\n      attributesToHighlight: ['hierarchy', 'content'],\n      attributesToSnippet: ['content:10'],\n      camelCaseAttributes: ['hierarchy', 'content'],\n      searchableAttributes: [\n        'unordered(hierarchy.lvl0)',\n        'unordered(hierarchy.lvl1)',\n        'unordered(hierarchy.lvl2)',\n        'unordered(hierarchy.lvl3)',\n        'unordered(hierarchy.lvl4)',\n        'unordered(hierarchy.lvl5)',\n        'unordered(hierarchy.lvl6)',\n        'content',\n      ],\n      distinct: true,\n      attributeForDistinct: 'url',\n      customRanking: [\n        'desc(weight.pageRank)',\n        'desc(weight.level)',\n        'asc(weight.position)',\n      ],\n      ranking: [\n        'words',\n        'filters',\n        'typo',\n        'attribute',\n        'proximity',\n        'exact',\n        'custom',\n      ],\n      highlightPreTag: '<span class=\"algolia-docsearch-suggestion--highlight\">',\n      highlightPostTag: '</span>',\n      minWordSizefor1Typo: 3,\n      minWordSizefor2Typos: 7,\n      allowTyposOnNumericTokens: false,\n      minProximity: 1,\n      ignorePlurals: true,\n      advancedSyntax: true,\n      attributeCriteriaComputedByMinProximity: true,\n      removeWordsIfNoResults: 'allOptional',\n      separatorsToIndex: '_',\n    },\n  },\n});\n"})}),"\n",(0,r.jsx)(e.h2,{id:"4-\u914d\u7f6e-docusaurus",children:"4. \u914d\u7f6e Docusaurus"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:"\u914d\u7f6e .env (\u952e\u503c\u4e0d\u5e26\u53cc\u5f15\u53f7)"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"APPLICATION_ID=Application ID\nAPI_KEY=Admin API Key # \u52a1\u5fc5\u786e\u8ba4, \u8fd9\u662f\u5751\u70b9 \u4e0d\u8981\u7528 'Write API Key' \u6216\u8005 'Search API Key'\n"})}),"\n",(0,r.jsxs)(e.ol,{start:"2",children:["\n",(0,r.jsx)(e.li,{children:"docusaurus.config.js"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"module.exports = {\n  // ...\n  presets: [[\n    // ...\n    \"classic\",\n    /** @type {import('@docusaurus/preset-classic').Options} */\n    ({\n      // \u8fd9\u4e2a\u63d2\u4ef6\u4f1a\u4e3a\u4f60\u7684\u7ad9\u70b9\u521b\u5efa\u4e00\u4e2a\u7ad9\u70b9\u5730\u56fe\n      // \u4ee5\u4fbf\u641c\u7d22\u5f15\u64ce\u7684\u722c\u866b\u80fd\u591f\u66f4\u51c6\u786e\u5730\u722c\u53d6\u4f60\u7684\u7f51\u7ad9\n      sitemap: {\n        changefreq: \"weekly\",\n        priority: 0.5,\n        ignorePatterns: [\"/tags/**\"],\n        filename: \"sitemap.xml\",\n      },\n    })\n  ]],\n  // ...\n  themeConfig: {\n    // ...\n    algolia: {\n      appId: 'YOUR_APP_ID', // Application ID\n      //  \u516c\u5f00 API\u5bc6\u94a5\uff1a\u63d0\u4ea4\u5b83\u6ca1\u6709\u5371\u9669\n      apiKey: 'YOUR_SEARCH_API_KEY', //  Search-Only API Key\n      indexName: 'YOUR_INDEX_NAME'\n    },\n  }\n}\n"})}),"\n",(0,r.jsxs)(e.ol,{start:"3",children:["\n",(0,r.jsx)(e.li,{children:"docsearch-config.json (\u722c\u866b\u914d\u7f6e\u6587\u4ef6)"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u9700\u4fee\u65393\u5904:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"index_name"}),"\n",(0,r.jsx)(e.li,{children:"start_urls"}),"\n",(0,r.jsx)(e.li,{children:"sitemap_urls"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:'{\n  "index_name": "light-docusaurus",\n  "start_urls": [\n    "https://lorchr.github.io/light-docusaurus/"\n  ],\n  "sitemap_urls": [\n    "https://lorchr.github.io/light-docusaurus/sitemap.xml"\n  ],\n  "sitemap_alternate_links": true,\n  "stop_urls": [\n    "/tests"\n  ],\n  "selectors": {\n    "lvl0": {\n      "selector": "(//ul[contains(@class,\'menu__list\')]//a[contains(@class, \'menu__link menu__link--sublist menu__link--active\')]/text() | //nav[contains(@class, \'navbar\')]//a[contains(@class, \'navbar__link--active\')]/text())[last()]",\n      "type": "xpath",\n      "global": true,\n      "default_value": "Documentation"\n    },\n    "lvl1": "header h1",\n    "lvl2": "article h2",\n    "lvl3": "article h3",\n    "lvl4": "article h4",\n    "lvl5": "article h5, article td:first-child",\n    "lvl6": "article h6",\n    "text": "article p, article li, article td:last-child"\n  },\n  "strip_chars": " .,;:#",\n  "custom_settings": {\n    "separatorsToIndex": "_",\n    "attributesForFaceting": [\n      "language",\n      "version",\n      "type",\n      "docusaurus_tag"\n    ],\n    "attributesToRetrieve": [\n      "hierarchy",\n      "content",\n      "anchor",\n      "url",\n      "url_without_anchor",\n      "type"\n    ]\n  },\n  "js_render": true,\n  "conversation_id": [\n    "833762294"\n  ],\n  "nb_hits": 46250\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"5-\u6267\u884c\u722c\u866b\u7a0b\u5e8f---docsearch-scraper",children:"5. \u6267\u884c\u722c\u866b\u7a0b\u5e8f - docsearch-scraper"}),"\n",(0,r.jsx)(e.h3,{id:"1-\u672c\u5730-\u6267\u884c\u722c\u866b",children:"1. \u672c\u5730 \u6267\u884c\u722c\u866b"}),"\n",(0,r.jsx)(e.p,{children:"\u524d\u7f6e\u6761\u4ef6:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Docker"}),"\n",(0,r.jsxs)(e.li,{children:["jq - \u8f7b\u91cf\u7ea7\u547d\u4ee4\u884c JSON \u5904\u7406\u5668",(0,r.jsx)(e.a,{href:"https://github.com/stedolan/jq/wiki/Installation#zero-install",children:"\u4f7f\u7528 brew \u5b89\u88c5\u6700\u65b0\u7248\u7684 jq"})]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"jq\u5b89\u88c5\u5b8c\u6210\u540e, \u5728\u547d\u4ee4\u884c\u6267\u884c \u722c\u866b\u811a\u672c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-shell",children:'docker run -it --env-file=.env -e "CONFIG=$(cat docsearch-config.json | jq -r tostring)" algolia/docsearch-scraper\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u7b49\u5f85 \u5bb9\u5668\u8fd0\u884c\u5b8c\u6210, \u5982\u4e0b\u5373\u53ef"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-shell",children:"Getting https://lorchr.github.io/light-docusaurus/docs/react/hooks/custom-hooks from selenium\nGetting https://lorchr.github.io/light-docusaurus/docs/react/hooks/useMemo from selenium\nGetting https://lorchr.github.io/light-docusaurus/docs/react/hooks/useCallback from selenium\nGetting https://lorchr.github.io/light-docusaurus/docs/javascript/versions/es-2016 from selenium\nGetting https://lorchr.github.io/light-docusaurus/docs/javascript/versions/es-2015 from selenium\n> DocSearch: https://lorchr.github.io/light-docusaurus/docs/plugins-and-libraries/big-screen/ 17 records)\n> DocSearch: https://lorchr.github.io/light-docusaurus/docs/server/nginx/nginx-forward-proxy-vs-reverse-proxy/ 8 records)\n> DocSearch: https://lorchr.github.io/light-docusaurus/docs/category/caddy/ 3 records)\n> DocSearch: https://lorchr.github.io/light-docusaurus/docs/category/nginx/ 5 records)\n\nNb hits: 1369\n"})}),"\n",(0,r.jsx)(e.h3,{id:"2-github-actions-\u6267\u884c\u722c\u866b",children:"2. GitHub Actions \u6267\u884c\u722c\u866b"}),"\n",(0,r.jsxs)(e.p,{children:["\u5728 ",(0,r.jsx)(e.code,{children:".github/workflows/"})," \u6587\u4ef6\u5939\u4e0b \u521b\u5efa ",(0,r.jsx)(e.code,{children:"docsearch-scraper.yml"}),", \u7528\u6765\u5b9a\u4e49 GitHub Actions \u5de5\u4f5c\u6d41"]}),"\n",(0,r.jsx)(e.p,{children:"docsearch-scraper.yml"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:'name: DocSearch-Scraper\n\non:\n  push:\n    branches: [main]\n  pull_request:\n    branches: [main]\n\njobs:\n  scan:\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Sleep for 10 seconds\n        run: sleep 10s\n        shell: bash\n\n      - name: Checkout repo\n        uses: actions/checkout@v3\n\n      - name: Run scraper\n        env:\n          APPLICATION_ID: ${{ secrets.ALGOLIA_APPLICATION_ID }}\n          API_KEY: ${{ secrets.ALGOLIA_API_KEY }}\n        run: |\n          CONFIG="$(cat docsearch-config.json)"\n          docker run -i --rm \\\n                  -e APPLICATION_ID=$APPLICATION_ID \\\n                  -e API_KEY=$API_KEY \\\n                  -e CONFIG="${CONFIG}" \\\n                  algolia/docsearch-scraper\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u7136\u540e\u5728 GitHub \u7684 Secrets \u521b\u5efa"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"APPLICATION_ID"}),"\n",(0,r.jsx)(e.li,{children:"API_KEY"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u5f53\u4f7f\u7528 Git \u63a8\u9001\u9879\u76ee\u5230 GitHub\u65f6, Actions\u5c31\u4f1a\u81ea\u52a8\u6267\u884c \u722c\u866b\u4efb\u52a1"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://didilinkin.cn/blog/algoliasearch",children:"\u5728 Docusaurus v2 \u4e2d\u4f7f\u7528 Algolia DocSearch\u641c\u7d22\u529f\u80fd"})})]})}function u(n={}){const{wrapper:e}={...(0,i.ah)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(h,{...n})}):h(n)}},11151:(n,e,s)=>{s.d(e,{ah:()=>l});var r=s(67294);const i=r.createContext({});function l(n){const e=r.useContext(i);return r.useMemo((()=>"function"==typeof n?n(e):{...e,...n}),[e,n])}}}]);